---
title: K3S vs K0S
slug: k3s-vs-k0s
tags:
  - Kubernetes
  - DevOps
---

# K0S vs K3S

| vs.               | k0s                               | k3s                                   |
| ----------------- | --------------------------------- | ------------------------------------- |
| since             | 2020-06                           | 2019-03                               |
| by                | Mirants                           | Rancher/SUSE                          |
| Governance        | Mirants                           | CNCF                                  |
| Github            | [k0sproject/k0s]                  | [k3s-io/k3s]                          |
| Stars             | [![][k0s-stars]][k0sproject/k0s]  | [![][k3s-stars]][k3s-io/k3s]          |
| Issues            | [![][k0s-issues]][k0sproject/k0s] | [![][k3s-issues]][k3s-io/k3s]         |
| CNI               | kube-router,calico                | flannel                               |
| CRI               | containerd                        | containerd                            |
| CSI               | OpenEBS                           | local-path-provisioner                |
| Windows           | âœ… - calico                       | âŒ                                    |
| Arch              | amd64,arm,arm64                   | amd64,arm,arm64                       |
| LoadBalancer      | n/a                               | klipper-lb                            |
| Ingress           | n/a                               | traefik                               |
| Controller-Worker | [konnectivity]                    | [remotedialer] - WebSocket åå‘ä»£ç†   |
| æ–‡æ¡£              | â­ï¸â­ï¸                            | â­ï¸â­ï¸                                |
| æˆç†Ÿ              | â­ï¸â­ï¸                            | â­ï¸â­ï¸â­ï¸                             |
| å›½å†…ç¯å¢ƒå‹å¥½      | â­ï¸                               | â­ï¸â­ï¸â­ï¸                             |
| Pod CIDR          | 10.244.0.0/16                     | 10.42.0.0/16                          |
| Service CIDR      | 10.96.0.0/12                      | 10.43.0.0/16                          |
| CoreDNS           | 10.96.0.10                        | 10.43.0.10                            |
| configuration     | /etc/k0s/k0s.yaml                 | /etc/rancher/k3s/config.yaml          |
| registry          | /etc/k0s/k0s.yaml                 | /etc/rancher/k3s/registry.yaml        |
| data-dir          | /var/lib/k0s                      | /var/lib/rancher/k3s                  |
| bin-dir           | /var/lib/k0s/bin                  | n/a                                   |
| kubeconfig        | /var/lib/k0s/pki/admin.conf       | /etc/rancher/k3s/k3s.yaml             |
| manifest          | /var/lib/k0s/manifests            | /var/lib/rancher/k3s/server/manifests |
| local storage     | /var/openebs/local                | /var/lib/rancher/k3s/storage/         |
| æœåŠ¡è¿è¡Œæ–¹å¼      | supervisor - ç‹¬ç«‹å¤šè¿›ç¨‹           | embeded - å•è¿›ç¨‹                      |
| containerd        | bundled                           | ç³»ç»Ÿ                                  |

[k0s-issues]: https://img.shields.io/github/issues/k0sproject/k0s
[k0s-stars]: https://img.shields.io/github/stars/k0sproject/k0s
[k0s]: https://wener.me/notes/devops/kubernetes/distro/k0s
[k0sproject/k0s]: https://github.com/k0sproject/k0s
[k3s-io/k3s]: https://github.com/k3s-io/k3s
[k3s-issues]: https://img.shields.io/github/issues/k3s-io/k3s
[k3s-stars]: https://img.shields.io/github/stars/k3s-io/k3s
[k3s]: https://wener.me/notes/devops/kubernetes/distro/k3s
[k0s]: https://wener.me/notes/devops/kubernetes/distro/k0s
[remotedialer]: https://github.com/rancher/remotedialer
[konnectivity]: https://kubernetes.io/docs/tasks/extend-kubernetes/setup-konnectivity/

<!-- more -->

- [k0s]
  - CIS security benchmark
  - ç¬¦åˆ FIPS 140-2 è¦æ±‚
  - bundled
    - iptables, containerd, ctr, runc, etcd, kine
    - openebs
      - openebs-hostpath -> /var/openebs/local
    - kube-router
    - konnectivity
    - helm-controller
- [k3s]
  - CNCF é¡¹ç›® - è„±ç¦»äº† rancher
  - bundled
    - containerd, ctr, runc, etcd, kine
    - helm-controller - æ”¯æŒéƒ¨ç½² helm chart, CDR æ§åˆ¶
    - traefik - æä¾› ingress èƒ½åŠ› - é€šè¿‡ helm éƒ¨ç½²
    - local-path-provisioner - æä¾›åŸºäºæœ¬åœ°ç›®å½•çš„å­˜å‚¨ç±»
      - é»˜è®¤ /var/lib/rancher/k3s/storage
    - klipper-lb - åŸºäº iptable è½¬å‘çš„è´Ÿè½½å‡è¡¡

:::caution

- k3s é»˜è®¤åŒ…å«è¾ƒå¤šç»„ä»¶ï¼Œéƒ¨ç½²å å¯ä½¿ç”¨æ€§ æ›´é«˜ï¼Œä½†éƒ¨åˆ†ç»„ä»¶ï¼ˆ traefik,klipper-lb,local-path-provisioner ï¼‰ä¸å»ºè®®ç”Ÿäº§ä½¿ç”¨ï¼Œæä¾›è¿™äº›ç»„ä»¶æ›´å¤šæ˜¯ä¸ºäº†ä¿è¯åŠŸèƒ½å®Œæ•´ï¼Œå¼€ç®±å³ç”¨ã€‚
- ä½¿ç”¨ k3s ä¸æ¨èä½¿ç”¨å†…ç½® traefik å’Œ klipper-lb
  - ingress å»ºè®®è‡ªè¡Œå®‰è£… - æ¯”è¾ƒé‡è¦çš„æ ¸å¿ƒç»„ä»¶
  - å»ºè®®ä½¿ç”¨ metallb æ›¿ä»£ klipper-lb
- å› ä¸º Controller-Worker ç½‘ç»œä¸åŒï¼Œk3s å’Œ k0s æ— æ³•æ··åˆä½¿ç”¨

:::

**å‘½ä»¤å¯¹æ¯”**

| k0s                   | k3s                                            |
| --------------------- | ---------------------------------------------- |
| k0s systinfo          | ./contrib/util/check-config.sh                 |
| k0s backup            | k3s etcd-snapshot                              |
| k0s restore           | k3s server --cluster-reset-restore-path        |
| k0s controller        | k3s server                                     |
| k0s worker            | k3s agent                                      |
| n/a                   | k3s crictl                                     |
| k0s install           | https://get.k3s.io ä¼šå®‰è£… systemd, openrc æœåŠ¡ |
| k0s reset             | n/a                                            |
| k0s kubeconfig create | n/a                                            |
| k0sctl                | n/a                                            |
| k0sctl apply          | ~autok3s                                       |
| k0sctl backup         | n/a                                            |
| ---                   | ---                                            |
| k0s kubectl           | k3s kubectl                                    |
| k0s ctr               | k3s ctr                                        |

## å¦‚ä½•é€‰æ‹©

**ç›¸åŒç‚¹**

- é¢å‘ç›¸åŒç”¨æˆ·ç¾¤ä½“å’Œä½¿ç”¨åœºæ™¯ï¼Œéå¸¸ç±»ä¼¼
- æ ¸å¿ƒéƒ½ä½¿ç”¨ kine - åŒºåˆ«ä¸å¤§
- éƒ½æœ‰å¤§çš„ä¼ä¸šæ”¯æ’‘å¼€å‘

**é€‰æ‹©è€ƒé‡**

- k3s
  - æ›´æˆç†Ÿ - å­˜åœ¨æ—¶é—´æ›´é•¿ï¼Œä½¿ç”¨çš„æ›´ç‹¬ç«‹
  - ç¤¾åŒºæ›´å¤§ - ç¤¾åŒºè¿˜ä¸ rancherã€rke æœ‰äº¤é›†
  - ä¸­æ–‡åŒ–ç¤¾åŒºå‹å¥½
- k0s
  - æ›´æ–° - 2020 å¹´ - ç›®å‰å·²ç»æˆç†Ÿï¼Œå¯ä»¥ç”¨äºç”Ÿäº§
  - ç”¨æˆ·ä½“éªŒæ›´å¥½
  - **k0sctl**
    - èƒ½æ›´å¥½çš„è¾…åŠ©ç»´æŠ¤æ›´å¤šçš„é›†ç¾¤ï¼Œå‡å°‘å¯¹ è„šæœ¬/ansible çš„ä¾èµ–ã€‚
    - æ›´å¥½å‡çº§
    - æ›´å¥½å¤‡ä»½

## ä¸ºä»€é€‰æ‹© K0S

- k0s ä½œä¸º supervisor è¿è¡Œ - ğŸŒŸ
  - æ¯ä¸ªè¿›ç¨‹ç‹¬ç«‹ - etcd, k0s-api, kube-apiserver
    - æ–¹ä¾¿è°ƒè¯•ï¼Œæ’æŸ¥é—®é¢˜ - èƒ½æ¸…æ¥šçŸ¥é“å“ªä¸ªè¿›ç¨‹å¯åŠ¨äº†æ²¡å¯åŠ¨
    - èƒ½çœ‹åˆ°æ‰€æœ‰å®é™…è¿è¡Œå‚æ•°
    - å¯ä»¥å•ç‹¬ kill è¿›ç¨‹ - ä¾‹å¦‚: ä¿®æ”¹äº† containerd é•œåƒé…ç½®ï¼Œåªèƒ½é€šè¿‡ kill æ¥ä½¿æ–°çš„é…ç½®ç”Ÿæ•ˆ
      - ä¸éœ€è¦å¯åœå…¨éƒ¨æœåŠ¡
  - ä»£ç éƒ¨ç½²è¿è¡Œé€»è¾‘æ¸…æ™° - å¦‚æœéœ€è¦æ›´æ·±å…¥äº†è§£
- k0s bundled äº†æ›´å¤šä¾èµ– - â­ï¸ - containerd, iptables
  - å‡ ä¹å¯¹ç³»ç»Ÿæ²¡ä»€ä¹ˆé¢å¤–ä¾èµ–
- k0sctl è¾…åŠ©éƒ¨ç½²
  - å¦‚æœéœ€è¦å¯è‡ªè¡Œè¿›è¡Œå®šåˆ¶åŒ–
  - æ›¿ä»£éƒ¨åˆ† ansible å·¥ä½œ
- é»˜è®¤ control plane å’Œ worker åˆ†ç¦»
  - âš ï¸ éƒ¨ç½²æœ‰ä¸€äº›æ³¨æ„äº‹é¡¹
- ä½¿ç”¨ konnectivity - ç›¸å¯¹æ›´ kubernetes

:::caution

é»˜è®¤ç”¨åˆ°äº† k8s.gcr.io é•œåƒ - å›½å†…ç¯å¢ƒéƒ¨ç½²éœ€è¦æ³¨æ„ï¼Œå»ºè®®ç”¨ airgap åŒ…å¯¼å…¥åŸºç¡€é•œåƒã€‚

:::

## ç»„ä»¶ç®€ä»‹

- [kine](https://wener.me/notes/devops/kubernetes/distro/kine)
  k3s å’Œ k0s æœ€æ ¸å¿ƒç»„ä»¶
  - æä¾› etcd èƒ½åŠ›
  - åç«¯æ”¯æŒ etcd,sqlite,mysql,postgresql,dqlite
- [traefik](https://wener.me/notes/devops/kubernetes/network/traefik-ingress)
  - æä¾› Ingress èƒ½åŠ›
- [k3s-io/helm-controller](https://github.com/k3s-io/helm-controller)
  - æ”¯æŒéƒ¨ç½² helm chart
  - é€šè¿‡ CDR æ§åˆ¶
- CNI - å®¹å™¨ç½‘ç»œ
  - [flannel](https://wener.me/notes/devops/kubernetes/network/flannel/)
  - [calico](https://wener.me/notes/devops/kubernetes/network/calico/)
  - [kube-router](https://wener.me/notes/devops/kubernetes/network/kube-router/)
- CSI - å®¹å™¨å­˜å‚¨
  - [local-path-provisioner](https://wener.me/notes/devops/kubernetes/storage/local-path-provisioner/)
    - åŸºäºæœ¬åœ°è·¯å¾„æä¾› volume
  - [openebs](https://wener.me/notes/devops/kubernetes/storage/openebs/)
- LoadBalancer
  - [k3s-io/klipper-lb](https://github.com/k3s-io/klipper-lb)
    - åŸºäº iptable æä¾› ClusterIP èƒ½åŠ›
  - [metallb](https://wener.me/notes/devops/kubernetes/network/metallb/)

## å‚è€ƒ

- [certified-kubernetes-installer](https://landscape.cncf.io/card-mode?category=certified-kubernetes-installer&grouping=category)

# ä¸ºä»€ä¹ˆä¼šå­˜åœ¨ä¸åŒå‘è¡Œç‰ˆ

K8S ä½œä¸ºæœ€åŸå§‹çš„é¡¹ç›®ï¼Œæ´¾ç”Ÿå‡ºæ¥å¾ˆå¤š åˆ†æ”¯/å‘å¸ƒç‰ˆã€‚

Kubernetes çš„æ ¸å¿ƒèƒ½åŠ›ä¸ºèµ„æºè°ƒåº¦ï¼Œä¸»è¦èµ„æºä¸º Pod/å®¹å™¨ç»„/è®¡ç®—èµ„æºã€‚
å› ä¸ºæ˜¯åˆ†å¸ƒå¼å¤šèŠ‚ç‚¹ï¼Œæ‰€ä»¥å¯¹ç½‘ç»œæœ‰è¦æ±‚ã€‚Pod è°ƒåº¦ä¸»è¦æä¾›è®¡ç®—èƒ½åŠ›ï¼Œå®é™…ä½¿ç”¨è¿˜ä¼šéœ€è¦å­˜å‚¨èƒ½åŠ›ã€‚
ä¹Ÿå°±æ˜¯è¯´ Kubernetes æ¶‰åŠåˆ°æ ¸å¿ƒçš„ä¸‰å…ƒç´ 

- è®¡ç®—
- ç½‘ç»œ
- å­˜å‚¨

Kubernetes æ ¸å¿ƒè°ƒåº¦è®¡ç®—èµ„æºï¼Œä½†å¯¹äºç½‘ç»œå’Œå­˜å‚¨æ˜¯ æ— æ„è§/Unopinioned ï¼Œä½†å®é™…éƒ¨ç½²ä½¿ç”¨æ—¶è¿™æ—¶å€™åˆä¸å¯é¿å…çš„è¦é¢å¯¹è¿™äº›é—®é¢˜ã€‚
å› æ­¤ä¸åŒçš„ å‘å¸ƒç‰ˆ/Distribution å°±æ˜¯å¯¹è¿™äº›é—®é¢˜ä¸åŒçš„çœ‹æ³•ã€‚

## K8S è¦æ±‚

Kubernetes ç”± Google å¼€å‘ï¼Œä½†ä¸æ˜¯æ‰€æœ‰äººéƒ½æœ‰é‚£ä¹ˆå¤§è§„æ¨¡çš„é—®é¢˜ï¼Œè€Œå¤§å¤šæ•°æ—¶å€™éƒ½æ˜¯å°è§„æ¨¡ï¼Œå…ˆè®© K8S â€œè·‘èµ·æ¥â€ã€‚

Kubernetes è‡ªèº«å› ä¸ºå¯¹åŸºç¡€è®¾æ–½å±‚ æ— æ„è§/Unopinionedï¼Œå› æ­¤é»˜è®¤æ˜¯æ²¡æœ‰éƒ¨ç½²å·¥å…·ï¼Œåªæœ‰è¦æ±‚ï¼š

- è¦æ±‚èŠ‚ç‚¹è¿è¡Œåœ¨å¹³å¦ç½‘ç»œ
- è¦æ±‚ etcd èƒ½åŠ›çš„çŠ¶æ€å­˜å‚¨
- è¦æ±‚ cloud-controller æä¾›èŠ‚ç‚¹ä¿¡æ¯
- è¦æ±‚ å®¹å™¨è¿è¡Œæ—¶

åœ¨è¿™äº›åŸºç¡€ä¹‹ä¸Šï¼ŒKubernetes æä¾›åŸºäºçŠ¶æ€çš„ æ¥å£ è¿›è¡Œèµ„æºè°ƒåº¦ã€‚

## K8S éƒ¨ç½²

é™¤äº†æ»¡è¶³ K8S çš„è¦æ±‚ï¼Œåœ¨å®é™…ä½¿ç”¨æ—¶è¿˜å¸Œæœ›èƒ½æ–¹ä¾¿å¿«æ·çš„ç®¡ç†éƒ¨ç½²ã€‚
K8S æä¾›äº† kubeadm è¿›è¡Œå®‰è£…ï¼Œä¸åŒçš„å‘å¸ƒç‰ˆä¹Ÿéœ€è¦æä¾›ç±»ä¼¼çš„å·¥å…·ï¼Œä½†å·¥å…·åŒºåˆ†ä¸ºä¸¤éƒ¨åˆ†

1. è¿œç¨‹å¼€é€šéƒ¨ç½²
   - SSH
   - æ§åˆ¶èŠ‚ç‚¹é€šè¿‡å·¥å…·éƒ¨ç½²åˆ°å¤šä¸ªèŠ‚ç‚¹
2. å¼€é€šéƒ¨ç½²çš„æå‰å‡†å¤‡
   - CA è¯ä¹¦
   - ETCD/å­˜å‚¨åˆå§‹åŒ–
   - ç½‘ç»œè®¾ç½®
   - Bootstrap

kubeadm å’Œ k0s, k3s éƒ½å±äºç¬¬äºŒç§åœºæ™¯ï¼Œç¬¬ä¸€ç§åœºæ™¯çš„å·¥å…·ä¾‹å¦‚

- autok3s
- rke
- ansible
