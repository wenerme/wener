"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["201536"],{962304:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>l,toc:()=>d,default:()=>o,metadata:()=>i,assets:()=>h,contentTitle:()=>c});var i=JSON.parse('{"id":"os/virt/webvm","title":"WebVM","description":"- container2wasm/container2wasm","source":"@site/../notes/os/virt/webvm.md","sourceDirName":"os/virt","slug":"/os/virt/webvm","permalink":"/notes/os/virt/webvm","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/virt/webvm.md","tags":[{"inline":true,"label":"WASM","permalink":"/notes/tags/wasm"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1772429368000,"frontMatter":{"tags":["WASM"]},"sidebar":"docs","previous":{"title":"VNC Awesome","permalink":"/notes/os/virt/vnc-awesome"},"next":{"title":"wine","permalink":"/notes/os/virt/wine"}}'),r=s(486106),t=s(917776);let l={tags:["WASM"]},c="WebVM",h={},d=[{value:"c2w",id:"c2w",level:2}];function x(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"webvm",children:"WebVM"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/container2wasm/container2wasm",children:"container2wasm/container2wasm"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"c2w-net-proxy"}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"RISC-V (riscv64)"}),": Recommended, faster emulation with TinyEMU\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5355\u7EBF\u7A0B"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"x86_64"}),": Slower, uses Bochs emulator"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"QEMU Mode"}),": ",(0,r.jsx)(e.code,{children:"--to-js"})," for Emscripten output with JIT (larger but faster)\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u652F\u6301 MTTCG"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/bjorn3/browser_wasi_shim",children:"bjorn3/browser_wasi_shim"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/mame/xterm-pty",children:"mame/xterm-pty"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/containers/gvisor-tap-vsock",children:"containers/gvisor-tap-vsock"})}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/joelseverin/linux-wasm/",children:"https://github.com/joelseverin/linux-wasm/"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"fast, buggy"}),"\n",(0,r.jsx)(e.li,{children:"\u628A linux \u7F16\u8BD1\u4E3A wasm"}),"\n",(0,r.jsx)(e.li,{children:"\u4E0D\u662F emu \u6216\u8005 vm"}),"\n",(0,r.jsx)(e.li,{children:"binfmt_wasm"}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://news.ycombinator.com/item?id=45783074",children:"https://news.ycombinator.com/item?id=45783074"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/webassembly/wasi-libc",children:"https://github.com/webassembly/wasi-libc"})}),"\n",(0,r.jsxs)(e.li,{children:["cheerpx\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://cheerpx.io/",children:"https://cheerpx.io/"})}),"\n",(0,r.jsx)(e.li,{children:"\u865A\u62DF\u5316\u5F15\u64CE"}),"\n",(0,r.jsx)(e.li,{children:"\u95ED\u6E90"}),"\n",(0,r.jsx)(e.li,{children:"x86 -> wasm jit compiler"}),"\n",(0,r.jsx)(e.li,{children:"virtual block fs"}),"\n",(0,r.jsx)(e.li,{children:"Linux syscall emulator"}),"\n",(0,r.jsxs)(e.li,{children:["Free\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u274C Self-Hosting not allowed"}),"\n",(0,r.jsx)(e.li,{children:"\u274C OEM/Redistribution"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Small\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\xa3100 per developer per month"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["WebVM: ",(0,r.jsx)(e.a,{href:"https://github.com/leaningtech/webvm",children:"https://github.com/leaningtech/webvm"})]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/copy/v86",children:"copy/v86"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"32bits x86"}),"\n",(0,r.jsx)(e.li,{children:"\u652F\u6301\u5F88\u591A\u8001\u7684\u67B6\u6784"}),"\n",(0,r.jsx)(e.li,{children:"Rust, WASM"}),"\n",(0,r.jsx)(e.li,{children:"\u6BD4 TinyEMU \u5FEB"}),"\n",(0,r.jsxs)(e.li,{children:["x86_64 ",(0,r.jsx)(e.a,{href:"https://github.com/copy/v86/issues/133",children:"https://github.com/copy/v86/issues/133"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["TinyEMU\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"riscv64, x86"}),"\n",(0,r.jsx)(e.li,{children:"\u89E3\u91CA\u5668, 10k LOC"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/ptitSeb/box64",children:"ptitSeb/box64"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"MIT, C"}),"\n",(0,r.jsx)(e.li,{children:"Linux Userspace x86_64 Emulator with a twist, targeted at ARM64, RV64 and LoongArch Linux devices"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Bochs\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"x86_64"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["QEMU TCG JIT\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["QEMU WASM ",(0,r.jsx)(e.a,{href:"https://github.com/ktock/qemu-wasm",children:"https://github.com/ktock/qemu-wasm"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/userland-run/nano",children:"https://github.com/userland-run/nano"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"tiny RISC-V user-mode Linux interpreter"}),"\n",(0,r.jsx)(e.li,{children:"nodejs+busybox 130MB"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'# \u7B80\u5355\u6027\u80FD\u6D4B\u8BD5\n# \u7CBE\u5EA6\u4E3A 1000 \u4F4D\u5C0F\u6570\n# 4*arctan(1) -> \u03C0\ntime sh -c \'echo "scale=1000; 4*a(1)" | bc -lq\' > /dev/null\n\n# linux-wasm \u4E0D\u652F\u6301 vfork\ndate +%s\necho "scale=1000; 4*a(1)" | bc -lq > /dev/null\ndate +%s\n'})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"env/scale"}),(0,r.jsx)(e.th,{style:{textAlign:"right"},children:"500"}),(0,r.jsx)(e.th,{children:"1000"}),(0,r.jsx)(e.th,{children:"5000"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"macOS M2 MAX"}),(0,r.jsx)(e.td,{style:{textAlign:"right"}}),(0,r.jsx)(e.td,{children:"0.01s"}),(0,r.jsx)(e.td,{children:"0.75s"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"alpine riscv64 TinyEMU"}),(0,r.jsx)(e.td,{style:{textAlign:"right"}}),(0,r.jsx)(e.td,{children:"22s"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"alpine x86 v86"}),(0,r.jsx)(e.td,{style:{textAlign:"right"},children:"23s"}),(0,r.jsx)(e.td,{}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"linux-wasm"}),(0,r.jsx)(e.td,{style:{textAlign:"right"}}),(0,r.jsx)(e.td,{children:"1s"}),(0,r.jsx)(e.td,{})]})]})]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"abbr."}),(0,r.jsx)(e.th,{children:"stand for"}),(0,r.jsx)(e.th,{children:"cn"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"COOP"}),(0,r.jsx)(e.td,{children:"Cross-Origin-Opener-Policy"}),(0,r.jsx)(e.td,{children:"\u8DE8\u6E90\u5F00\u653E\u8005\u653F\u7B56"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"COEP"}),(0,r.jsx)(e.td,{children:"Cross-Origin-Embedder-Policy"}),(0,r.jsx)(e.td,{children:"\u8DE8\u6E90\u5D4C\u5165\u8005\u653F\u7B56"})]})]})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"Cross-Origin-Opener-Policy: same-origin\nCross-Origin-Embedder-Policy: require-corp\n"})}),"\n",(0,r.jsx)(e.h2,{id:"c2w",children:"c2w"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["c2w-net-proxy\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"browser fetch"}),"\n",(0,r.jsx)(e.li,{children:"gvisor-tap-vsock"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["c2w-net\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"delegate websocket"}),"\n",(0,r.jsx)(e.li,{children:"gvisor-tap-vsock"}),"\n"]}),"\n"]}),"\n"]})]})}function o(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(x,{...n})}):x(n)}},917776:function(n,e,s){s.d(e,{R:()=>l,x:()=>c});var i=s(7378);let r={},t=i.createContext(r);function l(n){let e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);