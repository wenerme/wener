"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["6798"],{43572:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>c,toc:()=>d,default:()=>a,metadata:()=>l,assets:()=>t,contentTitle:()=>o});var l=JSON.parse('{"id":"web/cors","title":"CORS","description":"- fetch cookie \u8DE8\u57DF\u9700\u8981\u8BF7\u6C42\u65F6\u8BBE\u7F6E credentials: include","source":"@site/../notes/web/cors.md","sourceDirName":"web","slug":"/web/cors","permalink":"/notes/web/cors","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/cors.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1753172183000,"frontMatter":{"title":"CORS"},"sidebar":"docs","previous":{"title":"Cookie","permalink":"/notes/web/cookie"},"next":{"title":"deno","permalink":"/notes/web/deno/"}}'),r=s(86106),i=s(17776);let c={title:"CORS"},o="CORS",t={},d=[];function h(e){let n={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"cors",children:"CORS"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["fetch cookie \u8DE8\u57DF\u9700\u8981\u8BF7\u6C42\u65F6\u8BBE\u7F6E credentials: include\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u8981\u6C42\u670D\u52A1\u7AEF\u8FD4\u56DE ",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Credentials: true"})]}),"\n",(0,r.jsx)(n.li,{children:"\u5426\u5219\u4E0D\u4F1A set-cookie"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["mdn ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS",children:"CORS"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Allow-Credentials: true"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4F1A\u4F20\u9012 Cookie, \u4F1A\u63A5\u53D7 Set-Cookie"}),"\n",(0,r.jsx)(n.li,{children:"\u6CE8\u610F CSRF"}),"\n",(0,r.jsxs)(n.li,{children:["\u4E0D\u652F\u6301\u8FD4\u56DE ",(0,r.jsx)(n.code,{children:"Allow-Origin: *"})]}),"\n",(0,r.jsx)(n.li,{children:"\u5FC5\u987B\u5217\u4E3E\u6240\u6709 origin"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Allow-Origin: string"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u6307\u5B9A\u5141\u8BB8\u8BBF\u95EE\u8D44\u6E90\u7684\u5916\u90E8\u57DF\u540D\uFF08Origin\uFF09\u3002\u4E0D\u80FD\u4E3A ",(0,r.jsx)(n.code,{children:"*"})," \u65F6\u5141\u8BB8\u643A\u5E26 Cookie\uFF0C\u9700\u660E\u786E\u6307\u5B9A\u57DF\u540D\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Allow-Methods: string[]"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u6307\u5B9A\u5141\u8BB8\u7684 HTTP \u65B9\u6CD5 - ",(0,r.jsx)(n.code,{children:"['GET', 'HEAD', 'PUT', 'POST', 'DELETE', 'PATCH']"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Allow-Headers: string[]"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6307\u5B9A\u5141\u8BB8\u7684\u81EA\u5B9A\u4E49\u8BF7\u6C42\u5934\u5B57\u6BB5\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Max-Age: number"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u9884\u68C0\u8BF7\u6C42\uFF08Preflight\uFF09\u7ED3\u679C\u7684\u7F13\u5B58\u65F6\u95F4\uFF08\u79D2\uFF09\uFF0C\u51CF\u5C11\u91CD\u590D\u9884\u68C0\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Allow-Credentials: boolean"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u662F\u5426\u5141\u8BB8\u643A\u5E26 Cookie \u7B49\u51ED\u8BC1\u4FE1\u606F\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["\u4E3A ",(0,r.jsx)(n.code,{children:"true"})," \u65F6\uFF0C",(0,r.jsx)(n.code,{children:"Allow-Origin"})," \u4E0D\u80FD\u4E3A ",(0,r.jsx)(n.code,{children:"*"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Access-Control-Expose-Headers: string[]"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6307\u5B9A\u54EA\u4E9B\u54CD\u5E94\u5934\u53EF\u4EE5\u66B4\u9732\u7ED9\u524D\u7AEF JavaScript \u4EE3\u7801\u8BBF\u95EE\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u9ED8\u8BA4\u5141\u8BB8\u5934\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cache-Control"}),"\n",(0,r.jsx)(n.li,{children:"Content-Language"}),"\n",(0,r.jsx)(n.li,{children:"Content-Type"}),"\n",(0,r.jsx)(n.li,{children:"Expires"}),"\n",(0,r.jsx)(n.li,{children:"Last-Modified"}),"\n",(0,r.jsx)(n.li,{children:"Pragma"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# \u8BF7\u6C42\nAccess-Control-Request-Headers: authorization\nAccess-Control-Request-Method: GET\n\n# \u54CD\u5E94\nAccess-Control-Allow-Headers: authorization\nAccess-Control-Allow-Methods: POST,GET\nAccess-Control-Allow-Origin: http://127.0.0.1:3000\n# \u9ED8\u8BA4 5s\u3001\u6700\u5927 86400=24h\nAccess-Control-Max-Age: 86400\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Max-Age",children:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Max-Age"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preflight \u8BF7\u6C42"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Origin:\nAccess-Control-Request-Method:\nAccess-Control-Request-Headers: POST\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preflight \u54CD\u5E94"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Vary: Origin\nVary: Access-Control-Request-Method\nVary: Access-Control-Request-Headers\nAccess-Control-Allow-Origin: http://127.0.0.1:3000\nAccess-Control-Allow-Methods: POST\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 300\nAccess-Control-Expose-Headers: X-Page,X-Page-Size,X-Total,X-Total-Pages\n"})})]})}function a(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},17776:function(e,n,s){s.d(n,{R:()=>c,x:()=>o});var l=s(7378);let r={},i=l.createContext(r);function c(e){let n=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);