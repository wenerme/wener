"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["81480"],{82595:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>t,toc:()=>a,default:()=>h,metadata:()=>i,assets:()=>o,contentTitle:()=>c});var i=JSON.parse('{"id":"service/auth/keycloak/keycloak-dev","title":"Keycloak \u5F00\u53D1","description":"- \u53C2\u8003","source":"@site/../notes/service/auth/keycloak/keycloak-dev.md","sourceDirName":"service/auth/keycloak","slug":"/service/auth/keycloak/dev","permalink":"/notes/service/auth/keycloak/dev","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/auth/keycloak/keycloak-dev.md","tags":[{"inline":true,"label":"Devlopment","permalink":"/notes/tags/devlopment"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1690946986000,"frontMatter":{"title":"Keycloak \u5F00\u53D1","tags":["Devlopment"]},"sidebar":"docs","previous":{"title":"keycloak-config-cli","permalink":"/notes/service/auth/keycloak/config-cli"},"next":{"title":"Keycloak \u5E38\u89C1\u95EE\u9898","permalink":"/notes/service/auth/keycloak/faq"}}'),l=s(86106),r=s(17776);let t={title:"Keycloak \u5F00\u53D1",tags:["Devlopment"]},c="Keycloak \u5F00\u53D1",o={},a=[{value:"token",id:"token",level:2},{value:"keycloak-services-social-wechatwork",id:"keycloak-services-social-wechatwork",level:2},{value:"\u670D\u52A1\u7AEF\u5F00\u53D1",id:"\u670D\u52A1\u7AEF\u5F00\u53D1",level:2},{value:"\u5BA2\u6237\u7AEF",id:"\u5BA2\u6237\u7AEF",level:2},{value:"\u4E3B\u9898",id:"\u4E3B\u9898",level:2},{value:"SPI",id:"spi",level:2},{value:"JavaScript Providers",id:"javascript-providers",level:3},{value:"Authentication SPI",id:"authentication-spi",level:2},{value:"Event Listener SPI",id:"event-listener-spi",level:2},{value:"User Storage SPI",id:"user-storage-spi",level:2},{value:"Vault SPI",id:"vault-spi",level:2},{value:"Provider",id:"provider",level:2}];function d(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"keycloak-\u5F00\u53D1",children:"Keycloak \u5F00\u53D1"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u77ED\u4FE1\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/gwallet/keycloak-sms-authenticator",children:"gwallet/keycloak-sms-authenticator"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/search?q=keycloak+sms",children:"https://github.com/search?q=keycloak+sms"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/keycloak/keycloak/blob/master/services/src/main/java/org/keycloak/authentication/authenticators/resetcred/ResetCredentialChooseUser.java",children:"https://github.com/keycloak/keycloak/blob/master/services/src/main/java/org/keycloak/authentication/authenticators/resetcred/ResetCredentialChooseUser.java"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5FAE\u4FE1\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/jyqq163/keycloak-services-social-weixin",children:"jyqq163/keycloak-services-social-weixin"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6700\u65B0 fork ",(0,l.jsx)(n.a,{href:"https://github.com/zmlgit/keycloak-services-social-weixin",children:"zmlgit/keycloak-services-social-weixin"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4F01\u4E1A\u5FAE\u4FE1\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/kkzxak47/keycloak-services-social-wechatwork",children:"kkzxak47/keycloak-services-social-wechatwork"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.kkzxak47.com/2019/07/30/%E4%BD%BF%E7%94%A8%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E7%99%BB%E5%BD%95keycloak",children:"\u4F7F\u7528\u4F01\u4E1A\u5FAE\u4FE1\u767B\u5F55 keycloak"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u9489\u9489"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u6CE8\u610F\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u83B7\u53D6\u5230\u7684 attributes \u662F ",(0,l.jsx)(n.code,{children:"Map<String, List<String>> attributes;"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"user \u4F1A\u5904\u7406\u5BF9\u8C61\u8F6C\u6570\u7EC4"}),"\n",(0,l.jsx)(n.li,{children:"group \u4E0D\u4F1A\u5904\u7406\uFF0C\u9700\u8981\u63D0\u524D\u5904\u7406\u597D"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["realm endpoints\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/auth"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/token"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/logout"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/login-status-iframe.html"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/3p-cookies/step1.html"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/registrations"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/userinfo"}),"\n",(0,l.jsx)(n.li,{children:"/protocol/openid-connect/certs - JWK"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"kc_idp_hint - \u63D0\u793A\u4F7F\u7528\u7684 provider, \u76F4\u63A5\u8DF3\u8F6C"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u542F\u52A8\u5F00\u53D1\u5B9E\u4F8B\n# =========\n# \u7531\u4E8E\u542F\u52A8\u811A\u672C\u7684 --debug \u4E0D\u652F\u6301 java 11 \u6240\u4EE5 debug \u53C2\u6570\u81EA\u884C\u6DFB\u52A0\ndocker run --rm -it \\\n  -p 8080:8080 -p 8097:8097 \\\n  -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin \\\n  -e JAVA_OPTS="-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=0.0.0.0:8097 -Xms64m -Xmx512m -XX:MetaspaceSize=96M -XX:MaxMetaspaceSize=256m -Djava.net.preferIPv4Stack=true -Djboss.modules.system.pkgs=org.jboss.byteman -Djava.awt.headless=true" \\\n  -v $PWD/deployments:/opt/jboss/keycloak/standalone/deployments \\\n  -v $PWD/themes/dev:/opt/jboss/keycloak/standalone/themes/dev \\\n  --name keycloak jboss/keycloak\n\n# \u81EA\u5B9A\u4E49 identity \u65F6\u6DFB\u52A0\u81EA\u5B9A\u4E49\u8D44\u6E90\ndocker cp templates/realm-identity-provider-wechat.html keycloak:/opt/jboss/keycloak/themes/base/admin/resources/partials\ndocker cp templates/realm-identity-provider-wechat-ext.html keycloak:/opt/jboss/keycloak/themes/base/admin/resources/partials\n\n# \u542F\u52A8\u5F00\u53D1\u5B9E\u4F8B - \u4E3B\u9898\u5F00\u53D1\n# =========\n# \u4E3A\u4E86\u65B9\u4FBF\u5F00\u53D1 - \u53EF\u4EE5\u6620\u5C04\u6574\u4E2A themes \u76EE\u5F55\n# \u9ED8\u8BA4\u4E0D\u80FD\u6574\u4E2A\u6620\u5C04 themes \u76EE\u5F55 - \u56E0\u4E3A\u76EE\u5F55\u4E0B\u662F\u6709\u5185\u5BB9\u7684 - \u9664\u975E\u5148\u62F7\u8D1D\u51FA\u6765\n\ndocker run --rm -it --name temp jboss/keycloak\ndocker cp temp:/opt/jboss/keycloak/themes .\ndocker rm -f temp\n\ndocker run --rm -it \\\n  -p 8080:8080 -p 8097:8097 \\\n  -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin \\\n  -e JAVA_OPTS="-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=0.0.0.0:8097 -Xms64m -Xmx512m -XX:MetaspaceSize=96M -XX:MaxMetaspaceSize=256m -Djava.net.preferIPv4Stack=true -Djboss.modules.system.pkgs=org.jboss.byteman -Djava.awt.headless=true" \\\n  -v $PWD/deployments:/opt/jboss/keycloak/standalone/deployments \\\n  -v $PWD/themes:/opt/jboss/keycloak/themes \\\n  --name keycloak jboss/keycloak\n'})}),"\n",(0,l.jsx)(n.h2,{id:"token",children:"token"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["id_token\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"openid scope"}),"\n",(0,l.jsx)(n.li,{children:"identity information about the user is encoded right into the token and"}),"\n",(0,l.jsx)(n.li,{children:"the token can be definitively verified to prove that it hasn\u2019t been tampered with."}),"\n",(0,l.jsx)(n.li,{children:"auth_time - \u5B9E\u9645\u6388\u6743\u65F6\u95F4"}),"\n",(0,l.jsx)(n.li,{children:"\u7528\u4E8E\u83B7\u53D6\u7528\u6237 profile"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u4F1A\u7528\u4E8E API \u8BF7\u6C42"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["access_token\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"bearer token"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "access_token": "",\n  "expires_in": 300,\n  "refresh_expires_in": 1800,\n  "refresh_token": "",\n  "token_type": "Bearer",\n  "id_token": "",\n  "not-before-policy": 1623227705,\n  "session_state": "UUID",\n  "scope": "openid email profile"\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"keycloak-services-social-wechatwork",children:"keycloak-services-social-wechatwork"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/kkzxak47/keycloak-services-social-wechatwork",children:"kkzxak47/keycloak-services-social-wechatwork"})}),"\n",(0,l.jsx)(n.li,{children:"\u652F\u6301 qr \u626B\u7801\u767B\u9646"}),"\n",(0,l.jsx)(n.li,{children:"\u652F\u6301 \u4F01\u4E1A\u5FAE\u4FE1\u73AF\u5883 \u76F4\u63A5\u8DF3\u8F6C - ua \u5305\u542B wxwork"}),"\n",(0,l.jsxs)(n.li,{children:["\u9ED8\u8BA4\u6DFB\u52A0 attributes\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"gender,mobile,status,enable,userid"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"firstName \u4E3A\u90AE\u7BB1\u524D\u9762\u90E8\u5206"}),"\n",(0,l.jsx)(n.li,{children:"lastName \u4E3A name"}),"\n",(0,l.jsx)(n.li,{children:"username \u548C brokerUserId \u5747\u4E3A userid"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u670D\u52A1\u7AEF\u5F00\u53D1",children:"\u670D\u52A1\u7AEF\u5F00\u53D1"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.keycloak.org/docs/latest/server_development/",children:"\u5F00\u53D1\u6587\u6863"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u5BA2\u6237\u7AEF",children:"\u5BA2\u6237\u7AEF"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Java keycloak-admin-client"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'Keycloak keycloak = Keycloak.getInstance(\n    "http://localhost:8080/auth",\n    "master",\n    "admin",\n    "password",\n    "admin-cli");\nRealmRepresentation realm = keycloak.realm("master").toRepresentation();\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u4E3B\u9898",children:"\u4E3B\u9898"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.keycloak.org/docs/latest/server_development/#_themes",children:"\u4E3B\u9898\u5F00\u53D1"})}),"\n",(0,l.jsxs)(n.li,{children:["\u4E3B\u9898\u7C7B\u578B\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Account - \u8D26\u53F7\u7BA1\u7406"}),"\n",(0,l.jsx)(n.li,{children:"Admin - \u7BA1\u7406\u63A7\u5236\u53F0"}),"\n",(0,l.jsx)(n.li,{children:"Email"}),"\n",(0,l.jsx)(n.li,{children:"Login - \u767B\u9646\u8868\u5355"}),"\n",(0,l.jsx)(n.li,{children:"Welcome - \u6B22\u8FCE\u9875"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4E3B\u9898\u5305\u542B\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"HTML \u6A21\u677F - Freemaker"}),"\n",(0,l.jsx)(n.li,{children:"\u56FE\u7247"}),"\n",(0,l.jsx)(n.li,{children:"Message bundles - \u7FFB\u8BD1/I18N"}),"\n",(0,l.jsx)(n.li,{children:"CSS"}),"\n",(0,l.jsx)(n.li,{children:"\u811A\u672C"}),"\n",(0,l.jsx)(n.li,{children:"\u4E3B\u9898\u5C5E\u6027"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4E3B\u9898\u90E8\u7F72\u65B9\u5F0F\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u76F4\u63A5\u590D\u5236\u5230 themes \u76EE\u5F55"}),"\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7\u6253\u5305\u4E3A jar \u8FDB\u884C\u90E8\u7F72 - \u63A8\u8350"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4E3B\u9898\u5305\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"META-INF/keycloak-themes.json"})," - \u5305\u6362\u4E3B\u9898\u5217\u8868\u548C\u7C7B\u578B"]}),"\n",(0,l.jsx)(n.li,{children:"\u53EF\u4EE5\u5305\u542B\u591A\u4E2A\u4E3B\u9898"}),"\n",(0,l.jsxs)(n.li,{children:["\u5C06\u4E3B\u9898\u5305\u653E\u5230 ",(0,l.jsx)(n.code,{children:"standalone/deployments/"})," \u76EE\u5F55\u4F1A\u81EA\u52A8\u52A0\u8F7D"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"\u4F8B\u5982\u5305\u5185\u5BB9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"META-INF/keycloak-themes.json\ntheme/mytheme/login/theme.properties\ntheme/mytheme/login/login.ftl\ntheme/mytheme/login/resources/css/styles.css\ntheme/mytheme/login/resources/img/image.png\ntheme/mytheme/login/messages/messages_en.properties\ntheme/mytheme/email/messages/messages_en.properties\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u5219\u5C5E\u6027\u4E3A"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "themes": [\n    {\n      "name": "mytheme",\n      "types": ["login", "email"]\n    }\n  ]\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"spi",children:"SPI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u53EF\u4EE5\u5C06 jar \u653E\u5230 ",(0,l.jsx)(n.code,{children:"standalone/deployments/"})," \u8FDB\u884C\u70ED\u90E8\u7F72"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"javascript-providers",children:"JavaScript Providers"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7528\u4E8E\u7BA1\u7406\u5458\u81EA\u5B9A\u4E49\u7279\u6B8A\u529F\u80FD"}),"\n",(0,l.jsxs)(n.li,{children:["\u652F\u6301\u7684\u529F\u80FD\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"OpenID Connect Script Protocol Mapper"}),"\n",(0,l.jsx)(n.li,{children:"OpenID Connect Script Authenticator"}),"\n",(0,l.jsx)(n.li,{children:"JavaScript Policy"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"-Dkeycloak.profile.feature.upload_scripts=enable"})," \u5F00\u542F\u63A7\u5236\u53F0\u811A\u672C\u4E0A\u4F20"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u6587\u4EF6\u7ED3\u6784"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"META-INF/keycloak-scripts.json\n\nmy-script-authenticator.js\nmy-script-policy.js\nmy-script-mapper.js\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u914D\u7F6E\u5185\u5BB9"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "authenticators": [\n    {\n      "name": "My Authenticator",\n      "fileName": "my-authenticator.js",\n      "description": "My Authenticator from a JS file"\n    }\n  ],\n  "policies": [\n    {\n      "name": "My Policy",\n      "fileName": "my-policy.js",\n      "description": "My Policy from a JS file"\n    }\n  ],\n  "mappers": [\n    {\n      "name": "My Mapper",\n      "fileName": "my-mapper.js",\n      "description": "My Mapper from a JS file"\n    }\n  ]\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"authentication-spi",children:"Authentication SPI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9274\u6743"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"event-listener-spi",children:"Event Listener SPI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E8B\u4EF6\u76D1\u542C"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"org.keycloak.events.EventListenerProvider"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"user-storage-spi",children:"User Storage SPI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7528\u6237\u6570\u636E\u5E93\u548C\u6388\u6743\u4FE1\u606F"}),"\n",(0,l.jsx)(n.li,{children:"\u5185\u5EFA LDAP \u548C AD"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"vault-spi",children:"Vault SPI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/keycloak/keycloak-community/blob/master/design/secure-credentials-store.md",children:"Secure Credentials Store - Vault SPI"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5173\u4E8E\u96C6\u6210\u5916\u90E8 Vault \u7684\u8BA8\u8BBA"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u901A\u8FC7\u5B9E\u73B0 ",(0,l.jsx)(n.code,{children:"org.keycloak.vault.VaultProvider"})," SPI \u53EF\u4EE5\u505A\u5230\u548C\u5916\u90E8\u7CFB\u7EDF\u96C6\u6210"]}),"\n",(0,l.jsx)(n.li,{children:"\u7528\u4E8E\u9694\u79BB\u4E00\u4E9B\u654F\u611F\u4FE1\u606F"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"provider",children:"Provider"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["SPI\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["org.keycloak.broker.provider.IdentityProviderMapper - Provider \u7528\u6237\u5C5E\u6027\u6620\u5C04\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"preprocessFederatedIdentity"}),"\n",(0,l.jsx)(n.li,{children:"importNewUser - \u5BFC\u5165\u7528\u6237\u56DE\u8C03"}),"\n",(0,l.jsx)(n.li,{children:"updateBrokeredUser - \u66F4\u65B0\u7528\u6237\u56DE\u8C03"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"org.keycloak.broker.social.SocialIdentityProviderFactory"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["AbstractOAuth2IdentityProvider\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["performLogin\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"createAuthorizationUrl - \u521B\u5EFA\u6388\u6743\u8DF3\u8F6C URL"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["callback - \u8FD4\u56DE\u56DE\u8C03 Endpoint \u5904\u7406 - \u5904\u7406 GET \u8BF7\u6C42\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5904\u7406\u56DE\u8C03\u56DE\u6765\u7684 code, error, state \u7B49"}),"\n",(0,l.jsx)(n.li,{children:"\u8FD4\u56DE error, cancelled, authenticated"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"generateTokenRequest - \u901A\u8FC7 code \u751F\u6210\u7B2C\u4E09\u65B9 token \u7684\u8BF7\u6C42"}),"\n",(0,l.jsxs)(n.li,{children:["getFederatedIdentity - \u7B2C\u4E09\u65B9\u6362\u53D6 token \u751F\u6210 context\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"BrokeredIdentityContext - \u5305\u542B\u6CDB\u5316\u540E\u7684\u8EAB\u4EFD\u4FE1\u606F"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"supportsExternalExchange - \u9ED8\u8BA4 false\uFF0C\u901A\u8FC7\u5BF9\u5916\u6388\u6743\u7684\u8BBE\u7F6E\u4E3A true"}),"\n",(0,l.jsxs)(n.li,{children:["exchangeExternal\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["extractIdentityFromProfile\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u63D0\u53D6\u7B2C\u4E09\u65B9\u8FD4\u56DE\u7684\u7ED3\u679C\uFF0C\u751F\u6210 context"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},17776:function(e,n,s){s.d(n,{R:()=>t,x:()=>c});var i=s(7378);let l={},r=i.createContext(l);function t(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);