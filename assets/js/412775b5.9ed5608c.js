"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["42889"],{68869:function(e,o,t){t.r(o),t.d(o,{frontMatter:()=>r,toc:()=>d,default:()=>h,metadata:()=>n,assets:()=>a,contentTitle:()=>s});var n=JSON.parse('{"id":"ai/ml/pytorch/pytorch-cookbook","title":"Pytorch Cookbook","description":"Auto Set Device","source":"@site/../notes/ai/ml/pytorch/pytorch-cookbook.md","sourceDirName":"ai/ml/pytorch","slug":"/ai/ml/pytorch/cookbook","permalink":"/notes/ai/ml/pytorch/cookbook","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/ai/ml/pytorch/pytorch-cookbook.md","tags":[{"inline":true,"label":"Cookbook","permalink":"/notes/tags/cookbook"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1740927882000,"frontMatter":{"tags":["Cookbook"]},"sidebar":"docs","previous":{"title":"PyTorch","permalink":"/notes/ai/ml/pytorch/"},"next":{"title":"PyTorch FAQ","permalink":"/notes/ai/ml/pytorch/faq"}}'),c=t(86106),i=t(17776);let r={tags:["Cookbook"]},s="Pytorch Cookbook",a={},d=[{value:"Auto Set Device",id:"auto-set-device",level:2}];function l(e){let o={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,i.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.header,{children:(0,c.jsx)(o.h1,{id:"pytorch-cookbook",children:"Pytorch Cookbook"})}),"\n",(0,c.jsx)(o.h2,{id:"auto-set-device",children:"Auto Set Device"}),"\n",(0,c.jsx)(o.pre,{children:(0,c.jsx)(o.code,{className:"language-py",children:'import torch\n\nprint(f"Default device: {torch.get_default_device()}")\n\nif torch.backends.mps.is_available():\n    device = torch.device("mps")\n    x = torch.ones(1, device=device)\n    print(f"Using MPS device: {x}")\nelif torch.backends.cuda.is_built():\n    device = torch.device("cuda")\n    x = torch.ones(1, device=device)\n    print(f"Using CUDA device: {x}")\nelse:\n    device = torch.device("cpu")\n    x = torch.ones(1, device=device)\n    print(f"Using CPU device: {x}")\n'})}),"\n",(0,c.jsx)(o.pre,{children:(0,c.jsx)(o.code,{className:"language-py",children:'device = torch.device((\n    "cuda"\n    if torch.cuda.is_available()\n    else "mps"\n    if torch.backends.mps.is_available()\n    else "cpu"\n))\nprint(f"Using {device} device")\n'})}),"\n",(0,c.jsx)(o.pre,{children:(0,c.jsx)(o.code,{className:"language-py",children:'device = "cuda" if torch.cuda.is_available() else "mps" if torch.backends.mps.is_available() else "cpu"\n'})}),"\n",(0,c.jsx)(o.pre,{children:(0,c.jsx)(o.code,{className:"language-py",children:"# \u4E0D\u63A8\u8350\ntorch.set_default_device(device)\n"})})]})}function h(e={}){let{wrapper:o}={...(0,i.R)(),...e.components};return o?(0,c.jsx)(o,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}},17776:function(e,o,t){t.d(o,{R:()=>r,x:()=>s});var n=t(7378);let c={},i=n.createContext(c);function r(e){let o=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function s(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),n.createElement(i.Provider,{value:o},e.children)}}}]);