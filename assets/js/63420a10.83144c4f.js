"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["170111"],{287613:function(n,e,o){o.r(e),o.d(e,{frontMatter:()=>c,toc:()=>t,default:()=>p,metadata:()=>s,assets:()=>r,contentTitle:()=>d});var s=JSON.parse('{"id":"ai/agent/opencode","title":"opencode","description":"- anomalyco/opencode","source":"@site/../notes/ai/agent/opencode.md","sourceDirName":"ai/agent","slug":"/ai/agent/opencode","permalink":"/notes/ai/agent/opencode","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/ai/agent/opencode.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767839336000,"frontMatter":{"title":"opencode"},"sidebar":"docs","previous":{"title":"OpenClaw \u9879\u76EE\u5206\u6790","permalink":"/notes/ai/agent/openclaw"},"next":{"title":"Peekaboo","permalink":"/notes/ai/agent/peekaboo"}}'),l=o(486106),i=o(917776);let c={title:"opencode"},d="OpenCode",r={},t=[{value:"\u914D\u7F6E",id:"configuration",level:2}];function a(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"opencode",children:"OpenCode"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/anomalyco/opencode",children:"anomalyco/opencode"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"MIT, TypeScript"}),"\n",(0,l.jsx)(e.li,{children:"\u5F00\u6E90 AI \u7F16\u7A0B\u52A9\u624B\uFF0CClaude Code \u7684\u66FF\u4EE3\u54C1"}),"\n",(0,l.jsx)(e.li,{children:"\u652F\u6301\u591A\u6A21\u578B (Claude\u3001OpenAI\u3001Google\u3001Anthropic \u7B49)"}),"\n",(0,l.jsx)(e.li,{children:"\u57FA\u4E8E\u7EC8\u7AEF\u7684\u4EA4\u4E92\u754C\u9762\uFF0C\u7C7B\u4F3C neovim \u7528\u6237\u4F53\u9A8C"}),"\n",(0,l.jsx)(e.li,{children:"\u652F\u6301 MCP (Model Context Protocol) \u534F\u8BAE"}),"\n",(0,l.jsx)(e.li,{children:"\u5BA2\u6237\u7AEF-\u670D\u52A1\u5668\u67B6\u6784\uFF0C\u652F\u6301\u8FDC\u7A0B\u8FDE\u63A5"}),"\n",(0,l.jsx)(e.li,{children:"\u5185\u5EFA LSP \u652F\u6301\uFF0C\u4EE3\u7801\u667A\u80FD\u8865\u5168"}),"\n",(0,l.jsx)(e.li,{children:"\u63D2\u4EF6\u7CFB\u7EDF\uFF0C\u652F\u6301\u81EA\u5B9A\u4E49\u5DE5\u5177\u548C\u4EE3\u7406"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://github.com/code-yeongyu/oh-my-opencode",children:"https://github.com/code-yeongyu/oh-my-opencode"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.admonition,{type:"caution",children:(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u9879\u76EE\u7EF4\u5EA6 MCP\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/anomalyco/opencode/issues/361",children:"https://github.com/anomalyco/opencode/issues/361"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:".vscode/mcp.json"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,l.jsx)(e.admonition,{type:"tip",children:(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u4F7F\u7528 vercel ai sdk, \u56E0\u6B64 adapter \u53EF\u4EE5\u914D\u7F6E @ai-sdk/anthropic \u8FD9\u6837\u7684 adapter"}),"\n",(0,l.jsx)(e.li,{children:"\u5F88\u591A\u529F\u80FD\u6A21\u5757\u662F\u52A8\u6001\u7684\uFF0C\u52A8\u6001\u901A\u8FC7 npm package \u65B9\u5F0F\u63D0\u4F9B"}),"\n",(0,l.jsx)(e.li,{children:"tool \u76F4\u63A5\u652F\u6301\u5199 typescript \u65B9\u5F0F\u63D0\u4F9B"}),"\n",(0,l.jsx)(e.li,{children:"\u4F7F\u7528 bun \u6267\u884C"}),"\n",(0,l.jsx)(e.li,{children:"grep, glob, list \u4F7F\u7528 ripgrep \u63D0\u4F9B\u5DE5\u5177"}),"\n"]})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# npm\nnpm i -g opencode-ai@latest\n\n# Homebrew (macOS/Linux)\nbrew install opencode\nbrew install --cask opencode-desktop\n# Scoop (Windows)\nscoop bucket add extras\nscoop install extras/opencode\n\n# Chocolatey (Windows)\nchoco install opencode\n\n# Arch Linux\nparu -S opencode-bin\n\n# Nix\nnix run nixpkgs#opencode\n\n# \u5B89\u88C5\u7279\u5B9A\u7248\u672C\ncurl -fsSL https://opencode.ai/install | bash -s -- --version 1.1.3\n\n# \u81EA\u5B9A\u4E49\u5B89\u88C5\u76EE\u5F55\nOPENCODE_INSTALL_DIR=/usr/local/bin curl -fsSL https://opencode.ai/install | bash\nXDG_BIN_DIR=$HOME/.local/bin curl -fsSL https://opencode.ai/install | bash\n\n# http://127.0.0.1:4096/\nopencode web\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"~/.config/opencode/config.json"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"~/Library/Application Support/opencode/config.json"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"%APPDATA%\\opencode\\config.json"})}),"\n",(0,l.jsx)(e.li,{children:"./opencode.json"}),"\n",(0,l.jsx)(e.li,{children:"./opencode.jsonc"}),"\n",(0,l.jsx)(e.li,{children:"./.opencode/config.json"}),"\n",(0,l.jsx)(e.li,{children:"OPENCODE_CONFIG_CONTENT"}),"\n",(0,l.jsx)(e.li,{children:"OPENCODE_CONFIG"}),"\n",(0,l.jsx)(e.li,{children:"OPENCODE_CONFIG_DIR"}),"\n",(0,l.jsx)(e.li,{children:'OPENCODE_PERMISSION=\'{"bash":"allow","edit":"ask"}\''}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:".opencode/agent/*.md"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:".opencode/command/*.md"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:".opencode/themes/*.json"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:".opencode/lsp.json"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:".opencode/formatter.json"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:".opencode/mcp.json"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"{env:VAR_NAME}"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"{file:path/to/file}"})}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"/.well-known/opencode"})," URL"]}),"\n",(0,l.jsxs)(e.li,{children:["~/.local/share/opencode/mcp-auth.json\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"MCP Auth"}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"opencode mcp auth my-oauth-server"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:".opencode/tool/"}),"\n",(0,l.jsxs)(e.li,{children:["~/.config/opencode/tool/\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"import { tool } from \"@opencode-ai/plugin\"; export default tool({description:'',args:tool.schema.object(),execute:async({args})=>{}})"})}),"\n",(0,l.jsx)(e.li,{children:"\u53EF\u4EE5\u4E00\u4E2A\u6587\u4EF6\u4E00\u4E2A\uFF0C\u4E5F\u53EF\u4EE5\u4E00\u4E2A\u6587\u4EF6 export \u591A\u4E2A\u5DE5\u5177"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:'opencode debug config\n\n# ~/.local/share/opencode/auth.json\nopencode auth list\n\nopencode models\nopencode models --refresh\nopencode models anthropic\n\n# --continue\n# --session\n# --model\n# --file \u9644\u52A0\u6587\u4EF6\n# --attach http://localhost:4096\n# --title\nopencode run "hello"\n\n\n# build, plan\nopencode run --agent plan "analyze this codebase"\n\n# debug agent|lsp|file|ripgrep|snapshot|skill\nopencode debug agent NAME\n\nopencode session list\nopencode session rename <id> <new-name>\n\n\nopencode stats\nopencode upgrade\n\nopencode export SESSION-ID\nopencode import FILE # \u5BFC\u5165\u4F1A\u8BDD\n\n# GitHub \u96C6\u6210\nopencode github pr create\nopencode github issue list\n'})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"opencode"})," - \u63A8\u8350\u7684\u514D\u8D39\u6A21\u578B (Recommended free models)"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"anthropic"})," - Claude models"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"openai"})," - GPT models"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"google"})," - Gemini models"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"github-copilot"})," - GitHub Copilot"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"vercel"})," - Vercel AI Gateway"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"openrouter"})," - Multiple providers"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"deepinfra"}),", ",(0,l.jsx)(e.strong,{children:"cerebras"}),", ",(0,l.jsx)(e.strong,{children:"groq"}),", ",(0,l.jsx)(e.strong,{children:"mistral"}),", ",(0,l.jsx)(e.strong,{children:"togetherai"})," \u7B49"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"configuration",children:"\u914D\u7F6E"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"opencode.json"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "model": "anthropic/claude-3-5-sonnet",\n  "agent": "build",\n  "disabled_providers": ["openai"],\n  "enabled_providers": ["anthropic", "opencode"],\n  "share": "auto"\n}\n'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "theme": "dark",\n  "keybindings": {\n    "quit": "ctrl+c",\n    "submit": "enter"\n  }\n}\n'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",children:'{\n  "$schema": "https://opencode.ai/config.json",\n  "model": "anthropic/claude-3-5-sonnet",\n  "small_model": "opencode/glm-4.6",\n  "default_agent": "build",\n  "theme": "dark",\n  "share": "manual",\n  "disabled_providers": ["openai"],\n  "enabled_providers": ["anthropic", "opencode"],\n  "compaction": {\n    "auto": true,\n    "prune": true\n  },\n  "agent": {\n    "build": {\n      "model": "anthropic/claude-3-5-sonnet",\n      "temperature": 0.7,\n      "permission": {\n        "bash": "allow",\n        "edit": "allow"\n      }\n    },\n    "plan": {\n      "model": "opencode/glm-4.6",\n      "permission": {\n        "bash": "deny",\n        "edit": "ask"\n      }\n    }\n  },\n  "provider": {\n    "anthropic": {\n      "options": {\n        "baseURL": "",\n        "headers": {}\n      },\n      "models": {\n        "custom": {\n          "name": "Custome Model"\n        }\n      }\n    }\n  },\n  "mcp": {\n    "filesystem": {\n      "type": "remote",\n      "url": "http://localhost:3000/mcp",\n      "headers": {},\n      // false \u4E3A disable\n      "oauth": {\n        "clientId": "{env:MY_MCP_CLIENT_ID}",\n        "clientSecret": "{env:MY_MCP_CLIENT_SECRET}",\n        "scope": "tools:read tools:execute"\n      },\n      "enabled": true\n    },\n    "filesystem": {\n      "type": "local",\n      "command": ["npx", "-y", "my-mcp-command"],\n      "enabled": true,\n      "environment": {\n        "MY_ENV_VAR": "my_env_var_value"\n      },\n      "timeout": 5000\n    }\n  },\n  "tools": {\n    // \u53EF\u4EE5\u5173\u95ED mcp tool\n    "my-mcp-foo": false,\n    "my-mcp*": false\n  },\n  // \u5355\u72EC\u5F00\u542F\n  "agent": {\n    "my-agent": {\n      "tools": {\n        "my-mcp*": true\n      }\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:".opencode/agent/{agent-name}.md"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-markdown",children:"---\ndescription: \u81EA\u5B9A\u4E49\u4EE3\u7406\u63CF\u8FF0\nmodel: anthropic/claude-3-5-sonnet\ncolor: '#FF5733'\ntemperature: 0.8\nmode: primary\nsteps: 50\npermission:\n  bash: allow\n  edit: allow\n---\n\n\u4F60\u7684\u4EE3\u7406\u6307\u4EE4\u5185\u5BB9...\n\n\u4F7F\u7528\u7279\u5B9A\u7684\u7F16\u7A0B\u98CE\u683C\u548C\u65B9\u6CD5\u8BBA\u3002\n\u4E13\u6CE8\u4E8E [\u7279\u5B9A\u4EFB\u52A1]\u3002\n\n[\u8BE6\u7EC6\u6307\u4EE4...]\n"})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:".opencode/command/{command-name}.md`"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-markdown",children:"---\ndescription: \u547D\u4EE4\u63CF\u8FF0\nmodel: opencode/glm-4.6\nagent: build\nsubtask: true\n---\n\n\u547D\u4EE4\u6267\u884C\u7684\u5177\u4F53\u6307\u4EE4...\n\n[\u8BE6\u7EC6\u6B65\u9AA4\u548C\u6A21\u677F...]\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-json",metastring:'title=".opencode/themes/{theme-name}.json"',children:'{\n  "$schema": "https://opencode.ai/theme.json",\n  "defs": {\n    "primary": "#007ACC",\n    "secondary": "#6C757D",\n    "nord0": "#2E3440"\n  },\n  "theme": {\n    "primary": {\n      "dark": "primary",\n      "light": "primary"\n    },\n    "background": {\n      "dark": "nord0",\n      "light": "#FFFFFF"\n    },\n    "text": {\n      "dark": "#D8DEE9",\n      "light": "#2E3440"\n    }\n  }\n}\n'})})]})}function p(n={}){let{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(a,{...n})}):a(n)}},917776:function(n,e,o){o.d(e,{R:()=>c,x:()=>d});var s=o(7378);let l={},i=s.createContext(l);function c(n){let e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:c(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);