"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["135191"],{195060:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>t,toc:()=>c,default:()=>a,metadata:()=>d,assets:()=>o,contentTitle:()=>r});var d=JSON.parse('{"id":"web/deno/README","title":"deno","description":"- denoland/deno","source":"@site/../notes/web/deno/README.md","sourceDirName":"web/deno","slug":"/web/deno/","permalink":"/notes/web/deno/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/deno/README.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1693122196000,"frontMatter":{"title":"deno"},"sidebar":"docs","previous":{"title":"CORS","permalink":"/notes/web/cors"},"next":{"title":"Deno Awesome","permalink":"/notes/web/deno/awesome"}}'),l=s(486106),i=s(917776);let t={title:"deno"},r="deno",o={},c=[{value:"deno.json",id:"denojson",level:2},{value:"Node vs Deno",id:"node-vs-deno",level:2},{value:"deno deploy",id:"deno-deploy",level:2}];function h(n){let e={a:"a",admonition:"admonition",code:"code",del:"del",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"deno",children:"deno"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/denoland/deno",children:"denoland/deno"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"MIT, Rust"}),"\n",(0,l.jsx)(e.li,{children:"\u57FA\u4E8E V8"}),"\n",(0,l.jsx)(e.li,{children:"\u5185\u7F6E \u5305\u7BA1\u7406\u3001tsc\u3001fmt\u3001test\u3001bundle\u3001lint\u3001lsp \u7B49\u529F\u80FD"}),"\n",(0,l.jsx)(e.li,{children:"\u901A\u8FC7 url \u5F15\u7528\u5916\u90E8\u6A21\u5757 - \u8FD0\u884C\u65F6\u4E0B\u8F7D"}),"\n",(0,l.jsx)(e.li,{children:"\u4E25\u683C\u7684\u6743\u9650\u7BA1\u7406 - \u6C99\u76D2\u529F\u80FD\u5F3A"}),"\n",(0,l.jsxs)(e.li,{children:["\u529F\u80FD\u7406\u5FF5\u7C7B\u4F3C\u4E8E golang\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"stdlib \u53C2\u7167 go \u5B9E\u73B0"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:"Deno \u5168\u5C40\u547D\u540D\u7A7A\u95F4"}),"\n",(0,l.jsx)(e.li,{children:"~/.deno/bin - deno install \u4F4D\u7F6E"}),"\n"]}),"\n",(0,l.jsx)(e.admonition,{type:"info",children:(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["WebStorm deno fmt ",(0,l.jsx)(e.a,{href:"https://youtrack.jetbrains.com/issue/WEB-50743/Support-deno-fmt-as-formatter",children:"WEB-50743"})]}),"\n"]})}),"\n",(0,l.jsx)(e.admonition,{type:"caution",children:(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["deno \u975E\u5E38\u96BE\u7BA1\u7406\u4F9D\u8D56\u7248\u672C - \u56E0\u4E3A\u7248\u672C\u53F7 pin \u5728 import \u8DEF\u5F84\u4E0A\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u4E0D\u65B9\u4FBF\u4FEE\u6539\u548C\u5F15\u7528"}),"\n",(0,l.jsx)(e.li,{children:"\u5F88\u53EF\u80FD\u5F15\u5165\u591A\u4E2A\u7248\u672C"}),"\n",(0,l.jsx)(e.li,{children:"\u4E0D pin \u7248\u672C\u4F1A\u4F7F\u7528 latest\uFF0C\u5BFC\u81F4\u4F9D\u8D56\u5347\u7EA7\u540E\u811A\u672C\u5F02\u5E38 - \u9ED8\u8BA4\u6CA1\u6709 lock"}),"\n",(0,l.jsx)(e.li,{children:"import map \u4E0D\u65B9\u4FBF\u4F9D\u8D56\u6A21\u5757\u5F15\u5165"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["deno \u4E0D\u652F\u6301 AlpineLinux, CentOS 7\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsxs)(e.del,{children:["Release musl builds ",(0,l.jsx)(e.a,{href:"https://github.com/denoland/deno/issues/3711",children:"#3711"})]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"alpine 3.19+ \u652F\u6301"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["Release centos7 compatible binaries ",(0,l.jsx)(e.a,{href:"https://github.com/denoland/deno/issues/1658",children:"#1658"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["deno \u4E0D\u652F\u6301 gRPC\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["grpc-node \u4E5F\u65E0\u6CD5\u517C\u5BB9 Deno - \u56E0\u4E3A Deno HTTP2 \u7F3A\u5C11 trailing headers ",(0,l.jsx)(e.a,{href:"https://github.com/grpc/grpc-node/issues/1791#issuecomment-911984475",children:"grpc-node#1791"})]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:"// HTTP \u670D\u52A1\u5668\nconst listener = Deno.listen({ port: 8000 });\nconsole.log('http://localhost:8000/');\n\nfor await (const conn of listener) {\n  serve(conn);\n}\n\nasync function serve(conn: Deno.Conn) {\n  for await (const { respondWith } of Deno.serveHttp(conn)) {\n    respondWith(new Response('Hello world'));\n  }\n}\n"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# bundle \u4E3A\u5355\u4E2A\u6587\u4EF6 - \u8F93\u51FA\u4E3A js\ndeno bundle scripts/main.ts cli.js\ndeno run cli.js\n\n# compile \u4E3A\u53EF\u6267\u884C\u6587\u4EF6 - \u6253\u5305 deno - \u7EA6 70MB\n# -A \u7ED9\u6240\u6709\u6743\u9650\n# --target \u751F\u6210\u5176\u4ED6\u5E73\u53F0 - \u7B2C\u4E00\u6B21\u6267\u884C\u4F1A\u4E0B\u8F7D deno \u5230 DENO_DIR\n# x86_64-unknown-linux-gnu, x86_64-pc-windows-msvc, x86_64-apple-darwin, aarch64-apple-darwin\ndeno compile -o cli --allow-write --allow-read scripts/main.ts\n./cli\n"})}),"\n",(0,l.jsx)(e.h2,{id:"denojson",children:"deno.json"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"deno.jsonc"}),"\n",(0,l.jsx)(e.li,{children:"deno.json"}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://deno.land/manual/getting_started/configuration_file.md",children:"https://deno.land/manual/getting_started/configuration_file.md"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://deno.land/x/deno/cli/schemas/config-file.v1.json",children:"https://deno.land/x/deno/cli/schemas/config-file.v1.json"})}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \u751F\u6210 lock.json\ndeno cache --lock=lock.json --lock-write --unstable main.ts\n"})}),"\n",(0,l.jsx)(e.h2,{id:"node-vs-deno",children:"Node vs Deno"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"Node"}),(0,l.jsx)(e.th,{children:"Deno"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"npm i -g"}),(0,l.jsx)(e.td,{children:"deno install"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"npm i"}),(0,l.jsx)(e.td,{children:"not needed"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"node"}),(0,l.jsx)(e.td,{children:"deno run"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"eslint"}),(0,l.jsx)(e.td,{children:"deno lint"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"prettier"}),(0,l.jsx)(e.td,{children:"deno fmt"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"rollup/webpack/..."}),(0,l.jsx)(e.td,{children:"deno bundle"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"package.json"}),(0,l.jsx)(e.td,{children:"Deno.json, import_map.json"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"tsc"}),(0,l.jsx)(e.td,{children:"not needed - built-in"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"documentation"}),(0,l.jsx)(e.td,{children:"deno doc"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"jest/ava/tap/..."}),(0,l.jsx)(e.td,{children:"deno test"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"benchmarks"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.a,{href:"https://deno.land/std/testing/bench.ts",children:"https://deno.land/std/testing/bench.ts"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"nodemon"}),(0,l.jsx)(e.td,{children:"deno run/lint/test --watch"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"nexe/pkg"}),(0,l.jsx)(e.td,{children:"deno compile"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"npm explain"}),(0,l.jsx)(e.td,{children:"deno info"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"nvm"}),(0,l.jsx)(e.td,{children:"deno upgrade"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"tsserver"}),(0,l.jsx)(e.td,{children:"deno lsp"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"c8/istanbul"}),(0,l.jsx)(e.td,{children:"deno coverage"})]})]})]}),"\n",(0,l.jsx)(e.h2,{id:"deno-deploy",children:"deno deploy"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"deno \u5B98\u65B9\u63D0\u4F9B\u7684 serverless \u670D\u52A1"}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://deno.com/deploy/docs/pricing-and-limits",children:"\u5B9A\u4EF7 & \u9650\u5236"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"100k req/day, 1000 req/min"}),"\n",(0,l.jsx)(e.li,{children:"512 MB, \u6BCF\u6B21\u8BF7\u6C42 50 ms"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://deno.com/deploy",children:"https://deno.com/deploy"})}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://crux.land",children:"https://crux.land"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u514D\u8D39\u6258\u7BA1 \u2264 20kB \u7684 deno \u6A21\u5757"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function a(n={}){let{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(h,{...n})}):h(n)}},917776:function(n,e,s){s.d(e,{R:()=>t,x:()=>r});var d=s(7378);let l={},i=d.createContext(l);function t(n){let e=d.useContext(i);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:t(n.components),d.createElement(i.Provider,{value:e},n.children)}}}]);