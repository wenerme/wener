"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["295385"],{131972:function(n,e,i){i.r(e),i.d(e,{frontMatter:()=>r,toc:()=>a,default:()=>o,metadata:()=>l,assets:()=>c,contentTitle:()=>d});var l=JSON.parse('{"id":"dev/cloud/dapr","title":"Dapr","description":"Dapr \u63D0\u4F9B\u4E91\u670D\u52A1\u62BD\u8C61\uFF0C\u8BA9\u5B9E\u73B0\u5E95\u5C42\u89E3\u8026\u53EF\u66FF\u6362\u3002","source":"@site/../notes/dev/cloud/dapr.md","sourceDirName":"dev/cloud","slug":"/dev/cloud/dapr","permalink":"/notes/dev/cloud/dapr","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/cloud/dapr.md","tags":[{"inline":true,"label":"Distributed","permalink":"/notes/tags/distributed"},{"inline":true,"label":"CNCF","permalink":"/notes/tags/cncf"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1739157197000,"frontMatter":{"title":"Dapr","tags":["Distributed","CNCF"]},"sidebar":"docs","previous":{"title":"Dapr Version","permalink":"/notes/dev/cloud/dapr-version"},"next":{"title":"Code FAQ","permalink":"/notes/dev/code-faq"}}'),s=i(486106),t=i(917776);let r={title:"Dapr",tags:["Distributed","CNCF"]},d="Dapr",c={},a=[{value:"SDK",id:"sdk",level:2},{value:"Sidecar",id:"sidecar",level:2},{value:"Actor",id:"actor",level:2},{value:"Notes",id:"notes",level:2},{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:2}];function h(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"dapr",children:"Dapr"})}),"\n",(0,s.jsx)(e.p,{children:"Dapr \u63D0\u4F9B\u4E91\u670D\u52A1\u62BD\u8C61\uFF0C\u8BA9\u5B9E\u73B0\u5E95\u5C42\u89E3\u8026\u53EF\u66FF\u6362\u3002\n\u867D\u7136 Dapr \u770B\u4F3C\u63D0\u53D6\u4E86\u5F88\u591A\u5E38\u7528\u7684\u670D\u52A1\u529F\u80FD\uFF0C\u4F46\u90FD\u662F\u5BF9\u6807\u4E91\u5E73\u53F0\u670D\u52A1\u7684\u3002\n\u56E0\u4E3A Dapr \u662F \u5FAE\u8F6F \u548C \u963F\u91CC \u8054\u5408\u5F00\u53D1\u7684\uFF0C\u4E5F\u5C31\u662F\u4E3A\u4E86\u628A Azure \u548C Aliyun \u7684\u529F\u80FD\u96C6\u6210\u8FDB\u6765\u3002"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u4E0D\u9002\u7528\u573A\u666F"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"self-host - \u4E0D\u4F9D\u8D56\u4E91\u5E73\u53F0\u529F\u80FD"}),"\n",(0,s.jsx)(e.li,{children:"\u4E1A\u52A1\u529F\u80FD\u660E\u786E - \u62BD\u8C61\u65E0\u610F\u4E49"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"Tradeoff"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["sidecar \u6A21\u5F0F\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u66F4\u597D\u652F\u6301\u591A\u8BED\u8A00 - \u524D\u63D0\u662F\u6D89\u53CA\u5230\u90A3\u4E48\u591A\u8BED\u8A00"}),"\n",(0,s.jsx)(e.li,{children:"\u4F7F\u7528\u989D\u5916\u7684\u8D44\u6E90"}),"\n",(0,s.jsx)(e.li,{children:"\u5F00\u53D1\u4F53\u9A8C\u4F1A\u6709\u5F71\u54CD"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"https://github.com/dapr/dapr",children:"dapr/dapr"})," \u662F\u4EC0\u4E48\uFF1F\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Apache-2.0, Go"}),"\n",(0,s.jsx)(e.li,{children:"Distributed Application Runtime - \u5206\u5E03\u5F0F\u5E94\u7528\u8FD0\u884C\u65F6"}),"\n",(0,s.jsx)(e.li,{children:"\u4E91\u539F\u751F\u5F00\u53D1\u5DE5\u5177\u96C6"}),"\n",(0,s.jsx)(e.li,{children:"\u652F\u6301\u591A\u8BED\u8A00 - sidecar \u66B4\u9732 http \u548C grpc \u63A5\u53E3"}),"\n",(0,s.jsx)(e.li,{children:"\u652F\u6301\u591A\u73AF\u5883 - \u4E0D\u9650\u5236\u5728 kube \u96C6\u7FA4"}),"\n",(0,s.jsx)(e.li,{children:"Sidecar \u6A21\u5F0F - \u8F7B sdk \u91CD sidecar"}),"\n",(0,s.jsx)(e.li,{children:"CNCF"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["http-max-request-size \u9ED8\u8BA4\u9650\u5236 4m\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u56E0\u6B64\u5355\u4E2A gRPC/HTTP \u8BF7\u6C42\u6700\u5927 4mb"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(e.admonition,{type:"tip",children:(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["WIP\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Configuration - ",(0,s.jsx)(e.a,{href:"https://github.com/dapr/dapr/issues/2988",children:"dapr/dapr#2988"})]}),"\n",(0,s.jsx)(e.li,{children:"Lock"}),"\n",(0,s.jsx)(e.li,{children:"Circuit Breaking"}),"\n",(0,s.jsx)(e.li,{children:"Search"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# macOS \u5B89\u88C5 dapr \u547D\u4EE4\u884C\nbrew install dapr/tap/dapr-cli\n\n# \u672C\u5730\u542F\u52A8 Go \u5E94\u7528\ndapr run --app-id example-service \\\n  --app-protocol grpc \\\n  --app-port 50001 \\\n  go run main.go\n\n# \u542F\u52A8 JS \u5E94\u7528\ndapr run --app-id nodeapp --app-port 3000 --dapr-http-port 3500 app.js\n"})}),"\n",(0,s.jsx)(e.h2,{id:"sdk",children:"SDK"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Language"}),(0,s.jsx)(e.th,{style:{textAlign:"left"},children:"Status"}),(0,s.jsx)(e.th,{style:{textAlign:"center"},children:"Client"}),(0,s.jsx)(e.th,{style:{textAlign:"center"},children:"Server"}),(0,s.jsx)(e.th,{style:{textAlign:"center"},children:"Actor"}),(0,s.jsx)(e.th,{children:"Workflow"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:".NET"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Stable"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"ASP.NET Core"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{children:"\u2714"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Python"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Stable"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"gRPC, FastAPI, Flask"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{children:"\u2714"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Java"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Stable"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"Spring Boot, Quarkus"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{children:"\u2714"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Go"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Stable"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{children:"\u2714"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"PHP"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Stable"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"JavaScript"}),(0,s.jsx)(e.td,{style:{textAlign:"left"},children:"Stable"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"gRPC, express"}),(0,s.jsx)(e.td,{style:{textAlign:"center"},children:"\u2714"}),(0,s.jsx)(e.td,{children:"\u2714"})]})]})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Client\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u670D\u52A1\u65B9\u6CD5\u8BF7\u6C42"}),"\n",(0,s.jsx)(e.li,{children:"\u72B6\u6001\u5B58\u50A8"}),"\n",(0,s.jsx)(e.li,{children:"PubSub"}),"\n",(0,s.jsx)(e.li,{children:"\u7ED1\u5B9A\u64CD\u4F5C"}),"\n",(0,s.jsx)(e.li,{children:"Secret \u83B7\u53D6"}),"\n",(0,s.jsx)(e.li,{children:"Virtual Actor \u4EA4\u4E92"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Server \u6269\u5C55 - Dapr \u670D\u52A1\u6269\u5C55\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u80FD\u88AB\u5176\u4ED6\u670D\u52A1\u8C03\u7528"}),"\n",(0,s.jsx)(e.li,{children:"\u8BA2\u9605\u4E3B\u9898"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Actor\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u65B9\u6CD5\u88AB\u8BF7\u6C42"}),"\n",(0,s.jsx)(e.li,{children:"\u72B6\u6001\u4FDD\u5B58\u83B7\u53D6"}),"\n",(0,s.jsx)(e.li,{children:"Timer \u56DE\u8C03"}),"\n",(0,s.jsx)(e.li,{children:"\u6301\u4E45\u5316 reminder"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://docs.dapr.io/developing-applications/sdks/",children:"SDKs"})}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"sidecar",children:"Sidecar"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u9ED8\u8BA4\u7AEF\u53E3 3500"}),"\n",(0,s.jsxs)(e.li,{children:["\u5143\u6570\u636E - /v1.0/metadata\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5E94\u7528\u81EA\u7701"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"\u5065\u5EB7 - /v1.0/healthz"}),"\n",(0,s.jsxs)(e.li,{children:["\u670D\u52A1\u8C03\u7528 - /v1.0/invoke\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"gRPC, HTTP"}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"/v1.0/invoke/<appId>/method/<method-name>"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u4F8B\u5982 ",(0,s.jsx)(e.code,{children:"/v1.0/invoke/nodeapp.production/method/neworder"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"production \u4E3A namespace"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"NameResolution - consul, kubernetes, mdns"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u72B6\u6001\u7BA1\u7406 - /v1.0/state\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u652F\u6301 Redis, PostgreSQL, MySQL, Hazelcast, Consul, MongoDB, Zookeeper"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["PubSub - /v1.0/publish, /v1.0/subscribe\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u652F\u6301 Kafka, Hazelcast, MQTT, NATS Streaming, Pulsar, RabbitMQ, Redis"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Binding - /v1.0/bindings\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u652F\u6301 APN, Cron, HTTP, Kafka, MQTT, MySQL, PostgreSQL, RabbitMQ, Redis, SMTP, Local Storage, AliOSS"}),"\n",(0,s.jsx)(e.li,{children:"\u7ED1\u5B9A\u5916\u90E8\u670D\u52A1\u4E3A REST \u63A5\u53E3 - \u5916\u90E8\u670D\u52A1\u4EA4\u4E92"}),"\n",(0,s.jsx)(e.li,{children:"\u6839\u636E\u670D\u52A1\u4E0D\u540C\u63D0\u4F9B\u4E0D\u540C\u64CD\u4F5C\u63A5\u53E3 - \u8F93\u5165\u8F93\u51FA"}),"\n",(0,s.jsxs)(e.li,{children:["\u8F93\u5165 ",(0,s.jsx)(e.code,{children:"POST /<binding>"})]}),"\n",(0,s.jsxs)(e.li,{children:["\u8F93\u51FA ",(0,s.jsx)(e.code,{children:"POST /v1.0/bindings/<bidning>"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.code,{children:'{ "data": {}, "operation": "create" }'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Actor - /v1.0/actors\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4F9D\u8D56 state - etag, tx \u652F\u6301"}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.code,{children:"/v1.0/actors/<actorType>/<actorId>/<method/state/timers/reminders>"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:"Observability"}),"\n",(0,s.jsxs)(e.li,{children:["\u5BC6\u94A5\u7BA1\u7406 - /v1.0/secrets\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Env, File, Vault, Kubernetes Vault"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"actor",children:"Actor"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Actor_model",children:"Actor"})," - lowest-level \u201Cunit of computation\u201D"]}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://www.microsoft.com/en-us/research/project/orleans-virtual-actors/",children:"Virtual Actors"})}),"\n",(0,s.jsxs)(e.li,{children:["actor\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u652F\u6301 state"}),"\n",(0,s.jsx)(e.li,{children:"\u4E0D\u652F\u6301 sub - \u53EF\u4EE5 pub"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u7EC4\u4EF6\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"dapr - \u547D\u4EE4\u884C"}),"\n",(0,s.jsx)(e.li,{children:"daprd - sidecar"}),"\n",(0,s.jsx)(e.li,{children:"dashboard - \u9762\u677F"}),"\n",(0,s.jsxs)(e.li,{children:["placement\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"distributed hashing - distribute the actor instances across various pods of the user service"}),"\n",(0,s.jsx)(e.li,{children:"\u53EA\u7528\u4E8E actor"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["SDK - Go, Java, PHP, Python, .NET - WIP JS, Rust, C++\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://docs.dapr.io/developing-applications/sdks/sdk-serialization/",children:"Serialization"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Middleware\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u9650\u6D41\u3001OAuth2\u3001OAuth2 client credentials\u3001Bearer\u3001OPA"}),"\n",(0,s.jsx)(e.li,{children:"Uppercase - \u6D4B\u8BD5\u4F7F\u7528"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["~/.dapr/\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"config.yaml"}),"\n",(0,s.jsxs)(e.li,{children:["components/\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"pubsub.yaml"}),"\n",(0,s.jsx)(e.li,{children:"statestore.yaml"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["bin/\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"daprd"}),"\n",(0,s.jsx)(e.li,{children:"dashboard"}),"\n",(0,s.jsx)(e.li,{children:"web/"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://docs.dapr.io/reference/",children:"Dapr Reference"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'# self-host \u521D\u59CB\u5316 - docker - placement :50005, redis :6379, zipkin :9411\n# --network \u6307\u5B9A docker network\ndapr init\n# \u4E0D\u9700\u8981 docker\n# \u53EF\u624B\u52A8\u542F\u52A8 $HOME/.dapr/bin/placement\ndapr init -s # slim self-hosted - \u4E0D\u542F\u52A8 placement service, Redis, Zipkin\n\n# k8s \u521D\u59CB\u5316\n# --enable-ha\n# --enable-mtls - \u9ED8\u8BA4\u5F00\u542F\n# -n dapr-system\ndapr init -k\ndapr init -k --wait --timeout 600 --runtime-version 1.3.0 # \u6307\u5B9A\u7248\u672C\u3001\u8D85\u65F6\u3001\u7B49\u5F85\u5B8C\u6210\n\n# \u9762\u677F - \u76EE\u524D\u529F\u80FD\u6BD4\u8F83\u7B80\u5355\ndapr dashboard -p 9999\n\n# \u5B9E\u9A8C sidecar\ndapr run --app-id myapp --dapr-http-port 3500\n# \u5B58\u50A8\u72B6\u6001\ncurl -X POST -H "Content-Type: application/json" -d \'[{ "key": "name", "value": "Bruce Wayne"}]\' http://localhost:3500/v1.0/state/statestore\ndocker exec -it dapr_redis redis-cli keys \'*\'\n# hash "myapp||name"\n\n# \u5B9E\u9A8C\u5B9A\u4E49 secret \u7EC4\u4EF6\necho \'{"my-secret" : "Secret here"}\' > mysecrets.json\nmkdir my-components\ncat << CONF > my-components/localSecretStore.yaml\napiVersion: dapr.io/v1alpha1\nkind: Component\nmetadata:\n  name: my-secret-store\n  namespace: default\nspec:\n  type: secretstores.local.file\n  version: v1\n  metadata:\n  - name: secretsFile\n    value: $PWD/mysecrets.json\n  - name: nestedSeparator\n    value: ":"\nCONF\ndapr run --app-id myapp --dapr-http-port 3500 --components-path ./my-components\n# \u8BF7\u6C42 json \u4E2D\u7684\u5185\u5BB9\ncurl http://localhost:3500/v1.0/secrets/my-secret-store/my-secret\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"CDR Configuration"}),"\n",(0,s.jsxs)(e.li,{children:["\u901A\u8FC7 ",(0,s.jsx)(e.code,{children:'dapr.io/config: "zipkin"'})," \u4F7F\u7528"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'apiVersion: dapr.io/v1alpha1\nkind: Configuration\nmetadata:\n  name: zipkin\n  namespace: default\nspec:\n  tracing:\n    samplingRate: "1"\n    zipkin:\n      # \u53EF\u4EE5 selfhost\n      endpointAddress: "http://localhost:9411/api/v2/spans"\n      # k8s\n      endpointAddress: "http://zipkin.default.svc.cluster.local:9411/api/v2/spans"\n\n  # API ACL\n  api:\n    allowed:\n    - name: state # state, invoke, secrets, bindings, publish, actors, metadata\n      version: v1.0\n      protocol: http # http, grpc\n\n  # \u670D\u52A1\u8BBF\u95EE\u63A7\u5236\n  accessControl:\n    defaultAction: deny\n    trustDomain: "public"\n    policies:\n    - appId: app1\n      defaultAction: allow\n      trustDomain: \'public\'\n      namespace: "default"\n    - appId: app1\n      defaultAction: deny\n      trustDomain: \'public\'\n      namespace: "default"\n      operations:\n      - name: /op1 # /op1/*\n        httpVerb: [\'POST\', \'PUT\'] # [\'*\']\n        action: allow\n\n  # \u9884\u89C8\u7279\u6027\n  features:\n  - name: Feature1\n    enabled: true\n'})})]})}function o(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},917776:function(n,e,i){i.d(e,{R:()=>r,x:()=>d});var l=i(7378);let s={},t=l.createContext(s);function r(n){let e=l.useContext(t);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),l.createElement(t.Provider,{value:e},n.children)}}}]);