"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["61442"],{85813:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>c,toc:()=>d,default:()=>h,metadata:()=>t,assets:()=>a,contentTitle:()=>i});var t=JSON.parse('{"id":"languages/v/v-reference","title":"V Reference","description":"\u5185\u5B58\u7BA1\u7406","source":"@site/../notes/languages/v/v-reference.md","sourceDirName":"languages/v","slug":"/languages/v/reference","permalink":"/notes/languages/v/reference","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/languages/v/v-reference.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1623656447000,"frontMatter":{"title":"V Reference"},"sidebar":"docs","previous":{"title":"Vlang FAQ","permalink":"/notes/languages/v/faq"},"next":{"title":"WebAssembly","permalink":"/notes/languages/wasm/"}}'),l=r(86106),s=r(17776);let c={title:"V Reference"},i="V Reference",a={},d=[{value:"\u5185\u5B58\u7BA1\u7406",id:"\u5185\u5B58\u7BA1\u7406",level:2},{value:"C \u4EA4\u4E92",id:"c-\u4EA4\u4E92",level:2},{value:"C \u8F6C V",id:"c-\u8F6C-v",level:3},{value:"\u6C47\u7F16",id:"\u6C47\u7F16",level:2}];function o(e){let n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"v-reference",children:"V Reference"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5185\u5B58\u7BA1\u7406",children:"\u5185\u5B58\u7BA1\u7406"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"-autofree - v0.3 \u9ED8\u8BA4\u5F00\u542F - \u4E0D\u5F00\u542F\u53EF\u80FD\u4F1A\u6CC4\u6F0F\u5185\u5B58"}),"\n",(0,l.jsxs)(n.li,{children:["-manualfree, ",(0,l.jsx)(n.code,{children:"[manualfree]"})]}),"\n",(0,l.jsx)(n.li,{children:"-prealloc"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vlang",children:"struct MyType {}\n\n[unsafe]\nfn (data &MyType) free() {\n	// \u81EA\u5B9A\u4E49 free \u903B\u8F91\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"c-\u4EA4\u4E92",children:"C \u4EA4\u4E92"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"v"}),(0,l.jsx)(n.th,{children:"c"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"voidptr"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"void*"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"&byte"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"byte*"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"&char"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"char*"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"&&char"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"char**"})})]})]})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-vlang",children:'// -I,-L,-l,-D\n#flag -lsqlite3\n#include "sqlite3.h"\n\n// \u73AF\u5883\u533A\u5206\n#flag linux -lsdl2\n\n// \u4F7F\u7528 pkgconfig \u751F\u6210 flag - PKG_CONFIG_PATH\n#pkgconfig r_core\n#pkgconfig --cflags --libs r_core\n\nstruct C.sqlite3 {\n}\n\nstruct C.sqlite3_stmt {\n}\n\ntype FnSqlite3Callback = fn (voidptr, int, &&char, &&char) int\nfn C.sqlite3_open(&char, &&C.sqlite3) int\nfn C.sqlite3_close(&C.sqlite3) int\n\n\nfn main(){\n  // null \u7ED3\u5C3E\u5B57\u7B26\u4E32\u8F6C v string - \u5B57\u7B26\u4E32\u53EF\u80FD\u9700\u8981 dup \u4F7F\u7528 cstring_to_vstring(cstring)\n  unsafe { &char(cstring).vstring() }\n  // \u5DF2\u77E5\u957F\u5EA6\u8F6C string\n  unsafe { &char(cstring).vstring_with_len(len) }\n  // windows wide \u8F6C\u5B57\u7B26\u4E32 string_from_wide(&u16(cwidestring))\n}\n'})}),"\n",(0,l.jsx)(n.p,{children:"\u53EF\u76F4\u63A5\u5305\u542B c \u4EE3\u7801, \u5728 v.mod \u6DFB\u52A0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-c",children:'#flag -I @VMODROOT/c\n#flag @VMODROOT/c/implementation.o\n#include "header.h"\n'})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"@VMODROOT \u4F1A\u88AB\u81EA\u52A8\u66FF\u6362\u4E3A\u6700\u8FD1\u7684 parent module"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"c-\u8F6C-v",children:"C \u8F6C V"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"v translate test.c\n# \u751F\u6210 wrapper\nv wrapper c_code/libsodium/src/libsodium\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6C47\u7F16",children:"\u6C47\u7F16"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-v",children:"a := 100\nb := 20\nmut c := 0\nasm amd64 {\n    mov eax, a\n    add eax, b\n    mov c, eax\n    ; =r (c) as c // output\n    ; r (a) as a // input\n      r (b) as b\n}\nprintln('a: $a') // 100\nprintln('b: $b') // 20\nprintln('c: $c') // 120\n"})})]})}function h(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},17776:function(e,n,r){r.d(n,{R:()=>c,x:()=>i});var t=r(7378);let l={},s=t.createContext(l);function c(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:c(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);