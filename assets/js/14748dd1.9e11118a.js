"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["31025"],{56870:function(n,e,i){i.r(e),i.d(e,{frontMatter:()=>l,toc:()=>h,default:()=>o,metadata:()=>s,assets:()=>c,contentTitle:()=>d});var s=JSON.parse('{"id":"os/linux/security/chmod","title":"ACL","description":"- subject","source":"@site/../notes/os/linux/security/chmod.md","sourceDirName":"os/linux/security","slug":"/os/linux/security/chmod","permalink":"/notes/os/linux/security/chmod","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/security/chmod.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1667302770000,"frontMatter":{"title":"ACL"},"sidebar":"docs","previous":{"title":"POSIX","permalink":"/notes/os/linux/posix"},"next":{"title":"Grsecurity","permalink":"/notes/os/linux/security/grsecurity"}}'),r=i(86106),t=i(17776);let l={title:"ACL"},d="ACL",c={},h=[{value:"acl fix",id:"acl-fix",level:2}];function x(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"acl",children:"ACL"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["subject\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"owner - u"}),"\n",(0,r.jsx)(e.li,{children:"group - g"}),"\n",(0,r.jsx)(e.li,{children:"other - o"}),"\n",(0,r.jsx)(e.li,{children:"all - a"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["perm\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"read - r"}),"\n",(0,r.jsx)(e.li,{children:"write - w"}),"\n",(0,r.jsx)(e.li,{children:"execute - x"}),"\n",(0,r.jsxs)(e.li,{children:["sticky - t - 1\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u9650\u5B9A owner \u624D\u80FD\u64CD\u4F5C"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["setgid,setuid - s - 2,4\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Setuid",children:"https://en.wikipedia.org/wiki/Setuid"})}),"\n",(0,r.jsx)(e.li,{children:"exec \u65F6\u4F7F\u7528\u6587\u4EF6\u7684 owner \u548C group"}),"\n",(0,r.jsx)(e.li,{children:"\u4F8B\u5982 /usr/bin/passwd \u8981\u4FEE\u6539 /etc/passwd"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["2755\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"1 - sticky bit"}),"\n",(0,r.jsx)(e.li,{children:"2 - setgid"}),"\n",(0,r.jsx)(e.li,{children:"4 - setuid"}),"\n"]}),"\n"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"bits"}),(0,r.jsx)(e.th,{children:"name"}),(0,r.jsx)(e.th,{children:"for"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"04000"}),(0,r.jsx)(e.td,{children:"S_ISUID"}),(0,r.jsx)(e.td,{children:"setuid"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"02000"}),(0,r.jsx)(e.td,{children:"S_ISGID"}),(0,r.jsx)(e.td,{children:"setgid"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"01000"}),(0,r.jsx)(e.td,{children:"S_ISVTX"}),(0,r.jsx)(e.td,{children:"sticky bit"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["sticky bit - \u9650\u5236\u5220\u9664\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.man7.org/linux/man-pages/man2/unlink.2.html",children:"https://www.man7.org/linux/man-pages/man2/unlink.2.html"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'stat -c \'%A %a %n\' *\n\nmkdir dir\nchmod 0755 dir\nchmod 00755 dir # \u4F1A\u79FB\u9664 flag - sgid, suid\n\nstat -c "%a %U:%G %n" dir\nstat -c "%U:%G %n" dir\n'})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"mode"}),(0,r.jsx)(e.th,{children:"for"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"777"}),(0,r.jsx)(e.td,{children:"\u6240\u6709\u4EBA\u53EF\u8BFB\u5199"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"755"}),(0,r.jsx)(e.td,{children:"owner \u8BFB\u5199\u6267\u884C,group \u8BFB\u6267\u884C,\u5176\u4ED6 \u8BFB"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"644"}),(0,r.jsx)(e.td,{children:"\u6240\u6709\u53EF\u8BFB, owner \u53EF\u5199"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"711"}),(0,r.jsx)(e.td,{children:"\u4E0D\u53EF\u4EE5 list \u76EE\u5F55\uFF0C\u4F46\u53EF\u4EE5\u8BBF\u95EE\u91CC\u9762\u6709\u6743\u8BBF\u95EE\u7684\u6587\u4EF6"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"777 - rwxrwxrwx"}),"\n",(0,r.jsx)(e.li,{children:"r - 4"}),"\n",(0,r.jsx)(e.li,{children:"w - 2"}),"\n",(0,r.jsx)(e.li,{children:"x - 1"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.man7.org/linux/man-pages/man2/chmod.2.html",children:"chmod.2"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.man7.org/linux/man-pages/man1/chmod.1.html",children:"chmod.1"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://superkogito.github.io/blog/2020/10/25/chmod_modes.html",children:"https://superkogito.github.io/blog/2020/10/25/chmod_modes.html"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"acl-fix",children:"acl fix"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"find . -type d -a -not -perm 0755 -exec chmod 0755 {} \\;\nfind . -type f -a -not -perm 0644 -exec chmod 0644 {} \\;\n\n# \u4FEE\u6539\u7528\u6237\n# \u76EE\u5F55 root -> admin\nsudo find . -type d -user root -exec chown admin {} \\;\n# \u627E\u5230\u975E admin\nsudo find . -not -user admin -exec chown admin {} \\;\n"})})]})}function o(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(x,{...n})}):x(n)}},17776:function(n,e,i){i.d(e,{R:()=>l,x:()=>d});var s=i(7378);let r={},t=s.createContext(r);function l(n){let e=s.useContext(t);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),s.createElement(t.Provider,{value:e},n.children)}}}]);