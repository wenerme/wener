"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["59155"],{35348:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>a,toc:()=>t,default:()=>h,metadata:()=>s,assets:()=>o,contentTitle:()=>c});var s=JSON.parse('{"id":"devops/kubernetes/app/argocd/README","title":"ArgoCD","description":"- argoproj/argo-cd \u662F\u4EC0\u4E48\uFF1F","source":"@site/../notes/devops/kubernetes/app/argocd/README.md","sourceDirName":"devops/kubernetes/app/argocd","slug":"/devops/kubernetes/app/argocd/","permalink":"/notes/devops/kubernetes/app/argocd/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/kubernetes/app/argocd/README.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1757294976000,"frontMatter":{"title":"ArgoCD"},"sidebar":"docs","previous":{"title":"FAQ","permalink":"/notes/devops/kubernetes/app/argo/workflow/faq"},"next":{"title":"ArgoCD ApplicationSet","permalink":"/notes/devops/kubernetes/app/argocd/applicationset"}}'),i=r(86106),l=r(17776);let a={title:"ArgoCD"},c="ArgoCD",o={},t=[{value:"\u5E94\u7528\u53D1\u73B0",id:"\u5E94\u7528\u53D1\u73B0",level:2},{value:"\u7EC4\u4EF6",id:"\u7EC4\u4EF6",level:2},{value:"\u5BC6\u94A5\u7BA1\u7406",id:"\u5BC6\u94A5\u7BA1\u7406",level:2},{value:"\u547D\u4EE4\u884C",id:"\u547D\u4EE4\u884C",level:2},{value:"\u591A\u96C6\u7FA4",id:"\u591A\u96C6\u7FA4",level:2},{value:"\u9879\u76EE",id:"\u9879\u76EE",level:2},{value:"\u540C\u6B65\u9009\u9879",id:"\u540C\u6B65\u9009\u9879",level:2},{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:2},{value:"argocd-cm",id:"argocd-cm",level:3},{value:"ArgoCD \u7BA1\u7406 ArgoCD",id:"argocd-\u7BA1\u7406-argocd",level:2},{value:"Resource Hook",id:"resource-hook",level:2},{value:"Annotations",id:"annotations",level:2},{value:"\u4E0D\u540C\u6B65\u90E8\u5206\u5B57\u6BB5",id:"\u4E0D\u540C\u6B65\u90E8\u5206\u5B57\u6BB5",level:2},{value:"Sync",id:"sync",level:2},{value:"Tricks",id:"tricks",level:2},{value:"Application spec",id:"application-spec",level:2},{value:"webhook",id:"webhook",level:2},{value:"the server could not find the requested resource",id:"the-server-could-not-find-the-requested-resource",level:2},{value:"the server has asked for the client to provide credentials",id:"the-server-has-asked-for-the-client-to-provide-credentials",level:2},{value:"\u5347\u7EA7\u5E94\u7528\u65F6\u53EF\u80FD CRD \u6709\u53D8\u5316\u5BFC\u81F4\u6821\u9A8C\u4E0D\u901A\u8FC7",id:"\u5347\u7EA7\u5E94\u7528\u65F6\u53EF\u80FD-crd-\u6709\u53D8\u5316\u5BFC\u81F4\u6821\u9A8C\u4E0D\u901A\u8FC7",level:2},{value:"kustomize build \u5F02\u5E38",id:"kustomize-build-\u5F02\u5E38",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",del:"del",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"argocd",children:"ArgoCD"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd",children:"argoproj/argo-cd"})," \u662F\u4EC0\u4E48\uFF1F\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u58F0\u660E\u5F0F K8S \u6301\u7EED\u96C6\u6210/CD \u670D\u52A1/\u63A7\u5236\u5668"}),"\n",(0,i.jsx)(n.li,{children:"GitOps"}),"\n",(0,i.jsxs)(n.li,{children:["\u6709 ",(0,i.jsx)(n.strong,{children:"\u76F4\u89C2\u7684"})," WebUI \u53EF\u4F9B\u7BA1\u7406\u548C\u95EE\u9898\u6392\u67E5"]}),"\n",(0,i.jsx)(n.li,{children:"\u652F\u6301\u591A\u96C6\u7FA4\u3001\u7EDF\u4E00\u767B\u5F55\u3001\u6743\u9650\u7BA1\u7406"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://cd.apps.argoproj.io/",children:"DEMO"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u7279\u6027\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u81EA\u52A8\u5316\u90E8\u7F72\u5E94\u7528\u5230\u6307\u5B9A\u73AF\u5883"}),"\n",(0,i.jsx)(n.li,{children:"\u652F\u6301\u591A\u79CD\u914D\u7F6E - Kustomize, Helm, Ksonnet, Jsonnet, plain-YAML"}),"\n",(0,i.jsxs)(n.li,{children:["\u591A\u96C6\u7FA4\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u65E0\u9700\u90E8\u7F72 Agent"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"SSO - OIDC, OAuth2, LDAP, SAML 2.0, GitHub, GitLab, Microsoft, LinkedIn"}),"\n",(0,i.jsx)(n.li,{children:"\u591A\u79DF\u6237\uFF0CRBAC"}),"\n",(0,i.jsx)(n.li,{children:"\u56DE\u6EDA"}),"\n",(0,i.jsx)(n.li,{children:"\u5E94\u7528\u8D44\u6E90\u5065\u5EB7\u72B6\u6001"}),"\n",(0,i.jsx)(n.li,{children:"\u68C0\u6D4B\u672A\u540C\u6B65\u60C5\u51B5"}),"\n",(0,i.jsx)(n.li,{children:"\u81EA\u52A8\u6216\u624B\u52A8\u540C\u6B65"}),"\n",(0,i.jsx)(n.li,{children:"Web UI \u67E5\u770B\u5B9E\u65F6\u60C5\u51B5\u548C\u5E94\u7528\u6D3B\u52A8"}),"\n",(0,i.jsx)(n.li,{children:"CLI \u7528\u4E8E CI \u96C6\u6210"}),"\n",(0,i.jsx)(n.li,{children:"Webhook - GitHub, BitBucket, GitLab"}),"\n",(0,i.jsx)(n.li,{children:"\u7528\u4E8E\u81EA\u52A8\u5316\u7684 Access tokens"}),"\n",(0,i.jsx)(n.li,{children:"PreSync, Sync, PostSync \u94A9\u5B50\u652F\u6301\u590D\u6742\u5E94\u7528 - blue/green & canary upgrades"}),"\n",(0,i.jsx)(n.li,{children:"Audit trails for application events and API calls"}),"\n",(0,i.jsx)(n.li,{children:"Prometheus metrics"}),"\n",(0,i.jsx)(n.li,{children:"Parameter overrides for overriding ksonnet/helm parameters in Git"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5E94\u7528\u5B9A\u4E49\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Kustomize"}),"\n",(0,i.jsx)(n.li,{children:"Helm"}),"\n",(0,i.jsx)(n.li,{children:"A directory of YAML/JSON/Jsonnet manifests, including Jsonnet"}),"\n",(0,i.jsx)(n.li,{children:"\u81EA\u5B9A\u4E49\u914D\u7F6E\u7BA1\u7406\u5DE5\u5177"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.del,{children:"Ksonnet"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u7F3A\u9677\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["App of Apps \u652F\u6301\u4E0D\u597D\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["issues ",(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/labels/component%3Aapplications-set",children:"label:applications-set"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u5C1D\u8BD5\u89E3\u51B3 ",(0,i.jsx)(n.a,{href:"https://github.com/argoproj-labs/applicationset",children:"argoproj-labs/applicationset"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u591A\u96C6\u7FA4\u652F\u6301\u8F83\u5F31 - fleedcd \u76F8\u5BF9\u505A\u7684\u66F4\u597D\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4E00\u4E2A App \u53EA\u80FD\u6307\u5B9A\u4E00\u4E2A\u96C6\u7FA4 ",(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/issues/1673",children:"#1673"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u65E0 agent, \u65E0 crd \u5B9A\u4E49 - app of apps \u53EA\u80FD\u5728 argocd \u6240\u5728\u96C6\u7FA4\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u56E0\u4E3A\u76EE\u6807\u96C6\u7FA4\u6CA1\u6709 argocd \u56E0\u6B64\u8BBE\u7F6E application \u65E0\u6548"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u56E0\u4E3A\u76F8\u540C\u5E94\u7528\u8981\u653E\u5728\u540C\u4E00\u4E2A argocd \u7A7A\u95F4\uFF0C\u56E0\u6B64\u9700\u8981\u540D\u5B57\u524D\u7F00\uFF0C\u4F8B\u5982 ",(0,i.jsx)(n.code,{children:"dev-cert-manager"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u56E0\u4E3A\u52A0\u4E86\u540D\u5B57\u524D\u7F00\uFF0C\u8981\u6CE8\u610F\u6240\u6709\u7684 helm \u6700\u597D\u6307\u5B9A\u56FA\u5B9A\u7684 releaseName, \u4F8B\u5982 cert-manager\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u590D\u5199 releaseName \u4F1A\u6709",(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/user-guide/helm/#helm-release-name",children:"\u95EE\u9898"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsxs)(n.del,{children:["argocd \u4F9D\u8D56 ",(0,i.jsx)(n.code,{children:"app.kubernetes.io/instance"})," \u5339\u914D\u5E94\u7528"]})}),"\n",(0,i.jsx)(n.li,{children:"\u590D\u5199\u53EF\u80FD\u4F1A\u4FEE\u6539\u8BE5 label \u5BFC\u81F4\u65E0\u6CD5\u5339\u914D\u90E8\u5206\u8D44\u6E90"}),"\n",(0,i.jsxs)(n.li,{children:["\u53EF\u4EE5\u5728 ",(0,i.jsx)(n.code,{children:"argocd-cm.yaml"})," \u4FEE\u6539\u914D\u7F6E ",(0,i.jsx)(n.code,{children:"application.instanceLabelKey"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"\u8DE8\u96C6\u7FA4\u5E94\u7528\u65E0\u6CD5\u5220\u9664\u8D44\u6E90"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Kustomize \u540E\u5904\u7406 Helm - - ",(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argocd-example-apps/tree/master/plugins/kustomized-helm",children:"kustomized-helm"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5B98\u65B9\u660E\u786E\u4E0D\u4F1A\u5185\u5EFA\u652F\u6301\uFF0C\u53EA\u80FD\u901A\u8FC7\u81EA\u5B9A\u4E49\u5B9E\u73B0"}),"\n",(0,i.jsxs)(n.li,{children:["Helm 3.1+ \u652F\u6301 ",(0,i.jsx)(n.code,{children:"--post-renderer"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/issues/3882",children:"#3882"}),", ",(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/issues/3698",children:"#3698"})]}),"\n",(0,i.jsx)(n.li,{children:"\u53EF\u80FD\u5B58\u5728 argocd \u73AF\u5883\u65E0\u6CD5\u8BBF\u95EE chart \u95EE\u9898"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/notes/devops/kubernetes/app/argocd/applicationset",children:"ApplicationSet"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/notes/devops/kubernetes/app/argocd/image-updater",children:"Image Updater"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/notes/devops/kubernetes/app/argocd/notifications",children:"Notification"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/notes/devops/kubernetes/app/argocd/vault-plugin",children:"Vault Plugin"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6BCF 3 \u5206\u949F \u62C9\u53D6\u4E00\u6B21 Git"}),"\n",(0,i.jsxs)(n.li,{children:["hlem chart \u7248\u672C\u652F\u6301\u8303\u56F4\u5339\u914D - \u4F7F\u7528 Hard Refresh \u5237\u65B0\u4F1A\u89E6\u53D1\u65B0\u7684\u7248\u672C\u90E8\u7F72\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u9ED8\u8BA4\u5237\u65B0\u4E0D\u4F1A\u89E6\u53D1\u662F\u56E0\u4E3A\u6709 repo \u7F13\u5B58 ",(0,i.jsx)(n.code,{children:"--repo-cache-expiration"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u4F8B\u5982 ",(0,i.jsx)(n.code,{children:"1.1.*"}),", ",(0,i.jsx)(n.code,{children:"~0.1.57"})]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5E94\u7528\u540D\u5B57\u8981\u6C42\u5168\u5C40\u552F\u4E00\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5E94\u7528\u5C31\u662F helm \u7684 release \u540D\u5B57 - helm \u4E0D\u8981\u6C42\u5168\u5C40\u552F\u4E00\uFF0C\u56E0\u6B64\u8FC1\u79FB\u8FC7\u7A0B\u53EF\u80FD\u51B2\u7A81"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u53EF\u4EE5\u4FEE\u6539 ",(0,i.jsx)(n.code,{children:"application.instanceLabelKey"})," \u914D\u7F6E - \u8FD9\u6837 helm \u81EA\u5B9A\u4E49 releaseName \u624D\u4E0D\u4F1A\u51B2\u7A81\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4F8B\u5982\u4FEE\u6539\u4E3A ",(0,i.jsx)(n.code,{children:"app.kubernetes.io/argocd-instance"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u9ED8\u8BA4\u4E0E helm \u5E38\u7528\u51B2\u7A81 ",(0,i.jsx)(n.code,{children:"app.kubernetes.io/instance"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Kustomize \u4E0D\u53EF\u4EE5\u540E\u5904\u7406 Helm\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5982\u679C\u4E00\u5B9A\u9700\u8981\uFF0C\u53EF\u4EE5\u8003\u8651",(0,i.jsx)(n.a,{href:"https://dev.to/camptocamp-ops/use-kustomize-to-post-render-helm-charts-in-argocd-2ml6",children:"\u63D2\u4EF6"})]}),"\n",(0,i.jsx)(n.li,{children:"\u6216\u8005\u9884\u5148\u751F\u6210\u597D"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u4F7F\u7528\u7A33\u5B9A\u7684 Git \u670D\u52A1\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u907F\u514D\u4F7F\u7528 Gitlab, Github - \u56E0\u4E3A\u8BBF\u95EE\u4E0D\u7A33\u5B9A\u4F1A\u5BFC\u81F4 argocd \u5F88\u6162\u6216\u8005\u540C\u6B65\u72B6\u6001\u4E0D\u53EF\u77E5"}),"\n",(0,i.jsx)(n.li,{children:"\u53EF\u4EE5\u8003\u8651\u96C6\u7FA4\u5185\u90E8\u7F72 gitea \u7136\u540E\u955C\u50CF\u5916\u90E8\u4ED3\u5E93 - \u914D\u7F6E\u597D Webhook \u89E6\u53D1\u53EF\u5B9E\u73B0\u79D2\u7EA7\u540C\u6B65"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u76F4\u63A5\u5E94\u7528 manifest \u5347\u7EA7\u53EF\u80FD\u5BFC\u81F4\u914D\u7F6E\u4E22\u5931 ",(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/issues/3537",children:"#3537"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53EF\u80FD\u4F1A\u8986\u76D6 argocd-cm"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5B89\u88C5\nkubectl create namespace argocd\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\n# HA\n# kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/ha/install.yaml\n\n# \u8F6C\u53D1\u5230\u672C\u5730\u76F4\u63A5\u8BBF\u95EE\n# https://localhost:8080\nkubectl port-forward svc/argocd-server -n argocd 8443:443\n# \u8D26\u53F7 admin\n# \u5BC6\u7801 \u65E7\u7684\u65B9\u5F0F\u4E3A deploy \u540D\u5B57\n# kubectl get pods -n argocd -l app.kubernetes.io/name=argocd-server -o name | cut -d'/' -f 2\n# \u65B0\u7684\u65B9\u5F0F\u4F1A\u4FDD\u5B58\u521D\u59CB\u5BC6\u7801\n# \u83B7\u53D6\u5BC6\u7801\u540E \u5EFA\u8BAE\u5220\u9664 argocd-initial-admin-secret\nkubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=\"{.data.password}\" | base64 -d\nkubectl -n argocd delete secret argocd-initial-admin-secret\n\n# \u53EF\u901A\u8FC7\u4FEE\u6539 argocd-secret admin.password \u6765\u4FEE\u6539\u5BC6\u7801\n\n# argocd \u547D\u4EE4\u884C\u5DE5\u5177\n# https://argo-cd.readthedocs.io/en/latest/user-guide/commands/argocd/\nbrew install argocd\n# \u767B\u9646\nargocd login localhost:8080\n\n# \u5982\u679C\u914D\u7F6E\u4E86 ingress \u9700\u8981 grpc-web \u8BBF\u95EE\n# \u9664\u975E\u5F00\u542F ssl-paththrough - nginx \u5F00\u542F\u5BF9\u6027\u80FD\u5F71\u54CD\u5F88\u5927\nargocd login argocd.my.lan:443 --grpc-web\nargocd login argocd.example.com --sso --grpc-web\n\nargocd context #\nargocd relogin #\nargocd logout  #\nargocd app list\nargocd get argocd/gitea\nargocd app actions list argocd/gitea\nargocd app actions run argocd/gitea restart --kind Rollout\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u5E94\u7528\u53D1\u73B0",children:"\u5E94\u7528\u53D1\u73B0"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u76EE\u524D\u4E0D\u652F\u6301\uFF0C\u4F7F\u7528 app-in-app \u6A21\u5F0F"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/cluster-bootstrapping/",children:"Cluster Bootstrapping"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/issues/1766",children:"#1766"})," - Application auto-discovery"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/argoproj-labs/applicationset",children:"argoproj-labs/applicationset"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u7EC4\u4EF6",children:"\u7EC4\u4EF6"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["argocd-server\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ArgoCD API server"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["argocd-application-controller\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6301\u7EED\u5065\u5EB7\u8FD0\u884C\u7684\u5E94\u7528\uFF0C\u5BF9\u6BD4\u72B6\u6001"}),"\n",(0,i.jsx)(n.li,{children:"sts \u53EF\u90E8\u7F72\u591A\u4E2A"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["argocd-repo-server\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7BA1\u7406 Git \u672C\u5730\u7F13\u5B58\uFF0C\u7BA1\u7406\u5E94\u7528\u6E05\u5355"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5BC6\u94A5\u7BA1\u7406",children:"\u5BC6\u94A5\u7BA1\u7406"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u95EE\u9898\u6839\u6E90\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u56E0\u4E3A GitOps \u8981\u6C42\u6240\u6709\u5185\u5BB9\u90FD\u5728\u4ED3\u5E93\uFF0C\u56E0\u6B64\u5BC6\u94A5\u4E5F\u9700\u8981\u5B58\u50A8\u5728\u4ED3\u5E93"}),"\n",(0,i.jsx)(n.li,{children:"\u51FA\u4E8E\u5B89\u5168\u8003\u8651\u4E0D\u80FD\u76F4\u63A5\u653E\u660E\u6587\u7684 Secret\uFF0C\u56E0\u6B64\u9700\u8981\u66F2\u7EBF\u63D0\u4F9B Secret"}),"\n",(0,i.jsx)(n.li,{children:"\u90E8\u5206\u8981\u6C42\u5728 helm values.yaml \u63D0\u4F9B\u5BC6\u94A5\u7684\u8FD8\u9700\u8981\u5148\u751F\u6210 chart \u7136\u540E\u4FEE\u6539\u4E3A\u53E6\u5916\u7684\u65B9\u5F0F\u63D0\u4F9B\u5BC6\u94A5"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u65B9\u6848\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/bitnami-labs/sealed-secrets",children:"bitnami-labs/sealed-secrets"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u751F\u6210\u4E0D\u53EF\u9006\u7684\u5BC6\u94A5\u5B58\u50A8\u5728\u4ED3\u5E93\uFF0C\u63A7\u5236\u5668\u751F\u6210\u5BF9\u5E94 Secret - \u975E\u5BF9\u79F0\u52A0\u5BC6"}),"\n",(0,i.jsx)(n.li,{children:"\u6700\u7B80\u5355\u5B9E\u7528"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/secret-management/",children:"Secret Management"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u547D\u4EE4\u884C",children:"\u547D\u4EE4\u884C"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/user-guide/commands/argocd/",children:"https://argoproj.github.io/argo-cd/user-guide/commands/argocd/"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"~/.argocd/config"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u591A\u96C6\u7FA4",children:"\u591A\u96C6\u7FA4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# kubeconfig \u7684 test \u4E0A\u4E0B\u6587\nargocd cluster add test\nargocd cluster list\n# \u90E8\u7F72\u5E94\u7528\u540E connectionState \u624D\u4F1A\u662F\u6210\u529F - \u9ED8\u8BA4\u76F8\u5F53\u4E8E\u65E0\u94FE\u63A5\nargocd cluster get 'https://192.168.1.2:6443'\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u9879\u76EE",children:"\u9879\u76EE"}),"\n",(0,i.jsx)(n.p,{children:"\u5E94\u7528\u903B\u8F91\u5206\u7EC4"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"what - \u9650\u5B9A\u90E8\u7F72\u5185\u5BB9 - \u4ED3\u5E93"}),"\n",(0,i.jsx)(n.li,{children:"where - \u9650\u5B9A\u96C6\u7FA4\u548C\u547D\u540D\u7A7A\u95F4"}),"\n",(0,i.jsx)(n.li,{children:"what kind - API Kind"}),"\n",(0,i.jsx)(n.li,{children:"\u89D2\u8272 - RBAC"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u540C\u6B65\u9009\u9879",children:"\u540C\u6B65\u9009\u9879"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"metadata:\n  annotations:\n    argocd.argoproj.io/sync-options: Prune=false\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"syncPolicy:\n  # \u81EA\u52A8\u540C\u6B65\n  automated:\n    # \u662F\u5426\u5220\u9664\u8D44\u6E90\n    prune: true\n    # \u662F\u5426\u5141\u8BB8\u7A7A\u8D44\u6E90\n    allowEmpty: false\n    # selfheal \u8D85\u65F6\u540E\u518D\u6B21\u6267\u884C\u540C\u6B65 - \u9ED8\u8BA4 5s\n    # --self-heal-timeout-seconds\n    selfHeal: false\n  syncOptions:\n    # \u53EA\u540C\u6B65 out of sync \u8D44\u6E90 - \u9ED8\u8BA4\u5168\u90E8\uFF0C\u4F1A\u5BF9\u670D\u52A1\u7AEF\u5E26\u6765\u538B\u529B\n    - ApplyOutOfSyncOnly=true\n    - CreateNamespace=true\n    - RespectIgnoreDifferences=true\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"options"}),(0,i.jsx)(n.th,{children:"desc"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Prune=false"}),(0,i.jsx)(n.td,{children:"\u4E0D\u5220\u9664\u8D44\u6E90"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Validate=false"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"kubectl --validate=false"})," - \u4E0D\u6821\u9A8C YAML"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SkipDryRunOnMissingResource=true"}),(0,i.jsx)(n.td,{children:"\u65B0\u589E CRD \u65F6\u907F\u514D DryRun \u5931\u8D25"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/argocd-cm.yaml",children:"argocd-cm.yaml"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u57FA\u7840\u914D\u7F6E"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/argocd-secret.yaml",children:"argocd-secret.yaml"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Password, Certificates, Signing Key"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/argocd-rbac-cm.yaml",children:"argocd-rbac-cm.yaml"})}),"\n",(0,i.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/declarative-setup/",children:"Declarative Setup"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"argocd-cm",children:"argocd-cm"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: argocd-cm\n  namespace: argocd\n  labels:\n    app.kubernetes.io/name: argocd-cm\n    app.kubernetes.io/part-of: argocd\ndata:\nga.trackingid: ''\nrepositories: |\n  # \u4ED3\u5E93\u5217\u8868\n\n# \u7528\u6765\u5339\u914D Application - \u5982\u679C\u4E0D\u4FEE\u6539\u4F1A\u5BFC\u81F4 helm \u81EA\u5B9A\u4E49 releaseName \u6709\u95EE\u9898\n# application.instanceLabelKey: app.kubernetes.io/instance\napplication.resourceTrackingMethod: annotation\n# \u5EFA\u8BAE\u4FEE\u6539\n# application.instanceLabelKey: app.kubernetes.io/argocd-instance\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"repositories"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# \u5B9A\u4E49 Git \u4ED3\u5E93\u8D26\u53F7\u5BC6\u7801\n- passwordSecret:\n    key: password\n    name: repo-12345\n  usernameSecret:\n    key: username\n    name: repo-12345\n  type: git\n  url: https://gitlab.com/wener/repo.git\n# \u5B9A\u4E49 Git \u4ED3\u5E93 SSH \u5BC6\u94A5\n- insecure: true\n  insecureIgnoreHostKey: true\n  sshPrivateKeySecret:\n    key: sshPrivateKey\n    name: repo-1234\n  type: git\n  url: git@gitea-ssh.gitea:dev/dev-cluster\n"})}),"\n",(0,i.jsx)(n.h2,{id:"argocd-\u7BA1\u7406-argocd",children:"ArgoCD \u7BA1\u7406 ArgoCD"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/operator-manual/declarative-setup/#manage-argo-cd-using-argo-cd",children:"Manage Argo CD Using Argo CD"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argoproj-deployments/tree/master/argocd",children:"https://github.com/argoproj/argoproj-deployments/tree/master/argocd"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"kustomization.yaml"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"bases:\n  - github.com/argoproj/argo-cd//manifests/cluster-install?ref=v1.0.1\n\n# additional resources like ingress rules, cluster and repository secrets.\nresources:\n  - clusters-secrets.yaml\n  - repos-secrets.yaml\n\n# \u4FEE\u6539\u914D\u7F6E\npatchesStrategicMerge:\n  - overlays/argo-cd-cm.yaml\n"})}),"\n",(0,i.jsx)(n.h2,{id:"resource-hook",children:"Resource Hook"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://argoproj.github.io/argo-cd/user-guide/resource_hooks",children:"Resource Hooks"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u9009\u62E9\u6027\u540C\u6B65\u65F6\u4E0D\u4F1A\u6267\u884C"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"PreSync"}),"\n",(0,i.jsx)(n.li,{children:"Sync"}),"\n",(0,i.jsx)(n.li,{children:"PostSync"}),"\n",(0,i.jsx)(n.li,{children:"SyncFail"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: batch/v1\nkind: Job\nmetadata:\n  generateName: schema-migrate-\n  annotations:\n    # \u5B9A\u4E49 Hook \u7C7B\u578B\n    argocd.argoproj.io/hook: PreSync\n    # PostSync\n    # \u5220\u9664\u7B56\u7565 HookSucceeded HookFailed BeforeHookCreation\n    argocd.argoproj.io/hook-delete-policy: HookSucceeded\n"})}),"\n",(0,i.jsx)(n.h2,{id:"annotations",children:"Annotations"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# \u6BD4\u8F83\u9009\u9879\n# ==========\n# \u5FFD\u7565\u989D\u5916\u7684 - \u4F8B\u5982\u90E8\u5206\u5DE5\u5177\u751F\u6210\u5BF9\u8C61\n# \u4F3C\u4E4E\u6709\u70B9\u95EE\u9898 https://github.com/argoproj/argo-cd/issues/4487\nargocd.argoproj.io/compare-options: IgnoreExtraneous\n\n# \u540C\u6B65\u9009\u9879\n# ==========\n# \u4E0D\u5220\u9664\nargocd.argoproj.io/sync-options: Prune=false\n# \u4E0D\u6821\u9A8C\nargocd.argoproj.io/sync-options: Validate=false\n# \u4E0D\u6821\u9A8C CRD\nargocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true\n\nargocd.argoproj.io/sync-wave: "5"\n# \u6DFB\u52A0\u5916\u90E8\u94FE\u63A5 - \u7C7B\u4F3C Ingress\nlink.argocd.argoproj.io/external-link: http://my-grafana.com/pre-generated-link\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"syncPolicy:\n  syncOptions:\n    # \u53EA\u540C\u6B65\u4E0D\u540C\u6B65\u8D44\u6E90 - \u9009\u62E9\u6027\u540C\u6B65\n    # \u5F53\u8D44\u6E90\u975E\u5E38\u591A\u65F6\u9002\u7528\n    - ApplyOutOfSyncOnly=true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u4E0D\u540C\u6B65\u90E8\u5206\u5B57\u6BB5",children:"\u4E0D\u540C\u6B65\u90E8\u5206\u5B57\u6BB5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4F8B\u5982 cert-manager \u9884\u5148\u751F\u6210 secret \u5305\u542B labels \u548C annotations, \u4F46\u5185\u5BB9\u4E0D\u9700\u8981\u540C\u6B65"}),"\n",(0,i.jsx)(n.li,{children:"\u53EF\u5E94\u7528\u7EAC\u5EA6\u914D\u7F6E\u6216\u5168\u5C40\u914D\u7F6E"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://argo-cd.readthedocs.io/en/stable/user-guide/diffing/",children:"Diffing Customization\xb6"})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# \u5E94\u7528 spec \u914D\u7F6E\nspec:\n  ignoreDifferences:\n    - group: apps\n      kind: Deployment\n      name: guestbook\n      namespace: default\n      jsonPointers:\n        - /spec/replicas\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# argocd-cm \u914D\u7F6E - \u5168\u5C40\ndata:\n  resource.customizations: |\n    admissionregistration.k8s.io/MutatingWebhookConfiguration:\n      ignoreDifferences: |\n        jsonPointers:\n        - /webhooks/0/clientConfig/caBundle\n"})}),"\n",(0,i.jsx)(n.h2,{id:"sync",children:"Sync"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"The phase"}),"\n",(0,i.jsx)(n.li,{children:"The wave they are in (lower values first)"}),"\n",(0,i.jsx)(n.li,{children:"By kind (e.g. namespaces first)"}),"\n",(0,i.jsx)(n.li,{children:"By name"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"tricks",children:"Tricks"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"bases:\n  # latest\n  - github.com/argoproj/argo-cd//manifests/cluster-install\n  # tag\n  - github.com/argoproj/argo-cd//manifests/cluster-install?ref=v0.11.1\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u6784\u5EFA\u73AF\u5883"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"ARGOCD_APP_NAME"}),"\n",(0,i.jsx)(n.li,{children:"ARGOCD_APP_NAMESPACE"}),"\n",(0,i.jsx)(n.li,{children:"ARGOCD_APP_REVISION"}),"\n",(0,i.jsx)(n.li,{children:"ARGOCD_APP_SOURCE_PATH"}),"\n",(0,i.jsx)(n.li,{children:"ARGOCD_APP_SOURCE_REPO_URL"}),"\n",(0,i.jsx)(n.li,{children:"ARGOCD_APP_SOURCE_TARGET_REVISION | master"}),"\n",(0,i.jsx)(n.li,{children:"KUBE_VERSION"}),"\n",(0,i.jsx)(n.li,{children:"KUBE_API_VERSIONS"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"application-spec",children:"Application spec"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"spec:\n  destination:\n    # name: \u96C6\u7FA4\u540D\u5B57\n    namespace: demo-system\n    server: 'https://kubernetes.default.svc'\n  project: default\n  revisionHistoryLimit: 10\n  ignoreDifferences:\n    - group:\n      kind:\n      name:\n      namespace:\n      jqPathExpressions: []\n      jsonPointers: []\n  info:\n    - name:\n      value:\n  source:\n    # Git \u6216 Helm repo\n    repoURL: 'https://github.com/wenerme/kube-stub-cluster.git'\n    # Git \u76EE\u5F55\n    path: postgres-operator-ui\n    # Helm repo \u7684 chart \u540D\n    # chart: chart-name\n    # Git \u6216 Helm repo \u7248\u672C\n    targetRevision: HEAD\n    helm:\n      releaseName: postgres-operator-ui\n      # version: 3\n      fileParameters:\n        - name: name\n          path: file/path.txt\n      parameters:\n        - name: name\n          value: value\n          # \u662F\u5426\u68C0\u6D4B value \u7C7B\u578B\u4E3A number \u6216 boolean\n          forceString: false\n      valueFiles:\n        # \u76F8\u5BF9\u8DEF\u5F84\n        - values.yaml\n        # \u591A\u4E2A values \u6587\u4EF6\n        - ../same/repo/postgres-operator-ui-values.yaml\n      values: |\n        # values\n    kustomize:\n      commonAnnotations:\n      commonLabels:\n      forceCommonAnnotations: false\n      forceCommonLabels: false\n      # \u8986\u76D6 image\n      images: []\n      namePrefix:\n      nameSuffix:\n      version:\n    ksonnet:\n      environment: ''\n      parameters:\n        - name:\n          value:\n          component:\n    jsonnet:\n      extVars:\n        - name:\n          value:\n          code: false\n      libs: []\n      tlas: # Top-level Arguments\n        - name:\n          value:\n          code: false\n"})}),"\n",(0,i.jsx)(n.h2,{id:"webhook",children:"webhook"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"http://<argocd>/api/webhook"})}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(n.h2,{id:"the-server-could-not-find-the-requested-resource",children:"the server could not find the requested resource"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"CRD \u5B9A\u4E49\u4E0D\u5B58\u5728"}),"\n",(0,i.jsx)(n.li,{children:"Namespace \u4E0D\u5B58\u5728"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u7279\u6B8A\u60C5\u51B5\u53EF\u4EE5\u8003\u8651\u8DF3\u8FC7"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"metadata:\n  annotations:\n    argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true\n"})}),"\n",(0,i.jsx)(n.h2,{id:"the-server-has-asked-for-the-client-to-provide-credentials",children:"the server has asked for the client to provide credentials"}),"\n",(0,i.jsx)(n.p,{children:"\u6709\u53EF\u80FD\u662F k8s \u96C6\u7FA4\u53D1\u751F\u4E86 cert \u8F6E\u6362"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5728 argocd \u7A7A\u95F4\u627E\u5230\u5BF9\u5E94\u96C6\u7FA4 secret\uFF0Csecret \u6709\u6807\u7B7E ",(0,i.jsx)(n.code,{children:"argocd.argoproj.io/secret-type=cluster"})]}),"\n",(0,i.jsxs)(n.li,{children:["\u4FEE\u6539 secret \u91CC\u7684 config \u5B57\u6BB5\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4FEE\u6539 certData"}),"\n",(0,i.jsx)(n.li,{children:"\u4FEE\u6539 keyData"}),"\n",(0,i.jsx)(n.li,{children:"\u4FDD\u5B58\u5373\u53EF"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: cluster-name\n  namespace: argocd\nstringData:\n  config: '' # JSON\n  name:\n  url:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",metastring:'title="config"',children:'{\n  "tlsClientConfig": {\n    "insecure": false,\n    "certData": "", // \u4FEE\u6539\n    "keyData": "", // \u4FEE\u6539\n    "caData": "" // \u4FDD\u7559\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/argoproj/argo-cd/issues/3941",children:"argoproj/argo-cd#3941"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5347\u7EA7\u5E94\u7528\u65F6\u53EF\u80FD-crd-\u6709\u53D8\u5316\u5BFC\u81F4\u6821\u9A8C\u4E0D\u901A\u8FC7",children:"\u5347\u7EA7\u5E94\u7528\u65F6\u53EF\u80FD CRD \u6709\u53D8\u5316\u5BFC\u81F4\u6821\u9A8C\u4E0D\u901A\u8FC7"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5148\u540C\u6B65 CRD"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"kustomize-build-\u5F02\u5E38",children:"kustomize build \u5F02\u5E38"}),"\n",(0,i.jsx)(n.p,{children:"\u4F7F\u7528\u4E0E argocd \u76F8\u540C\u7248\u672C\u8BD5\u8BD5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it -v $PWD:/tmp -w /tmp registry.cn-hongkong.aliyuncs.com/cmi/argoproj_argocd:v2.0.1 bash\n"})})]})}function h(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},17776:function(e,n,r){r.d(n,{R:()=>a,x:()=>c});var s=r(7378);let i={},l=s.createContext(i);function a(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);