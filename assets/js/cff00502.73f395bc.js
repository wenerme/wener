"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["55074"],{93046:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>a,toc:()=>d,default:()=>p,metadata:()=>t,assets:()=>c,contentTitle:()=>i});var t=JSON.parse('{"id":"os/linux/shell/expect","title":"expect","description":"- expect.1","source":"@site/../notes/os/linux/shell/expect.md","sourceDirName":"os/linux/shell","slug":"/os/linux/shell/expect","permalink":"/notes/os/linux/shell/expect","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/shell/expect.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1619945683000,"frontMatter":{"title":"expect"},"sidebar":"docs","previous":{"title":"doas","permalink":"/notes/os/linux/shell/doas"},"next":{"title":"find","permalink":"/notes/os/linux/shell/find"}}'),r=s(86106),l=s(17776);let a={title:"expect"},i="expect",c={},d=[{value:"SSH \u8F93\u5165\u5BC6\u7801",id:"ssh-\u8F93\u5165\u5BC6\u7801",level:2},{value:"SCP \u53D1\u9001\u6587\u4EF6",id:"scp-\u53D1\u9001\u6587\u4EF6",level:2},{value:"\u5D4C\u5165\u5230 Shell",id:"\u5D4C\u5165\u5230-shell",level:2},{value:"interact: received eof from spawn_id exp0",id:"interact-received-eof-from-spawn_id-exp0",level:2}];function o(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"expect",children:"expect"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://man7.org/linux/man-pages/man1/expect.1.html",children:"expect.1"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-expect",children:'set username [lindex $argv 0];\nset password [lindex $argv 1];\n\n# \u663E\u793A\nsend_user "$username $password"\n\n# \u9ED8\u8BA4\u53C2\u6570\nset argv [lassign $argv username password]\nif {$username eq ""} {set username default_user}\nif {$password eq ""} {set password default_password}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"ssh-\u8F93\u5165\u5BC6\u7801",children:"SSH \u8F93\u5165\u5BC6\u7801"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'#!/usr/local/bin/expect\nspawn ssh admin@127.0.0.1\nexpect "password:"\nsend "PASSWOPD\\n";\ninteract\n'})}),"\n",(0,r.jsx)(n.h2,{id:"scp-\u53D1\u9001\u6587\u4EF6",children:"SCP \u53D1\u9001\u6587\u4EF6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'#!/usr/local/bin/expect\nset argv [lassign $argv src dst]\nif {$dst eq ""} {set dst $src}\n\nspawn  scp -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -P 22 $src admin@192.168.1.1:/tmp/$dst\nexpect "password:"\nsend [exec cat password.txt];\nsend "\\n"\ninteract\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u5D4C\u5165\u5230-shell",children:"\u5D4C\u5165\u5230 Shell"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"expect <(cat << EOD\n# ...\ninteract\nEOD\n)\n"})}),"\n",(0,r.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(n.h2,{id:"interact-received-eof-from-spawn_id-exp0",children:"interact: received eof from spawn_id exp0"}),"\n",(0,r.jsx)(n.p,{children:"\u907F\u514D\u7528 stdin \u4F20\u5165\u811A\u672C"})]})}function p(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},17776:function(e,n,s){s.d(n,{R:()=>a,x:()=>i});var t=s(7378);let r={},l=t.createContext(r);function a(e){let n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);