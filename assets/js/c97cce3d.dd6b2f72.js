"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["13705"],{86273:function(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var s=t(63378),a=t(86106),l=t(17776);let r={slug:"ubuntu-new-server",title:"Ubuntu \u65B0\u670D\u52A1\u5668\u914D\u7F6E"},i="Ubuntu \u65B0\u670D\u52A1\u5668\u914D\u7F6E",o={authorsImageUrls:[]},d=[{value:"Tips",id:"tips",level:2},{value:"mosh-dev",id:"mosh-dev",level:3},{value:"fail2ban",id:"fail2ban",level:2},{value:"env",id:"env",level:2},{value:"ipv6",id:"ipv6",level:2}];function p(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u4FEE\u6539\u4E3B\u673A\u540D\nhostnamectl set-hostname myHostName\n# \u5982\u679C\u60F3\u8981\u76F4\u63A5\u4F7F\u7528\u4E3B\u673A\u540D,\u8FD8\u9700\u8981\u5728 /etc/hosts \u91CC\u6DFB\u52A0\u76F8\u5173\u8BB0\u5F55\n# nano /etc/hostname\n# nano /etc/hosts\n\n# \u751F\u6210\u4E2D\u6587\nlocale-gen zh_CN.UTF-8\n# \u57FA\u672C\u66F4\u65B0\napt-get update\napt-get upgrade\n\n# \u51FA\u73B0 The following packages have been kept back \u53EF\u8003\u8651 apt dist-upgrade \u6216 install\n# \u5F53 /etc/apt/sources.list* \u6709\u5176\u4ED6\u4ED3\u5E93\u65F6\u4F7F\u7528 dist-upgrade \u76F8\u5BF9\u6CA1\u90A3\u4E48\u5B89\u5168\n\n# \u4FEE\u6539\u5BC6\u7801\npasswd\n\n\n# \u521B\u5EFA\u7528\u4E8E\u90E8\u7F72\u7684\u7528\u6237\nuseradd deploy\nmkdir /home/deploy\nmkdir /home/deploy/.ssh\nchmod 700 /home/deploy/.ssh\n# \u5C06\u9700\u8981\u4F7F\u7528\u8BE5\u7528\u6237\u7684\u516C\u94A5\u6DFB\u52A0\u8FDB\u53BB\nvim /home/deploy/.ssh/authorized_keys\n\nchmod 400 /home/deploy/.ssh/authorized_keys\nchown deploy:deploy /home/deploy -R\n\n# \u7F16\u8F91 sudoers\nvisudo\n# \u5C06\u9700\u8981 sudo \u7684\u7528\u6237\u6DFB\u52A0\u8FDB\u53BB\n# deploy  ALL=(ALL) ALL\n\n# \u4FEE\u6539 sshd \u6743\u9650\nvim /etc/ssh/sshd_config\n# PermitRootLogin no # \u4E0D\u5141\u8BB8\u76F4\u63A5 root \u767B\u9646\n# PasswordAuthentication no # \u4E0D\u5141\u8BB8\u5BC6\u7801\u767B\u9646\n# AllowUsers deploy@(your-ip) deploy@(another-ip-if-any) # \u53EA\u5141\u8BB8\u6307\u5B9A\u5730\u5740\u7684\u4EBA\u767B\u9646\n# service ssh restart\n\n# \u9632\u706B\u5899\u8BBE\u7F6E\n# DNS 53\n# mosh allow 60000:61000/udp \u6216 allow mosh\nufw allow 22\nufw allow 80\nufw allow 443\nufw default deny\nufw enable\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://news.ycombinator.com/item?id=5316093",children:"How I spend my first 5 minutes on a server "})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://www.upguard.com/blog/10-essential-steps-for-configuring-a-new-server",children:"10 Essential Steps for Configuring a New Server"})}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"tips",children:"Tips"}),"\n",(0,a.jsx)(n.p,{children:"\u5F53\u6709\u591A\u53F0\u4E3B\u673A\u9700\u8981\u90E8\u7F72\u7684\u65F6\u5019,\u5EFA\u8BAE\u4F7F\u7528 sshrc, tmuxrc, \u8FD9\u6837\u80FD\u5FEB\u901F\u7684\u5C06\u6240\u6709\u7684\u914D\u7F6E\u90FD\u5E26\u7ED9\u670D\u52A1\u5668,\u80FD\u591F\u5FEB\u901F\u65B9\u4FBF\u7684\u5BF9\u591A\u53F0\u8FDB\u884C\u5B89\u88C5\u90E8\u7F72."}),"\n",(0,a.jsx)(n.h3,{id:"mosh-dev",children:"mosh-dev"}),"\n",(0,a.jsx)(n.p,{children:"\u7531\u4E8E mosh \u90E8\u5206\u9F20\u6807\u76F8\u5173\u7684\u529F\u80FD\u9700\u8981\u6700\u65B0\u7248,\u6240\u4EE5\u5EFA\u8BAE\u76F4\u63A5\u5B89\u88C5 dev \u7248\u672C"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"apt-get install -y software-properties-common\nadd-apt-repository ppa:keithw/mosh-dev\napt-get update\napt install -y mosh\n"})}),"\n",(0,a.jsx)(n.h2,{id:"fail2ban",children:"fail2ban"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"apt-get install fail2ban\ncp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\n# bantime = 3600 # ban 1 \u5C0F\u65F6\n# destemail = admin@admin # \u53D1\u9001\u8B66\u544A\u7684\u90AE\u7BB1\u5730\u5740\n# \u5C06 ssh/ssh-ddos \u7B49\u6BB5\u843D\u4E0B\u7684 enable \u8BBE\u7F6E\u4E3A true \u6253\u5F00\u76F8\u5E94\u7684 filter\n"})}),"\n",(0,a.jsx)(n.h2,{id:"env",children:"env"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"apt-get install software-properties-common\n# \u6DFB\u52A0 Oracle Java \u4ED3\u5E93\nadd-apt-repository ppa:webupd8team/java#\napt-get update\n# \u5B89\u88C5 Oracle Java 8 JDK\napt-get install oracle-java8-installer\n# \u5982\u679C\u6709\u591A\u4E2A Java \u73AF\u5883\u53EF\u8C03\u6574\u914D\u7F6E\nupdate-alternatives --config java\n"})}),"\n",(0,a.jsx)(n.h2,{id:"ipv6",children:"ipv6"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# https://jiandanxinli.github.io/2016-08-06.html\n\n# /etc/sysctl.conf\n# net.ipv6.conf.all.disable_ipv6=0\n# net.ipv6.conf.default.disable_ipv6=0\n# net.ipv6.conf.lo.disable_ipv6=0\nsysctl -p\n\n# https://www.tunnelbroker.net/\n# \u9009\u62E9 linux route2, \u7136\u540E\u6267\u884C\u811A\u672C\n\n# \u68C0\u6D4B ipv6 \u662F\u5426\u53EF\u7528\n# http://ready.chair6.net/?url=wener.me\n\n# \u5982\u679C\u64CD\u4F5C\u5931\u8D25\u4E86\u5219\u5220\u9664\u901A\u9053\u4ECE\u6765\nip tun del he-ipv6\n"})})]})}function c(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},17776:function(e,n,t){t.d(n,{R:()=>r,x:()=>i});var s=t(7378);let a={},l=s.createContext(a);function r(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(l.Provider,{value:n},e.children)}},63378:function(e){e.exports=JSON.parse('{"permalink":"/story/ubuntu-new-server","editUrl":"https://github.com/wenerme/wener/edit/master/story/../story/2016/2016-09-28-ubuntu-new-server.md","source":"@site/../story/2016/2016-09-28-ubuntu-new-server.md","title":"Ubuntu \u65B0\u670D\u52A1\u5668\u914D\u7F6E","description":"* How I spend my first 5 minutes on a server","date":"2016-09-28T00:00:00.000Z","tags":[],"readingTime":2.22,"hasTruncateMarker":false,"authors":[],"frontMatter":{"slug":"ubuntu-new-server","title":"Ubuntu \u65B0\u670D\u52A1\u5668\u914D\u7F6E"},"unlisted":false,"prevItem":{"title":"\u8FDB\u51FB\u7684\u7A0B\u5E8F\u733F","permalink":"/story/attack-on-programmer"},"nextItem":{"title":"\u5206\u5E03\u5F0F\u67B6\u6784\u624B\u8BB0","permalink":"/story/learning-dist-arch"}}')}}]);