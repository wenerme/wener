"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["920038"],{48621:function(e,t,n){n.r(t),n.d(t,{frontMatter:()=>r,toc:()=>c,default:()=>h,metadata:()=>l,assets:()=>a,contentTitle:()=>d});var l=JSON.parse('{"id":"java/jvm/jvm-tools","title":"JVM Diagnostic Tools","description":"\u547D\u4EE4\u884C\u5DE5\u5177","source":"@site/../notes/java/jvm/jvm-tools.md","sourceDirName":"java/jvm","slug":"/java/jvm/tools","permalink":"/notes/java/jvm/tools","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/java/jvm/jvm-tools.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"JVM Diagnostic Tools"},"sidebar":"docs","previous":{"title":"JVM \u5185\u90E8\u539F\u7406 (Internals)","permalink":"/notes/java/jvm/internals"},"next":{"title":"Apache Arrow","permalink":"/notes/java/lib/arrow"}}'),s=n(486106),i=n(917776);let r={title:"JVM Diagnostic Tools"},d="JVM \u8BCA\u65AD\u4E0E\u76D1\u63A7\u5DE5\u5177",a={},c=[{value:"\u547D\u4EE4\u884C\u5DE5\u5177",id:"\u547D\u4EE4\u884C\u5DE5\u5177",level:2},{value:"jps (\u8FDB\u7A0B\u72B6\u6001)",id:"jps-\u8FDB\u7A0B\u72B6\u6001",level:3},{value:"jstat (\u7EDF\u8BA1\u76D1\u6D4B)",id:"jstat-\u7EDF\u8BA1\u76D1\u6D4B",level:3},{value:"jmap (\u5185\u5B58\u6620\u5C04)",id:"jmap-\u5185\u5B58\u6620\u5C04",level:3},{value:"jstack (\u7EBF\u7A0B\u5806\u6808)",id:"jstack-\u7EBF\u7A0B\u5806\u6808",level:3},{value:"\u8FDC\u7A0B\u8FDE\u63A5\u4E0E JMX",id:"\u8FDC\u7A0B\u8FDE\u63A5\u4E0E-jmx",level:2},{value:"\u53EF\u89C6\u5316\u5DE5\u5177",id:"\u53EF\u89C6\u5316\u5DE5\u5177",level:2}];function j(e){let t={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"jvm-\u8BCA\u65AD\u4E0E\u76D1\u63A7\u5DE5\u5177",children:"JVM \u8BCA\u65AD\u4E0E\u76D1\u63A7\u5DE5\u5177"})}),"\n",(0,s.jsx)(t.h2,{id:"\u547D\u4EE4\u884C\u5DE5\u5177",children:"\u547D\u4EE4\u884C\u5DE5\u5177"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u547D\u4EE4"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u5168\u79F0"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u4F5C\u7528"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"\u5907\u6CE8"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jps"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"JVM Process Status Tool"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u663E\u793A\u6307\u5B9A\u7CFB\u7EDF\u5185\u6240\u6709\u7684 HotSpot \u865A\u62DF\u673A\u8FDB\u7A0B"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["\u7C7B\u4F3C\u4E8E Linux \u7684 ",(0,s.jsx)(t.code,{children:"ps"})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jstat"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"JVM Statistics Monitoring Tool"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u76D1\u89C6\u865A\u62DF\u673A\u5404\u79CD\u8FD0\u884C\u72B6\u6001\u4FE1\u606F\uFF08\u7C7B\u52A0\u8F7D\u3001\u5185\u5B58\u3001GC\u3001JIT\uFF09"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u9002\u5408\u65E0 GUI \u73AF\u5883"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jinfo"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Configuration Info for Java"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u5B9E\u65F6\u67E5\u770B\u548C\u8C03\u6574\u865A\u62DF\u673A\u5404\u9879\u53C2\u6570"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.code,{children:"-flag"})})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jmap"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Memory Map for Java"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u751F\u6210\u5806\u8F6C\u50A8\u5FEB\u7167 (heapdump/hprof)"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:[(0,s.jsx)(t.code,{children:"-dump"}),", ",(0,s.jsx)(t.code,{children:"-histo"})]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jhat"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"JVM Heap Dump Browser"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u5206\u6790 heapdump \u6587\u4EF6\uFF0C\u63D0\u4F9B HTTP \u670D\u52A1\u67E5\u770B"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u529F\u80FD\u8F83\u7B80\u964B\uFF0C\u5EFA\u8BAE\u7528 VisualVM/MAT"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jstack"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"Stack Trace for Java"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u751F\u6210\u865A\u62DF\u673A\u5F53\u524D\u65F6\u523B\u7684\u7EBF\u7A0B\u5FEB\u7167 (threaddump)"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u5206\u6790\u6B7B\u9501\u3001\u6B7B\u5FAA\u73AF\u3001\u8BF7\u6C42\u5916\u90E8\u957F\u65F6\u95F4\u7B49\u5F85"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"jcmd"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"JVM Command"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"\u591A\u529F\u80FD\u5DE5\u5177\uFF0C\u63A8\u8350\u4F7F\u7528"}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"JDK 7+ \u5F15\u5165\uFF0C\u53EF\u66FF\u4EE3\u5927\u90E8\u5206\u4E0A\u8FF0\u5DE5\u5177"})]})]})]}),"\n",(0,s.jsx)(t.h3,{id:"jps-\u8FDB\u7A0B\u72B6\u6001",children:"jps (\u8FDB\u7A0B\u72B6\u6001)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"jps -l # \u8F93\u51FA\u4E3B\u7C7B\u5168\u540D\u6216 JAR \u8DEF\u5F84\njps -v # \u8F93\u51FA JVM \u542F\u52A8\u53C2\u6570\n"})}),"\n",(0,s.jsx)(t.h3,{id:"jstat-\u7EDF\u8BA1\u76D1\u6D4B",children:"jstat (\u7EDF\u8BA1\u76D1\u6D4B)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# \u76D1\u89C6 GC \u60C5\u51B5\uFF0C\u91C7\u6837\u95F4\u9694 250ms\uFF0C\u91C7\u6837 20 \u6B21\njstat -gc 20 < pid > 250\n\n# \u5E38\u7528\u9009\u9879\n# -class: \u7C7B\u52A0\u8F7D\u7EDF\u8BA1\n# -gc: \u5806 GC \u7EDF\u8BA1\n# -gccapacity: \u5806\u5404\u4EE3\u5BB9\u91CF\n# -gcutil: \u7A7A\u95F4\u5229\u7528\u7387\u767E\u5206\u6BD4\n# -gcnew / -gcold: \u65B0\u751F\u4EE3/\u8001\u5E74\u4EE3\u7EDF\u8BA1\n"})}),"\n",(0,s.jsx)(t.h3,{id:"jmap-\u5185\u5B58\u6620\u5C04",children:"jmap (\u5185\u5B58\u6620\u5C04)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# \u751F\u6210 heapdump \u6587\u4EF6\njmap -dump:format=b,file=heap.hprof <pid>\njmap -dump:live,format=b,file=heap.hprof <pid> # \u53EA dump \u5B58\u6D3B\u5BF9\u8C61\n\n# \u67E5\u770B\u5806\u5185\u5B58\u76F4\u65B9\u56FE (\u7C7B\u5B9E\u4F8B\u6570\u548C\u5360\u7528\u5927\u5C0F)\njmap -histo <pid> | head -20\njmap -histo:live <pid> # \u89E6\u53D1 Full GC\n"})}),"\n",(0,s.jsx)(t.h3,{id:"jstack-\u7EBF\u7A0B\u5806\u6808",children:"jstack (\u7EBF\u7A0B\u5806\u6808)"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"# \u751F\u6210\u7EBF\u7A0B\u5FEB\u7167\u5230\u6587\u4EF6 (\u5E38\u7528)\njstack -l <pid> > thread_dump.txt\n\n# \u68C0\u6D4B\u6B7B\u9501\njstack -l <pid>\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\u8FDC\u7A0B\u8FDE\u63A5\u4E0E-jmx",children:"\u8FDC\u7A0B\u8FDE\u63A5\u4E0E JMX"}),"\n",(0,s.jsx)(t.p,{children:"\u5F00\u542F\u8FDC\u7A0B JMX \u76D1\u63A7\u901A\u5E38\u9700\u8981\u914D\u7F6E\u4EE5\u4E0B\u7CFB\u7EDF\u5C5E\u6027\uFF1A"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"java -Dcom.sun.management.jmxremote \\\n  -Dcom.sun.management.jmxremote.port=9010 \\\n  -Dcom.sun.management.jmxremote.rmi.port=9010 \\\n  -Dcom.sun.management.jmxremote.authenticate=false \\\n  -Dcom.sun.management.jmxremote.ssl=false \\\n  -Djava.rmi.server.hostname= \\\n  app.jar < HOST_IP > -jar\n"})}),"\n",(0,s.jsx)(t.h2,{id:"\u53EF\u89C6\u5316\u5DE5\u5177",children:"\u53EF\u89C6\u5316\u5DE5\u5177"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"VisualVM"}),": JDK \u81EA\u5E26 (JDK 9+ \u53EF\u80FD\u9700\u8981\u5355\u72EC\u4E0B\u8F7D)\uFF0C\u96C6\u6210\u4E86 jstat, jmap, jstack \u7B49\u529F\u80FD\uFF0C\u652F\u6301\u63D2\u4EF6\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"JConsole"}),": JDK \u81EA\u5E26\uFF0C\u57FA\u4E8E JMX \u7684\u8F7B\u91CF\u7EA7 GUI\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Arthas"}),": \u963F\u91CC\u5DF4\u5DF4\u5F00\u6E90\u7684 Java \u8BCA\u65AD\u5DE5\u5177\uFF0C\u547D\u4EE4\u884C\u4EA4\u4E92\uFF0C\u529F\u80FD\u5F3A\u5927\uFF08trace, watch, jad \u7B49\uFF09\u3002"]}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(j,{...e})}):j(e)}},917776:function(e,t,n){n.d(t,{R:()=>r,x:()=>d});var l=n(7378);let s={},i=l.createContext(s);function r(e){let t=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(i.Provider,{value:t},e.children)}}}]);