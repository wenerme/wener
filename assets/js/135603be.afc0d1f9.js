"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["55463"],{92817:function(n,e,i){i.r(e),i.d(e,{frontMatter:()=>c,toc:()=>a,default:()=>h,metadata:()=>r,assets:()=>o,contentTitle:()=>l});var r=JSON.parse('{"id":"web/script/lib/inversify","title":"inversify","description":"- inversify/InversifyJS","source":"@site/../notes/web/script/lib/inversify.md","sourceDirName":"web/script/lib","slug":"/web/script/lib/inversify","permalink":"/notes/web/script/lib/inversify","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/script/lib/inversify.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1730187174000,"frontMatter":{"title":"inversify"},"sidebar":"docs","previous":{"title":"i18next","permalink":"/notes/web/script/lib/i18next"},"next":{"title":"JIMP","permalink":"/notes/web/script/lib/jimp"}}'),t=i(86106),s=i(17776);let c={title:"inversify"},l="inversify",o={},a=[{value:"\u6838\u5FC3\u6982\u5FF5",id:"\u6838\u5FC3\u6982\u5FF5",level:2},{value:"Typed Token",id:"typed-token",level:2}];function d(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"inversify",children:"inversify"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.a,{href:"https://github.com/inversify/InversifyJS",children:"inversify/InversifyJS"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"MIT, TS"}),"\n",(0,t.jsx)(e.li,{children:"~50kB/11kB"}),"\n",(0,t.jsx)(e.li,{children:"Reflect.getMetadata, Map, Promise, Proxy"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["Decorator\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"@injectable()"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:'@inject("token")'}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"@optional()"})}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:'@tagged("key", "value")'}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u907F\u514D AMBIGUOUS_MATCH"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:'@named("name")'})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:'@targetName("")'})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.code,{children:"@unmanaged()"})," - \u907F\u514D BaseClass constructor \u6CE8\u5165"]}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:'@multiInject("token")'})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"@postConstruct()"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.code,{children:"@preDestroy()"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["inversify-inject-decorators\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"@lazyInject"}),"\n",(0,t.jsx)(e.li,{children:"@lazyInjectNamed"}),"\n",(0,t.jsx)(e.li,{children:"@lazyInjectTagged"}),"\n",(0,t.jsx)(e.li,{children:"@lazyMultiInject"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://github.com/inversify/InversifyJS/blob/master/wiki/ecosystem.md",children:"https://github.com/inversify/InversifyJS/blob/master/wiki/ecosystem.md"})}),"\n",(0,t.jsx)(e.li,{children:(0,t.jsx)(e.a,{href:"https://github.com/Kukkimonsuta/inversify-react",children:"https://github.com/Kukkimonsuta/inversify-react"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.admonition,{type:"tip",children:(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u63A8\u8350\u4F7F\u7528 Symbol - \u4E5F\u53EF\u4EE5\u4F7F\u7528 Class/string \u4F5C\u4E3A Token"}),"\n"]})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"const TYPES = {\n  ServiceFoo: Symbol.for('ServiceFoo'),\n  ServiceConf: Symbol.for('ServiceConf'),\n  ServiceBar: Symbol.for('ServiceBar'),\n};\n\n@injectable()\nclass ServiceBar implements IServiceBar {\n  private _conf: any;\n  @inject(TYPES.ServiceFoo) private _foo: IServiceFoo;\n  public constructor(@inject(TYPES.ServiceConf) conf: any) {\n    this._conf = conf;\n  }\n}\n\n//\nconst container = new Container();\ncontainer.bind<IServiceBar>(TYPES.ServiceBar).to(ServiceBar);\n//\nconst bar = container.get<IServiceBar>(TYPES.ServiceBar);\n// \u7EA7\u8054\nlet childContainer = new Container();\nchildContainer.parent = parentContainer;\n\n// \u5916\u90E8 Class \u53EF\u624B\u52A8\u4FEE\u9970\nimport { decorate, injectable } from 'inversify';\ndecorate(injectable(), SomeClass);\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6838\u5FC3\u6982\u5FF5",children:"\u6838\u5FC3\u6982\u5FF5"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"ContainerModule"}),"\n",(0,t.jsx)(e.li,{children:"AsyncContainerModule"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"// \u6A21\u5757\nlet warriors = new ContainerModule((bind: interfaces.Bind, unbind: interfaces.Unbind) => {\n  bind<Ninja>('Ninja').to(Ninja);\n});\n// \u5F02\u6B65 load\nlet warriors = new AsyncContainerModule(async (bind: interfaces.Bind, unbind: interfaces.Unbind) => {\n  const ninja = await getNinja();\n  bind<Ninja>('Ninja').toConstantValue(ninja);\n});\n\ncontainer.load(warriors); // \u52A0\u8F7D\nawait container.loadAsync(warriors, weapons); // \u52A0\u8F7D\u5F02\u6B65\ncontainer.unload(warriors); // \u5378\u8F7D\n"})}),"\n",(0,t.jsx)(e.h2,{id:"typed-token",children:"Typed Token"}),"\n",(0,t.jsx)(e.p,{children:"collocate service identifier and type"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"export interface IFoo {}\nexport namespace IFoo {\n  export const $: interfaces.ServiceIdentifier<IFoo> = Symbol('IFoo');\n}\n\nclass MyService {\n  @inject(IFoo.$)\n  private readonly foo!: IFoo;\n\n  constructor(@inject(IFoo.$) foo: IFoo) {}\n}\n"})})]})}function h(n={}){let{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},17776:function(n,e,i){i.d(e,{R:()=>c,x:()=>l});var r=i(7378);let t={},s=r.createContext(t);function c(n){let e=r.useContext(s);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:c(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);