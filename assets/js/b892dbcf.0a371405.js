"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["51006"],{5682:function(e,t,r){r.r(t),r.d(t,{frontMatter:()=>i,toc:()=>c,default:()=>m,metadata:()=>n,assets:()=>s,contentTitle:()=>d});var n=JSON.parse('{"id":"devops/infra/terraform/terraform-backend-git","title":"terraform-backend-git","description":"- plumber-cd/terraform-backend-git","source":"@site/../notes/devops/infra/terraform/terraform-backend-git.md","sourceDirName":"devops/infra/terraform","slug":"/devops/infra/terraform/backend-git","permalink":"/notes/devops/infra/terraform/backend-git","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/infra/terraform/terraform-backend-git.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1759894156000,"frontMatter":{"title":"terraform-backend-git"},"sidebar":"docs","previous":{"title":"Terraform Awesome","permalink":"/notes/devops/infra/terraform/awesome"},"next":{"title":"cf-terraforming","permalink":"/notes/devops/infra/terraform/cf"}}'),a=r(86106),o=r(17776);let i={title:"terraform-backend-git"},d="terraform-backend-git",s={},c=[{value:"HTTP remote state already locked",id:"http-remote-state-already-locked",level:2}];function l(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"terraform-backend-git",children:"terraform-backend-git"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://github.com/plumber-cd/terraform-backend-git",children:"plumber-cd/terraform-backend-git"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Apache-2.0, Golang"}),"\n",(0,a.jsx)(t.li,{children:"HTTP Backend by Git"}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:["\u901A\u8FC7\u5206\u652F\u5B9E\u73B0 lock ",(0,a.jsx)(t.code,{children:"locks/PATH"})]}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'curl -LO https://github.com/plumber-cd/terraform-backend-git/releases/download/v0.1.4/terraform-backend-git-darwin-amd64\nchmod +x terraform-backend-git-darwin-amd64\nmv terraform-backend-git-darwin-amd64 ~/bin/terraform-backend-git\n\n# by Wrapper\n# ==========\n# \u64CD\u4F5C\u77AC\u95F4\u751F\u6210 *.auto.tf\nexport TF_BACKEND_HTTP_ENCRYPTION_PROVIDER=sops\nexport TF_BACKEND_HTTP_SOPS_PGP_FP=\n\nterraform-backend-git git \\\n  --repository git@gitlab.com:wener/wener-ops-vault.git \\\n  --ref main \\\n  --state tf-statealiyun.state.json \\\n  terraform -- $@\n\n# by HCL\n# ===========\ncat << TF > terraform-backend-git.hcl\ngit.repository = "https://github.com/my-org/tf-state"\ngit.ref = "main"\ngit.state = "my/state.json"\nTF\n\n# by HTTP\n# ===========\n# backend.http.username\nTF_BACKEND_GIT_HTTP_USERNAME=\nTF_BACKEND_GIT_HTTP_PASSWORD=\nterraform-backend-git -l\n'})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"env"}),(0,a.jsx)(t.th,{children:"for"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"TF_BACKEND_GIT_GIT_REPOSITORY"}),(0,a.jsx)(t.td,{})]})})]}),"\n",(0,a.jsx)(t.h1,{id:"faq",children:"FAQ"}),"\n",(0,a.jsx)(t.h2,{id:"http-remote-state-already-locked",children:"HTTP remote state already locked"}),"\n",(0,a.jsxs)(t.p,{children:["\u5220\u9664\u5206\u652F ",(0,a.jsx)(t.code,{children:"locks/tf-state/wener/aliyun.state.json"})]})]})}function m(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},17776:function(e,t,r){r.d(t,{R:()=>i,x:()=>d});var n=r(7378);let a={},o=n.createContext(a);function i(e){let t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);