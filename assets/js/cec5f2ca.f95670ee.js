"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["71652"],{42255:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>t,toc:()=>a,default:()=>o,metadata:()=>s,assets:()=>h,contentTitle:()=>c});var s=JSON.parse('{"id":"java/hibernate/README","title":"Hibernate","description":"\u6587\u6863\u8DEF\u5F84","source":"@site/../notes/java/hibernate/README.md","sourceDirName":"java/hibernate","slug":"/java/hibernate/","permalink":"/notes/java/hibernate/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/java/hibernate/README.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1678678348000,"frontMatter":{"title":"Hibernate"},"sidebar":"docs","previous":{"title":"spotless","permalink":"/notes/java/build/spotless"},"next":{"title":"Hibernate Enver","permalink":"/notes/java/hibernate/enver"}}'),r=i(86106),l=i(17776);let t={title:"Hibernate"},c="Hibernate",h={},a=[{value:"\u6587\u6863\u8DEF\u5F84",id:"\u6587\u6863\u8DEF\u5F84",level:2},{value:"\u914D\u7F6E\u9009\u9879",id:"\u914D\u7F6E\u9009\u9879",level:2},{value:"What&#39;s new in Hibernate 5",id:"whats-new-in-hibernate-5",level:2},{value:"\u4F18\u5316",id:"\u4F18\u5316",level:2},{value:"Fetching \u7B56\u7565",id:"fetching-\u7B56\u7565",level:2},{value:"\u4E00\u7EA7\u7F13\u5B58 vs \u4E8C\u7EA7\u7F13\u5B58",id:"\u4E00\u7EA7\u7F13\u5B58-vs-\u4E8C\u7EA7\u7F13\u5B58",level:2},{value:"2LC - \u4E8C\u7EA7\u7F13\u5B58",id:"2lc---\u4E8C\u7EA7\u7F13\u5B58",level:2},{value:"Hibernate \u66F4\u65B0\u64CD\u4F5C",id:"hibernate-\u66F4\u65B0\u64CD\u4F5C",level:2},{value:"\u591A\u79DF\u6237/Multi-Tenancy",id:"\u591A\u79DF\u6237multi-tenancy",level:2},{value:"JSON",id:"json",level:2},{value:"FAQ",id:"faq",level:2},{value:"\u5185\u5D4C\u81EA\u5B9A\u4E49\u65B9\u8A00\u51FD\u6570",id:"\u5185\u5D4C\u81EA\u5B9A\u4E49\u65B9\u8A00\u51FD\u6570",level:3}];function d(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"hibernate",children:"Hibernate"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6587\u6863\u8DEF\u5F84",children:"\u6587\u6863\u8DEF\u5F84"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://docs.jboss.org/hibernate/orm",children:"https://docs.jboss.org/hibernate/orm"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/hibernate/hibernate-orm/blob/master/hibernate-core/src/main/antlr/hql.g",children:"https://github.com/hibernate/hibernate-orm/blob/master/hibernate-core/src/main/antlr/hql.g"})}),"\n",(0,r.jsx)(n.h2,{id:"\u914D\u7F6E\u9009\u9879",children:"\u914D\u7F6E\u9009\u9879"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://docs.jboss.org/hibernate/orm/4.3/devguide/en-US/html/apa.html",children:"Configuration properties"})}),"\n",(0,r.jsxs)(n.li,{children:["\u6240\u6709\u7684\u5C5E\u6027\u4E5F\u5B9A\u4E49\u5728\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"org.hibernate.cfg.Environment"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"org.hibernate.cfg.AvailableSettings"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"org.hibernate.jpa.AvailableSettings"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"whats-new-in-hibernate-5",children:"What's new in Hibernate 5"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Java 8 \u652F\u6301 ",(0,r.jsx)(n.a,{href:"http://mvnrepository.com/artifact/org.hibernate/hibernate-java8",children:"Hibernate Java 8"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u4F18\u5316",children:"\u4F18\u5316"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5F00\u542F\u7528\u4E8E\u8C03\u8BD5\u7684\u65E5\u5FD7"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"org.hibernate.SQL: debug # \u5982\u679C\u5F00\u4E86 show_sql \u5C31\u53EF\u4EE5\u4E0D\u7528\u5F00\u8FD9\u4E2A\norg.hibernate.id: info # Logs SQL statements for id generation\norg.hibernate.type: debug # \u8BF7\u6C42\u53C2\u6570\norg.hibernate.type.descriptor.sql: trace # \u63D0\u53D6\u7684\u8FD4\u56DE\u503C\norg.hibernate.cache: debug # \u7F13\u5B58\u76F8\u5173\norg.hibernate.stat: debug # \u7EDF\u8BA1\norg.hibernate.event.internal: trace # \u67E5\u770B\u6240\u6709\u7684\u7F13\u5B58\u64CD\u4F5C\norg.springframework.cache: trace\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5F00\u542F\u7528\u4E8E\u8C03\u8BD5\u7684\u914D\u7F6E"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# \u751F\u6210\u7EDF\u8BA1\nhibernate.generate_statistics: true\n# \u683C\u5F0F\u5316 SQL\nhibernate.format_sql: true\n# \u663E\u793A SQL\nhibernate.show_sql: true\n# \u6DFB\u52A0 HQL \u76F8\u5173\u7684\u6CE8\u91CA\u4FE1\u606F\nhibernate.use_sql_comments: true\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u4E8C\u7EA7\u7F13\u5B58\u914D\u7F6E"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# \u53EA\u9488\u5BF9\u4F7F\u7528\u4E86\u6CE8\u89E3\u7684\u5B9E\u4F53\u8FDB\u884C\u7F13\u5B58\njavax.persistence.sharedCache.mode: ENABLE_SELECTIVE\n# \u7F13\u5B58\u5904\u7406\u7C7B\nhibernate.cache.region.factory_class: com.hazelcast.hibernate.HazelcastLocalCacheRegionFactory\nhibernate.cache.hazelcast.instance_name: default # \u4F7F\u7528\u73B0\u6709\u7684 Hazelcast \u5B9E\u4F8B,\u800C\u4E0D\u662F\u521B\u5EFA\nhibernate.cache.use_second_level_cache: true # \u542F\u7528\u4E8C\u7EA7\u7F13\u5B58\nhibernate.cache.use_query_cache: true # \u542F\u7528\u67E5\u8BE2\u7F13\u5B58\nhibernate.cache.use_reference_entries: true # \u7F13\u5B58\u4F7F\u7528\u5F15\u7528\nhibernate.cache.use_structured_entries: true # \u4F7F\u7F13\u5B58\u6570\u636E\u7684\u7ED3\u6784\u66F4\u53EF\u8BFB\nhibernate.cache.use_minimal_puts: true # \u63D0\u793A Hibernate \u51CF\u5C11\u7F13\u5B58 put\nhibernate.cache.default_cache_concurrency_strategy: nonstrict-read-write # \u9ED8\u8BA4\u7F13\u5B58\u5E76\u53D1\u7EA7\u522B\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Hibernate \u7EDF\u8BA1\u4FE1\u606F\nStatistics statistics = sessionFactory.getStatistics();\nstatistics.setStatisticsEnabled(true);\nstatistics.logSummary();\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4F7F\u7528 ",(0,r.jsx)(n.code,{children:"BatchSize"})," \u63A7\u5236\u96C6\u5408\u52A0\u8F7D\u7684\u6570\u636E\u91CF"]}),"\n",(0,r.jsxs)(n.li,{children:["\u53EF\u901A\u8FC7\u8BBE\u7F6E ",(0,r.jsx)(n.code,{children:"default_batch_fetch_size"})," \u6765\u63A7\u5236\u9ED8\u8BA4\u7684\u52A0\u8F7D\u91CF"]}),"\n",(0,r.jsx)(n.li,{children:"\u4F7F\u7528 Bag \u6216 List \u6765\u5B9E\u73B0\u53CD\u5411\u7684\u96C6\u5408,\u800C\u975E Set, \u8FD9\u6837\u53EF\u4EE5\u5728\u4E0D\u83B7\u53D6\u6574\u4E2A\u96C6\u5408\u7684\u524D\u63D0\u4E0B\u5411\u96C6\u5408\u4E2D\u6DFB\u52A0\u5143\u7D20"}),"\n",(0,r.jsxs)(n.li,{children:["\u7F13\u5B58\u53EA\u4F1A\u7F13\u5B58\u5B9E\u4F53\u672C\u8EAB\u800C",(0,r.jsx)(n.strong,{children:"\u4E0D\u4F1A"}),"\u7F13\u5B58\u5B9E\u4F53\u5173\u7CFB,\u4F8B\u5982: OneToMany \u96C6\u5408"]}),"\n",(0,r.jsxs)(n.li,{children:["\u96C6\u5408\u7F13\u5B58\u9700\u8981\u989D\u5916\u6DFB\u52A0\u6CE8\u89E3 ",(0,r.jsx)(n.code,{children:"@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.READ_ONLY)"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"fetching-\u7B56\u7565",children:"Fetching \u7B56\u7565"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5EFA\u8BAE\u4FDD\u7559\u9ED8\u8BA4,\u5EFA\u8BAE\u5728\u67E5\u8BE2\u65F6\u63A7\u5236,\u7EC6\u7C92\u5EA6\u63A7\u5236"}),"\n",(0,r.jsxs)(n.li,{children:["WHEN - \u4F55\u65F6\u83B7\u53D6\u6570\u636E - \u901A\u8FC7\u5404\u4E2A ToOne \u548C ToMany \u4E0A\u7684 fetch \u63A7\u5236\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["EAGER - ToOne \u9ED8\u8BA4\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5F53\u5173\u8054\u5173\u7CFB\u8F83\u6DF1\u65F6\u4F1A\u52A0\u8F7D\u5927\u91CF\u6570\u636E"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["LAZY - ToMany \u9ED8\u8BA4\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u61D2\u60F0\u7EA7\u522B\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5C5E\u6027\u7EA7\u522B: \u8F83\u5C11\u4F7F\u7528"}),"\n",(0,r.jsxs)(n.li,{children:["ToOne\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4EE3\u7406\u5B9E\u73B0: \u5728\u4F7F\u7528 ID \u65F6\u4E0D\u4F1A\u5BFC\u81F4\u6574\u4E2A\u5BF9\u8C61\u52A0\u8F7D,\u4EE3\u7406\u5BF9\u8C61\u7531 Hibernate \u7BA1\u7406"}),"\n",(0,r.jsx)(n.li,{children:"\u975E\u4EE3\u7406\u5B9E\u73B0: \u5728\u4F7F\u7528 ID \u65F6\u4F1A\u5BFC\u81F4\u6574\u4E2A\u5BF9\u8C61\u52A0\u8F7D,\u9700\u8981\u6784\u5EFA\u65F6\u7EC7\u5165"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["EXTRA LAZY - \u901A\u8FC7 Hibernate LazyCollection \u6CE8\u89E3\u8BBE\u7F6E\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u53EA\u5BF9\u96C6\u5408\u6709\u6548"}),"\n",(0,r.jsx)(n.li,{children:"\u5728\u4F7F\u7528\u96C6\u5408\u5185\u5143\u7D20\u7684 ID \u65F6\u4E5F\u4E0D\u4F1A\u5BFC\u81F4\u96C6\u5408\u4E2D\u5B9E\u4F53\u7684\u6570\u636E\u88AB\u52A0\u8F7D"}),"\n",(0,r.jsx)(n.li,{children:"\u4F7F\u7528\u96C6\u5408\u4E2D\u7684\u5355\u4E2A\u5143\u7D20\u53EA\u4F1A\u52A0\u8F7D\u5355\u4E2A,\u800C\u4E0D\u4F1A\u52A0\u8F7D\u6574\u4E2A\u96C6\u5408"}),"\n",(0,r.jsx)(n.li,{children:"\u96C6\u5408\u5927\u5C0F\u4E0D\u4F1A\u88AB\u7F13\u5B58"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["HOW - \u5982\u4F55\u83B7\u53D6\u6570\u636E - Hibernate \u6269\u5C55,\u4F7F\u7528 Fetch \u6CE8\u89E3\u63A7\u5236\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["JOIN\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u9002\u7528\u4E8E ToOne \u5173\u7CFB"}),"\n",(0,r.jsx)(n.li,{children:"\u5728\u5BF9\u96C6\u5408\u4F7F\u7528\u65F6\u9700\u8981\u6CE8\u610F\u4E00\u822C\u6570\u636E\u5E93 Select \u4F1A\u6BD4 Join \u66F4\u5FEB"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["SELECT\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u96C6\u5408\u7684\u9ED8\u8BA4\u83B7\u53D6\u65B9\u5F0F,\u907F\u514D\u7B1B\u5361\u5C14\u4E58\u79EF"}),"\n",(0,r.jsx)(n.li,{children:"\u9700\u8981\u6CE8\u610F N+1 \u95EE\u9898, \u6BCF\u4E2A\u96C6\u5408\u5143\u7D20\u90FD\u83B7\u53D6\u4E00\u6B21"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["BATCH - @Fetch(FetchMode.SELECT) @BatchSize(size = 10)\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5728\u8BBF\u95EE\u4E00\u4E2A\u5143\u7D20\u65F6\u5373\u52A0\u8F7D\u591A\u4E2A\u5143\u7D20"}),"\n",(0,r.jsx)(n.li,{children:"\u6279\u91CF\u52A0\u8F7D\u6570\u91CF\u53EF\u914D\u7F6E"}),"\n",(0,r.jsx)(n.li,{children:"\u6279\u91CF\u52A0\u8F7D\u6570\u91CF\u6709\u591A\u79CD\u7B97\u6CD5\u6765\u5224\u65AD"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["SUBSELLECT\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5F53\u8BBF\u95EE\u96C6\u5408\u4E2D\u7684\u67D0\u4E2A\u5143\u7D20\u65F6\u52A0\u8F7D\u6574\u4E2A\u96C6\u5408"}),"\n",(0,r.jsx)(n.li,{children:"\u6027\u80FD\u53D6\u51B3\u4E8E\u6570\u636E\u5E93"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["PROFILE\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u53EF\u901A\u8FC7\u6307\u5B9A\u591A\u4E2A\u914D\u7F6E\u5728\u5B9E\u9645\u4F7F\u7528\u65F6\u4F7F\u7528\u4E0D\u540C\u7684\u7B56\u7565"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u4E00\u7EA7\u7F13\u5B58-vs-\u4E8C\u7EA7\u7F13\u5B58",children:"\u4E00\u7EA7\u7F13\u5B58 vs \u4E8C\u7EA7\u7F13\u5B58"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4E00\u7EA7\u7F13\u5B58\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Session \u7EA7\u522B\u7F13\u5B58"}),"\n",(0,r.jsx)(n.li,{children:"\u5728\u540C\u4E00\u4E2A\u4E8B\u52A1\u4E2D"}),"\n",(0,r.jsx)(n.li,{children:"\u4E8B\u52A1\u4E4B\u95F4\u4E0D\u4F1A\u5171\u4EAB\u7F13\u5B58\u6570\u636E"}),"\n",(0,r.jsx)(n.li,{children:"\u4E8B\u52A1\u7ED3\u675F\u65F6\u7F13\u5B58\u5373\u88AB\u6E05\u7406"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4E8C\u7EA7\u7F13\u5B58\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"SessionFactory \u7EA7\u522B\u7F13\u5B58\u5373 JVM \u7EA7\u522B\u7F13\u5B58"}),"\n",(0,r.jsx)(n.li,{children:"\u6240\u6709\u7684\u4F1A\u8BDD\u90FD\u4F1A\u5171\u4EAB\u7F13\u5B58"}),"\n",(0,r.jsx)(n.li,{children:"\u4E8B\u52A1\u5B8C\u6210\u540E\u7F13\u5B58\u4F9D\u7136\u5B58\u5728"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"2lc---\u4E8C\u7EA7\u7F13\u5B58",children:"2LC - \u4E8C\u7EA7\u7F13\u5B58"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u9ED8\u8BA4\u4E0D\u542F\u7528\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u53EF\u6253\u5F00\u5168\u5C40\u7684\u4E8C\u7EA7\u7F13\u5B58,sharedMode ALL"}),"\n",(0,r.jsx)(n.li,{children:"\u53EF\u9488\u5BF9\u5355\u4E2A\u5B9E\u4F53\u548C\u96C6\u5408\u8FDB\u884C\u7F13\u5B58"}),"\n",(0,r.jsx)(n.li,{children:"\u53EF\u5728\u4F1A\u8BDD\u7EA7\u522B\u63A7\u5236\u7F13\u5B58\u6A21\u5F0F"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"\u53EF\u7F13\u5B58\u6240\u6709\u5C5E\u6027(\u9ED8\u8BA4)\u6216\u975E\u61D2\u52A0\u8F7D\u5C5E\u6027"}),"\n",(0,r.jsxs)(n.li,{children:["userguide ",(0,r.jsx)(n.a,{href:"https://docs.jboss.org/hibernate/orm/current/userguide/html_single/chapters/caching/Caching.html",children:"Caching"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://www.slideshare.net/brmeyer/hibernate-orm-performance-31550150",children:"Hibernate ORM: Tips, Tricks, and Performance Techniques"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://what-when-how.com/hibernate/optimizing-fetching-and-caching-hibernate/",children:"\u6570\u636E\u83B7\u53D6\u548C\u7F13\u5B58\u4F18\u5316"})}),"\n",(0,r.jsxs)(n.li,{children:["\u96C6\u5408\u7F13\u5B58\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"@Cachable"})," \u4E0D\u652F\u6301 Field"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4F7F\u7528 ",(0,r.jsx)(n.code,{children:"@org.hibernate.annotations.Cache(usage = CacheConcurrencyStrategy.NONSTRICT_READ_WRITE)"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"hibernate.cache.auto_evict_collection_cache"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u9ED8\u8BA4\u5173\u95ED, \u56E0\u4E3A\u8DDF\u8E2A\u8BE5\u72B6\u6001\u4F1A\u6709\u4E00\u5B9A\u6027\u80FD\u5F71\u54CD"}),"\n",(0,r.jsx)(n.li,{children:"\u5728\u53CC\u5411\u5173\u7CFB\u65F6, \u5F53\u4E0D\u662F\u5173\u7CFB\u6240\u5C5E\u65B9, \u662F\u5426\u81EA\u52A8\u6E05\u9664\u96C6\u5408\u7F13\u5B58"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["FAQ\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u6CE8\u610F\u4F7F\u7528\u4E8C\u7EA7\u7F13\u5B58, JCache \u5728\u914D\u5408 SpringBoot Restart \u65F6\u53EF\u80FD\u4F1A\u6709 ClassLoader \u7684\u95EE\u9898\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"org.hibernate.PropertyAccessException: Could not set field value [VAL] value by reflection : [class me.wener.CustomerEntity.type] setter of me.wener.CustomerEntity.type.type"}),"\n",(0,r.jsxs)(n.li,{children:["\u5728 ",(0,r.jsx)(n.code,{children:"META-INF/spring-devtools.properties"})," \u6DFB\u52A0\u76F8\u5E94 jar \u5305\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4F8B\u5982 ",(0,r.jsx)(n.code,{children:"restart.include.jcache=/jcache-[.0-9]+\\.jar"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u4E8C\u7EA7\u7F13\u5B58\u7684\u5E76\u53D1\u7B56\u7565"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"CacheConcurrencyStrategy"}),(0,r.jsx)(n.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"NONE"}),(0,r.jsx)(n.td,{children:"\u4E0D\u4F7F\u7528\u4EFB\u4F55\u5E76\u53D1\u7B56\u7565"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"READ_ONLY"}),(0,r.jsx)(n.td,{children:"\u6700\u7B80\u5355\u548C\u6700\u4F18\u7684"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"NONSTRICT_READ_WRITE"}),(0,r.jsx)(n.td,{children:"\u5982\u679C\u66F4\u65B0\u8F83\u5C11\u4E14\u4E0D\u6613\u78B0\u649E,\u4E8B\u52A1\u9694\u79BB\u4E0D\u5F3A"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"READ_WRITE"}),(0,r.jsx)(n.td,{children:"\u652F\u6301\u66F4\u65B0,\u5728\u4F7F\u7528\u4E32\u884C\u4E8B\u52A1\u7EA7\u522B\u65F6\u4E0D\u5E94\u8BE5\u4F7F\u7528"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"TRANSACTIONAL"}),(0,r.jsx)(n.td,{children:"\u9700\u8981\u652F\u6301\u4E8B\u52A1\u7684\u7F13\u5B58,\u9700\u8981 JTA"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"hibernate-\u66F4\u65B0\u64CD\u4F5C",children:"Hibernate \u66F4\u65B0\u64CD\u4F5C"}),"\n",(0,r.jsx)(n.p,{children:"PreUpdate \u53EA\u6709\u5728\u4FEE\u6539\u5B9E\u4F53\u65F6\u624D\u4F1A\u89E6\u53D1,\u5982\u679C\u4F7F\u7528 Hibernate \u7684 EXTRA LAZY, \u5F80 Collection \u4E2D\u63D2\u5165\u65F6\u65F6\u4E0D\u4F1A\u89E6\u53D1\u539F\u5B9E\u4F53\u7684,\u56E0\u6B64 PreUpdate \u5728\u4FEE\u6539\u90E8\u5206 Collection \u7684\u65F6\u5019\u4E0D\u4F1A\u88AB\u89E6\u53D1."}),"\n",(0,r.jsx)(n.p,{children:"Version \u5B57\u6BB5\u53EA\u6709\u5728\u81EA\u5DF1\u6240\u6301\u6709\u719F\u6089\u548C\u81EA\u5DF1\u6240\u6301\u6709\u7684\u5173\u7CFB\u88AB\u4FEE\u6539\u65F6\u624D\u4F1A\u66F4\u65B0 Version, \u66F4\u65B0 Version \u65F6\u4E5F\u4F1A\u89E6\u53D1 PreUpdate \u4FEE\u6539."}),"\n",(0,r.jsxs)(n.p,{children:["\u5728 Hibernate \u4E2D\u53EF\u5F3A\u5236\u4F7F\u7528 ",(0,r.jsx)(n.code,{children:"OptimisticLock"})," \u4F7F\u5F97\u5728\u66F4\u65B0\u96C6\u5408\u65F6\u4E5F\u89E6\u53D1 Version \u7684\u4FEE\u6539,\u56E0\u6B64\u4E5F\u53EF\u4EE5\u5F3A\u5236\u89E6\u53D1 PreUpdate \u4E8B\u4EF6."]}),"\n",(0,r.jsx)(n.h2,{id:"\u591A\u79DF\u6237multi-tenancy",children:"\u591A\u79DF\u6237/Multi-Tenancy"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u4E09\u79CD\u6A21\u5F0F\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"DB per tenant"}),"\n",(0,r.jsx)(n.li,{children:"Schema per tenant"}),"\n",(0,r.jsx)(n.li,{children:"\u6BCF\u4E2A Schema \u4E00\u4E2A\u8FDE\u63A5\u6C60"}),"\n",(0,r.jsx)(n.li,{children:"\u6BCF\u6B21\u6307\u5B9A Schema"}),"\n",(0,r.jsx)(n.li,{children:"Discriminator field"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u4E3B\u8981\u63A5\u53E3\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["CurrentTenantIdentifierResolver\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u83B7\u53D6\u5F53\u524D\u7684\u79DF\u6237"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["MultiTenantConnectionProvider\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4F7F\u7528\u79DF\u6237\u83B7\u53D6\u94FE\u63A5"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://dzone.com/articles/spring-boot-hibernate-multitenancy-implementation",children:"Multi-Tenancy Implementation for Spring Boot + Hibernate Projects"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"json",children:"JSON"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/velo/hibernate-native-json",children:"https://github.com/velo/hibernate-native-json"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/wenerme/postjava",children:"https://github.com/wenerme/postjava"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@TypeDefs({\n  @TypeDef(name = "json", typeClass = JsonStringType.class),\n  @TypeDef(name = "jsonb", typeClass = JsonBinaryType.class),\n  @TypeDef(name = "json-node", typeClass = JsonNodeStringType.class),\n  @TypeDef(name = "jsonb-node", typeClass = JsonNodeBinaryType.class),\n})\n@Entity\n@Table(name = "users")\n@Setter\n@Getter\nclass UserEntity {\n  Integer id;\n  @Type(type="json-node")\n  JsonNode attributes;\n  @Type(type="jsonb")\n  Map<String,String> labels;\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(n.h3,{id:"\u5185\u5D4C\u81EA\u5B9A\u4E49\u65B9\u8A00\u51FD\u6570",children:"\u5185\u5D4C\u81EA\u5B9A\u4E49\u65B9\u8A00\u51FD\u6570"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://stackoverflow.com/questions/17368962",children:"Can I nest functions in Hibernate custom dialect ?"})}),"\n",(0,r.jsx)(n.li,{children:"\u4E0D\u80FD, \u6700\u7B80\u5355\u7684\u505A\u6CD5\u662F\u589E\u52A0\u53C2\u6570\u6570\u91CF, \u5408\u5E76\u6210\u5355\u4E2A\u51FD\u6570"}),"\n"]})]})}function o(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},17776:function(e,n,i){i.d(n,{R:()=>t,x:()=>c});var s=i(7378);let r={},l=s.createContext(r);function t(e){let n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);