"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["485678"],{29557:function(n,e,r){r.r(e),r.d(e,{frontMatter:()=>i,toc:()=>h,default:()=>j,metadata:()=>s,assets:()=>c,contentTitle:()=>t});var s=JSON.parse('{"id":"os/linux/shell/lsof","title":"lsof","description":"- lsof.8","source":"@site/../notes/os/linux/shell/lsof.md","sourceDirName":"os/linux/shell","slug":"/os/linux/shell/lsof","permalink":"/notes/os/linux/shell/lsof","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/shell/lsof.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1687760370000,"frontMatter":{"title":"lsof"},"sidebar":"docs","previous":{"title":"jq","permalink":"/notes/os/linux/shell/jq"},"next":{"title":"nano","permalink":"/notes/os/linux/shell/nano"}}'),d=r(486106),l=r(917776);let i={title:"lsof"},t="lsof",c={},h=[];function x(n){let e={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"lsof",children:"lsof"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://man7.org/linux/man-pages/man8/lsof.8.html",children:"lsof.8"})}),"\n"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u641C\u7D22\u76EE\u5F55\nlsof +D /var/lib/k0s/containerd/io.containerd.snapshotter.v1.overlayfs/\n# \u641C\u7D22 Linux \u6587\u4EF6\nlsof -f -- /run/k0s/konnectivity-server/konnectivity-server.sock\n\nlsof -c ssh -c init\n\n# \u5224\u65AD roofs \u5BF9\u5E94\u78C1\u76D8\u6CA1\u6709\u592A\u591A\u8BFB\u5199\nlsof -a -d "^cwd,^rtd" +D "/"\nlsof -a -d "^cwd,^rtd,^mem,^txt" +D "/"\n'})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"flag"}),(0,d.jsx)(e.th,{children:"for"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-d FD"}),(0,d.jsx)(e.td,{})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"+D DIR"}),(0,d.jsx)(e.td,{children:"\u904D\u5386 DIR"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"+d DIR"}),(0,d.jsx)(e.td,{children:"\u4E0D\u904D\u5386"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-u USER"}),(0,d.jsx)(e.td,{})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-g GROUP"}),(0,d.jsx)(e.td,{})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-a"}),(0,d.jsx)(e.td,{children:"AND"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-c PROCESS_NAME"}),(0,d.jsx)(e.td,{})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-p PID"}),(0,d.jsx)(e.td,{})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-t"}),(0,d.jsx)(e.td,{children:"\u8F93\u51FA PID"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:(0,d.jsx)(e.code,{children:"+|-r [t[m<fmt>]]"})}),(0,d.jsx)(e.td,{children:"repeat N times"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-i"}),(0,d.jsx)(e.td,{children:"network"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-N"}),(0,d.jsx)(e.td,{children:"NFS"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-P"}),(0,d.jsx)(e.td,{children:"\u4E0D port -> name"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-n"}),(0,d.jsx)(e.td,{children:"\u4E0D ip -> hostname"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:(0,d.jsx)(e.code,{children:"+|-f [cfgGn]"})}),(0,d.jsx)(e.td,{children:"path name"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"-D D"}),(0,d.jsx)(e.td,{children:"device cache file"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:(0,d.jsx)(e.code,{children:"-x [fl]"})}),(0,d.jsx)(e.td,{children:"l - symlink, f - mount"})]})]})]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"^EXCLUDE"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"-u ^root"})," - exclude root user"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"-p ^init"})," - exclude init process"]}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.code,{children:"-p 123,^456"})}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"-i [46][protocol][@hostname|hostaddr][:service|port]"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.code,{children:"-i TCP:22"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.code,{children:"-i TCP:1-1024"})}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"-i 4"})," - IPv4"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"-i 6"})," - IPv6"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"+D DIR -x l"})," - follow symlink"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"+D DIR -x f"})," - follow mount point"]}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"FD"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"FD"}),(0,d.jsx)(e.th,{children:"for"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"cwd"}),(0,d.jsx)(e.td,{children:"current working directory"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"Lnn"}),(0,d.jsx)(e.td,{children:"library references (AIX)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"err"}),(0,d.jsx)(e.td,{children:"FD information error (see NAME column)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"jld"}),(0,d.jsx)(e.td,{children:"jail directory (FreeBSD)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"ltx"}),(0,d.jsx)(e.td,{children:"shared library text (code and data)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"Mxx"}),(0,d.jsx)(e.td,{children:"hex memory-mapped type number xx"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"m86"}),(0,d.jsx)(e.td,{children:"DOS Merge mapped file"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"mem"}),(0,d.jsx)(e.td,{children:"memory-mapped file"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"mmap"}),(0,d.jsx)(e.td,{children:"memory-mapped device"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"pd"}),(0,d.jsx)(e.td,{children:"parent directory"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"rtd"}),(0,d.jsx)(e.td,{children:"root directory"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"tr"}),(0,d.jsx)(e.td,{children:"kernel trace file (OpenBSD)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"txt"}),(0,d.jsx)(e.td,{children:"program text (code and data)"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"v86"}),(0,d.jsx)(e.td,{children:"VP/ix mapped file"})]})]})]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"r -> read"}),"\n",(0,d.jsx)(e.li,{children:"w -> write"}),"\n",(0,d.jsx)(e.li,{children:"u -> read+write"}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:" "})," -> unknow & no lock"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"-"})," -> unknown & lock"]}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Lock"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"L"}),(0,d.jsx)(e.th,{children:"for"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"N"}),(0,d.jsx)(e.td,{children:"Solaris NFS lock of unknown type;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"r"}),(0,d.jsx)(e.td,{children:"read lock on part of the file;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"R"}),(0,d.jsx)(e.td,{children:"read lock on the entire file;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"w"}),(0,d.jsx)(e.td,{children:"write lock on part of the file;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"W"}),(0,d.jsx)(e.td,{children:"write lock on the entire file;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"u"}),(0,d.jsx)(e.td,{children:"read and write lock of any length;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"U"}),(0,d.jsx)(e.td,{children:"lock of unknown type;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"x"}),(0,d.jsx)(e.td,{children:"SCO OpenServer Xenix lock on part of the file;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"X"}),(0,d.jsx)(e.td,{children:"SCO OpenServer Xenix lock on the entire file;"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"space"}),(0,d.jsx)(e.td,{children:"no lock."})]})]})]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["TYPE\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"REG - Regular File"}),"\n",(0,d.jsx)(e.li,{children:"DIR"}),"\n",(0,d.jsx)(e.li,{children:"FIFO"}),"\n",(0,d.jsx)(e.li,{children:"CHR"}),"\n"]}),"\n"]}),"\n"]})]})}function j(n={}){let{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(x,{...n})}):x(n)}},917776:function(n,e,r){r.d(e,{R:()=>i,x:()=>t});var s=r(7378);let d={},l=s.createContext(d);function i(n){let e=s.useContext(l);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:i(n.components),s.createElement(l.Provider,{value:e},n.children)}}}]);