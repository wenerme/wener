"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["459834"],{626589:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>r,toc:()=>x,default:()=>a,metadata:()=>l,assets:()=>c,contentTitle:()=>d});var l=JSON.parse('{"id":"os/linux/sys/interrupt","title":"Linux Interrupts (IRQ)","description":"linux-interrupts-irq}","source":"@site/../notes/os/linux/sys/interrupt.md","sourceDirName":"os/linux/sys","slug":"/os/linux/sys/interrupt","permalink":"/notes/os/linux/sys/interrupt","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/sys/interrupt.md","tags":[{"inline":true,"label":"Linux","permalink":"/notes/tags/linux"},{"inline":true,"label":"Kernel","permalink":"/notes/tags/kernel"},{"inline":true,"label":"IRQ","permalink":"/notes/tags/irq"},{"inline":true,"label":"Hardware","permalink":"/notes/tags/hardware"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"Linux Interrupts (IRQ)","tags":["Linux","Kernel","IRQ","Hardware"]},"sidebar":"docs","previous":{"title":"hugetlbpage","permalink":"/notes/os/linux/sys/hugetlbpage"},"next":{"title":"Linux I/O Subsystem","permalink":"/notes/os/linux/sys/io"}}'),s=t(486106),i=t(917776);let r={title:"Linux Interrupts (IRQ)",tags:["Linux","Kernel","IRQ","Hardware"]},d="Linux Interrupts (IRQ) {#linux-interrupts-irq}",c={},x=[{value:"Concepts",id:"concepts",level:2},{value:"IRQ Assignment",id:"irq-assignment",level:3},{value:"Controllers",id:"controllers",level:3},{value:"Debugging &amp; Tuning",id:"debugging-tuning",level:2},{value:"SMP Affinity",id:"smp-affinity",level:3},{value:"PRI &amp; Signalling",id:"pri-signalling",level:2}];function h(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"linux-interrupts-irq",children:"Linux Interrupts (IRQ)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.asteriskguru.com/tutorials/pci_irq_apic_tdm_ticks_te410p_te405p_noise.html",children:"Asterisk Guru: PCI, IRQ, APIC, TDM, Ticks, TE410P/TE405P, Noise"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"concepts",children:"Concepts"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Interrupt"}),": A method by which hardware communicates with the processor."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"IRQ (Interrupt Request Line)"}),": A number used to describe an interrupt.\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Typical PC has 16 IRQs (0-15)."}),"\n",(0,s.jsx)(n.li,{children:"Many are reserved (timer, keyboard, etc.)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"irq-assignment",children:"IRQ Assignment"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"IRQ"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Device"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Note"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"0"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"timer"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"can't be changed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"keyboard"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"can't be changed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"2"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"irq9 cascade"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"can't be changed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"com 2/4"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"4"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"com 1/3"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"5"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"usually free"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"6"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"floppy disk"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"7"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"lpt1"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"8"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"clock"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"can't be changed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"9"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"usually free"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"may be labelled as irq 2 due to cascading"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"10"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"free"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"11"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"free"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"12"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"mouse"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"13"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"co-processor"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"can't be changed"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"14"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Pri eide adapter"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"15"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"secondary eide adapter"}),(0,s.jsx)(n.td,{style:{textAlign:"left"}})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"controllers",children:"Controllers"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"APIC (Advanced Processor Interrupt Controller)"}),": Overcomes the 16 IRQ limit. Adds 24+ IRQs per APIC."]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"IO-APIC"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"PCI-MSI"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"debugging-tuning",children:"Debugging & Tuning"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check IRQs\nlspci -v | grep IRQ\n# Bus-centric view\nlspci -vb | grep IRQ\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Troubleshooting Tips"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Disable unused devices in BIOS (USB, Audio, etc.)."}),"\n",(0,s.jsx)(n.li,{children:"Assign IRQ to specific PCI slot in BIOS (if available)."}),"\n",(0,s.jsx)(n.li,{children:"Move card to different PCI slot."}),"\n",(0,s.jsx)(n.li,{children:'Disable "Plug \'n Play OS" in BIOS.'}),"\n",(0,s.jsx)(n.li,{children:"Enable APIC in kernel."}),"\n",(0,s.jsx)(n.li,{children:"Disable IRQ load balancing."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"dahdi_test"}),": > 99.98% ok. < 99.975% problems."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"dahdi_tool"}),": check IRQ misses."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"PCI Latency: min=0, max=248."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"smp-affinity",children:"SMP Affinity"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check affinity\ncat /proc/irq/16/smp_affinity\n\n# Set affinity (e.g., CPU 2 or 2-3)\necho -n 2-3 > /proc/irq/16/smp_affinity_list\necho -n 2 > /proc/irq/16/smp_affinity\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://stackoverflow.com/a/1500135/1870054",children:"StackOverflow: SMP Affinity"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"pri-signalling",children:"PRI & Signalling"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.asteriskguru.com/tutorials/pri.html",children:"Asterisk Guru: PRI"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"T1"})," (NA/Japan): 23 B + 1 D."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"E1"})," (Europe/Aus): 30 B + 1 D."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"B-channel"}),": Voice/Data."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"D-channel"}),": Signalling (Call setup/teardown)."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CAS (Channel Associated Signalling)"}),": Bits replicate circuit status or tone signalling clearly."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"CCS (Common Channel Signalling)"}),": ISDN/SS7. Messages sent over signalling channel."]}),"\n"]}),"\n"]})]})}function a(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},917776:function(e,n,t){t.d(n,{R:()=>r,x:()=>d});var l=t(7378);let s={},i=l.createContext(s);function r(e){let n=l.useContext(i);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);