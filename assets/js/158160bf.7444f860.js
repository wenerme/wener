"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["654511"],{724100:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>r,toc:()=>d,default:()=>c,metadata:()=>t,assets:()=>a,contentTitle:()=>o});var t=JSON.parse('{"id":"os/linux/boot/bootloader","title":"Linux \u5F15\u5BFC\u52A0\u8F7D\u7A0B\u5E8F\u4E0E\u5206\u533A (Bootloader & Partitioning)","description":"bootloader-partitioning}","source":"@site/../notes/os/linux/boot/bootloader.md","sourceDirName":"os/linux/boot","slug":"/os/linux/boot/bootloader","permalink":"/notes/os/linux/boot/bootloader","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/boot/bootloader.md","tags":[{"inline":true,"label":"Linux","permalink":"/notes/tags/linux"},{"inline":true,"label":"Boot","permalink":"/notes/tags/boot"},{"inline":true,"label":"Bootloader","permalink":"/notes/tags/bootloader"},{"inline":true,"label":"Partition","permalink":"/notes/tags/partition"},{"inline":true,"label":"UEFI","permalink":"/notes/tags/uefi"},{"inline":true,"label":"GRUB","permalink":"/notes/tags/grub"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"Linux \u5F15\u5BFC\u52A0\u8F7D\u7A0B\u5E8F\u4E0E\u5206\u533A (Bootloader & Partitioning)","tags":["Linux","Boot","Bootloader","Partition","UEFI","GRUB"]},"sidebar":"docs","previous":{"title":"BIOS","permalink":"/notes/os/linux/boot/bios"},"next":{"title":"coreboot","permalink":"/notes/os/linux/boot/coreboot"}}'),s=i(486106),l=i(917776);let r={title:"Linux \u5F15\u5BFC\u52A0\u8F7D\u7A0B\u5E8F\u4E0E\u5206\u533A (Bootloader & Partitioning)",tags:["Linux","Boot","Bootloader","Partition","UEFI","GRUB"]},o="Linux \u5F15\u5BFC\u52A0\u8F7D\u7A0B\u5E8F\u4E0E\u5206\u533A (Bootloader & Partitioning) {#bootloader-partitioning}",a={},d=[{value:"ESP (EFI System Partition)",id:"esp",level:2},{value:"Alpine Linux LVM &amp; UEFI",id:"alpine-lvm-uefi",level:2},{value:"\u521B\u5EFA UEFI \u542F\u52A8 USB (Create UEFI Boot USB)",id:"create-uefi-usb",level:2},{value:"Partitioning Status",id:"partitioning-status",level:3},{value:"OVMF &amp; QEMU",id:"ovmf-qemu",level:2},{value:"Parted &amp; GPT",id:"parted-gpt",level:2},{value:"\u53C2\u8003\u8D44\u6599 (References)",id:"references",level:2},{value:"Bootloader Features",id:"bootloader-features",level:3}];function h(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"bootloader-partitioning",children:"Linux \u5F15\u5BFC\u52A0\u8F7D\u7A0B\u5E8F\u4E0E\u5206\u533A (Bootloader & Partitioning)"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Comparison_of_boot_loaders",children:"Comparison of boot loaders - Wikipedia"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.makeuseof.com/tag/how-to-boot-a-linux-live-usb-stick-on-your-mac/",children:"How To Boot A Linux Live USB Stick On Your Mac"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Mac OS X \u9700\u8981 GUID \u6216 Apple File System \u5206\u533A\u3002"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://support.apple.com/kb/PH6382",children:"Startup key combinations for Mac"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"MBR vs EFI vs UEFI"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"MBR vs GPT"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.syslinux.org/wiki/index.php?title=Install",children:"SYSLINUX Install"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cat /proc/partitions\ncat /proc/version\nlsusb -t\n"})}),"\n",(0,s.jsx)(n.h2,{id:"esp",children:"ESP (EFI System Partition)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"ESP - EFI SYSTEM PARTITION - \u4E00\u822C\u4E3A FAT32 \u6216 FAT \u53D8\u79CD"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/EFI_system_partition",children:"EFI system partition - Wikipedia"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/BIOS_boot_partition",children:"BIOS boot partition - Wikipedia"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"alpine-lvm-uefi",children:"Alpine Linux LVM & UEFI"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wiki.alpinelinux.org/wiki/Setting_up_LVM_on_GPT-labeled_disks",children:"Setting up LVM on GPT-labeled disks - AlpineWiki"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wiki.alpinelinux.org/wiki/Installing_on_GPT_LVM",children:"Installing on GPT LVM - AlpineWiki"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"dd bs=440 conv=notrunc count=1 if=/usr/share/syslinux/gptmbr.bin of=/dev/sda\n"})}),"\n",(0,s.jsx)(n.h2,{id:"create-uefi-usb",children:"\u521B\u5EFA UEFI \u542F\u52A8 USB (Create UEFI Boot USB)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wiki.alpinelinux.org/wiki/Create_UEFI_boot_USB",children:"Create UEFI boot USB - AlpineWiki"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"DEVICE=/dev/sdb\nparted --script $DEVICE mklabel gpt\nparted --script --align=optimal $DEVICE mkpart ESP fat32 1MiB 200MiB\nparted --script $DEVICE set 1 boot on\n\ngdisk -l /dev/sdb\n\n# mkfs.fat: warning - lowercase labels might not work properly with DOS or Windows\nmkfs.vfat -n Alpine ${DEVICE}1\nmount -t vfat ${DEVICE}1 /mnt\n\nwget https://mirrors.tuna.tsinghua.edu.cn/alpine/v3.8/releases/x86_64/alpine-standard-3.8.0-x86_64.iso\ncd /mnt && uniso < ~/alpine-standard-3.8.0-x86_64.iso\n\nmkdir -p loader/entries\n\ncat << CONF > loader/loader.conf\ndefault alpine\ntimeout 4\nCONF\n\n# boot/syslinux/syslinux.cfg\ncat << CONF > loader/entries/alpine.conf\ntitle    AlpineLinux-Vanilla\nlinux    /boot/vmlinuz-vanilla\ninitrd   /boot/initramfs-vanilla\noptions  modules=loop,squashfs,sd-mod,usb-storage quiet nomodeset\nCONF\n\ncd ~ && umount /mnt\n"})}),"\n",(0,s.jsx)(n.h3,{id:"partitioning-status",children:"Partitioning Status"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MBR: protective"}),"\n",(0,s.jsx)(n.li,{children:"BSD: not present"}),"\n",(0,s.jsx)(n.li,{children:"APM: not present"}),"\n",(0,s.jsx)(n.li,{children:"GPT: present"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ovmf-qemu",children:"OVMF & QEMU"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'OVMF "is a project to enable UEFI support for Virtual Machines".'}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"http://www.linux-kvm.org/page/OVMF",children:"OVMF - KVM"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://fedoraproject.org/wiki/Using_UEFI_with_QEMU",children:"Using UEFI with QEMU - Fedora"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://fedoraproject.org/wiki/Architectures/AArch64/Install_with_QEMU",children:"AArch64/Install with QEMU - Fedora"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wiki.ubuntu.com/UEFI/OVMF",children:"UEFI/OVMF - Ubuntu Wiki"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/tianocore/edk2",children:"tianocore/edk2"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"QEMU:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"-L path"}),": set the directory for the BIOS, VGA BIOS and keymaps"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"parted-gpt",children:"Parted & GPT"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://serverfault.com/questions/104923/unrecognised-disc-label-when-using-parted-with-qemu-images",children:"Unrecognised disc label when using parted with qemu images"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Parted commands:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"mklabel msdos\n\nunit MiB\nmklabel gpt\nmkpart 1 1 256\nname 1 boot\nset 1 legacy_boot on\nmkpart 2 256 100%\nset 2 lvm on\n\npartprobe\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Use ",(0,s.jsx)(n.code,{children:"sgdisk"})," and ",(0,s.jsx)(n.code,{children:"parted"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u8F6C\u6362\u4E3A GPT\nparted -s /dev/sdb 'mklabel gpt'\n# \u7F16\u8F91 GPT \u5206\u533A\ngdisk /dev/sdb\n# \u811A\u672C\u64CD\u4F5C http://www.rodsbooks.com/gdisk/sgdisk-walkthrough.html\n# -p \u67E5\u770B\u5206\u533A -o \u6E05\u9664\u5206\u533A\u8868 -g \u8F6C\u6362 MBR \u4E3A GPT -n \u5220\u9664\u5206\u533A -n \u6DFB\u52A0\u5206\u533A -c \u66F4\u6539\u5206\u533A\u540D\n# -t \u5206\u533A\u7C7B\u578B -v \u6821\u9A8C -Z \u6E05\u9664\u5206\u533A\u6570\u636E,\u5F53\u9700\u8981\u4ECE\u65B0\u5206\u533A\u7684\u65F6\u5019\u4F7F\u7528\nsgdisk -og /dev/sdb\n"})}),"\n",(0,s.jsx)(n.h2,{id:"references",children:"\u53C2\u8003\u8D44\u6599 (References)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface",children:"Unified Extensible Firmware Interface - Wikipedia"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/EFI_system_partition#Linux",children:"EFI system partition: Linux - Wikipedia"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Windows_To_Go",children:"Windows To Go - Wikipedia"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wiki.archlinux.org/index.php/syslinux#UEFI_Systems",children:"syslinux: UEFI Systems - ArchWiki"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://askubuntu.com/questions/651902/what-is-the-difference-between-grub-and-syslinux",children:"What is the difference between GRUB and Syslinux? - Ask Ubuntu"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wiki.archlinux.org/index.php/Unified_Extensible_Firmware_Interface",children:"Unified Extensible Firmware Interface - ArchWiki"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Das_U-Boot",children:"Das U-Boot - Wikipedia"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"bootloader-features",children:"Bootloader Features"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Feature"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"SYSLINUX"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"Das U-Boot"}),(0,s.jsx)(n.th,{style:{textAlign:"left"},children:"GRUB 2"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"Platforms"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"x86 (PC)"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"PPC, ARM, MIPS, x86, etc."}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"x86, ARM, PowerPC, MIPS, SPARC"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"Filesystems"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"ext2/3/4, btrfs, FAT16/32, NTFS, iso9660"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"FAT, ext2/3/4, jffs2, ubifs, nfs"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"ext2/3/4, btrfs, zfs, xfs, FAT, NTFS, iso9660"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"OS Support"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"GNU/Linux"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Linux, BSD, RTOS, Solaris, etc."}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"Linux, BSD, Solaris, Multiboot"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{style:{textAlign:"left"},children:(0,s.jsx)(n.strong,{children:"Network"})}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"TFTP"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"TFTP, NFS"}),(0,s.jsx)(n.td,{style:{textAlign:"left"},children:"?"})]})]})]})]})}function c(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},917776:function(e,n,i){i.d(n,{R:()=>r,x:()=>o});var t=i(7378);let s={},l=t.createContext(s);function r(e){let n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);