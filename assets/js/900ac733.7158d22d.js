"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["79414"],{72935:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>l,toc:()=>h,default:()=>o,metadata:()=>d,assets:()=>r,contentTitle:()=>c});var d=JSON.parse('{"id":"db/column/duckdb","title":"DuckDB","description":"- duckdb/duckdb","source":"@site/../notes/db/column/duckdb.md","sourceDirName":"db/column","slug":"/db/column/duckdb","permalink":"/notes/db/column/duckdb","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/db/column/duckdb.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1758158840000,"frontMatter":{"title":"DuckDB"},"sidebar":"docs","previous":{"title":"CQL","permalink":"/notes/db/column/cql"},"next":{"title":"ScyllaDB","permalink":"/notes/db/column/scylladb/"}}'),i=s(86106),t=s(17776);let l={title:"DuckDB"},c="DuckDB",r={},h=[{value:"Inspect",id:"inspect",level:2},{value:"extension",id:"extension",level:2},{value:"Settings",id:"settings",level:2},{value:"NodeJS",id:"nodejs",level:2},{value:"Version",id:"version",level:2},{value:"duckdb vs SQLite3",id:"duckdb-vs-sqlite3",level:2}];function a(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"duckdb",children:"DuckDB"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb",children:"duckdb/duckdb"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"MIT, C++"}),"\n",(0,i.jsx)(e.li,{children:"\u5D4C\u5165\u5F0F OLAP \u6570\u636E\u5E93"}),"\n",(0,i.jsx)(e.li,{children:"\u7C7B\u4F3C SQLite - \u4F46\u5217\u5B58\u50A8\uFF0C\u9762\u5411\u5206\u6790"}),"\n",(0,i.jsx)(e.li,{children:"\u652F\u6301\u67E5\u8BE2 Parquet, CSV"}),"\n",(0,i.jsx)(e.li,{children:"\u5411\u91CF\u5F15\u64CE\uFF0C\u5E76\u884C\u67E5\u8BE2"}),"\n",(0,i.jsx)(e.li,{children:"\u5B98\u65B9\u652F\u6301 SDK: Python, Java, C++, NodeJS, R"}),"\n",(0,i.jsx)(e.li,{children:"\u8BED\u6CD5\u7C7B\u4F3C pg - \u4F7F\u7528 libpg_query"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/duckdb/pg_duckdb",children:"duckdb/pg_duckdb"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4F5C\u4E3A PG \u63D2\u4EF6\u4F7F\u7528 DuckDB"}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/supabase/postgres/issues/1106",children:"supabase/postgres#1106"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb-wasm",children:"duckdb/duckdb-wasm"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u5728 Web \u5185\u6267\u884C\uFF0C\u57FA\u4E8E FS API \u8FDB\u884C IO \u4EA4\u4E92"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://news.ycombinator.com/item?id=32684424",children:"https://news.ycombinator.com/item?id=32684424"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://h2oai.github.io/db-benchmark/",children:"https://h2oai.github.io/db-benchmark/"})}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/duckdblabs/arrow",children:"duckdblabs/arrow"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Arrow - Python Binding"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/evanwashere/duckdb",children:"evanwashere/duckdb"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"bun binding"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.admonition,{type:"caution",children:(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4E0D\u80FD\u66F4\u65B0 unique \u5217 ",(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb/issues/5771",children:"#5771"})]}),"\n"]})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# by Homebre\nbrew install duckdb\n# by Download\ncurl -LO https://echo.wener.cc/github.com/duckdb/duckdb/releases/download/v0.8.0/duckdb_cli-osx-universal.zip\nunzip duckdb_cli-osx-universal.zip\n./duckdb\n\nduckdb -h\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT * FROM 'myfile.csv';\nSELECT * FROM 'myfile.parquet';\nSELECT * FROM 'myfile.json';\nSELECT * FROM 'myfile.jsonl';\n\n-- \u884C\u6A21\u5F0F\n.mode line\nSELECT * FROM users WHERE id = 1;\n\n-- csv, parquet\nSELECT * FROM 'https://domain.tld/file.extension';\n\n-- S3\nSET s3_region='us-east-1';\nSET s3_endpoint='<domain>.<tld>:<port>';\nSET s3_url_style='path';\nSET s3_access_key_id='<AWS access key id>';\nSET s3_secret_access_key='<AWS secret access key>';\nSET s3_session_token='<AWS session token>';\nSELECT * FROM 's3://bucket/file.extension';\n\nSELECT * FROM parquet_scan('s3://bucket/*.parquet');\nSELECT COUNT(*) FROM parquet_scan('s3://bucket/folder*/100?/t[0-9].parquet');\nSELECT * FROM parquet_scan('s3://bucket/*.parquet', FILENAME = 1);\nSELECT * FROM parquet_scan('s3://bucket/*/file.parquet', HIVE_PARTITIONING = 1);\n\n-- s3_uploader_max_parts_per_file, s3_uploader_max_filesize, s3_uploader_thread_limit\nCOPY table_name TO 's3://bucket/file.extension';\n\n-- SQLite\nCALL sqlite_attach('data.db');\nPRAGMA show_tables;\n\n-- PostgreSQL\n-- connect string\nCALL POSTGRES_ATTACH('');\nSELECT * FROM POSTGRES_SCAN('', 'public', 'mytable');\n\n-- CSV\nSELECT * FROM read_csv_auto('test.csv');\n-- HEADER=TRUE\n-- read_csv_auto -> read_csv(AUTO_DETECT=TRUE)\nSELECT * FROM read_csv_auto('test.csv', SAMPLE_SIZE=20000);\n-- \u5BFC\u5165\nCREATE TABLE ontime AS SELECT * FROM read_csv_auto('test.csv');\n-- \u4E5F\u53EF\u4EE5\u5148\u521B\u5EFA\u8868\u518D\u901A\u8FC7 COPY \u5BFC\u5165\nCOPY ontime FROM 'test.csv' ( DELIMITER '|', HEADER, AUTO_DETECT TRUE );\n\n-- PARQUET\nSELECT * FROM parquet_scan('test.parquet');\nSELECT * FROM 'test.parquet';\n-- \u591A\u6587\u4EF6\nSELECT * FROM parquet_scan('test/*.parquet');\n-- \u4E0D\u5BFC\u5165\u4F46\u4E5F\u63D0\u4F9B\u67E5\u8BE2\nCREATE VIEW people AS SELECT * FROM parquet_scan('test.parquet');\n-- \u5BFC\u5165\u5E26\u538B\u7F29\nCOPY tbl TO 'result-zstd.parquet' (FORMAT 'PARQUET', CODEC 'ZSTD')\n\n-- \u5BFC\u51FA\u8868 - \u53EF\u4EE5 FORMAT PARQUET\nCOPY lineitem TO 'lineitem.tbl' ( DELIMITER '|', HEADER );\nCOPY lineitem(l_orderkey) TO 'orderkey.tbl' ( DELIMITER '|' );\nCOPY (SELECT 42 AS a, 'hello' AS b) TO 'query.csv' WITH (HEADER 1, DELIMITER ',');\n\n-- \u5BFC\u51FA\u6570\u636E\u5E93\n-- \u5BFC\u51FA\u5230\u76EE\u5F55\nEXPORT DATABASE 'target_directory';\n-- \u5BFC\u51FA CSV\nEXPORT DATABASE 'target_directory' (FORMAT CSV, DELIMITER '|');\n-- \u5BFC\u51FA parquet \u683C\u5F0F\nEXPORT DATABASE 'target_directory' (FORMAT PARQUET);\n-- \u5BFC\u5165\nIMPORT DATABASE 'target_directory'\n"})}),"\n",(0,i.jsx)(e.h2,{id:"inspect",children:"Inspect"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"PRAGMA storage_info('table_name');\n\nSELECT * EXCLUDE (column_path, segment_id, start, stats, persistent, block_id, block_offset, has_updates)\nFROM pragma_storage_info('names') USING SAMPLE 10 ROWS\nORDER BY row_group_id;\n"})}),"\n",(0,i.jsx)(e.h2,{id:"extension",children:"extension"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"select * from duckdb_extensions();\n\ninstall 'fts';\nload 'fts';\n\n-- \u4E0B\u8F7D http://extensions.duckdb.org/v0.6.1/osx_amd64/httpfs.duckdb_extension.gz\n-- \u672C\u5730 ~/.duckdb/extensions/v0.6.1/osx_amd64/httpfs.duckdb_extension\ninstall 'httpfs';\nload 'httpfs';\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4E0D\u652F\u6301\u4EE3\u7406 ",(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb/issues/3836",children:"https://github.com/duckdb/duckdb/issues/3836"})]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"ver=$(duckdb -version | cut -d ' ' -f 1)\nmkdir -p ~/.duckdb/extensions/$ver/osx_amd64\ncd ~/.duckdb/extensions/$ver/osx_amd64\n\n# https://duckdb.org/docs/extensions/overview\nfor name in httpfs excel fts sqlite_scanner postgres_scanner json parquet jemalloc; do\n  [ -e $name.duckdb_extension ] && continue\n  echo Installing $name\n  curl -LO http://extensions.duckdb.org/$ver/osx_amd64/$name.duckdb_extension.gz\n  gzip -d $name.duckdb_extension.gz\ndone\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"load 'jemalloc';\nload 'json';\nload 'postgres_scanner';\nload 'sqlite_scanner';\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["sqlite_scanner\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"sqlite_attach('data.sqlite')"})," - \u521B\u5EFA view - \u53EA\u80FD\u67E5 ",(0,i.jsx)(e.strong,{children:"\u4E0D\u80FD\u5199"})]}),"\n",(0,i.jsxs)(e.li,{children:["sqlite_scan - ",(0,i.jsx)(e.code,{children:"SELECT * FROM sqlite_scan('data.sqlite', 'tab');"})," - \u76F4\u63A5\u67E5\u8BE2\u5355\u4E2A\u8868"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"wasm"}),"\n",(0,i.jsxs)(e.li,{children:["visualizer\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6D4B\u8BD5\u7ED3\u679C -> HTML"}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.code,{children:"pragma visualize_last_profiling_output('__TEST_DIR__/test.html')"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["sqlsmith\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"SQL \u751F\u6210\u5668\uFF0C\u7528\u4E8E\u6D4B\u8BD5"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"tpch"}),"\n",(0,i.jsx)(e.li,{children:"tpcds"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"settings",children:"Settings"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"name"}),(0,i.jsx)(e.th,{children:"value"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"memory_limit"}),(0,i.jsx)(e.td,{})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"threads"}),(0,i.jsx)(e.td,{})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"enable_progress_bar"}),(0,i.jsx)(e.td,{})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"default_null_order"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"nulls_last"})})]})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"SELECT current_setting('threads') AS threads;\n\nSELECT *\nFROM duckdb_settings()\nWHERE name = 'threads';\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://duckdb.org/docs/stable/configuration/overview",children:"https://duckdb.org/docs/stable/configuration/overview"})}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"nodejs",children:"NodeJS"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb-node-neo",children:"duckdb/duckdb-node-neo"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["npm:@duckdb/node-api\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u57FA\u4E8E @duckdb/node-bindings"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.li,{children:"\u76F4\u63A5\u4F7F\u7528 DuckDB C API, \u4E0D\u4F9D\u8D56 SQLite Node API"}),"\n",(0,i.jsx)(e.li,{children:"\u6570\u636E\u5904\u7406\u66F4\u9AD8\u6548"}),"\n",(0,i.jsx)(e.li,{children:"\u76F4\u63A5\u4F7F\u7528 DuckDB binaries \u800C\u4E0D\u662F\u91CD\u65B0\u6784\u5EFA"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb-node",children:"duckdb/duckdb-node"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"npm:duckdb"}),"\n",(0,i.jsx)(e.li,{children:"\u57FA\u4E8E SQLite Node API"}),"\n",(0,i.jsx)(e.li,{children:"\u4F7F\u7528\u7684\u91CD\u65B0\u6784\u5EFA\u7684 DuckDB"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-tsx",children:"import duckdb from '@duckdb/node-api';\nimport { test } from 'vitest';\n\ntest('duckdb info', async () => {\n  console.log(duckdb.version());\n  console.log(duckdb.configurationOptionDescriptions());\n});\n"})}),"\n",(0,i.jsx)(e.h2,{id:"version",children:"Version"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["1.2.0\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["prefix alias ",(0,i.jsx)(e.code,{children:"SELECT alias: column_name from t: table_name"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/duckdb/duckdb/pull/14436",children:"https://github.com/duckdb/duckdb/pull/14436"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["rename column ",(0,i.jsx)(e.code,{children:"SELECT * RENAME (a TO b)"})]}),"\n",(0,i.jsxs)(e.li,{children:["star LIKE ",(0,i.jsx)(e.code,{children:"SLEECT * LIKE '%_time'"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\u4E5F\u652F\u6301 ",(0,i.jsx)(e.code,{children:"SIMILAR TO"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["upsert 0.6.2\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u652F\u6301 insert or replace/ignore"}),"\n",(0,i.jsx)(e.li,{children:"\u652F\u6301 on conflict"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h1,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(e.h2,{id:"duckdb-vs-sqlite3",children:"duckdb vs SQLite3"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"-"}),(0,i.jsx)(e.th,{children:"duckdb"}),(0,i.jsx)(e.th,{children:"SQLite"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Since"}),(0,i.jsx)(e.td,{children:"2018"}),(0,i.jsx)(e.td,{children:"2000-08-17"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u67B6\u6784"}),(0,i.jsx)(e.td,{children:"\u5217\u5B58"}),(0,i.jsx)(e.td,{children:"\u884C\u5B58"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u573A\u666F"}),(0,i.jsx)(e.td,{children:"OLAP"}),(0,i.jsx)(e.td,{children:"OLTP"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u8BED\u8A00"}),(0,i.jsx)(e.td,{children:"C++"}),(0,i.jsx)(e.td,{children:"C"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u591A\u7EBF\u7A0B\u8BBF\u95EE"}),(0,i.jsx)(e.td,{children:"\u274C"}),(0,i.jsx)(e.td,{children:"\u2705"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u751F\u6001"}),(0,i.jsx)(e.td,{children:"\u2B50\uFE0F"}),(0,i.jsx)(e.td,{children:"\u2B50\uFE0F\u2B50\uFE0F\u2B50\uFE0F"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6210\u719F"}),(0,i.jsx)(e.td,{children:"\u2B50\uFE0F"}),(0,i.jsx)(e.td,{children:"\u2B50\uFE0F\u2B50\uFE0F\u2B50\uFE0F"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5E76\u53D1"}),(0,i.jsx)(e.td,{children:"MVCC"}),(0,i.jsx)(e.td,{children:"fs lock"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Native JSON"}),(0,i.jsx)(e.td,{children:"\u2705"}),(0,i.jsx)(e.td,{children:"\u274C"})]})]})]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://duckdb.org/why_duckdb.html",children:"https://duckdb.org/why_duckdb.html"})}),"\n"]})]})}function o(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},17776:function(n,e,s){s.d(e,{R:()=>l,x:()=>c});var d=s(7378);let i={},t=d.createContext(i);function l(n){let e=d.useContext(t);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),d.createElement(t.Provider,{value:e},n.children)}}}]);