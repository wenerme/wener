"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["863883"],{367605:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>l,toc:()=>d,default:()=>c,metadata:()=>t,assets:()=>o,contentTitle:()=>s});var t=JSON.parse('{"id":"os/ubuntu/README","title":"Ubuntu Server Guide","description":"ubuntu-server-guide}","source":"@site/../notes/os/ubuntu/README.md","sourceDirName":"os/ubuntu","slug":"/os/ubuntu/","permalink":"/notes/os/ubuntu/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/ubuntu/README.md","tags":[{"inline":true,"label":"Linux","permalink":"/notes/tags/linux"},{"inline":true,"label":"Ubuntu","permalink":"/notes/tags/ubuntu"},{"inline":true,"label":"Server","permalink":"/notes/tags/server"},{"inline":true,"label":"Installation","permalink":"/notes/tags/installation"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"Ubuntu Server Guide","tags":["Linux","Ubuntu","Server","Installation"]},"sidebar":"docs","previous":{"title":"Synology","permalink":"/notes/os/synology"},"next":{"title":"Netplan Network Configuration","permalink":"/notes/os/ubuntu/netplan"}}'),a=i(486106),r=i(917776);let l={title:"Ubuntu Server Guide",tags:["Linux","Ubuntu","Server","Installation"]},s="Ubuntu Server Guide {#ubuntu-server-guide}",o={},d=[{value:"Installation &amp; Setup",id:"installation-setup",level:2},{value:"Nvidia GPU Driver",id:"nvidia-gpu-driver",level:2},{value:"Disable Nouveau",id:"disable-nouveau",level:3},{value:"Nvidia cuDNN",id:"nvidia-cudnn",level:2},{value:"Python Check Script",id:"python-check-script",level:3},{value:"Docker",id:"docker",level:2},{value:"Custom Data Root",id:"custom-data-root",level:3},{value:"Nvidia Container Toolkit",id:"nvidia-container-toolkit",level:2},{value:"AI Models (Ollama &amp; vLLM)",id:"ai-models-ollama--vllm",level:3}];function u(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"ubuntu-server-guide",children:"Ubuntu Server Guide"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Downloads: ",(0,a.jsx)(n.a,{href:"https://ubuntu.com/download/server",children:"Ubuntu Server"})]}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"http://mirrors.aliyun.com/ubuntu-releases/",children:"Ubuntu Releases Mirror (Aliyun)"})}),"\n",(0,a.jsxs)(n.li,{children:["Kernel:\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://wiki.ubuntu.com/Kernel/LTSEnablementStack",children:"HWE Kernel"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://wiki.ubuntu.com/Kernel",children:"Ubuntu Kernel Team"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"installation-setup",children:"Installation & Setup"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Download & Verify\ncurl -LO https://releases.ubuntu.com/24.04.2/ubuntu-24.04.2-live-server-amd64.iso\n\n# Make Live USB\ndd if=./ubuntu-24.04.2-live-server-amd64.iso of=/dev/rdisk6 status=progress bs=4M\n\n# QEMU Test\nqemu-system-x86_64 -m 8g -smp 4 -hda /dev/rdisk6 -cdrom ./ubuntu-24.04.2-live-server-amd64.iso \\\n  -net nic,model=virtio,mac=52:54:00:12:34:56 -net user,hostfwd=tcp::2222-:22 -boot d\n\n# Post-Install Tools\napt install -y btop build-essential curl dialog git htop iotop iputils-ping jq lsof nano pip pipx python3 python3-pip sysstat wget tree\n\n# fastfetch\ncurl -LO https://github.com/fastfetch-cli/fastfetch/releases/download/2.43.0/fastfetch-linux-amd64.deb\ndpkg -i fastfetch-linux-amd64.deb\n\n# Check UEFI SecureBoot\nbootctl status | grep SecureBoot\n\n# Check Firewall\nsudo ufw status\n"})}),"\n",(0,a.jsx)(n.h2,{id:"nvidia-gpu-driver",children:"Nvidia GPU Driver"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"nvidia-headless-no-dkms-XXX-server"}),": For headless servers (no X11/Wayland)."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Tools\napt install -y nvtop\ncat /proc/driver/nvidia/version\nnvidia-smi\n\n# Check Hardware\nlspci | grep -i nvidia\nlspci -v | grep -A 7 NVIDIA\n\n# Recommended Drivers\nubuntu-drivers list\nubuntu-drivers list --gpgpu\nubuntu-drivers install --gpgpu\n\n# Manual Install\napt install nvidia-driver-570-server\n\n# Logs\ndmesg | grep -i nvidia\njournalctl -b 0 -k | grep -i nvidia\n"})}),"\n",(0,a.jsx)(n.h3,{id:"disable-nouveau",children:"Disable Nouveau"}),"\n",(0,a.jsxs)(n.p,{children:["File: ",(0,a.jsx)(n.code,{children:"/etc/modprobe.d/blacklist-nouveau.conf"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-modconf",children:"blacklist nouveau\noptions nouveau modeset=0\n"})}),"\n",(0,a.jsx)(n.p,{children:"Apply:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo update-initramfs -u\nsudo reboot\n"})}),"\n",(0,a.jsx)(n.h2,{id:"nvidia-cudnn",children:"Nvidia cuDNN"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://docs.nvidia.com/cuda/cuda-installation-guide-linux/#network-repo-installation-for-ubuntu",children:"Installation Guide"})}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Add Repo (Ubuntu 22.04 LTS)\nwget https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64/cuda-keyring_1.1-1_all.deb\nsudo dpkg -i cuda-keyring_1.1-1_all.deb\nsudo apt update\n\n# Install\napt install libcudnn9-cuda-12\n\n# Verification\nnvcc --version\nnvidia-smi\napt list --installed | grep -i cuda\n"})}),"\n",(0,a.jsx)(n.h3,{id:"python-check-script",children:"Python Check Script"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",metastring:'title="check_cuda.py"',children:'import torch\n\nprint(f"PyTorch Version: {torch.__version__}")\nis_cuda_available = torch.cuda.is_available()\nprint(f"CUDA Available: {is_cuda_available}")\n\nif is_cuda_available:\n    print(f"PyTorch CUDA Version: {torch.version.cuda}")\n    print(f"GPU Name: {torch.cuda.get_device_name(0)}")\n    print(f"GPU Compute Capability: {torch.cuda.get_device_capability(0)}")\nelse:\n    print("CUDA is not available.")\n'})}),"\n",(0,a.jsx)(n.h2,{id:"docker",children:"Docker"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://download.docker.com/linux/ubuntu/",children:"Docker CE for Ubuntu"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://mirrors.aliyun.com/docker-ce/linux/ubuntu/",children:"Mirror (Aliyun)"})}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'# Install\nsudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n\necho "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(. /etc/os-release && echo "$VERSION_CODENAME") stable" \\\n  | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\nsudo apt-get update\n\nsudo apt-get -y install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# User Group\nsudo usermod -aG docker $USER\nnewgrp docker\n'})}),"\n",(0,a.jsx)(n.h3,{id:"custom-data-root",children:"Custom Data Root"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"sudo rsync -aqxP /var/lib/docker/ /data/docker/\n"})}),"\n",(0,a.jsxs)(n.p,{children:["File: ",(0,a.jsx)(n.code,{children:"/etc/docker/daemon.json"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "data-root": "/data/docker"\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"nvidia-container-toolkit",children:"Nvidia Container Toolkit"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/NVIDIA/nvidia-container-toolkit",children:"nvidia-container-toolkit"})}),"\n",(0,a.jsxs)(n.li,{children:["Mirrors: ",(0,a.jsx)(n.a,{href:"https://mirrors.ustc.edu.cn/libnvidia-container/",children:"USTC"})]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Install (using USTC mirror)\ncurl -fsSL https://mirrors.ustc.edu.cn/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \\\n  && curl -s -L https://mirrors.ustc.edu.cn/libnvidia-container/stable/deb/nvidia-container-toolkit.list \\\n  | sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' \\\n    | sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list\n\napt update\napt install -y nvidia-container-toolkit\n\n# Configure Docker\nsudo nvidia-ctk runtime configure --runtime=docker\nsystemctl restart docker\n\n# Test\ndocker run --rm -it --gpus all docker.m.daocloud.io/nvidia/cuda:12.9.0-base-ubuntu24.04 nvidia-smi\n"})}),"\n",(0,a.jsx)(n.h3,{id:"ai-models-ollama--vllm",children:"AI Models (Ollama & vLLM)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# Ollama\ndocker run --rm -it --gpus all \\\n  -v /data/home/.ollama/:/root/.ollama/ \\\n  -p 11434:11434 \\\n  -e OLLAMA_CONTEXT_LENGTH=8192 \\\n  -e OLLAMA_FLASH_ATTENTION=1 \\\n  -e OLLAMA_KV_CACHE_TYPE=q4_0 \\\n  --name ollama docker.m.daocloud.io/ollama/ollama:0.7.1\n\n# vLLM\ndocker run --rm -it --gpus all \\\n  --runtime nvidia \\\n  -p 8080:8080 \\\n  --ipc=host \\\n  -v /data/home/.cache/huggingface:/root/.cache/huggingface \\\n  --entrypoint bash \\\n  --name vllm docker.m.daocloud.io/vllm/vllm-openai:v0.8.5\n"})})]})}function c(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},917776:function(e,n,i){i.d(n,{R:()=>l,x:()=>s});var t=i(7378);let a={},r=t.createContext(a);function l(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);