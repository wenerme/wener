"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["447572"],{623550:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>r,toc:()=>u,default:()=>p,metadata:()=>s,assets:()=>o,contentTitle:()=>l});var s=JSON.parse('{"id":"os/alpine/alpine-manual","title":"Alpine QEMU Manual","description":"\u4F7F\u7528 Qemu \u5236\u4F5C\u542F\u52A8\u76D8","source":"@site/../notes/os/alpine/alpine-manual.md","sourceDirName":"os/alpine","slug":"/os/alpine/manual","permalink":"/notes/os/alpine/manual","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/alpine/alpine-manual.md","tags":[{"inline":true,"label":"OS","permalink":"/notes/tags/os"},{"inline":true,"label":"Alpine","permalink":"/notes/tags/alpine"},{"inline":true,"label":"QEMU","permalink":"/notes/tags/qemu"},{"inline":true,"label":"Manual","permalink":"/notes/tags/manual"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"Alpine QEMU Manual","tags":["OS","Alpine","QEMU","Manual"]},"sidebar":"docs","previous":{"title":"Alpine local backup","permalink":"/notes/os/alpine/lbu"},"next":{"title":"Alpine Hardware Operation","permalink":"/notes/os/alpine/ops-hw"}}'),a=t(486106),i=t(917776);let r={title:"Alpine QEMU Manual",tags:["OS","Alpine","QEMU","Manual"]},l="Qemu Manual",o={},u=[{value:"\u4F7F\u7528 Qemu \u5236\u4F5C\u542F\u52A8\u76D8",id:"\u4F7F\u7528-qemu-\u5236\u4F5C\u542F\u52A8\u76D8",level:2},{value:"Qemu UEFI",id:"qemu-uefi",level:2},{value:"Qemu GPT",id:"qemu-gpt",level:2},{value:"chroot",id:"chroot",level:2}];function d(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"qemu-manual",children:"Qemu Manual"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4F7F\u7528-qemu-\u5236\u4F5C\u542F\u52A8\u76D8",children:"\u4F7F\u7528 Qemu \u5236\u4F5C\u542F\u52A8\u76D8"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u5BBF\u4E3B\u673A\u4E0A\u64CD\u4F5C\n# ==========\n# \u521B\u5EFA\u78C1\u76D8\u5E76\u4ECE cd \u542F\u52A8, \u6620\u5C04\u865A\u62DF\u673A 22 \u5230\u672C\u5730 2222 \u7AEF\u53E3, \u9ED8\u8BA4\u8D26\u53F7 root\nqemu-img create -f raw alp-x86.raw 1g\n# \u5BC6\u7801 root\n# -m 1g \u9ED8\u8BA4\u5185\u5B58\u8FC7\u4F4E, \u5B89\u88C5\u65F6\u53EF\u80FD\u51FA\u73B0\u5185\u5B58\u4E0D\u591F\n# mac \u53EF\u6DFB\u52A0 -accel hvf \u8FDB\u884C\u52A0\u901F\nqemu-system-x86_64 -m 1g -hda alp-x86.raw -net nic -net user,hostfwd=tcp::2222-:22 -cdrom alpine-extended-3.8.0-x86_64.iso -boot d\n\n# \u865A\u62DF\u673A\u64CD\u4F5C\n# ==========\n# \u8BBE\u7F6E\u7F51\u7EDC, \u9ED8\u8BA4\u5373\u53EF\nsetup-interfaces\nrc-service networking restart\n# \u8BBE\u7F6E sshd, \u5141\u8BB8 root \u8FDC\u7A0B\u767B\u9646, \u5E76\u4E3A root \u8BBE\u7F6E\u5BC6\u7801\nsetup-sshd -c openssh\necho 'PermitRootLogin yes' >> /etc/ssh/sshd_config\necho root:root | chpasswd\nrc-service sshd restart\n\n# \u5BBF\u4E3B\u673A\u64CD\u4F5C\n# ==========\n# \u8FDC\u7A0B\u767B\u9646\u5230\u865A\u62DF\u673A\u4E2D\nssh-keygen -R [127.0.0.1]:2222\nssh root@127.0.0.1 -p 2222\n\n# \u8BBE\u7F6E\u4ED3\u5E93\u955C\u50CF, \u66F4\u65B0\u7D22\u5F15\necho \"http://mirrors.aliyun.com/alpine/v$(head -c3 /etc/alpine-release)/main\nhttp://mirrors.aliyun.com/alpine/v$(head -c3 /etc/alpine-release)/community\" >> /etc/apk/repositories\napk update\n\n# \u5B89\u88C5\u5230\u521B\u5EFA\u7684\u786C\u76D8\n# -m sys \u5B89\u88C5\u4E3A\u672C\u5730\u78C1\u76D8, \u53EF\u6307\u5B9A data, sys\n# -s 0 \u4E0D\u542F\u7528\u4EA4\u6362\u533A\n# -k hardened \u5185\u6838\u98CE\u683C, \u53EF\u6307\u5B9A hardened(\u9ED8\u8BA4), virthardened, virt, vanilla\n# -L \u4F7F\u7528 LVM\n# \u73AF\u5883\u53D8\u91CF\n# BOOT_SIZE=100m \u542F\u52A8\u5206\u533A\u5927\u5C0F, \u9ED8\u8BA4 100m, \u5B9E\u9645\u5B89\u88C5\u53EA\u4F1A\u5360\u7528 20m \u5DE6\u53F3\n# BOOTLOADER=syslinux \u53EF\u9009\u62E9 syslinux, grub\n# BOOTFS, ROOTFS, VARFS \u6307\u5B9A\u4E0D\u540C\u5206\u533A\u6587\u4EF6\u7CFB\u7EDF,\u53EF\u9009\u62E9 ext2, ext3, ext4(\u9ED8\u8BA4), btrfs, xfs, vfat(EFI,\u53EA\u7528\u4E8E boot)\n# ERASE_DISKS=/dev/sda \u8FD9\u6837\u53EF\u4EE5\u4E0D\u8BE2\u95EE\u662F\u5426\u64E6\u9664\u78C1\u76D8\n# \u4F8B\u5982\n# BOOT_SIZE=50m setup-disk -m sys -k hardened -s 0 /dev/sda\nERASE_DISKS=/dev/sda setup-disk -m sys -s 0 /dev/sda\n# \u5B89\u88C5\u5B8C\u6210\u5173\u673A\npoweroff\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u955C\u50CF\u5236\u4F5C\u5B8C\u6210,\u53EF\u76F4\u63A5\u5B89\u88C5\u5230 usb"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# macOS \u5B89\u88C5\u5230 U \u76D8\ndiskutils unmountDisk disk2\nsudo dd if=alp-x86.raw of=/dev/rdisk2 status=progress bs=16M\n\n# \u53EF\u4EE5\u505A\u4E2A\u5907\u4EFD\u4EE5\u4FBF\u4E8E\u4EE5\u540E\u4F7F\u7528\n# gzip -k alp-x86.raw\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# \u5B89\u88C5\u5B8C\u6210\u540E\u5173\u673A, \u4ECE\u65B0\u7684\u78C1\u76D8\u542F\u52A8\nqemu-system-x86_64 -hda alp-x86.raw -net nic -net user,hostfwd=tcp::2222-:22\n\n# \u865A\u62DF\u673A\u64CD\u4F5C\n# ==========\n# \u8BBE\u7F6E\u7F51\u7EDC, \u9ED8\u8BA4\u5373\u53EF\nsetup-interfaces\nrc-service networking restart\n\n# \u5BBF\u4E3B\u673A\u64CD\u4F5C\n# ==========\n# \u8FDC\u7A0B\u767B\u9646\u5230\u865A\u62DF\u673A\u4E2D\nssh root@127.0.0.1 -p 2222\n\n# \u5E38\u7528\u7684\u521D\u59CB\u5316\u8BBE\u7F6E\nsetup-ntp -c busybox\nsetup-timezone -z Asia/Shanghai\nsetup-keymap us us\n\n# \u5E38\u7528\u7684\u5305\napk add --no-cache util-linux e2fsprogs-extra nano curl\n# \u5220\u9664\u547D\u4EE4\u884C\u64CD\u4F5C\u8BB0\u5F55\nrm ~/.ash_history\n\n# \u81F3\u6B64\u8BE5\u955C\u50CF\u5373\u53EF\u4F5C\u4E3A\u6807\u51C6\u7CFB\u7EDF\u57FA\u7840\u8FDB\u884C\u4F7F\u7528\u4E86\n"})}),"\n",(0,a.jsx)(n.h2,{id:"qemu-uefi",children:"Qemu UEFI"}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.a,{href:"https://wiki.alpinelinux.org/wiki/Create_UEFI_boot_USB",children:"https://wiki.alpinelinux.org/wiki/Create_UEFI_boot_USB"})}),"\n",(0,a.jsx)(n.h2,{id:"qemu-gpt",children:"Qemu GPT"}),"\n",(0,a.jsx)(n.h2,{id:"chroot",children:"chroot"})]})}function p(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},917776:function(e,n,t){t.d(n,{R:()=>r,x:()=>l});var s=t(7378);let a={},i=s.createContext(a);function r(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);