"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["81689"],{451405:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>s,toc:()=>c,default:()=>d,metadata:()=>o,assets:()=>l,contentTitle:()=>r});var o=JSON.parse('{"id":"voip/asterisk/asterisk-extension","title":"Asterisk Extensions","description":"\u9759\u6001\u62E8\u53F7\u914D\u7F6E\uFF0C pbx_config \u4F1A\u4F7F\u7528\u3002\u901A\u8FC7 dialplan reload \u548C reload \u8FDB\u884C\u91CD\u8F7D\u3002","source":"@site/../notes/voip/asterisk/asterisk-extension.md","sourceDirName":"voip/asterisk","slug":"/voip/asterisk/extension","permalink":"/notes/voip/asterisk/extension","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/voip/asterisk/asterisk-extension.md","tags":[{"inline":true,"label":"Asterisk","permalink":"/notes/tags/asterisk"},{"inline":true,"label":"Conf","permalink":"/notes/tags/conf"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"Asterisk Extensions","tags":["Asterisk","Conf"]},"sidebar":"docs","previous":{"title":"\u62E8\u53F7\u8BA1\u5212","permalink":"/notes/voip/asterisk/dialplain"},"next":{"title":"\u5E38\u89C1\u95EE\u9898","permalink":"/notes/voip/asterisk/faq"}}'),a=t(486106),i=t(917776);let s={title:"Asterisk Extensions",tags:["Asterisk","Conf"]},r="Asterisk Extensions",l={},c=[];function u(e){let n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"asterisk-extensions",children:"Asterisk Extensions"})}),"\n",(0,a.jsxs)(n.p,{children:["\u9759\u6001\u62E8\u53F7\u914D\u7F6E\uFF0C ",(0,a.jsx)(n.code,{children:"pbx_config"})," \u4F1A\u4F7F\u7528\u3002\u901A\u8FC7 ",(0,a.jsx)(n.code,{children:"dialplan reload"})," \u548C ",(0,a.jsx)(n.code,{children:"reload"})," \u8FDB\u884C\u91CD\u8F7D\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-conf",children:'[general]\n; \u5982\u679C\u8BBE\u7F6E\u4E3A no \u6216\u6CA1\u6709\uFF0Cpbx_config \u53EF\u80FD\u4F1A\u91CD\u5199\u8BE5\u6587\u4EF6\u3002\nstatic=yes\n\n; \u5982\u679C static=yes \u4E14 writeprotect=no \u5219\u53EF\u901A\u8FC7 dialplan save \u4FDD\u5B58\nwriteprotect=no\n\n; \u81EA\u52A8\u8FDB\u5165\u4E0B\u4E00\u4E2A\n; \u5982\u679C\u8BBE\u7F6E\u4E86\uFF0C\u5728\u8FD0\u884C\u5B8C\u540E\u4F1A\u901A\u8FC7 BUSY, CONGESTION \u6216 HANGUP \u6765\u7EC8\u6B62\u3002\n; \u5982\u679C\u6CA1\u6709\u8BBE\u7F6E\u5728\u8FD0\u884C\u5B8C\u540E\u4F1A\u7EE7\u7EED\u7B49\u5F85\u65B0\u7684\u6307\u4EE4\u8F93\u5165\u3002\n;autofallthrough=no\n;\n;\n;\n; If extenpatternmatchnew is set (true, yes, etc), then a new algorithm that uses\n; a Trie to find the best matching pattern is used. In dialplans\n; with more than about 20-40 extensions in a single context, this\n; new algorithm can provide a noticeable speedup.\n; With 50 extensions, the speedup is 1.32x\n; with 88 extensions, the speedup is 2.23x\n; with 138 extensions, the speedup is 3.44x\n; with 238 extensions, the speedup is 5.8x\n; with 438 extensions, the speedup is 10.4x\n; With 1000 extensions, the speedup is ~25x\n; with 10,000 extensions, the speedup is 374x\n; Basically, the new algorithm provides a flat response\n; time, no matter the number of extensions.\n;\n; By default, the old pattern matcher is used.\n;\n; ****This is a new feature! *********************\n; The new pattern matcher is for the brave, the bold, and\n; the desperate. If you have large dialplans (more than about 50 extensions\n; in a context), and/or high call volume, you might consider setting\n; this value to "yes" !!\n; Please, if you try this out, and are forced to return to the\n; old pattern matcher, please report your reasons in a bug report\n; on https://issues.asterisk.org. We have made good progress in providing\n; something compatible with the old matcher; help us finish the job!\n;\n; This value can be switched at runtime using the cli command "dialplan set extenpatternmatchnew true"\n; or "dialplan set extenpatternmatchnew false", so you can experiment to your hearts content.\n;\n;extenpatternmatchnew=no\n; \u6E05\u9664\u5168\u5C40\u53D8\u91CF\n; \u5168\u5C40\u53D8\u91CF\u4F1A\u5728 dialplan reload \u6216 reload \u88AB\u6E05\u9664\n; ael \u4E2D\u7684\u53D8\u91CF\u8FD8\u662F\u4F1A\u88AB\u6E05\u9664\nclearglobalvars=no\n\n; \u901A\u8FC7 users.conf \u6CE8\u518C\u8FDB\u5165\u7684\u4E0A\u4E0B\u6587\n;userscontext=default\n\n\n; \u5168\u5C40\u53D8\u91CF - \u4F7F\u7528\u65B9\u5F0F\n; ${GLOBAL(VARIABLE)}\n; ${${GLOBAL(VARIABLE)}}\n; ${text${GLOBAL(VARIABLE)}}\n; \u4F7F\u7528\u73AF\u5883\u53D8\u91CF\n; ${ENV(VARIABLE)}\n[globals]\nTRUNK=DAHDI/G2					; Trunk interface\n;\n; Note the \'G2\' in the TRUNK variable above. It specifies which group (defined\n; in chan_dahdi.conf) to dial, i.e. group 2, and how to choose a channel to use\n; in the specified group. The four possible options are:\n;\n; g: select the lowest-numbered non-busy DAHDI channel\n;    (aka. ascending sequential hunt group).\n; G: select the highest-numbered non-busy DAHDI channel\n;    (aka. descending sequential hunt group).\n; r: use a round-robin search, starting at the next highest channel than last\n;    time (aka. ascending rotary hunt group).\n; R: use a round-robin search, starting at the next lowest channel than last\n;    time (aka. descending rotary hunt group).\n;\nTRUNKMSD=1					; MSD digits to strip (usually 1 or 0)\n;TRUNK=IAX2/user:pass@provider\n\n;FREENUMDOMAIN=mydomain.com                     ; domain to send on outbound\n                                                ; freenum calls (uses outbound-freenum\n                                                ; context)\n\n;\n; WARNING WARNING WARNING WARNING\n; If you load any other extension configuration engine, such as pbx_ael.so,\n; your global variables may be overridden by that file.  Please take care to\n; use only one location to set global variables, and you will likely save\n; yourself a ton of grief.\n; WARNING WARNING WARNING WARNING\n;\n; Any category other than "General" and "Globals" represent\n; extension contexts, which are collections of extensions.\n;\n; Extension names may be numbers, letters, or combinations\n; thereof. If an extension name is prefixed by a \'_\'\n; character, it is interpreted as a pattern rather than a\n; literal.  In patterns, some characters have special meanings:\n;\n;   X - any digit from 0-9\n;   Z - any digit from 1-9\n;   N - any digit from 2-9\n;   [1235-9] - any digit in the brackets (in this example, 1,2,3,5,6,7,8,9)\n;   . - wildcard, matches anything remaining (e.g. _9011. matches\n;	anything starting with 9011 excluding 9011 itself)\n;   ! - wildcard, causes the matching process to complete as soon as\n;       it can unambiguously determine that no other matches are possible\n;\n; For example, the extension _NXXXXXX would match normal 7 digit dialings,\n; while _1NXXNXXXXXX would represent an area code plus phone number\n; preceded by a one.\n;\n; Each step of an extension is ordered by priority, which must always start\n; with 1 to be considered a valid extension.  The priority "next" or "n" means\n; the previous priority plus one, regardless of whether the previous priority\n; was associated with the current extension or not.  The priority "same" or "s"\n; means the same as the previously specified priority, again regardless of\n; whether the previous entry was for the same extension.  Priorities may be\n; immediately followed by a plus sign and another integer to add that amount\n; (most useful with \'s\' or \'n\').  Priorities may then also have an alias, or\n; label, in parentheses after their name which can be used in goto situations.\n;\n; Contexts contain several lines, one for each step of each extension.  One may\n; include another context in the current one as well, optionally with a date\n; and time.  Included contexts are included in the order they are listed.\n; Switches may also be included within a context.  The order of matching within\n; a context is always exact extensions, pattern match extensions, includes, and\n; switches.  Includes are always processed depth-first.  So for example, if you\n; would like a switch "A" to match before context "B", simply put switch "A" in\n; an included context "C", where "C" is included in your original context\n; before "B".\n;\n;[context]\n;\n;autohints = yes\n; If enabled for a context, a device state hint will be automatically created in\n; the context with the name of the device and updated with device state changes.\n;\n;exten => someexten,{priority|label{+|-}offset}[(alias)],application(arg1,arg2,...)\n;\n; Timing list for includes is\n;\n;   <time range>,<days of week>,<days of month>,<months>[,<timezone>]\n;\n; Note that ranges may be specified to wrap around the ends.  Also, minutes are\n; fine-grained only down to the closest even minute.\n;\n;include => daytime,9:00-17:00,mon-fri,*,*\n;include => weekend,*,sat-sun,*,*\n;include => weeknights,17:02-8:58,mon-fri,*,*\n;\n; ignorepat can be used to instruct drivers to not cancel dialtone upon receipt\n; of a particular pattern.  The most commonly used example is of course \'9\'\n; like this:\n;\n;ignorepat => 9\n;\n; so that dialtone remains even after dialing a 9.  Please note that ignorepat\n; only works with channels which receive dialtone from the PBX, such as DAHDI,\n; Phone, and VPB.  Other channels, such as SIP and MGCP, which generate their\n; own dialtone and converse with the PBX only after a number is complete, are\n; generally unaffected by ignorepat (unless DISA or another method is used to\n; generate a dialtone after answering the channel).\n;\n\n;\n; Sample entries for extensions.conf\n;\n;\n[dundi-e164-canonical]\n;include => stdexten\n;\n; List canonical entries here\n;\n;exten => 12564286000,1,Gosub(6000,stdexten(IAX2/foo))\n;exten => 12564286000,n,Goto(default,s,1)	; exited Voicemail\n;exten => _125642860XX,1,Dial(IAX2/otherbox/${EXTEN:7})\n\n[dundi-e164-customers]\n;\n; If you are an ITSP or Reseller, list your customers here.\n;\n;exten => _12564286000,1,Dial(SIP/customer1)\n;exten => _12564286001,1,Dial(IAX2/customer2)\n\n[dundi-e164-via-pstn]\n;\n; If you are freely delivering calls to the PSTN, list them here\n;\n;exten => _1256428XXXX,1,Dial(DAHDI/G2/${EXTEN:7}) ; Expose all of 256-428\n;exten => _1256325XXXX,1,Dial(DAHDI/G2/${EXTEN:7}) ; Ditto for 256-325\n\n[dundi-e164-local]\n;\n; Context to put your dundi IAX2 or SIP user in for\n; full access\n;\ninclude => dundi-e164-canonical\ninclude => dundi-e164-customers\ninclude => dundi-e164-via-pstn\n\n[dundi-e164-switch]\n;\n; Just a wrapper for the switch\n;\nswitch => DUNDi/e164\n\n[dundi-e164-lookup]\n;\n; Locally to lookup, try looking for a local E.164 solution\n; then try DUNDi if we don\'t have one.\n;\ninclude => dundi-e164-local\ninclude => dundi-e164-switch\n;\n; DUNDi can also be implemented as a Macro instead of using\n; the Local channel driver.\n;\n[macro-dundi-e164]\n;\n; ARG1 is the extension to Dial\n;\n; Extension "s" is not a wildcard extension that matches "anything".\n; In macros, it is the start extension. In most other cases,\n; you have to goto "s" to execute that extension.\n;\n; Note: In old versions of Asterisk the PBX in some cases defaulted to\n; extension "s" when a given extension was wrong (like in AMI originate).\n; This is no longer the case.\n;\n; For wildcard matches, see above - all pattern matches start with\n; an underscore.\nexten => s,1,Goto(${ARG1},1)\ninclude => dundi-e164-lookup\n\n;\n; Here are the entries you need to participate in the IAXTEL\n; call routing system.  Most IAXTEL numbers begin with 1-700, but\n; there are exceptions.  For more information, and to sign\n; up, please go to www.gnophone.com or www.iaxtel.com\n;\n[iaxtel700]\nexten => _91700XXXXXXX,1,Dial(IAX2/${GLOBAL(IAXINFO)}@iaxtel.com/${EXTEN:1}@iaxtel)\n\n;\n; The SWITCH statement permits a server to share the dialplan with\n; another server. Use with care: Reciprocal switch statements are not\n; allowed (e.g. both A -> B and B -> A), and the switched server needs\n; to be on-line or else dialing can be severly delayed.\n;\n[iaxprovider]\n;switch => IAX2/user:[key]@myserver/mycontext\n\n[trunkint]\n;\n; International long distance through trunk\n;\nexten => _9011.,1,Macro(dundi-e164,${EXTEN:4})\nexten => _9011.,n,Dial(${GLOBAL(TRUNK)}/${FILTER(0-9,${EXTEN:${GLOBAL(TRUNKMSD)}})})\n\n[trunkld]\n;\n; Long distance context accessed through trunk\n;\nexten => _91NXXNXXXXXX,1,Macro(dundi-e164,${EXTEN:1})\nexten => _91NXXNXXXXXX,n,Dial(${GLOBAL(TRUNK)}/${EXTEN:${GLOBAL(TRUNKMSD)}})\n\n[trunklocal]\n;\n; Local seven-digit dialing accessed through trunk interface\n;\nexten => _9NXXXXXX,1,Dial(${GLOBAL(TRUNK)}/${EXTEN:${GLOBAL(TRUNKMSD)}})\n\n[trunktollfree]\n;\n; Long distance context accessed through trunk interface\n;\nexten => _91800NXXXXXX,1,Dial(${GLOBAL(TRUNK)}/${EXTEN:${GLOBAL(TRUNKMSD)}})\nexten => _91888NXXXXXX,1,Dial(${GLOBAL(TRUNK)}/${EXTEN:${GLOBAL(TRUNKMSD)}})\nexten => _91877NXXXXXX,1,Dial(${GLOBAL(TRUNK)}/${EXTEN:${GLOBAL(TRUNKMSD)}})\nexten => _91866NXXXXXX,1,Dial(${GLOBAL(TRUNK)}/${EXTEN:${GLOBAL(TRUNKMSD)}})\n\n[international]\n;\n; Master context for international long distance\n;\nignorepat => 9\ninclude => longdistance\ninclude => trunkint\n\n[longdistance]\n;\n; Master context for long distance\n;\nignorepat => 9\ninclude => local\ninclude => trunkld\n\n[local]\n;\n; Master context for local, toll-free, and iaxtel calls only\n;\nignorepat => 9\ninclude => default\ninclude => trunklocal\ninclude => iaxtel700\ninclude => trunktollfree\ninclude => iaxprovider\n\n;Include parkedcalls (or the context you define in features conf)\n;to enable call parking.\ninclude => parkedcalls\n;\n; You can use an alternative switch type as well, to resolve\n; extensions that are not known here, for example with remote\n; IAX switching you transparently get access to the remote\n; Asterisk PBX\n;\n; switch => IAX2/user:password@bigserver/local\n;\n; An "lswitch" is like a switch but is literal, in that\n; variable substitution is not performed at load time\n; but is passed to the switch directly (presumably to\n; be substituted in the switch routine itself)\n;\n; lswitch => Loopback/12${EXTEN}@othercontext\n;\n; An "eswitch" is like a switch but the evaluation of\n; variable substitution is performed at runtime before\n; being passed to the switch routine.\n;\n; eswitch => IAX2/context@${CURSERVER}\n\n; The following two contexts are a template to enable the ability to dial\n; ISN numbers. For more information about what an ISN number is, please see\n; http://www.freenum.org.\n;\n; This is the dialing hook.  use:\n; include => outbound-freenum\n\n[outbound-freenum]\n; We\'ll add more digits as needed. The purpose is to dial things\n; like extension numbers at domains (ITAD number) so we\'re matching\n; on lengths of 1 through 6 prior to the separator (the asterisk [*])\n;\nexten => _X*X!,1,Goto(outbound-freenum2,${EXTEN},1)\nexten => _XX*X!,1,Goto(outbound-freenum2,${EXTEN},1)\nexten => _XXX*X!,1,Goto(outbound-freenum2,${EXTEN},1)\nexten => _XXXX*X!,1,Goto(outbound-freenum2,${EXTEN},1)\nexten => _XXXXX*X!,1,Goto(outbound-freenum2,${EXTEN},1)\nexten => _XXXXXX*X!,1,Goto(outbound-freenum2,${EXTEN},1)\n\n[outbound-freenum2]\n; This is the handler which performs the dialing logic. It is called\n; from the [outbound-freenum] context\n;\nexten => _X!,1,Verbose(2,Performing ISN lookup for ${EXTEN})\nsame => n,Set(SUFFIX=${CUT(EXTEN,*,2-)})                                ; make sure the suffix is all digits as well\nsame => n,GotoIf($["${FILTER(0-9,${SUFFIX})}" != "${SUFFIX}"]?fn-CONGESTION,1)\n                                                                        ; filter out bad characters per the README-SERIOUSLY.best-practices.txt document\nsame => n,Set(TIMEOUT(absolute)=10800)\nsame => n,Set(isnresult=${ENUMLOOKUP(${EXTEN},sip,,1,freenum.org)})     ; perform our lookup with freenum.org\nsame => n,GotoIf($["${isnresult}" != ""]?from)\nsame => n,Set(DIALSTATUS=CONGESTION)\nsame => n,Goto(fn-CONGESTION,1)\nsame => n(from),Set(__SIPFROMUSER=${CALLERID(num)})\nsame => n,GotoIf($["${GLOBAL(FREENUMDOMAIN)}" = ""]?dial)               ; check if we set the FREENUMDOMAIN global variable in [global]\nsame => n,Set(__SIPFROMDOMAIN=${GLOBAL(FREENUMDOMAIN)})                 ;    if we did set it, then we\'ll use it for our outbound dialing domain\nsame => n(dial),Dial(SIP/${isnresult},40)\nsame => n,Goto(fn-${DIALSTATUS},1)\n\nexten => fn-BUSY,1,Busy()\n\nexten => _f[n]-.,1,NoOp(ISN: ${DIALSTATUS})\nsame => n,Congestion()\n\n[macro-trunkdial]\n;\n; Standard trunk dial macro (hangs up on a dialstatus that should\n; terminate call)\n;   ${ARG1} - What to dial\n;\nexten => s,1,Dial(${ARG1})\nexten => s,n,Goto(s-${DIALSTATUS},1)\nexten => s-NOANSWER,1,Hangup()\nexten => s-BUSY,1,Hangup()\nexten => _s-.,1,NoOp\n\n[stdexten]\n;\n; Standard extension subroutine:\n;   ${EXTEN} - Extension\n;   ${ARG1} - Device(s) to ring\n;   ${ARG2} - Optional context in Voicemail\n;\n; Note that the current version will drop through to the next priority in the\n; case of their pressing \'#\'.  This gives more flexibility in what do to next:\n; you can prompt for a new extension, or drop the call, or send them to a\n; general delivery mailbox, or...\n;\n; The use of the LOCAL() function is purely for convenience.  Any variable\n; initially declared as LOCAL() will disappear when the innermost Gosub context\n; in which it was declared returns.  Note also that you can declare a LOCAL()\n; variable on top of an existing variable, and its value will revert to its\n; previous value (before being declared as LOCAL()) upon Return.\n;\nexten => _X.,50000(stdexten),NoOp(Start stdexten)\nexten => _X.,n,Set(LOCAL(ext)=${EXTEN})\nexten => _X.,n,Set(LOCAL(dev)=${ARG1})\nexten => _X.,n,Set(LOCAL(cntx)=${ARG2})\nexten => _X.,n,Set(LOCAL(mbx)=${ext}${IF($[!${ISNULL(${cntx})}]?@${cntx})})\nexten => _X.,n,Dial(${dev},20)				; Ring the interface, 20 seconds maximum\nexten => _X.,n,Goto(stdexten-${DIALSTATUS},1)		; Jump based on status (NOANSWER,BUSY,CHANUNAVAIL,CONGESTION,ANSWER)\n\nexten => stdexten-NOANSWER,1,VoiceMail(${mbx},u)	; If unavailable, send to voicemail w/ unavail announce\nexten => stdexten-NOANSWER,n,Return()			; If they press #, return to start\n\nexten => stdexten-BUSY,1,VoiceMail(${mbx},b)		; If busy, send to voicemail w/ busy announce\nexten => stdexten-BUSY,n,Return()			; If they press #, return to start\n\nexten => _stde[x]te[n]-.,1,Goto(stdexten-NOANSWER,1)	; Treat anything else as no answer\n\nexten => a,1,VoiceMailMain(${mbx})			; If they press *, send the user into VoicemailMain\nexten => a,n,Return()\n\n[stdPrivacyexten]\n;\n; Standard extension subroutine:\n;   ${ARG1} - Extension\n;   ${ARG2} - Device(s) to ring\n;   ${ARG3} - Optional DONTCALL context name to jump to (assumes the s,1 extension-priority)\n;   ${ARG4} - Optional TORTURE context name to jump to (assumes the s,1 extension-priority)`\n;   ${ARG5} - Context in voicemail (if empty, then "default")\n;\n; See above note in stdexten about priority handling on exit.\n;\nexten => _X.,60000(stdPrivacyexten),NoOp(Start stdPrivacyexten)\nexten => _X.,n,Set(LOCAL(ext)=${ARG1})\nexten => _X.,n,Set(LOCAL(dev)=${ARG2})\nexten => _X.,n,Set(LOCAL(dontcntx)=${ARG3})\nexten => _X.,n,Set(LOCAL(tortcntx)=${ARG4})\nexten => _X.,n,Set(LOCAL(cntx)=${ARG5})\n\nexten => _X.,n,Set(LOCAL(mbx)="${ext}"$["${cntx}" ? "@${cntx}" :: ""])\nexten => _X.,n,Dial(${dev},20,p)			; Ring the interface, 20 seconds maximum, call screening\n						; option (or use P for databased call _X.creening)\nexten => _X.,n,Goto(stdexten-${DIALSTATUS},1)		; Jump based on status (NOANSWER,BUSY,CHANUNAVAIL,CONGESTION,ANSWER)\n\nexten => stdexten-NOANSWER,1,VoiceMail(${mbx},u)	; If unavailable, send to voicemail w/ unavail announce\nexten => stdexten-NOANSWER,n,NoOp(Finish stdPrivacyexten NOANSWER)\nexten => stdexten-NOANSWER,n,Return()			; If they press #, return to start\n\nexten => stdexten-BUSY,1,VoiceMail(${mbx},b)		; If busy, send to voicemail w/ busy announce\nexten => stdexten-BUSY,n,NoOp(Finish stdPrivacyexten BUSY)\nexten => stdexten-BUSY,n,Return()			; If they press #, return to start\n\nexten => stdexten-DONTCALL,1,Goto(${dontcntx},s,1)	; Callee chose to send this call to a polite "Don\'t call again" script.\n\nexten => stdexten-TORTURE,1,Goto(${tortcntx},s,1)	; Callee chose to send this call to a telemarketer torture script.\n\nexten => _stde[x]te[n]-.,1,Goto(stdexten-NOANSWER,1)	; Treat anything else as no answer\n\nexten => a,1,VoiceMailMain(${mbx})		; If they press *, send the user into VoicemailMain\nexten => a,n,Return()\n\n[macro-page]\n;\n; Paging macro:\n;\n;       Check to see if SIP device is in use and DO NOT PAGE if they are\n;\n;   ${ARG1} - Device to page\n\nexten => s,1,ChanIsAvail(${ARG1},s)			; s is for ANY call\nexten => s,n,GotoIf($[${AVAILSTATUS} = "1"]?autoanswer:fail)\nexten => s,n(autoanswer),Set(_ALERT_INFO="RA")			; This is for the PolyComs\nexten => s,n,SIPAddHeader(Call-Info: Answer-After=0)	; This is for the Grandstream, Snoms, and Others\nexten => s,n,NoOp()					; Add others here and Post on the Wiki!!!!\nexten => s,n,Dial(${ARG1})\nexten => s,n(fail),Hangup()\n\n\n[demo]\ninclude => stdexten\n;\n; We start with what to do when a call first comes in.\n;\nexten => s,1,Wait(1)			; Wait a second, just for fun\nexten => s,n,Answer()			; Answer the line\nexten => s,n,Set(TIMEOUT(digit)=5)	; Set Digit Timeout to 5 seconds\nexten => s,n,Set(TIMEOUT(response)=10)	; Set Response Timeout to 10 seconds\nexten => s,n(restart),BackGround(demo-congrats)	; Play a congratulatory message\nexten => s,n(instruct),BackGround(demo-instruct)	; Play some instructions\nexten => s,n,WaitExten()		; Wait for an extension to be dialed.\n\nexten => 2,1,BackGround(demo-moreinfo)	; Give some more information.\nexten => 2,n,Goto(s,instruct)\n\nexten => 3,1,Set(CHANNEL(language)=fr)		; Set language to french\nexten => 3,n,Goto(s,restart)		; Start with the congratulations\n\nexten => 1000,1,Goto(default,s,1)\n;\n; We also create an example user, 1234, who is on the console and has\n; voicemail, etc.\n;\nexten => 1234,1,Playback(transfer,skip)		; "Please hold while..."\n					; (but skip if channel is not up)\nexten => 1234,n,Gosub(${EXTEN},stdexten(${GLOBAL(CONSOLE)}))\nexten => 1234,n,Goto(default,s,1)		; exited Voicemail\n\nexten => 1235,1,VoiceMail(1234,u)		; Right to voicemail\n\nexten => 1236,1,Dial(Console/dsp)		; Ring forever\nexten => 1236,n,VoiceMail(1234,b)		; Unless busy\n\n;\n; # for when they\'re done with the demo\n;\nexten => #,1,Playback(demo-thanks)	; "Thanks for trying the demo"\nexten => #,n,Hangup()			; Hang them up.\n\n;\n; A timeout and "invalid extension rule"\n;\nexten => t,1,Goto(#,1)			; If they take too long, give up\nexten => i,1,Playback(invalid)		; "That\'s not valid, try again"\n\n;\n; Create an extension, 500, for dialing the\n; Asterisk demo.\n;\nexten => 500,1,Playback(demo-abouttotry)	; Let them know what\'s going on\nexten => 500,n,Dial(IAX2/guest@pbx.digium.com/s@default)	; Call the Asterisk demo\nexten => 500,n,Playback(demo-nogo)	; Couldn\'t connect to the demo site\nexten => 500,n,Goto(s,6)		; Return to the start over message.\n\n;\n; Create an extension, 600, for evaluating echo latency.\n;\nexten => 600,1,Playback(demo-echotest)	; Let them know what\'s going on\nexten => 600,n,Echo()			; Do the echo test\nexten => 600,n,Playback(demo-echodone)	; Let them know it\'s over\nexten => 600,n,Goto(s,6)		; Start over\n\n;\n;	You can use the Macro Page to intercom a individual user\nexten => 76245,1,Macro(page,SIP/Grandstream1)\n; or if your peernames are the same as extensions\nexten => _7XXX,1,Macro(page,SIP/${EXTEN})\n;\n;\n; System Wide Page at extension 7999\n;\nexten => 7999,1,Set(TIMEOUT(absolute)=60)\nexten => 7999,2,Page(Local/Grandstream1@page&Local/Xlite1@page&Local/1234@page/n,d)\n\n; Give voicemail at extension 8500\n;\nexten => 8500,1,VoiceMailMain()\nexten => 8500,n,Goto(s,6)\n;\n; Here\'s what a phone entry would look like (IXJ for example)\n;\n;exten => 1265,1,Dial(Phone/phone0,15)\n;exten => 1265,n,Goto(s,5)\n\n;\n;	The page context calls up the page macro that sets variables needed for auto-answer\n;	It is in is own context to make calling it from the Page() application as simple as\n;	Local/{peername}@page\n;\n[page]\nexten => _X.,1,Macro(page,SIP/${EXTEN})\n\n;[mainmenu]\n;\n; Example "main menu" context with submenu\n;\n;exten => s,1,Answer\n;exten => s,n,Background(thanks)		; "Thanks for calling press 1 for sales, 2 for support, ..."\n;exten => s,n,WaitExten\n;exten => 1,1,Goto(submenu,s,1)\n;exten => 2,1,Hangup\n;include => default\n;\n;[submenu]\n;exten => s,1,Ringing					; Make them comfortable with 2 seconds of ringback\n;exten => s,n,Wait,2\n;exten => s,n,Background(submenuopts)	; "Thanks for calling the sales department.  Press 1 for steve, 2 for..."\n;exten => s,n,WaitExten\n;exten => 1,1,Goto(default,steve,1)\n;exten => 2,1,Goto(default,mark,2)\n\n[public]\n;\n; ATTENTION: If your Asterisk is connected to the internet and you do\n; not have allowguest=no in sip.conf, everybody out there may use your\n; public context without authentication.  In that case you want to\n; double check which services you offer to the world.\n;\ninclude => demo\n\n[default]\n;\n; By default we include the demo.  In a production system, you\n; probably don\'t want to have the demo there.\n;\ninclude => demo\n\n;\n; An extension like the one below can be used for FWD, Nikotel, sipgate etc.\n; Note that you must have a [sipprovider] section in sip.conf\n;\n;exten => _41X.,1,Dial(SIP/${FILTER(0-9,${EXTEN:2})}@sipprovider,,r)\n\n; Real extensions would go here. Generally you want real extensions to be\n; 4 or 5 digits long (although there is no such requirement) and start with a\n; single digit that is fairly large (like 6 or 7) so that you have plenty of\n; room to overlap extensions and menu options without conflict.  You can alias\n; them with names, too, and use global variables\n\n;exten => 6245,hint,SIP/Grandstream1&SIP/Xlite1(Joe Schmoe) ; Channel hints for presence\n;exten => 6245,1,Dial(SIP/Grandstream1,20,rt)	; permit transfer\n;exten => 6245,n(dial),Dial(${HINT},20,rtT)	; Use hint as listed\n;exten => 6245,n,VoiceMail(6245,u)		; Voicemail (unavailable)\n;exten => 6245,s+1,Hangup			; s+1, same as n\n;exten => 6245,dial+101,VoiceMail(6245,b)	; Voicemail (busy)\n;exten => 6361,1,Dial(IAX2/JaneDoe,,rm)		; ring without time limit\n;exten => 6389,1,Dial(MGCP/aaln/1@192.168.0.14)\n;exten => 6390,1,Dial(JINGLE/caller/callee) ; Dial via jingle using labels\n;exten => 6391,1,Dial(JINGLE/asterisk@digium.com/mogorman@astjab.org) ;Dial via jingle using asterisk as the transport and calling mogorman.\n;exten => 6394,1,Dial(Local/6275/n)		; this will dial ${MARK}\n\n;exten => 6275,1,Gosub(${EXTEN},stdexten(${MARK}))\n						; assuming ${MARK} is something like DAHDI/2\n;exten => 6275,n,Goto(default,s,1)		; exited Voicemail\n;exten => mark,1,Goto(6275,1)			; alias mark to 6275\n;exten => 6536,1,Gosub(${EXTEN},stdexten(${WIL}))\n						; Ditto for wil\n;exten => 6536,n,Goto(default,s,1)		; exited Voicemail\n;exten => wil,1,Goto(6236,1)\n\n;If you want to subscribe to the status of a parking space, this is\n;how you do it. Subscribe to extension 6600 in sip, and you will see\n;the status of the first parking lot with this extensions\' help\n;exten => 6600,hint,park:701@parkedcalls\n;exten => 6600,1,noop\n;\n;To subscribe to the availability of a free member in the \'markq\' queue.\n;Note: \'_avail\' is added to the QueueName\n;exten => 8501,hint,Queue:markq_avail\n;exten => 8501,1,Queue(markq)\n;\n; You can also monitor the status of a queue by providing a hint for a\n; particular queue name.\n;exten => 8502,hint,Queue:markq\n;exten => 8502,1,Queue(markq)\n;\n; Some other handy things are an extension for checking voicemail via\n; voicemailmain\n;\n;exten => 8500,1,VoicemailMain\n;exten => 8500,n,Hangup\n;\n; Or a conference room (you\'ll need to edit meetme.conf to enable this room)\n;\n;exten => 8600,1,Meetme(1234)\n;\n; Or playing an announcement to the called party, as soon it answers\n;\n;exten = 8700,1,Dial(${MARK},30,A(/path/to/my/announcemsg))\n;\n\n; example of a compartmentalized company called "acme"\n;\n; this is the context that your incoming IAX/SIP trunk dumps you in...\n;[acme-incoming]\n;exten => s,1,Wait(1)\n;exten => s,n,Answer()\n;exten => s,n(menu),Playback(acme/vm-brief-menu)\n;exten => s,n(exten),Background(vm-enter-num-to-call)\n;exten => s,n,WaitExten(5)\n;exten => s,n(goodbye),Playback(vm-goodbye)\n;exten => s,n(end),Hangup()\n;\n;include  => acme-extens\n;\n;exten => i,1,Playback(vm-invalid)\n;exten => i,n,Goto(s,exten)			; optionally, transfer to operator\n;\n;exten => t,1,Goto(s,goodbye)\n;\n; this is the context our internal SIP hardphones use (see sip.conf)\n;\n;[acme-internal]\n;exten => s,1,Answer()\n;exten => s,n(exten),Background(vm-enter-num-to-call)\n;exten => s,n,WaitExten(5)\n;exten => s,n(goodbye),Playback(vm-goodbye)\n;exten => s,n(end),Hangup()\n;\n;include => trunkint\n;include => trunkld\n;include => trunklocal\n;\n;include => acme-extens\n;\n; you can test what your system sounds like to outside callers by dialing this\n;exten => 777,1,DISA(no-password,acme-incoming)\n;\n; grouping of acme\'s extensions... never used directly, always included.\n;\n;[acme-extens]\n;include => stdexten\n;exten => 111,1,Gosub(111,stdexten(SIP/pete_1,acme))\n;exten => 111,n,Goto(s,exten)\n;\n;exten => 112,1,Gosub(112,stdexten(SIP/nancy_1,acme))\n;exten => 112,n,Goto(s,end)\n;\n; end of acme example\n\n;\n; Time context: you can patch this in via the following.\n;\n; [acme-internal]\n; ...\n; exten => 777,1,Gosub(time)\n; exten => 777,n,Hangup()\n;\n; ...\n; include => time\n;\n; Note: if you\'re geographically spread out, you can have SIP extensions\n; specify their own local timezone in sip.conf as:\n;\n; [boi]\n; type=friend\n; context=acme-internal\n; callerid="Boise Ofc. <2083451111>"\n; ...\n; ; use system-wide default timezone of MST7MDT\n;\n; [lws]\n; type=friend\n; context=acme-internal\n; callerid="Lewiston Ofc. <2087431111>"\n; ...\n; setvar=timezone=PST8PDT\n;\n; "timezone" isn\'t a \'reserved\' name in any way, and other places where\n; the timezone is significant (e.g. calls to "SayUnixTime()", etc) will\n; require modification as well.  Note that voicemail.conf already has\n; a mechanism for timezones.\n;\n\n[time]\nexten => _X.,30000(time),NoOp(Time: ${EXTEN} ${timezone})\nexten => _X.,n,Wait(0.25)\nexten => _X.,n,Answer()\n; the amount of delay is set for English; you may need to adjust this time\n; for other languages if there\'s no pause before the synchronizing beep.\nexten => _X.,n,Set(FUTURETIME=$[${EPOCH} + 12])\nexten => _X.,n,SayUnixTime(${FUTURETIME},Zulu,HNS)\nexten => _X.,n,SayPhonetic(z)\n; use the timezone associated with the extension (sip only), or system-wide\n; default if one hasn\'t been set.\nexten => _X.,n,SayUnixTime(${FUTURETIME},${timezone},HNS)\nexten => _X.,n,Playback(spy-local)\nexten => _X.,n,WaitUntil(${FUTURETIME})\nexten => _X.,n,Playback(beep)\nexten => _X.,n,Return()\n\n;\n; ANI context: use in the same way as "time" above\n;\n\n[ani]\nexten => _X.,40000(ani),NoOp(ANI: ${EXTEN})\nexten => _X.,n,Wait(0.25)\nexten => _X.,n,Answer()\nexten => _X.,n,Playback(vm-from)\nexten => _X.,n,SayDigits(${CALLERID(ani)})\nexten => _X.,n,Wait(1.25)\nexten => _X.,n,SayDigits(${CALLERID(ani)})	; playback again in case of missed digit\nexten => _X.,n,Return()\n\n; For more information on applications, just type "core show applications" at your\n; friendly Asterisk CLI prompt.\n;\n; "core show application <command>" will show details of how you\n; use that particular application in this file, the dial plan.\n; "core show functions" will list all dialplan functions\n; "core show function <COMMAND>" will show you more information about\n; one function. Remember that function names are UPPER CASE.\n\n'})})]})}function d(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},917776:function(e,n,t){t.d(n,{R:()=>s,x:()=>r});var o=t(7378);let a={},i=o.createContext(a);function s(e){let n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);