"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["442329"],{101908:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>d,toc:()=>o,default:()=>h,metadata:()=>i,assets:()=>t,contentTitle:()=>c});var i=JSON.parse('{"id":"dev/design/api/README","title":"API Design","description":"- grpc \u5185\u90E8\u9ED8\u8BA4 4mb buffer","source":"@site/../notes/dev/design/api/README.md","sourceDirName":"dev/design/api","slug":"/dev/design/api/","permalink":"/notes/dev/design/api/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/design/api/README.md","tags":[{"inline":true,"label":"Design","permalink":"/notes/tags/design"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1742710127000,"frontMatter":{"tags":["Design"]},"sidebar":"docs","previous":{"title":"Design","permalink":"/notes/dev/design/"},"next":{"title":"FAQ","permalink":"/notes/dev/design/api/faq"}}'),l=s(486106),r=s(917776);let d={tags:["Design"]},c="API Design",t={},o=[{value:"\u8BBE\u8BA1\u573A\u666F",id:"scenarios",level:2},{value:"\u5206\u9875\u548C\u6392\u5E8F",id:"pagination",level:2},{value:"\u8FC7\u6EE4",id:"filter",level:2},{value:"\u9009\u62E9\u8FD4\u56DE",id:"select",level:2},{value:"Zalando",id:"zalando",level:2},{value:"Google Cloud",id:"google-cloud",level:2},{value:"gRPC API Design",id:"grpc-api-design",level:2},{value:"entpb",id:"entpb",level:3},{value:"\u7FFB\u9875\u53C2\u6570",id:"pagination",level:2},{value:"\u6E38\u6807\u7FFB\u9875",id:"cursor",level:2},{value:"pageInfo",id:"pageinfo",level:2},{value:"Naming",id:"naming",level:2},{value:"Grouping and Aggregation",id:"grouping-and-aggregation",level:2},{value:"Payload vs Input vs Data vs Object vs Output",id:"payload-vs-input-vs-data-vs-object-vs-output",level:2}];function a(e){let n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"api-design",children:"API Design"})}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"grpc \u5185\u90E8\u9ED8\u8BA4 4mb buffer"}),"\n"]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Google Cloud API ",(0,l.jsx)(n.a,{href:"https://cloud.google.com/apis/design/design_patterns",children:"\u5E38\u89C1\u8BBE\u8BA1\u6A21\u5F0F"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"[start_xxx, end_xxx)"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"map<string, string> labels"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/Microsoft/api-guidelines",children:"Microsoft/api-guidelines"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://cloud.google.com/apis/design/",children:"https://cloud.google.com/apis/design/"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://opensource.zalando.com/restful-api-guidelines/",children:"https://opensource.zalando.com/restful-api-guidelines/"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/zalando/zally",children:"zalando/zally"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"API linter"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://apistylebook.com/",children:"https://apistylebook.com/"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"http://apistylebook.com/design/guidelines/",children:"http://apistylebook.com/design/guidelines/"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/restcookbook/restcookbook",children:"restcookbook/restcookbook"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://developer.atlassian.com/server/framework/atlassian-sdk/atlassian-rest-api-design-guidelines-version-1/",children:"Atlassian REST API design guidelines version 1"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u96C6\u5408\u540D\u5B57 singular"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/adidas/api-guidelines",children:"adidas/api-guidelines"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://adidas.gitbook.io/api-guidelines/",children:"https://adidas.gitbook.io/api-guidelines/"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/interagent/http-api-design",children:"interagent/http-api-design"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/WhiteHouse/api-standards",children:"WhiteHouse/api-standards"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://postgrest.org/en/stable/api.html",children:"https://postgrest.org/en/stable/api.html"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"scenarios",children:"\u8BBE\u8BA1\u573A\u666F"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u672C\u5730/\u5185\u5B58"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u80FD\u591F\u5728\u5185\u90E8\u6301\u6709\u5F15\u7528\uFF0C\u65E0\u9700\u4E00\u6B21\u6027\u52A0\u8F7D\u6216\u8BFB\u5199\u6240\u6709\u6570\u636E\uFF0C\u652F\u6301\u9010\u6B65\u5904\u7406\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u63A5\u53E3\u53CB\u597D\uFF0C\u76F4\u89C2\u7B80\u6D01\uFF0C\u65B9\u4FBF\u5F00\u53D1\u8005\u76F4\u63A5\u64CD\u4F5C\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u5E38\u89C1\u5F62\u5F0F\uFF1A",(0,l.jsx)(n.code,{children:"handle"}),", ",(0,l.jsx)(n.code,{children:"pointer"}),", ",(0,l.jsx)(n.code,{children:"reference"}),", ",(0,l.jsx)(n.code,{children:"object"}),", ",(0,l.jsx)(n.code,{children:"entity"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8FDC\u7A0B/\u7F51\u7EDC"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u670D\u52A1\u4EE5 Request/Response \u6A21\u5F0F\u63D0\u4F9B\uFF0C\u4FDD\u6301 API \u7684\u7B80\u5355\u6027\u548C\u53EF\u6269\u5C55\u6027\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u8BF7\u6C42\u54CD\u5E94\u5E94\u4FDD\u6301\u5355\u5C42\u5173\u7CFB\uFF1A",(0,l.jsx)(n.code,{children:"Service.Method(Request) -> Response"}),"\u3002"]}),"\n",(0,l.jsx)(n.li,{children:"\u5C3D\u91CF\u4FDD\u6301\u5355\u4E2A\u8F93\u5165\u8F93\u51FA\u5BF9\u8C61\uFF0C\u907F\u514D\u591A\u5C42\u5D4C\u5957\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u4FE1\u606F\u8BBE\u8BA1\u76F8\u5BF9\u6D53\u7F29\uFF1A\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F8B\u5982\uFF0C\u4F7F\u7528\u5B57\u7B26\u4E32 ",(0,l.jsx)(n.code,{children:'"A > 1"'})," \u8868\u793A\u6761\u4EF6\uFF0C\u800C\u975E\u590D\u6742\u5BF9\u8C61 ",(0,l.jsx)(n.code,{children:"{op: '>', field: 'A', value: 1}"}),"\u3002"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u5355\u4E2A\u63A5\u53E3\u5E94\u529F\u80FD\u4E30\u5BCC\uFF0C\u8986\u76D6\u7279\u5B9A\u7528\u4F8B\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u9700\u8981\u8003\u8651\uFF1A\u5E8F\u5217\u5316\u3001\u5305\u5927\u5C0F\u3001\u72B6\u6001\u3001\u4F1A\u8BDD\u3001\u5E42\u7B49\u6027\u3001\u6027\u80FD\u3001\u9519\u8BEF\u5904\u7406\u3001\u5B89\u5168\u6027\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u5E38\u89C1\u5F62\u5F0F\uFF1A",(0,l.jsx)(n.code,{children:"message"}),", ",(0,l.jsx)(n.code,{children:"payload"}),", ",(0,l.jsx)(n.code,{children:"data"}),", ",(0,l.jsx)(n.code,{children:"object"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5C01\u88C5"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5C06\u590D\u6742\u7684\u8FDC\u7A0B\u6216\u5E95\u5C42\u63A5\u53E3\u5C01\u88C5\u4E3A\u7C7B\u4F3C\u672C\u5730\u63A5\u53E3\uFF0C\u9690\u85CF\u5185\u90E8\u5B9E\u73B0\u7EC6\u8282\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u63D0\u4F9B\u5F00\u53D1\u8005\u53CB\u597D\u7684\u63A5\u53E3\uFF0C\u4FBF\u4E8E\u5FEB\u901F\u4E0A\u624B\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u63D0\u4F9B\u4FBF\u643A\u7684\u4F7F\u7528\u65B9\u5F0F\uFF0C\u964D\u4F4E\u96C6\u6210\u6210\u672C\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u5E38\u89C1\u5F62\u5F0F\uFF1A",(0,l.jsx)(n.code,{children:"object"}),", ",(0,l.jsx)(n.code,{children:"resource"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7CFB\u7EDF/\u96C6\u6210"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5C3D\u91CF\u4FDD\u6301\u7CFB\u7EDF\u539F\u8C8C\uFF0C\u907F\u514D\u8FC7\u5EA6\u62BD\u8C61\u5BFC\u81F4\u7CFB\u7EDF\u529F\u80FD\u53D7\u9650\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u9690\u85CF\u7CFB\u7EDF\u5185\u90E8\u673A\u5236\uFF0C\u4FBF\u4E8E\u5F00\u53D1\u8005\u7406\u89E3\u548C\u6392\u67E5\u95EE\u9898\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u6309\u7167\u7CFB\u7EDF\u672C\u8EAB\u7684\u903B\u8F91\u5EFA\u6A21\uFF0C\u63D0\u5347\u517C\u5BB9\u6027\u548C\u53EF\u7EF4\u62A4\u6027\u3002"}),"\n",(0,l.jsxs)(n.li,{children:["\u5E38\u89C1\u5F62\u5F0F\uFF1A",(0,l.jsx)(n.code,{children:"syscall"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"pagination",children:"\u5206\u9875\u548C\u6392\u5E8F"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Offset/Limit\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"offset+limit"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Cursor/Limit\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"cursor+limit"}),"\n",(0,l.jsx)(n.li,{children:"\u65F6\u95F4: until, since"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Zalando\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["sort - ",(0,l.jsx)(n.code,{children:"+id,-name"}),",",(0,l.jsx)(n.code,{children:"-id"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"+"})," asc, ",(0,l.jsx)(n.code,{children:"-"})," desc"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Google API\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["order_by - ",(0,l.jsx)(n.code,{children:"field [asc|desc],..."})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["MS API\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"orderBy=name desc,hireDate"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",metastring:'title="Meta GQL.json"',children:'{\n  "data": [],\n  "paging": {\n    "cursors": {\n      "after": "XYZ=",\n      "before": "XYZ="\n    },\n    "previous": "https://?limit=25&before=XYZ=",\n    "next": "https://?limit=25&after=XYZ="\n  }\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",metastring:'title="Twitter.json"',children:'{\n  "ids": [123],\n  "next_cursor": 123,\n  "next_cursor_str": "123",\n  "previous_cursor": -123,\n  "previous_cursor_str": "-123"\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",metastring:'"Zalando.json"',children:'{\n  "items": [],\n  "self": "http://?cursor=",\n  "first": "",\n  "prev": "",\n  "next": "",\n  "last": "",\n  "query": {}\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://developers.facebook.com/docs/graph-api/results",children:"https://developers.facebook.com/docs/graph-api/results"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"filter",children:"\u8FC7\u6EE4"}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u51CF\u5C11\u63A5\u53E3\u6570\u91CF - \u63D0\u5347\u5F00\u53D1\u6548\u7387"}),"\n",(0,l.jsx)(n.li,{children:"\u589E\u52A0\u4E1A\u52A1\u7075\u6D3B\u6027 - \u4E1A\u52A1\u53D8\u5316\u63A5\u53E3\u4E0D\u53D8"}),"\n"]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/notes/dev/design/api/filter",children:"Filter"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"select",children:"\u9009\u62E9\u8FD4\u56DE"}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u90E8\u5206\u8FD4\u56DE - \u6027\u80FD"}),"\n",(0,l.jsx)(n.li,{children:"\u5173\u8054\u67E5\u8BE2 - \u5BA2\u6237\u7AEF\u7684\u5F00\u53D1\u4F53\u9A8C"}),"\n",(0,l.jsx)(n.li,{children:"\u589E\u52A0\u4E1A\u52A1\u7075\u6D3B\u6027 - \u4E1A\u52A1\u53D8\u5316\u63A5\u53E3\u4E0D\u53D8"}),"\n",(0,l.jsx)(n.li,{children:"\u652F\u6301\u591A\u7AEF\u5F00\u53D1\u573A\u666F"}),"\n",(0,l.jsx)(n.li,{children:"GraphQL\u7684\u51FA\u73B0\u89E3\u51B3\u4E86\u8BE5\u95EE\u9898"}),"\n"]})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Google API\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"fields=name,generation,size"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"fields=items(id,metadata/key1)"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Zalando\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["fields - ",(0,l.jsx)(n.code,{children:"(name,friends(name))"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u83B7\u53D6\u90E8\u5206\u5B57\u6BB5"}),"\n",(0,l.jsx)(n.li,{children:"\u5305\u542B name \u548C friends \u6570\u7EC4\u5BF9\u8C61\u7684 name"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["embed - ",(0,l.jsx)(n.code,{children:"(items)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5305\u542B\u5173\u8054\u5C5E\u6027"}),"\n",(0,l.jsx)(n.li,{children:"\u5305\u542B\u989D\u5916\u5185\u5BB9"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["PostgREST\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"GET /people?select=first_name,age HTTP/1.1"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GET /people?select=id,json_data->>blood_type,json_data->phones HTTP/1.1"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"JSON \u6570\u636E\u9009\u62E9"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"GET /people?select=*,full_name HTTP/1.1"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u989D\u5916\u5B57\u6BB5"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"zalando",children:"Zalando"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u67E5\u8BE2\u53C2\u6570\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"q - \u9ED8\u8BA4\u67E5\u8BE2"}),"\n",(0,l.jsxs)(n.li,{children:["sort - \u9017\u53F7\u5206\u9694\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"+id,-name"}),",",(0,l.jsx)(n.code,{children:"-id"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"+"})," asc, ",(0,l.jsx)(n.code,{children:"-"})," desc"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["fields - ",(0,l.jsx)(n.code,{children:"(name,friends(name))"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u83B7\u53D6\u90E8\u5206\u5B57\u6BB5"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["embed - ",(0,l.jsx)(n.code,{children:"(items)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5305\u542B\u5173\u8054\u5C5E\u6027"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"offset"}),"\n",(0,l.jsx)(n.li,{children:"cursor"}),"\n",(0,l.jsx)(n.li,{children:"limit"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"fields"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:'<fields>            ::= [ <negation> ] <fields_struct>\n<fields_struct>     ::= "(" <field_items> ")"\n<field_items>       ::= <field> [ "," <field_items> ]\n<field>             ::= <field_name> | <fields_substruct>\n<fields_substruct>  ::= <field_name> <fields_struct>\n<field_name>        ::= <dash_letter_digit> [ <field_name> ]\n<dash_letter_digit> ::= <dash> | <letter> | <digit>\n<dash>              ::= "-" | "_"\n<letter>            ::= "A" | ... | "Z" | "a" | ... | "z"\n<digit>             ::= "0" | ... | "9"\n<negation>          ::= "!"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"google-cloud",children:"Google Cloud"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"fields=name,generation,size"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"fields=items(id,metadata/key1)"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://cloud.google.com/storage/docs/json_api#partial-response",children:"https://cloud.google.com/storage/docs/json_api#partial-response"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"grpc-api-design",children:"gRPC API Design"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u63A5\u53E3\u9762\u5411\u8D44\u6E90"}),"\n",(0,l.jsxs)(n.li,{children:["\u8D44\u6E90\u540D\u5B57\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u8D44\u6E90 ",(0,l.jsx)(n.strong,{children:"\u5FC5\u987B"})," \u5305\u542B\u8D44\u6E90\u540D\u5B57"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.em,{children:"\u53EF\u4EE5"})," \u5305\u542B ",(0,l.jsx)(n.code,{children:"<resource>_id"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.em,{children:"\u53EF\u4EE5"})," \u5305\u542B ",(0,l.jsx)(n.code,{children:"uid"})]}),"\n",(0,l.jsxs)(n.li,{children:["ID \u5B57\u6BB5 ",(0,l.jsx)(n.em,{children:"\u5E94\u8BE5"})," \u4E3A \u5B57\u7B26\u4E32"]}),"\n",(0,l.jsxs)(n.li,{children:["\u4F8B\u5982\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"teams/first/members/wener"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"users/wener"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5B8C\u6574\u8D44\u6E90\u540D\u5B57\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"\u670D\u52A1\u540D\u5B57/\u8D44\u6E90\u540D\u5B57"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"//library.wener.me/publishers/123/books/456"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5BF9\u4E8E\u7684\u7C7B\u578B ",(0,l.jsx)(n.code,{children:"library.wener.me/Publisher"}),", ",(0,l.jsx)(n.code,{children:"library.wener.me/Book"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u96C6\u5408\u8D44\u6E90\u540D\u5B57\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u590D\u6570\u3001\u9A7C\u5CF0"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"users/wener/events/hello-world"})}),"\n",(0,l.jsxs)(n.li,{children:["\u53EF\u4EE5\u8003\u8651\u652F\u6301\u8DE8\u96C6\u5408\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"publishers/-/books/{book}"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"users/-/events?filter="})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u8D44\u6E90\u7C7B\u578B - {Service Name}/{Type}\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"ServiceName"}),"\n",(0,l.jsx)(n.li,{children:"Type"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["GetResource(GetResourceRequest) returns (Resource)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["GetResourceRequest#name -- \u8D44\u6E90\u540D\u5B57 -> ",(0,l.jsx)(n.code,{children:"publishers/{publisher}/books/{book}"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ListResources(ListResourceRequest) returns (ListResourceResponse)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ListResourceRequest#\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["parent - \u4E0A\u7EA7\u96C6\u5408 -> ",(0,l.jsx)(n.code,{children:"publishers/*"})]}),"\n",(0,l.jsx)(n.li,{children:"page_size"}),"\n",(0,l.jsx)(n.li,{children:"page_token - \u5C3D\u91CF\u524D\u7AEF\u4E0D\u53EF\u9006"}),"\n",(0,l.jsx)(n.li,{children:"skip - \u53EF\u9009\u5B9E\u73B0"}),"\n",(0,l.jsxs)(n.li,{children:["order_by - ",(0,l.jsx)(n.code,{children:"field [asc|desc],..."})]}),"\n",(0,l.jsxs)(n.li,{children:["filter - ",(0,l.jsx)(n.a,{href:"https://google.aip.dev/160",children:"AIP-160"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"a AND b OR NOT c"})," - OR \u4F18\u5148\u7EA7\u9AD8\u4E8E AND"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"NOT a"})," = ",(0,l.jsx)(n.code,{children:"-a"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"=,!=,>,<,>=,<="})}),"\n",(0,l.jsx)(n.li,{children:"true,false,null"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"a.b = true"})}),"\n",(0,l.jsxs)(n.li,{children:["\u5305\u542B/has ",(0,l.jsx)(n.code,{children:"a.b:10"})," - a \u4E3A\u96C6\u5408\uFF0Cb \u4E3A\u96C6\u5408\u5143\u7D20\u5B57\u6BB5"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"call(args...)"})}),"\n",(0,l.jsx)(n.li,{children:"\u5B57\u6BB5\u540D\u5FC5\u987B\u5728\u5DE6\u8FB9"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"bool show_deleted - \u8F6F\u5220\u9664"}),"\n",(0,l.jsx)(n.li,{children:"unreachable"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ListResourceResponse\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"repeated Resource resources"}),"\n",(0,l.jsx)(n.li,{children:"next_page_token"}),"\n",(0,l.jsx)(n.li,{children:"\u53EF\u9009 int64 total_size"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["CreateResource(CreateResourceRequest) returns (Resource)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["CreateResourceRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"parent"}),"\n",(0,l.jsx)(n.li,{children:"resource"}),"\n",(0,l.jsx)(n.li,{children:"resource_id \u6709\u4E9B\u573A\u666F\u53EF\u4EE5\u652F\u6301\u5BA2\u6237\u7AEF\u81EA\u5DF1\u6307\u5B9A"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u957F\u65F6\u95F4\u8FD0\u884C\u64CD\u4F5C\u8FD4\u56DE google.longrunning.Operation"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["UpdateResource(UpdateResourceRequest) returns (Resource)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["UpdateResourceRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["resource\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u8FC7 name \u5339\u914D"}),"\n",(0,l.jsx)(n.li,{children:"etag - \u53EF\u6307\u5B9A etga \u8FDB\u884C\u6BD4\u8F83\u66F4\u65B0\uFF0C\u5982\u679C\u4E0D\u5339\u914D\u5219\u5931\u8D25"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"google.protobuf.FieldMask update_mask - \u652F\u6301\u90E8\u5206\u66F4\u65B0"}),"\n",(0,l.jsx)(n.li,{children:"bool allow_missing - \u5982\u679C\u4E0D\u5B58\u5219\u521B\u5EFA"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"DeleteResource(DeleteResourceRequest) returns (google.protobuf.Empty)"}),"\n",(0,l.jsxs)(n.li,{children:["DeleteResourceRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"name"}),"\n",(0,l.jsx)(n.li,{children:"bool force - \u5F3A\u5236\u7EA7\u8054\u5220\u9664"}),"\n",(0,l.jsx)(n.li,{children:"etag - \u5982\u679C\u5339\u914D\u624D\u5220\u9664"}),"\n",(0,l.jsx)(n.li,{children:"bool allow_missing - \u5FFD\u7565\u4E0D\u5B58\u5728"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["PurgeResources(PurgeResourcesRequest) returns (google.longrunning.Operation)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6279\u91CF\u5220\u9664"}),"\n",(0,l.jsxs)(n.li,{children:["PurgeResourcesRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"parent"}),"\n",(0,l.jsx)(n.li,{children:"filter"}),"\n",(0,l.jsx)(n.li,{children:"force"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["PurgeResourcesResponse\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"purge_count"}),"\n",(0,l.jsx)(n.li,{children:"purge_sample"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["UndeleteResource(UndeleteResourceRequest) returns (Resource)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u652F\u6301\u8F6F\u5220\u9664"}),"\n",(0,l.jsxs)(n.li,{children:["UndeleteResourceRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"name"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Batch"}),"\n",(0,l.jsxs)(n.li,{children:["ImportResources(ImportResourcesRequest) returns (google.longrunning.Operation)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ImportResourcesRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"parent"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ExportResources(ExportResourcesRequest) returns (google.longrunning.Operation)\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ExportResourcesRequest\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"filter"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5E38\u89C1\u6807\u51C6\u5B57\u6BB5\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"name"}),"\n",(0,l.jsx)(n.li,{children:"parent"}),"\n",(0,l.jsx)(n.li,{children:"uid"}),"\n",(0,l.jsx)(n.li,{children:"display_name,title,given_name,faamily_ame"}),"\n",(0,l.jsx)(n.li,{children:"create_time,update_time,delete_time"}),"\n",(0,l.jsx)(n.li,{children:"expire_time - \u8F6F\u5220\u9664\u573A\u666F"}),"\n",(0,l.jsx)(n.li,{children:"etag - checksum"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u5E38\u89C1\u8BF7\u6C42\u5B57\u6BB5\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"request_id - UUID"}),"\n",(0,l.jsx)(n.li,{children:"validate_only - Change validation"}),"\n",(0,l.jsxs)(n.li,{children:["google.protobuf.FieldMask\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E0D\u5E94\u8BE5\u5728\u8BF7\u6C42\u5305\u542B - \u53EF\u4EE5\u5728 metadata \u5305\u542B - \u4F8B\u5982 \u5934"}),"\n",(0,l.jsx)(n.li,{children:"\u5FC5\u987B optional"}),"\n",(0,l.jsxs)(n.li,{children:["\u652F\u6301 ",(0,l.jsx)(n.code,{children:"*"})]}),"\n",(0,l.jsx)(n.li,{children:"\u73B0\u5728\u63A8\u8350 view"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u4F8B\u5982 enum BookView {BOOK_VIEW_UNSPECIFIED=0;BASIC = 1;FULL = 2;}"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u5355\u5B9E\u4F8B\u8D44\u6E90\u53EA\u6709 Get \u548C Update"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://google.aip.dev/",children:"https://google.aip.dev/"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/googleapis/googleapis/blob/master/google/api/",children:"https://github.com/googleapis/googleapis/blob/master/google/api/"})}),"\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/einride/aip-go",children:"einride/aip-go"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5305\u542B\u4E86\u89E3\u6790\u8D44\u6E90\u540D\u5B57\u903B\u8F91"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Note"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E0D\u8981\u7528 unsigned integer"}),"\n",(0,l.jsxs)(n.li,{children:["\u4E0D\u8981\u7528 optional - \u9664\u975E\u8868\u793A\u7279\u5B9A\u542B\u4E49 - \u4F8B\u5982 \u7A7A \u4E3A \u672A\u6295\u7968\u3001\u672A\u8BC4\u5206\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"optional \u4F1A\u8FD4\u56DE zero value - \u5373\u4FBF\u6CA1\u6709 set"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"entpb",children:"entpb"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E00\u4E2A\u8D44\u6E90\u4E00\u4E2A\u670D\u52A1"}),"\n",(0,l.jsx)(n.li,{children:"\u751F\u6210\u5927\u91CF\u5185\u5BB9\uFF0C\u4F46\u6A21\u5F0F\u56FA\u5B9A"}),"\n",(0,l.jsxs)(n.li,{children:["entpb ",(0,l.jsx)(n.a,{href:"https://github.com/ent/contrib",children:"https://github.com/ent/contrib"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/ent/ent/issues/2446",children:"#2446"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-proto",children:'syntax = "proto3";\n\nservice UserService {\n  rpc Create ( CreateUserRequest ) returns ( User );\n  rpc Get ( GetUserRequest ) returns ( User );\n  rpc Update ( UpdateUserRequest ) returns ( User );\n  rpc Delete ( DeleteUserRequest ) returns ( google.protobuf.Empty );\n  rpc List ( ListUserRequest ) returns ( ListUserResponse );\n  rpc BatchCreate ( BatchCreateUsersRequest ) returns ( BatchCreateUsersResponse );\n}\n\nmessage CreateUserRequest {\n  User user = 1;\n}\n\nmessage GetUserRequest {\n  int64 id = 1;\n  View view = 2;\n\n  enum View {\n    VIEW_UNSPECIFIED = 0;\n    BASIC = 1;\n    WITH_EDGE_IDS = 2;\n  }\n}\nmessage UpdateUserRequest {\n  User user = 1;\n}\nmessage DeleteUserRequest {\n  int64 id = 1;\n}\nmessage ListUserRequest {\n  int32 page_size = 1;\n  string page_token = 2;\n  View view = 3;\n\n  enum View {\n    VIEW_UNSPECIFIED = 0;\n    BASIC = 1;\n    WITH_EDGE_IDS = 2;\n  }\n}\nmessage ListUserResponse {\n  repeated User user_list = 1;\n  string next_page_token = 2;\n}\n\nmessage BatchCreateUsersRequest {\n  repeated CreateUserRequest requests = 1;\n}\nmessage BatchCreateUsersResponse {\n  repeated User users = 1;\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/ent/contrib/blob/1faab982b6648b7704a6cf41ff65d9cb7811a2be/entproto/internal/todo/ent/proto/entpb/entpb.proto",children:"https://github.com/ent/contrib/blob/1faab982b6648b7704a6cf41ff65d9cb7811a2be/entproto/internal/todo/ent/proto/entpb/entpb.proto"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"pagination",children:"\u7FFB\u9875\u53C2\u6570"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6700\u7EC8\u662F\u9700\u8981 limit+offset"}),"\n",(0,l.jsxs)(n.li,{children:["\u5141\u8BB8\u7528\u6237\u63D0\u4F9B\u5404\u79CD\u8F93\u5165\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"cursor \u4E0D\u5728\u8FD9\u4E2A\u8303\u56F4\u5185"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"export function normalizePagination(page: {\n  pageSize?: number;\n  pageIndex?: number;\n  pageNumber?: number;\n  limit?: number;\n  offset?: number;\n}) {\n  let { pageSize = 20, pageNumber = 1, pageIndex = pageNumber - 1, limit, offset } = page;\n  return {\n    limit: limit || pageSize,\n    offset: offset ?? pageIndex * pageSize,\n  };\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"cursor",children:"\u6E38\u6807\u7FFB\u9875"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"cursor+limit"}),"\n",(0,l.jsxs)(n.li,{children:["\u57FA\u672C\u4FE1\u606F\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"id/timestamp"}),"\n",(0,l.jsxs)(n.li,{children:["direction - \u65B9\u5411\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u9ED8\u8BA4 ",(0,l.jsx)(n.code,{children:">"})," - \u5F80\u540E\u53D6"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53EF\u4EE5\u8003\u8651\u989D\u5916\u7684\u4FE1\u606F\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4F8B\u5982\u6392\u5E8F\u5B57\u6BB5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"interface Cursor {\n  id: string;\n  direction: 'asc' | 'desc';\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"where id ${direction === 'asc' ? '>' : '<'} ${id}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"pageinfo",children:"pageInfo"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"relay \u4F1A\u8FD4\u56DE pageInfo \u5305\u542B\u6E38\u6807\u4FE1\u606F"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"export class RelayPageInfo {\n  readonly startCursor?: RelayConnectionCursor | null;\n  readonly endCursor?: RelayConnectionCursor | null;\n  readonly hasPreviousPage!: boolean;\n  readonly hasNextPage!: boolean;\n}\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Spring \u7684 Page \u5BF9\u8C61\u6709\u7C7B\u4F3C\u4FE1\u606F\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/PageImpl.html",children:"https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/PageImpl.html"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"export interface Page<T> {\n  content: T[];\n  // number of the current Slice\n  number: number;\n  // number of elements currently on this Slice.\n  numberOfElements: number;\n\n  pageable: Pageable;\n\n  size: number;\n  sort: Sort;\n\n  totalElements: number;\n  totalPages: number;\n\n  hasContent(): boolean;\n  hasNext(): boolean;\n  hasPrevious(): boolean;\n  isFirst(): boolean;\n  isLast(): boolean;\n\n  nextPageable(): Pageable;\n  previousPageable(): Pageable;\n}\n\ninterface Pageable {\n  pageNumber: number;\n  pageSize: number;\n  offset: number;\n  paged: boolean;\n  sort: Sort;\n  unpaged: boolean;\n  paged: boolean;\n\n  next(): Pageable;\n  previousOrFirst(): Pageable;\n  first(): Pageable;\n}\n\ninterface Sort {\n  sorted: boolean;\n  unsorted: boolean;\n  empty: boolean;\n\n  orders: Order[];\n}\n\ninterface Order {\n  direction: 'ASC' | 'DESC';\n  property: string;\n  ignoreCase: boolean;\n  nullHandling: 'NATIVE' | 'NULLS_FIRST' | 'NULLS_LAST';\n  ascending: boolean;\n  descending: boolean;\n}\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Django Rest Framework (DRF)"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.django-rest-framework.org/api-guide/pagination/",children:"https://www.django-rest-framework.org/api-guide/pagination/"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "count": 1023,\n  "next": "https://api.example.org/accounts/?limit=100&offset=500",\n  "previous": "https://api.example.org/accounts/?limit=100&offset=300",\n  "results": []\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Prisma"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"const result = await prisma.user.findMany({\n  take: 10,\n  skip: 10,\n});\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Larval"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "total": 200,\n  "per_page": 15,\n  "current_page": 1,\n  "last_page": 14,\n  "next_page_url": "...",\n  "prev_page_url": null,\n  "from": 1,\n  "to": 15,\n  "data": []\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"naming",children:"Naming"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"PaginationResponse"}),"\n",(0,l.jsx)(n.li,{children:"PaginatedResponse"}),"\n",(0,l.jsx)(n.li,{children:"PaginationInfo"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"grouping-and-aggregation",children:"Grouping and Aggregation"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5927\u591A\u9700\u8981\u5206\u6790\u573A\u666F\u7684\u65F6\u5019\u53C8\u4F1A\u56DE\u5230\u4F7F\u7528 DSL/SQL"}),"\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://cube.dev/docs/reference/rest-api",children:"https://cube.dev/docs/reference/rest-api"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html",children:"https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations.html"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/odata/client/grouping-and-aggregation",children:"https://learn.microsoft.com/en-us/odata/client/grouping-and-aggregation"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"ES"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-http",children:"GET /my-index-000001/_search\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "size": 0,\n  "aggs": {\n    "my-agg-name": {\n      "terms": {\n        "field": "my-field"\n      },\n      "meta": {\n        "my-metadata-field": "foo"\n      }\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "aggregations": {\n    "my-agg-name": {\n      "meta": {\n        "my-metadata-field": "foo"\n      },\n      "doc_count_error_upper_bound": 0,\n      "sum_other_doc_count": 0,\n      "buckets": [\n        {\n          "key": "foo",\n          "doc_count": 5,\n          "my-sub-agg-name": {\n            "value": 75.0\n          }\n        }\n      ]\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,l.jsx)(n.h2,{id:"payload-vs-input-vs-data-vs-object-vs-output",children:"Payload vs Input vs Data vs Object vs Output"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Payload - \u8F7D\u8377\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"GraphQL \u91CC\u4E00\u822C mutation \u8FD4\u56DE\u90FD\u662F Payload"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u5177\u6709 Resource/Entity \u5C5E\u6027"}),"\n",(0,l.jsx)(n.li,{children:"CreateUserPayload, UpdateUserPayload"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Input - \u8F93\u5165\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5F3A\u8C03\u6570\u636E\u4F5C\u4E3A\u8F93\u5165"}),"\n",(0,l.jsx)(n.li,{children:"GraphQL \u91CC\u6709 Input \u6982\u5FF5\u533A\u5206\u4E8E Object \u6982\u5FF5"}),"\n",(0,l.jsx)(n.li,{children:"\u5177\u6709 Resource/Entity \u5C5E\u6027"}),"\n",(0,l.jsx)(n.li,{children:"UserCreateInput, UserUpdateInput"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Data - \u6570\u636E\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u7528 - Data -> Key & Value"}),"\n",(0,l.jsx)(n.li,{children:"\u7C7B\u4F3C Dicionary, Record, DTO"}),"\n",(0,l.jsx)(n.li,{children:"UserCreationData, UserUpdateData"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Object - \u5BF9\u8C61\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901A\u5E38\u5185\u5B58\u8868\u793A"}),"\n",(0,l.jsx)(n.li,{children:"\u53EF\u80FD\u652F\u6301\u65B9\u6CD5 - Object -> Method & Fields"}),"\n",(0,l.jsx)(n.li,{children:"UserCreationObject, UserUpdateObject"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Output\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8F93\u51FA"}),"\n",(0,l.jsx)(n.li,{children:"\u5F3A\u8C03\u53EF\u5E8F\u5217\u5316\u7684\u6570\u636E"}),"\n",(0,l.jsx)(n.li,{children:"\u7528\u4E8E IO/API \u4EA4\u4E92\u573A\u666F"}),"\n",(0,l.jsx)(n.li,{children:"\u533A\u5206\u5185\u90E8\u7684 Entity"}),"\n",(0,l.jsx)(n.li,{children:"\u7C7B\u4F3C Object"}),"\n",(0,l.jsx)(n.li,{children:"\u4F8B\u5982: UserEntity, UserOutput, UserObject - \u907F\u514D\u90FD\u53EB User"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},917776:function(e,n,s){s.d(n,{R:()=>d,x:()=>c});var i=s(7378);let l={},r=i.createContext(l);function d(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);