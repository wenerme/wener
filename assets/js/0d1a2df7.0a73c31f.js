"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["47635"],{73519:function(n,e,i){i.r(e),i.d(e,{frontMatter:()=>r,toc:()=>h,default:()=>o,metadata:()=>s,assets:()=>d,contentTitle:()=>t});var s=JSON.parse('{"id":"dev/design/design-auth","title":"Auth","description":"1. \u8D44\u6E90\u8BBF\u95EE","source":"@site/../notes/dev/design/design-auth.md","sourceDirName":"dev/design","slug":"/dev/design/auth","permalink":"/notes/dev/design/auth","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/design/design-auth.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1717134008000,"frontMatter":{"title":"Auth"},"sidebar":"docs","previous":{"title":"Auth API","permalink":"/notes/dev/design/auth-api"},"next":{"title":"\u54CD\u5E94\u5F0F\u65AD\u70B9","permalink":"/notes/dev/design/breakpoint"}}'),l=i(86106),c=i(17776);let r={title:"Auth"},t="Auth",d={},h=[{value:"API Key",id:"api-key",level:2},{value:"OpenAI",id:"openai",level:3},{value:"Service Account",id:"service-account",level:2},{value:"Principal vs Subject",id:"principal-vs-subject",level:2},{value:"ACL",id:"acl",level:2},{value:"Permission",id:"permission",level:2}];function a(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"auth",children:"Auth"})}),"\n",(0,l.jsxs)(e.admonition,{title:"\u573A\u666F",type:"tip",children:[(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:"\u8D44\u6E90\u8BBF\u95EE"}),"\n"]}),(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u6709 Owner \u5BF9\u8C61"}),"\n",(0,l.jsx)(e.li,{children:"\u901A\u5E38\u901A\u8FC7 Agent/Browser \u65B9\u5F0F"}),"\n",(0,l.jsx)(e.li,{children:"\u5BA2\u6237\u7AEF\u4E0D\u53D7\u4FE1"}),"\n",(0,l.jsx)(e.li,{children:"\u4EA4\u6362\u83B7\u53D6 Token"}),"\n",(0,l.jsx)(e.li,{children:"Token \u4F1A\u5931\u6548"}),"\n"]}),(0,l.jsxs)(e.ol,{start:"2",children:["\n",(0,l.jsx)(e.li,{children:"\u670D\u52A1\u8BBF\u95EE - \u540E\u7AEF-\u540E\u7AEF"}),"\n"]}),(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u5BA2\u6237\u7AEF\u53D7\u4FE1"}),"\n",(0,l.jsx)(e.li,{children:"API Key"}),"\n",(0,l.jsx)(e.li,{children:"Service Account"}),"\n",(0,l.jsx)(e.li,{children:"Basic Auth"}),"\n"]})]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"API Auth"}),"\n",(0,l.jsx)(e.li,{children:"Service Auth"}),"\n",(0,l.jsx)(e.li,{children:"Service Account - SA"}),"\n",(0,l.jsx)(e.li,{children:"API Key"}),"\n",(0,l.jsxs)(e.li,{children:["HTTP Auth ",(0,l.jsx)(e.a,{href:"https://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml",children:"HTTP Authentication Schemes"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Basic RFC7617"}),"\n",(0,l.jsx)(e.li,{children:"Bearer RFC6750"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:"PAT - Persional Access Token"}),"\n",(0,l.jsx)(e.li,{children:"Bearer - Opaque \u7684\u5185\u5BB9"}),"\n",(0,l.jsx)(e.li,{children:"JWT \u5BF9 Token \u5185\u5BB9\u505A\u5B9A\u4E49"}),"\n",(0,l.jsxs)(e.li,{children:["ACL\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Subject, Object, Action, Condition, Effect, Priority"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://swagger.io/docs/specification/authentication/",children:"Swagger Aith"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"api-key",children:"API Key"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://swagger.io/docs/specification/authentication/api-keys/",children:"Swagger API Key"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"?api_key=$KEY"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"X-API-Key: $KEY"})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"Cookie: X-API-KEY=KEY"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://apisix.apache.org/docs/apisix/plugins/key-auth/",children:"key-auth"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"X-API-KEY: "})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"apikey: "})}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"?apikey="})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"openai",children:"OpenAI"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"GET https://api.openai.com/v1/models\nAuthorization: Bearer $OPENAI_API_KEY\nOpenAI-Organization: $ORG_ID\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["ORG_ID \u6709\u9ED8\u8BA4\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"org-ID"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["Secret Key\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"sk-KEY"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"service-account",children:"Service Account"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["client_id + client_secret\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"grant=client_credential -> AccessToken"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:"\u53EF\u4EE5\u83B7\u53D6\u7528\u6237\u76F8\u5173\u7684 AccessToken"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"principal-vs-subject",children:"Principal vs Subject"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["Subject - \u8BBF\u95EE\u4E3B\u4F53 - \u8BF7\u6C42\u8BBF\u95EE\u5BF9\u8C61\u6216\u8005\u6267\u884C\u64CD\u4F5C\u7684\u53D1\u8D77\u65B9\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u901A\u7528\u6982\u5FF5 - \u66F4\u62BD\u8C61"}),"\n",(0,l.jsx)(e.li,{children:"\u4E3B\u52A8\u53D1\u8D77"}),"\n",(0,l.jsx)(e.li,{children:"\u5F53\u524D\u72B6\u6001"}),"\n",(0,l.jsx)(e.li,{children:"\u4F7F\u7528\u573A\u666F: ACL, \u4E34\u65F6\u6388\u6743, \u4E3B\u4F53\u9694\u79BB, \u4EE3\u7406\u8BBF\u95EE, \u4F1A\u8BDD\u7BA1\u7406, \u5BA1\u8BA1\u8DDF\u8E2A"}),"\n",(0,l.jsx)(e.li,{children:"\u5E38\u89C1\u4E3B\u4F53: User, Department, Customer, Process, Group, Service Account, System, Device"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["Principal - \u660E\u786E\u8EAB\u4EFD\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u662F\u4E00\u4E2A\u9A8C\u8BC1\u8FC7\u7684\u8EAB\u4EFD,\u901A\u5E38\u662F\u4E00\u4E2A\u6307\u5B9A\u7684\u7528\u6237 - \u66F4\u5177\u4F53"}),"\n",(0,l.jsx)(e.li,{children:"\u88AB\u52A8\u7ED1\u5B9A"}),"\n",(0,l.jsx)(e.li,{children:"\u6301\u4E45\u6807\u8BC6"}),"\n",(0,l.jsx)(e.li,{children:"\u4F7F\u7528\u573A\u666F: \u8BA4\u8BC1, \u6388\u6743, \u8DDF\u8E2A\u5BA1\u8BA1, \u8EAB\u4EFD\u9694\u79BB, \u6743\u9650\u59D4\u6258, \u8D44\u6E90\u5F52\u5C5E, \u8D23\u4EFB\u8FFD\u7A76, \u957F\u4F1A\u8BDD"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"acl",children:"ACL"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"ACL"}),"\n",(0,l.jsx)(e.li,{children:"abilities"}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-ts",children:"// cancancan\n"})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/stalniy/casl",children:"stalniy/casl"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"MIT, JS, TS"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/CanCanCommunity/cancancan",children:"CanCanCommunity/cancancan"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"MIT, Ruby"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/casbin/casbin",children:"casbin"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Apache-2.0, Go"}),"\n",(0,l.jsx)(e.li,{children:"r - request -  sub, obj, act"}),"\n",(0,l.jsx)(e.li,{children:"p - policy - sub, obj, act"}),"\n",(0,l.jsx)(e.li,{children:"e - effect - allow, deny"}),"\n",(0,l.jsx)(e.li,{children:"m - matcher"}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://casbin.org/editor/",children:"https://casbin.org/editor/"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"permission",children:"Permission"})]})}function o(n={}){let{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(a,{...n})}):a(n)}},17776:function(n,e,i){i.d(e,{R:()=>r,x:()=>t});var s=i(7378);let l={},c=s.createContext(l);function r(n){let e=s.useContext(c);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:r(n.components),s.createElement(c.Provider,{value:e},n.children)}}}]);