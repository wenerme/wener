"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["13807"],{19942:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>r,toc:()=>a,default:()=>g,metadata:()=>t,assets:()=>d,contentTitle:()=>i});var t=JSON.parse('{"id":"web/nodejs/nodejs-debug","title":"Debug","description":"- --inspect","source":"@site/../notes/web/nodejs/nodejs-debug.md","sourceDirName":"web/nodejs","slug":"/web/nodejs/debug","permalink":"/notes/web/nodejs/debug","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/nodejs/nodejs-debug.md","tags":[{"inline":true,"label":"Debug","permalink":"/notes/tags/debug"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1753627141000,"frontMatter":{"tags":["Debug"]},"sidebar":"docs","previous":{"title":"NodeJS CLS","permalink":"/notes/web/nodejs/cls"},"next":{"title":"NodeJS FAQ","permalink":"/notes/web/nodejs/faq"}}'),o=s(86106),l=s(17776);let r={tags:["Debug"]},i="Debug",d={},a=[{value:"Memory",id:"memory",level:2}];function c(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"debug",children:"Debug"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"--inspect"}),"\n",(0,o.jsx)(n.li,{children:"--inspect-brk"}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://nodejs.org/en/docs/guides/debugging-getting-started",children:"https://nodejs.org/en/docs/guides/debugging-getting-started"})}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/davidmarkclements/0x",children:"davidmarkclements/0x"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"flamegraph profiling"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"NODE_OPTIONS='--inspect' node script.js\n"})}),"\n",(0,o.jsx)(n.h2,{id:"memory",children:"Memory"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Windows \u91CC\u67E5\u770B vmmem \u662F WSL \u5185\u5B58"}),"\n",(0,o.jsx)(n.li,{children:"WSL \u9ED8\u8BA4\u4E3A Host 50% \u7684\u5185\u5B58"}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"function logMemoryUsage() {\n  const usage = process.memoryUsage();\n  console.log('--- Memory Usage ---');\n  console.log(`RSS: ${(usage.rss / 1024 / 1024).toFixed(2)} MB`); // \u7269\u7406\u5185\u5B58\u5360\u7528\n  console.log(`Heap Total: ${(usage.heapTotal / 1024 / 1024).toFixed(2)} MB`); // \u603B\u5806\u5927\u5C0F\n  console.log(`Heap Used: ${(usage.heapUsed / 1024 / 1024).toFixed(2)} MB`); // \u5DF2\u7528\u5806\u5927\u5C0F\n  console.log(`External: ${(usage.external / 1024 / 1024).toFixed(2)} MB`); // \u5806\u5916\u5185\u5B58\n  console.log('--------------------');\n}\n\nfunction triggerGabageCollection() {\n  if (global.gc) {\n    global.gc();\n    console.log('Garbage collection triggered');\n  } else {\n    console.warn('Garbage collection is not exposed. Run with --expose-gc.');\n  }\n}\n"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"# 4GB \u7684\u5806\u5185\u5B58\nnode --max-old-space-size=4096 --expose-gc --trace-gc main.js\n"})})]})}function g(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},17776:function(e,n,s){s.d(n,{R:()=>r,x:()=>i});var t=s(7378);let o={},l=t.createContext(o);function r(e){let n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);