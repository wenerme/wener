"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["166560"],{653679:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>l,toc:()=>c,default:()=>d,metadata:()=>i,assets:()=>o,contentTitle:()=>s});var i=JSON.parse('{"id":"java/lib/guava","title":"Guava","description":"- google/guava","source":"@site/../notes/java/lib/guava.md","sourceDirName":"java/lib","slug":"/java/lib/guava","permalink":"/notes/java/lib/guava","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/java/lib/guava.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1678678348000,"frontMatter":{"title":"Guava"},"sidebar":"docs","previous":{"title":"Apache Geode","permalink":"/notes/java/lib/geode"},"next":{"title":"Guice","permalink":"/notes/java/lib/guice"}}'),a=t(486106),r=t(917776);let l={title:"Guava"},s="Gauva",o={},c=[{value:"TypeToken",id:"typetoken",level:2},{value:"Immutable",id:"immutable",level:2}];function u(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"gauva",children:"Gauva"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/google/guava",children:"google/guava"})}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"performance",children:"Performance"}),"\n",(0,a.jsx)(n.h2,{id:"typetoken",children:"TypeToken"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5BF9\u6027\u80FD\u6709\u4E00\u5B9A\u5F71\u54CD, \u8C28\u614E\u4F7F\u7528"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Benchmark                       Mode  Cnt     Score     Error  Units\nBenchTypeToken.generic          avgt   10     4.001 \xb1   0.197  ns/op\nBenchTypeToken.typeTokenString  avgt   10   973.403 \xb1  13.519  ns/op\nBenchTypeToken.typeTokenTwo     avgt   10  3289.355 \xb1 134.182  ns/op\nBenchTypeToken.typeTokenVoid    avgt   10  1019.551 \xb1  43.565  ns/op\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'@State(Scope.Thread)\n@OutputTimeUnit(TimeUnit.NANOSECONDS)\n@Warmup(iterations = 4)\n@Measurement(iterations = 10)\n@BenchmarkMode(Mode.AverageTime)\npublic class BenchTypeToken {\n  public static void main(String[] args) throws RunnerException {\n    Options options =\n        new OptionsBuilder()\n            .include(BenchTypeToken.class.getSimpleName())\n            .threads(1)\n            .forks(1)\n            .shouldFailOnError(true)\n            .shouldDoGC(true)\n            .jvmArgs("-server")\n            .measurementTime(TimeValue.seconds(2))\n            .build();\n    new Runner(options).run();\n  }\n\n  @Benchmark\n  public void typeTokenString(Blackhole bh) {\n    bh.consume(new ATyped());\n  }\n\n  @Benchmark\n  public void typeTokenVoid(Blackhole bh) {\n    bh.consume(new ATyped());\n  }\n\n  @Benchmark\n  public void typeTokenTwo(Blackhole bh) {\n    bh.consume(new ATyped2());\n  }\n\n  @Benchmark\n  public void generic(Blackhole bh) {\n    bh.consume(new AGen());\n  }\n\n  static class ATyped extends TypedImpl<Void> {}\n\n  static class ATypedS extends TypedImpl<String> {}\n\n  static class ATyped2 extends TypedImpl2<Void, Void> {}\n\n  static class AGen extends GenImpl<Void> {}\n\n  @Getter\n  @Setter\n  static class TypedImpl<IN> {\n\n    private final TypeToken<IN> in = new TypeToken<IN>(getClass()) {};\n  }\n\n  @Getter\n  @Setter\n  static class TypedImpl2<IN, OUT> {\n\n    private final TypeToken<IN> in = new TypeToken<IN>(getClass()) {};\n    private final TypeToken<OUT> out = new TypeToken<OUT>(getClass()) {};\n  }\n\n  @Getter\n  @Setter\n  static class GenImpl<IN> {}\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"immutable",children:"Immutable"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u6BD4\u6B63\u5E38\u7684\u6027\u80FD\u7A0D\u5FAE\u597D\u4E00\u70B9\u70B9"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Benchmark                     Mode  Cnt     Score     Error  Units\nBenchImmutable.immutableList  avgt   10  4288.096 \xb1  97.184  ns/op\nBenchImmutable.immutableMap   avgt   10  7922.092 \xb1 368.066  ns/op\nBenchImmutable.list           avgt   10  4739.961 \xb1 131.327  ns/op\nBenchImmutable.map            avgt   10  8779.917 \xb1 498.843  ns/op\n"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'@State(Scope.Thread)\n@OutputTimeUnit(TimeUnit.NANOSECONDS)\n@Warmup(iterations = 4)\n@Measurement(iterations = 10)\n@BenchmarkMode(Mode.AverageTime)\npublic class BenchImmutable {\n  public static void main(String[] args) throws RunnerException {\n    Options options =\n        new OptionsBuilder()\n            .include(BenchImmutable.class.getSimpleName())\n            .threads(1)\n            .forks(1)\n            .shouldFailOnError(true)\n            .shouldDoGC(true)\n            .jvmArgs("-server")\n            .measurementTime(TimeValue.seconds(8))\n            .build();\n    new Runner(options).run();\n  }\n\n  @Benchmark\n  public void list(Blackhole bh) {\n    ArrayList<Integer> list = Lists.newArrayList();\n    for (int i = 0; i < 100; i++) {\n      list.add(i);\n    }\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(list.get(i % 100));\n    }\n  }\n\n  @Benchmark\n  public void immutableList(Blackhole bh) {\n    Builder<Integer> builder = ImmutableList.builder();\n    for (int i = 0; i < 100; i++) {\n      builder.add(i);\n    }\n    ImmutableList<Integer> list = builder.build();\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(list.get(i % 100));\n    }\n  }\n\n  @Benchmark\n  public void map(Blackhole bh) {\n    HashMap<Integer, Integer> map = Maps.newHashMap();\n\n    for (int i = 0; i < 100; i++) {\n      map.put(i, i);\n    }\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(map.get(i % 100));\n    }\n  }\n\n  @Benchmark\n  public void immutableMap(Blackhole bh) {\n    ImmutableMap.Builder<Integer, Integer> builder = ImmutableMap.builder();\n\n    for (int i = 0; i < 100; i++) {\n      builder.put(i, i);\n    }\n    ImmutableMap<Integer, Integer> map = builder.build();\n    for (int i = 0; i < 1000; i++) {\n      bh.consume(map.get(i % 100));\n    }\n  }\n}\n'})})]})}function d(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},917776:function(e,n,t){t.d(n,{R:()=>l,x:()=>s});var i=t(7378);let a={},r=i.createContext(a);function l(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);