"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["3223"],{37762:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>s,toc:()=>a,default:()=>p,metadata:()=>i,assets:()=>d,contentTitle:()=>c});var i=JSON.parse('{"id":"web/spec/fedcm","title":"FedCM","description":"- https://fedidcg.github.io/FedCM/","source":"@site/../notes/web/spec/fedcm.md","sourceDirName":"web/spec","slug":"/web/spec/fedcm","permalink":"/notes/web/spec/fedcm","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/spec/fedcm.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1657531736000,"frontMatter":{"title":"FedCM"},"sidebar":"docs","previous":{"title":"Drag & Drop","permalink":"/notes/web/spec/dnd"},"next":{"title":"fetch","permalink":"/notes/web/spec/fetch"}}'),r=t(86106),l=t(17776);let s={title:"FedCM"},c="FedCM",d={},a=[];function o(e){let n={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"fedcm",children:"FedCM"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://fedidcg.github.io/FedCM/",children:"https://fedidcg.github.io/FedCM/"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Chrome 105"}),"\n",(0,r.jsx)(n.li,{children:"WebID"}),"\n",(0,r.jsx)(n.li,{children:"\u7531\u6D4F\u89C8\u5668\u8FDB\u884C oauth \u64CD\u4F5C"}),"\n",(0,r.jsx)(n.li,{children:"/.well-known/web-identity -> provider_urls"}),"\n",(0,r.jsx)(n.li,{children:"IdentityCredential"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/credentials",children:"navigator.credentials"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://w3c.github.io/webappsec-credential-management",children:"Credential Management"})}),"\n",(0,r.jsx)(n.li,{children:"Chrome 51+, Safari 13"}),"\n",(0,r.jsxs)(n.li,{children:["mdn ",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/FederatedCredential",children:"FederatedCredential"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"<html>\n  <head>\n    <title>Welcome to my Website</title>\n  </head>\n  <body>\n    <button onclick=\"login()\">Login with idp.example</button>\n\n    <script>\n      async function login() {\n        // IdentityCredential\n        // <code data-opaque bs-autolink-syntax='`token`'>token</code>\n        return await navigator.credentials.get({\n          mediation: 'optional', // \u9ED8\u8BA4\u4E3A optional\n          // \u65B0\u589E\n          identity: {\n            providers: [\n              {\n                configURL: 'https://idp.example/manifest.json',\n                clientId: '123',\n                nonce: random(), //\n              },\n            ],\n          },\n        });\n      }\n    <\/script>\n  </body>\n</html>\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "accounts_endpoint": "",\n  "client_metadata_endpoint": "",\n  "id_token_endpoint": "",\n  "branding": {\n    "background_color": "",\n    "color": "",\n    "icons": [{"url": "", "size": 32}]\n  }\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Accounts List"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "accounts": [\n    {\n      "id": "",\n      "name": "",\n      "email": "",\n      "given_name": "",\n      "picture": "",\n      "approved_clients": [""]\n    }\n  ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Client Metadata"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "privacy_policy_url": "https://rp.example/clientmetadata/privacy_policy.html",\n  "terms_of_service_url": "https://rp.example/clientmetadata/terms_of_service.html"\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"ID Token"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"POST /fedcm_token_endpoint HTTP/1.1\nHost: idp.example\nReferer: https://rp.example/\nContent-Type: application/x-www-form-urlencoded\nCookie: 0x23223\nSec-FedCM-CSRF: ?1\naccount_id=123&client_id=client1234&nonce=Ct60bD&disclosure_text_shown=true\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6240\u6709\u6D4F\u89C8\u5668\u53D1\u8D77\u7684\u8BF7\u6C42\u90FD\u4F1A\u5E26\u4E0A Sec-FedCM-CSRF"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "token" : "JWT"\n}\n'})})]})}function p(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},17776:function(e,n,t){t.d(n,{R:()=>s,x:()=>c});var i=t(7378);let r={},l=i.createContext(r);function s(e){let n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);