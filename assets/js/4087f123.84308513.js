"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["976531"],{55890:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>d,toc:()=>h,default:()=>a,metadata:()=>i,assets:()=>c,contentTitle:()=>t});var i=JSON.parse('{"id":"network/application/dns","title":"DNS","description":"Tips","source":"@site/../notes/network/application/dns.md","sourceDirName":"network/application","slug":"/network/application/dns","permalink":"/notes/network/application/dns","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/network/application/dns.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1645033829000,"frontMatter":{"id":"dns","title":"DNS"},"sidebar":"docs","previous":{"title":"DNS over HTTPS (DoH)","permalink":"/notes/network/application/dns-over-https"},"next":{"title":"HTTP Security","permalink":"/notes/network/application/http-security"}}'),r=s(486106),l=s(917776);let d={id:"dns",title:"DNS"},t="DNS",c={},h=[{value:"Tips",id:"tips",level:2},{value:"\u670D\u52A1",id:"\u670D\u52A1",level:2},{value:"coredns",id:"coredns",level:2},{value:"dnsupdate",id:"dnsupdate",level:2},{value:"dig",id:"dig",level:2},{value:"FAQ",id:"faq",level:3},{value:"\u516C\u5171 DSN",id:"\u516C\u5171-dsn",level:4},{value:"\u5C06\u65E5\u5FD7\u8BB0\u5F55\u5230\u6587\u4EF6",id:"\u5C06\u65E5\u5FD7\u8BB0\u5F55\u5230\u6587\u4EF6",level:4},{value:"DDNS",id:"ddns",level:4},{value:"\u4F18\u5316",id:"\u4F18\u5316",level:3}];function o(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"dns",children:"DNS"})}),"\n",(0,r.jsx)(e.h2,{id:"tips",children:"Tips"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Comparison_of_DNS_server_software",children:"Comparison of DNS server software"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.isc.org/community/rfcs/dns/",children:"DNS RFC"})}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://tools.ietf.org/html/rfc2136",children:"rfc2136"})," - Dynamic Updates in the Domain Name System (DNS UPDATE)\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Dynamic_DNS",children:"Dynamic DNS:wiki"})}),"\n",(0,r.jsxs)(e.li,{children:["caddy ",(0,r.jsx)(e.a,{href:"https://caddyserver.com/docs/tls.dns.rfc2136",children:"tls.dns.rfc2136"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://intodns.com",children:"intodns"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"DNS \u68C0\u6D4B"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://zh.wikipedia.org/zh-cn/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F",children:"DNS"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/List_of_DNS_record_types",children:"List of DNS record types"})}),"\n",(0,r.jsxs)(e.li,{children:["\u5237\u65B0 Google ",(0,r.jsx)(e.a,{href:"https://developers.google.com/speed/public-dns/cache",children:"Public DNS"})]}),"\n",(0,r.jsx)(e.li,{children:"SOA - Start of [a zone of] authority record"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"Primary nameserver: ns.wener.me\nHostmaster E-mail address: hostmaster.i.wener.me\nSerial #: 1\nRefresh: 10800\nRetry: 3600\nExpire: 604800   1 weeks\nDefault TTL: 3600\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"TSIG - Transaction Signature"}),"\n",(0,r.jsxs)(e.li,{children:["KSK - Key Signing Key\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u662F\u4E00\u5BF9\u516C\u94A5\u79C1\u94A5."}),"\n",(0,r.jsx)(e.li,{children:"\u79C1\u94A5\u7528\u4E8E\u751F\u6210 ZSK \u7684\u6570\u5B57\u7B7E\u540D. \u516C\u94A5\u5B58\u50A8\u4E8E DNS, \u7528\u4E8E\u5BF9 ZSK \u8FDB\u884C\u8BA4\u8BC1"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["ZSK - Zone Signing Key\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u662F\u4E00\u5BF9\u516C\u94A5\u79C1\u94A5."}),"\n",(0,r.jsx)(e.li,{children:"\u79C1\u94A5\u7528\u4E8E\u751F\u6210\u6570\u5B57\u7B7E\u540D, \u5373\u4E3A\u6BCF\u4E2A RRSET \u751F\u6210 RSSIG(Resource Record Signature).\u516C\u94A5\u5B58\u50A8\u4E8E DNS \u7528\u4E8E\u5BF9 RRSIG \u8FDB\u884C\u8BA4\u8BC1."}),"\n",(0,r.jsx)(e.li,{children:"\u6BCF\u4E2A DNSSET \u4E2D\u7B7E\u540D\u7684 zone \u90FD\u7531 RRSIG \u4FDD\u62A4"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["AXFR - Authoritative Zone Transfer\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/DNS_zone_transfer",children:"DNS zone transfer"})}),"\n",(0,r.jsxs)(e.li,{children:["PowerDNS ",(0,r.jsx)(e.a,{href:"https://github.com/PowerDNS/pdns/wiki/AXFR-FAQ",children:"AXFR-FAQ"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["References\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.cloudflare.com/dns/dnssec/how-dnssec-works/",children:"How DNSSEC works"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"http://tinydns.org/",children:"http://tinydns.org/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/miekg/dns",children:"https://github.com/miekg/dns"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"http://social.dnsmadeeasy.com/blog/authoritative-vs-recursive-dns-servers-whats-the-difference/",children:"Authoritative vs. Recursive DNS Servers: What\u2019s The Difference?"})}),"\n",(0,r.jsxs)(e.li,{children:["dnsimple ",(0,r.jsx)(e.a,{href:"https://support.dnsimple.com/categories/dns/",children:"DNS FAQ"})]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://support.dnsimple.com/articles/differences-between-a-cname-alias-url/",children:"Differences between the A, CNAME, ALIAS and URL records"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u670D\u52A1",children:"\u670D\u52A1"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.knot-dns.cz/",children:"https://www.knot-dns.cz/"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"C + Lua"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.a,{href:"https://github.com/tenta-browser/tenta-dns",children:"tenta-browser/tenta-dns"})," Recursive and authoritative DNS server in go, including DNSSEC and DNS-over-TLS"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://news.ycombinator.com/item?id=15796943",children:"HN"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"coredns",children:"coredns"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://coredns.io/",children:"https://coredns.io/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/coredns/coredns",children:"https://github.com/coredns/coredns"})}),"\n",(0,r.jsx)(e.li,{children:"CNCF \u4E0B\u7684\u9879\u76EE"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"coredns -conf Corefile -dns.port 1053\n\ndig -p 1053 @localhost AAAA www.example.org +noall +answer\n\nnslookup -type=A twitter.com 1.0.0.1\nnslookup -type=A twitter.com 114.114.114.114\n"})}),"\n",(0,r.jsx)(e.h2,{id:"dnsupdate",children:"dnsupdate"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://linux.die.net/man/8/nsupdate",children:"nsupdate.8"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u66F4\u65B0 NS \u8BB0\u5F55\u7684\u51FD\u6570\nns_update_record(){\n  nsupdate -y $TSIG_NAME:$TSIG_SECRET <<!\n  update delete $1 $3\n  update add $1 $2 $3 $4\n  send\n  !\n}\n# ns_update_record test.wener.me 600 A 192.168.1.1\n"})}),"\n",(0,r.jsx)(e.h2,{id:"dig",children:"dig"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u6240\u6709 IP\ndig +short amazon.com\n# \u6240\u6709 NS\ndig NS +short amazon.com\n# \u8BF7\u6C42\u8FC7\u7A0B\ndig amazone.com +trace\n# \u901A\u8FC7 IP \u8BF7\u6C42\u57DF\u540D\ndig +short -x 8.8.8.8\n# \u9876\u7EA7\u57DF\u540D\u7684 NS\ndig +short NS me.\n# \u6307\u5B9A\u8BF7\u6C42\u7684 ns\ndig google.com @8.8.8.8\n# \u83B7\u53D6\u8D85\u65F6\u65F6\u95F4\ndig google.com +noall +answer\n# \u5224\u65AD\u662F\u5426\u6240\u6709 NS \u90FD\u540C\u6B65\u4E86\u57DF\u540D, \u4E3B\u8981\u901A\u8FC7 SOA \u5E8F\u53F7\u5224\u65AD\ndig google.com +nssearch\n# \u770B\u57DF\u540D\u5728 DNS \u4E0A\u662F\u5426\u5B58\u5728\ndig SOA google.nl @ns1.dns.nl.\n"})}),"\n",(0,r.jsx)(e.h3,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(e.h4,{id:"\u516C\u5171-dsn",children:"\u516C\u5171 DSN"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://public-dns.info/",children:"https://public-dns.info/"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://wiki.ipfire.org/dns/public-servers",children:"https://wiki.ipfire.org/dns/public-servers"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.lifewire.com/free-and-public-dns-servers-2626062",children:"https://www.lifewire.com/free-and-public-dns-servers-2626062"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"https://www.dnsperf.com",children:"https://www.dnsperf.com"})}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"8.8.8.8"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"8.8.4.4"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"223.6.6.6"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"223.5.5.5"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"114.114.114.114"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"1.1.1.1"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://blog.cloudflare.com/dns-resolver-1-1-1-1/",children:"https://blog.cloudflare.com/dns-resolver-1-1-1-1/"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"1.0.0.1"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h4,{id:"\u5C06\u65E5\u5FD7\u8BB0\u5F55\u5230\u6587\u4EF6",children:"\u5C06\u65E5\u5FD7\u8BB0\u5F55\u5230\u6587\u4EF6"}),"\n",(0,r.jsx)(e.p,{children:"\u4FEE\u6539\u914D\u7F6E,\u8C03\u6574 syslog \u8F93\u51FA"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u4F7F\u7528 LOCAL0 \u4F5C\u4E3A\u65E5\u5FD7\u8F93\u51FA\nlogging-facility=0\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u91CD\u5B9A\u5411 syslog \u8F93\u51FA"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u4FEE\u6539 syslog.conf\nlocal0	/var/log/pdns.log\n"})}),"\n",(0,r.jsx)(e.h4,{id:"ddns",children:"DDNS"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://wiki.archlinux.org/index.php/Dynamic_DNS",children:"https://wiki.archlinux.org/index.php/Dynamic_DNS"})}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u4FEE\u6539 pdns.conf \u542F\u7528 dnsupdate"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u542F\u7528\ndnsupdate=yes\n# \u9ED8\u8BA4\u662F 0.0.0.0/0, \u7F6E\u7A7A\u5219\u7981\u6B62\u6240\u6709\nallow-dnsupdate-from=\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u751F\u6210 TSIG\npu generate-tsig-key home-test hmac-md5\n# \u4E3A\u8BE5 ZONE \u8BBE\u7F6E\u5141\u8BB8\u4FEE\u6539\npu set-meta i.wener.me ALLOW-DNSUPDATE-FROM 0.0.0.0/0\n# \u4F7F\u7528 nsupdate \u66F4\u65B0\u8BB0\u5F55\nnsupdate <<!\nserver 127.0.0.1 5300\nzone i.wener.me\nupdate delete dev.i.wener.me. A\nupdate add dev.i.wener.me. 3600 A 127.0.0.4\nkey home-wener jI8oJLnLIVOEc6QR7fCUylRnpiD3DL4yXgvBQoaAodM=\nsend\n!\n\n# \u751F\u6210\u53E6\u5916\u4E00\u4E2A tsig\npu generate-tsig-key home-test2 hmac-md5\n# \u4FEE\u6539\u4E3A\u53EA\u5141\u8BB8\u6307\u5B9A\u7684 tsig \u4FEE\u6539\npu set-meta i.wener.me TSIG-ALLOW-DNSUPDATE home-test2\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4F18\u5316",children:"\u4F18\u5316"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://doc.powerdns.com/md/authoritative/performance/",children:"Performance and Tuning"})}),"\n",(0,r.jsx)(e.li,{children:"\u67E5\u8BE2\u7F13\u5B58"}),"\n",(0,r.jsx)(e.li,{children:"\u5305\u7F13\u5B58"}),"\n",(0,r.jsx)(e.li,{children:"\u76D1\u63A7\u7EDF\u8BA1"}),"\n",(0,r.jsx)(e.li,{children:"\u65E5\u5FD7"}),"\n",(0,r.jsx)(e.li,{children:"\u540E\u7AEF\u7F13\u5B58"}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"# \u4EE5\u4E0B\u7684\u503C\u5747\u4E3A\u9ED8\u8BA4\u503C\n\n# SO_REUSEPORT\nreuseport=no\n# \u542F\u52A8\u76D1\u542C\u7684\u7EBF\u7A0B\u6570, \u4E00\u822C\u5EFA\u8BAE 3-4\nreceiver-threads=1\n# \u6BCF\u4E2A\u63A5\u6536\u7EBF\u7A0B\u5BF9\u5E94\u7684\u540E\u7AEF\u7EBF\u7A0B\u6570\ndistributor-threads=3\n# \u5305\u7F13\u5B58\u7684\u65F6\u95F4, \u5C06\u5305\u7F13\u5B58\u540E\u4E0D\u9700\u8981\u8BF7\u6C42\u540E\u7AEF\u6765\u4ECE\u65B0\u7EC4\u88C5\u4E00\u4E2A\u5B8C\u6574\u7684\u6570\u636E\u5305\n# \u8BBE\u7F6E\u4E3A 60 \u4E00\u822C\u4E0D\u4F1A\u6709\u95EE\u9898\n# \u4E5F\u53EF\u4EE5\u5C06\u8BE5\u503C\u8BBE\u7F6E\u4E3A\u51E0\u4E2A\u5C0F\u65F6, \u9700\u8981\u6E05\u9664\u7F13\u5B58\u7684\u65F6\u5019\u901A\u8FC7 pdns_control purge \u6765\u6E05\u9664\ncache-ttl=20\n# \u7F13\u5B58\u67E5\u8BE2\u548C\u7ED3\u679C\u7684\u65F6\u95F4\nquery-cache-ttl=20\n# \u7F13\u5B58\u67E5\u8BE2\u4F46\u4E0D\u7F13\u5B58\u7ED3\u679C\u7684\u65F6\u95F4\nnegquery-cache-ttl=60\n"})})]})}function a(n={}){let{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},917776:function(n,e,s){s.d(e,{R:()=>d,x:()=>t});var i=s(7378);let r={},l=i.createContext(r);function d(n){let e=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);