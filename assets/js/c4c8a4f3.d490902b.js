"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["18838"],{85414:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>p,toc:()=>o,default:()=>u,metadata:()=>r,assets:()=>l,contentTitle:()=>i});var r=JSON.parse('{"id":"os/linux/network/tcpdump","title":"tcpdump","description":"- \u53C2\u8003","source":"@site/../notes/os/linux/network/tcpdump.md","sourceDirName":"os/linux/network","slug":"/os/linux/network/tcpdump","permalink":"/notes/os/linux/network/tcpdump","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/network/tcpdump.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1685296509000,"frontMatter":{"title":"tcpdump"},"sidebar":"docs","previous":{"title":"TCP","permalink":"/notes/os/linux/network/tcp"},"next":{"title":"tshark","permalink":"/notes/os/linux/network/tshark"}}'),s=t(86106),c=t(17776);let p={title:"tcpdump"},i="tcpdump",l={},o=[{value:"\u6293\u8FDB\u7A0B\u7F51\u7EDC",id:"\u6293\u8FDB\u7A0B\u7F51\u7EDC",level:2}];function d(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,c.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"tcpdump",children:"tcpdump"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://www.tcpdump.org/manpages/tcpdump.1.html",children:"tcpdump.1"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://danielmiessler.com/study/tcpdump/",children:"A tcpdump Tutorial with Examples"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"http://www.mavetju.org/unix/dhcpdump-man.php",children:"dhcpdump"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"http://linuxwiki.github.io/NetTools/tcpdump.html",children:"http://linuxwiki.github.io/NetTools/tcpdump.html"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://github.com/linuxwiki/SourceWiki",children:"https://github.com/linuxwiki/SourceWiki"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u76D1\u542C ICMP\ntcpdump -nni eth0 icmp\n# NAT \u5305\ntcpdump -qnn\n# \u5E7F\u64AD\u5305 - DHCP, ARP\ntcpdump -n -i mynet broadcast\n# DHCP - \u5339\u914D Client MAC\ntcpdump -i br0 -vvv -s 1500 '((port 67 or port 68) and (udp[38:4] = 0x3e0ccf08))'\n# DHCP - DISCOVER, REQUEST, INFORM\ntcpdump -i br0 -vvv -s 1500 '((port 67 or port 68) and (udp[8:1] = 0x1))'\n\ntcpdump port 80 -w capture_file\ntcpdump -r capture_file\n\ntcpdump -i any host 1.1.1.1\n\n\n# HTTP GET \u663E\u793A\u5934\u4FE1\u606F\ntcpdump -vvvs 1024 -A port 80 and 'tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420'\n# POST \u8BF7\u6C42\ntcpdump -vvvs 1024 -A port 80 and 'tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x504F5354'\n"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# \u534F\u8BAE\n# /etc/protocols\nicmp\nip6\n\n# \u7AEF\u53E3\nport 443\nportrange 21-23\n\n# \u4E3B\u673A\n# to or from\nhost 1.1.1.1\n# to or from\nnet 1.2.3.0/24\n\n# from\nsrc 1.1.1.1\n# to\ndst 1.0.0.1\n\n# \u6765\u6E90\u9650\u5B9A\nsrc port 1025\nsrc net 192.168.0.0/16\n\n# \u5305\u5927\u5C0F\nless 32\ngreater 64\n<= 128\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6293\u8FDB\u7A0B\u7F51\u7EDC",children:"\u6293\u8FDB\u7A0B\u7F51\u7EDC"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"strace -f -e trace=network -s 10000 PROCESS\nstrace -f -e trace=network -s 10000 -p PID\n"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://github.com/nsntrace/nsntrace",children:"https://github.com/nsntrace/nsntrace"})}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"tcptracer-bpfcc -v -p (PID)\n"})})]})}function u(n={}){let{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},17776:function(n,e,t){t.d(e,{R:()=>p,x:()=>i});var r=t(7378);let s={},c=r.createContext(s);function p(n){let e=r.useContext(c);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:p(n.components),r.createElement(c.Provider,{value:e},n.children)}}}]);