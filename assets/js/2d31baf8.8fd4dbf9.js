"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["63441"],{84191:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>c,toc:()=>o,default:()=>a,metadata:()=>r,assets:()=>t,contentTitle:()=>d});var r=JSON.parse('{"id":"platform/wechat/wechat-miniprogram","title":"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F","description":"- wxss/css","source":"@site/../notes/platform/wechat/wechat-miniprogram.md","sourceDirName":"platform/wechat","slug":"/platform/wechat/miniprogram","permalink":"/notes/platform/wechat/miniprogram","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/platform/wechat/wechat-miniprogram.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1713335755000,"frontMatter":{"title":"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F"},"sidebar":"docs","previous":{"title":"\u5FAE\u4FE1\u6D88\u606F","permalink":"/notes/platform/wechat/message"},"next":{"title":"\u5FAE\u4FE1\u516C\u4F17\u53F7","permalink":"/notes/platform/wechat/officialaccount"}}'),s=i(86106),l=i(17776);let c={title:"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F"},d="\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F",t={},o=[{value:"API",id:"api",level:2},{value:"\u5206\u6790",id:"\u5206\u6790",level:2},{value:"wx",id:"wx",level:2},{value:"Library",id:"library",level:2},{value:"JS \u8BED\u6CD5",id:"js-\u8BED\u6CD5",level:2},{value:"app.json",id:"appjson",level:2},{value:"CORS",id:"cors",level:2},{value:"\u8BF7\u6C42\u4F1A\u5305\u542B\u5E94\u7528\u4FE1\u606F",id:"\u8BF7\u6C42\u4F1A\u5305\u542B\u5E94\u7528\u4FE1\u606F",level:2},{value:"\u7528\u6237\u4FE1\u606F",id:"\u7528\u6237\u4FE1\u606F",level:2},{value:"SyntaxError: Unexpected token \uFF1F",id:"syntaxerror-unexpected-token-",level:2},{value:"SyntaxError: Unexpected token .&quot;use strict&quot;;",id:"syntaxerror-unexpected-token-use-strict",level:2},{value:"miniprogram-ci 10009 undefined",id:"miniprogram-ci-10009-undefined",level:2},{value:"render webview vs skyline",id:"render-webview-vs-skyline",level:2}];function h(e){let n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F",children:"\u5FAE\u4FE1\u5C0F\u7A0B\u5E8F"})}),"\n",(0,s.jsx)(n.admonition,{title:"\u8FD0\u884C\u65F6\u533A\u522B",type:"caution",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["wxss/css\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301 ",(0,s.jsx)(n.code,{children:"*"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u540D\u5B57\u4E0D\u80FD\u5305\u542B ",(0,s.jsx)(n.code,{children:":"}),",",(0,s.jsx)(n.code,{children:"#"}),",",(0,s.jsx)(n.code,{children:"/"}),",",(0,s.jsx)(n.code,{children:"["}),",",(0,s.jsx)(n.code,{children:"]"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301\u6709\u4E9B\u573A\u666F\u7684 ",(0,s.jsx)(n.code,{children:"~"})]}),"\n",(0,s.jsx)(n.li,{children:"\u4E0D\u652F\u6301 rem"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["DOM \u73AF\u5883\u65E0\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"fetch/Header/Request/Response"}),"\n",(0,s.jsx)(n.li,{children:"File/Blob/ReadableStream"}),"\n",(0,s.jsx)(n.li,{children:"FormData"}),"\n",(0,s.jsx)(n.li,{children:"AbortController/AbortSignal"}),"\n",(0,s.jsx)(n.li,{children:"URLSearchParams"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301 svg \u6807\u7B7E\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u652F\u6301 canvas"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/dntzhang/cax",children:"https://github.com/dntzhang/cax"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u901A\u8FC7 canvas \u6E32\u67D3 svg"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53EF\u4EE5\u901A\u8FC7 Image.src \u4F7F\u7528 svg\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://juejin.cn/post/6936529740433997861",children:"https://juejin.cn/post/6936529740433997861"})}),"\n",(0,s.jsx)(n.li,{children:"\u53EF\u4EE5 dataurl"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u6709 TextEncoder/TextDecoder/ArrayBuffer"}),"\n",(0,s.jsxs)(n.li,{children:["JS \u8BED\u6CD5\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301 ",(0,s.jsx)(n.code,{children:"??"}),", ",(0,s.jsx)(n.code,{children:"?."})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301 ",(0,s.jsx)(n.code,{children:"eval"}),", ",(0,s.jsx)(n.code,{children:"new Function"})]}),"\n",(0,s.jsx)(n.li,{children:"\u5185\u7F6E core-js"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://mp.weixin.qq.com/",children:"https://mp.weixin.qq.com/"})," \u767B\u5F55\u540E\u53F0"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://mp.weixin.qq.com/cgi-bin/wx",children:"https://mp.weixin.qq.com/cgi-bin/wx"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://kf.qq.com/faq/170109umMvm6170109MZNnYV.html",children:"https://kf.qq.com/faq/170109umMvm6170109MZNnYV.html"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u547D\u540D\u89C4\u5219"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u624B\u673A\u53F7\u5FEB\u901F\u9A8C\u8BC1 ",(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html",children:"getPhoneNumber"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5E73\u53F0\u4E0D\u505A\u4E8C\u6B21\u5B9E\u9645\u6821\u9A8C"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u624B\u673A\u53F7\u5B9E\u65F6\u9A8C\u8BC1 ",(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getRealtimePhoneNumber.html",children:"getRealtimePhoneNumber"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u{1F4B2} \u4ED8\u8D39\u4F7F\u7528"}),"\n",(0,s.jsx)(n.li,{children:"\u5E73\u53F0\u8FDB\u884C\u5B9E\u9645\u6821\u9A8C"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["wx.getSetting()\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u83B7\u53D6\u6743\u9650\u4FE1\u606F"}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"scope.userInfo"}),",",(0,s.jsx)(n.code,{children:"scope.address"}),",",(0,s.jsx)(n.code,{children:"scope.invoice"}),",",(0,s.jsx)(n.code,{children:"scope.invoiceTitle"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["wx.getUserInfo\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4E00\u6B21\u6027\u6388\u6743"}),"\n",(0,s.jsxs)(n.li,{children:["\u8FD4\u56DE",(0,s.jsx)(n.strong,{children:"\u533F\u540D"}),"\u4FE1\u606F"]}),"\n",(0,s.jsx)(n.li,{children:"\u9700\u8981 scope.userInfo"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["wx.getUserProfile\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u6BCF\u6B21\u6388\u6743"}),"\n",(0,s.jsx)(n.li,{children:"2021\u5E744\u6708"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u5206\u6790",children:"\u5206\u6790"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"console.assert(globalThis === window);\nconst global = {\n  __wcc_version__: 'v0.5vv_20200413_syb_scopedata',\n  __wcc_version_info__: {\n    customComponents: true,\n    fixZeroRpx: true,\n    propValueDeepCopy: false,\n  },\n};\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"\u5185\u90E8\u7F16\u8BD1\u5668"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["wcc\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"wxml -> js"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["wcsc\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"wxss -> js"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://zhaomenghuan.js.org/blog/wechat-miniprogram-principle-analysis.html",children:"https://zhaomenghuan.js.org/blog/wechat-miniprogram-principle-analysis.html"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"wx",children:"wx"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Taro\nwx['webpackJsonp'];\nconsole.assert(wxModuleVersion === 2);\nWXWebAssembly;\n\n__wxAppCode__;\n__wxAppData;\n__wxAppCurrentFile__;\n__wxConfig;\n__wxRoute;\nwx.env;\n\n__wxAppCode__[__wxRoute + '.json'];\n__wxAppCode__[__wxRoute + '.wxml'];\n"})}),"\n",(0,s.jsx)(n.h2,{id:"library",children:"Library"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["NodeJS\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://www.npmjs.com/package/wx-server-sdk",children:"wx-server-sdk"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://cdn.jsdelivr.net/npm/wx-server-sdk/",children:"https://cdn.jsdelivr.net/npm/wx-server-sdk/"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"js-\u8BED\u6CD5",children:"JS \u8BED\u6CD5"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/wechat-miniprogram/miniprogram-compat",children:"wechat-miniprogram/miniprogram-compat"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://wechat-miniprogram.github.io/miniprogram-compat/",children:"https://wechat-miniprogram.github.io/miniprogram-compat/"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/devtools/codecompile.html",children:"https://developers.weixin.qq.com/miniprogram/dev/devtools/codecompile.html"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/js-support.html",children:"https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/js-support.html"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"appjson",children:"app.json"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/config.html",children:"https://developers.weixin.qq.com/miniprogram/dev/framework/config.html"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html",children:"https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"project.config.json"}),"\n",(0,s.jsx)(n.li,{children:"project.private.config.json"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,s.jsx)(n.h2,{id:"cors",children:"CORS"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"request \u8BF7\u6C42\u53EF\u4EE5\u76F4\u63A5\u4FEE\u6539 Origin"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u56FE\u7247\u8D44\u6E90"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cross-origin-resource-policy: cross-origin\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u8BF7\u6C42\u4F1A\u5305\u542B\u5E94\u7528\u4FE1\u606F",children:"\u8BF7\u6C42\u4F1A\u5305\u542B\u5E94\u7528\u4FE1\u606F"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"referer: https://servicewechat.com/WXID/devtools/page-frame.html\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u7528\u6237\u4FE1\u606F",children:"\u7528\u6237\u4FE1\u606F"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { appid, fakeId, nickName, openid, userName } = window.__INITIAL_STATE__.userInfo;\ncopy(JSON.stringify({ appid, fakeId, nickName, openid, userName }, null, 2));\n"})}),"\n",(0,s.jsx)(n.h2,{id:"syntaxerror-unexpected-token-",children:"SyntaxError: Unexpected token \uFF1F"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"??"})," \u7684\u95EE\u9898"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"syntaxerror-unexpected-token-use-strict",children:'SyntaxError: Unexpected token ."use strict";'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"?."})," \u7684\u95EE\u9898"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"miniprogram-ci-10009-undefined",children:"miniprogram-ci 10009 undefined"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u4E0D\u8981\u628A miniprogram-ci \u5B89\u88C5\u5728\u73B0\u6709\u9879\u76EE\u91CC\uFF0C\u592A\u591A\u4F9D\u8D56\u4E86"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"PROJECT_DIR=$PWD\nWXA_APP_ID=\nmkdir -p /tmp/wxa-ci\ncd /tmp/wxa-ci\npnpm init\npnpm add -D miniprogram-ci\n\npnpm miniprogram-ci upload --appid $WXA_APP_ID --pp $PROJECT_DIR/dist/weapp/ --pkp $PROJECT_DIR/private.key -r 1 -v --uv 1.0.0\n\n# by script\npnpm add -D tsx typescript\ncp $PROJECT_DIR/scripts/wxa-deploy.ts .\nenv PROJECT_DIR=$PROJECT_DIR pnpm tsx ./wxa-deploy.ts\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u9690\u85CF\u4E86\u5B9E\u9645\u7684 error\uFF0C\u8C03\u6574\u5185\u90E8 js \u8F93\u51FA\u9519\u8BEF\u53D1\u73B0\u662F"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"require() of ES Module ansi-styles from chalk not supported\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"chalk 5 is ESM"}),"\n",(0,s.jsx)(n.li,{children:"chalk 4 is CJS"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"render-webview-vs-skyline",children:"render webview vs skyline"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/skyline/custom-route.html",children:"https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/skyline/custom-route.html"})}),"\n"]})]})}function a(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},17776:function(e,n,i){i.d(n,{R:()=>c,x:()=>d});var r=i(7378);let s={},l=r.createContext(s);function c(e){let n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);