"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["232116"],{497860:function(e,t,s){s.r(t),s.d(t,{frontMatter:()=>l,toc:()=>a,default:()=>u,metadata:()=>n,assets:()=>c,contentTitle:()=>i});var n=JSON.parse('{"id":"db/relational/postgresql/cstore_fdw","title":"cstore_fdw","description":"- citusdata/cstorefdw","source":"@site/../notes/db/relational/postgresql/cstore_fdw.md","sourceDirName":"db/relational/postgresql","slug":"/db/relational/postgresql/cstore_fdw","permalink":"/notes/db/relational/postgresql/cstore_fdw","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/db/relational/postgresql/cstore_fdw.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1633617108000,"frontMatter":{"title":"cstore_fdw"},"sidebar":"docs","previous":{"title":"Citus","permalink":"/notes/db/relational/postgresql/citus"},"next":{"title":"Gel","permalink":"/notes/db/relational/postgresql/gel"}}'),r=s(486106),o=s(917776);let l={title:"cstore_fdw"},i="cstore_fdw",c={},a=[];function d(e){let t={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"cstore_fdw",children:"cstore_fdw"})}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"https://github.com/citusdata/cstore_fdw",children:"citusdata/cstore_fdw"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"\u5217\u5B58"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(t.li,{children:"\u5B9E\u9645\u4F7F\u7528\u6548\u679C\u4E00\u822C"}),"\n"]}),"\n",(0,r.jsx)(t.admonition,{type:"caution",children:(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"citus 10+ \u5185\u7F6E columnar, \u53D6\u4EE3 cstore_fdw"}),"\n"]})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"# \u4F9D\u8D56\u4E8E protobuf-c\n# \u786E\u4FDD pg_config \u5728 PATH \u4E2D\n\ngit clone https://github.com/citusdata/cstore_fdw\ncd cstore_fdw\nmake install\n# /bin/sh /usr/local/lib/postgresql/pgxs/src/makefiles/../../config/install-sh -c -d '/usr/local/lib/postgresql'\n# /bin/sh /usr/local/lib/postgresql/pgxs/src/makefiles/../../config/install-sh -c -d '/usr/local/share/postgresql/extension'\n# /bin/sh /usr/local/lib/postgresql/pgxs/src/makefiles/../../config/install-sh -c -d '/usr/local/share/postgresql/extension'\n# /usr/bin/install -c -m 755  cstore_fdw.so '/usr/local/lib/postgresql/cstore_fdw.so'\n# /usr/bin/install -c -m 644 .//cstore_fdw.control '/usr/local/share/postgresql/extension/'\n# /usr/bin/install -c -m 644 .//cstore_fdw--1.6.sql .//cstore_fdw--1.5--1.6.sql .//cstore_fdw--1.4--1.5.sql .//cstore_fdw--1.3--1.4.sql .//cstore_fdw--1.2--1.3.sql .//cstore_fdw--1.1--1.2.sql .//cstore_fdw--1.0--1.1.sql  '/usr/local/share/postgresql/extension/'\n\n# mac\ncp cstore_fdw.so /usr/local/lib/postgresql/\n\necho \"shared_preload_libraries = 'cstore_fdw'\" >> postgresql.conf\n"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sql",children:"-- load extension first time after install\nCREATE EXTENSION cstore_fdw;\n\n-- create server object\nCREATE SERVER cstore_server FOREIGN DATA WRAPPER cstore_fdw;\n\n-- create foreign table\nCREATE FOREIGN TABLE customer_reviews\n(\n    customer_id TEXT,\n    review_date DATE,\n    review_rating INTEGER,\n    review_votes INTEGER,\n    review_helpful_votes INTEGER,\n    product_id CHAR(10),\n    product_title TEXT,\n    product_sales_rank BIGINT,\n    product_group TEXT,\n    product_category TEXT,\n    product_subcategory TEXT,\n    similar_product_ids CHAR(10)[]\n)\nSERVER cstore_server\nOPTIONS(compression 'pglz');\n\nCOPY customer_reviews FROM '/home/user/customer_reviews_1998.csv' WITH CSV;\nCOPY customer_reviews FROM '/home/user/customer_reviews_1999.csv' WITH CSV;\n\nANALYZE customer_reviews;\n\n-- Find all reviews a particular customer made on the Dune series in 1998.\nSELECT\n    customer_id, review_date, review_rating, product_id, product_title\nFROM\n    customer_reviews\nWHERE\n    customer_id ='A27T7HVDXA3K2A' AND\n    product_title LIKE '%Dune%' AND\n    review_date >= '1998-01-01' AND\n    review_date <= '1998-12-31';\n\n-- Do we have a correlation between a book's title's length and its review ratings?\nSELECT\n    width_bucket(length(product_title), 1, 50, 5) title_length_bucket,\n    round(avg(review_rating), 2) AS review_average,\n    count(*)\nFROM\n   customer_reviews\nWHERE\n    product_group = 'Book'\nGROUP BY\n    title_length_bucket\nORDER BY\n    title_length_bucket;\n\nDROP FOREIGN TABLE cstore_table_n;\n\nDROP SERVER cstore_server;\nDROP EXTENSION cstore_fdw;\n"})})]})}function u(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},917776:function(e,t,s){s.d(t,{R:()=>l,x:()=>i});var n=s(7378);let r={},o=n.createContext(r);function l(e){let t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);