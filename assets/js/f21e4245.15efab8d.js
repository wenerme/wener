"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["610495"],{524371:function(e,s,t){t.r(s),t.d(s,{frontMatter:()=>o,toc:()=>c,default:()=>d,metadata:()=>n,assets:()=>a,contentTitle:()=>i});var n=JSON.parse('{"id":"db/relational/postgresql/postgresql-ssl","title":"PostgreSQL SSL Configuration","description":"Introspection","source":"@site/../notes/db/relational/postgresql/postgresql-ssl.md","sourceDirName":"db/relational/postgresql","slug":"/db/relational/postgresql/ssl","permalink":"/notes/db/relational/postgresql/ssl","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/db/relational/postgresql/postgresql-ssl.md","tags":[{"inline":true,"label":"SSL","permalink":"/notes/tags/ssl"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"PostgreSQL SSL Configuration","tags":["SSL"]},"sidebar":"docs","previous":{"title":"Pg SQL \u5E38\u89C1\u95EE\u9898","permalink":"/notes/db/relational/postgresql/sql-faq"},"next":{"title":"PostgreSQL Tenant","permalink":"/notes/db/relational/postgresql/tenant"}}'),r=t(486106),l=t(917776);let o={title:"PostgreSQL SSL Configuration",tags:["SSL"]},i="PostgreSQL SSL",a={},c=[{value:"Introspection",id:"introspection",level:2},{value:"Setup Script",id:"setup-script",level:2}];function p(e){let s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"postgresql-ssl",children:"PostgreSQL SSL"})}),"\n",(0,r.jsx)(s.h2,{id:"introspection",children:"Introspection"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SHOW ssl;\nSHOW ssl_cert_file;\nSHOW ssl_key_file;\n\n-- Check backend SSL status\nSELECT ssl FROM pg_stat_ssl WHERE pid = pg_backend_pid();\n"})}),"\n",(0,r.jsx)(s.h2,{id:"setup-script",children:"Setup Script"}),"\n",(0,r.jsxs)(s.p,{children:["Reference: ",(0,r.jsx)(s.a,{href:"https://github.com/infrastructure-as-code/docker-postgres/blob/main/generate-ssl-certs.sh",children:"docker-postgres generate-ssl-certs.sh"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'SSL_DOMAIN=${SSL_DOMAIN:="pg.local"}\nSSL_DAYS=${SSL_DAYS:=3650}\nPGDATA=/var/lib/postgresql/data\n\necho "Generating self-signed SSL certificates for ${SSL_DOMAIN}"\nopenssl req -new -x509 -days ${SSL_DAYS} -nodes -text \\\n  -out "${PGDATA}/server.crt" \\\n  -keyout "${PGDATA}/server.key" \\\n  -subj "/CN=${SSL_DOMAIN}"\n\nchown postgres:postgres "${PGDATA}/server.crt" "${PGDATA}/server.key"\nchmod 0600 "${PGDATA}/server.key"\n\ncat >> "${PGDATA}/postgresql.conf" << EOF\nssl = on\nssl_cert_file = \'${PGDATA}/server.crt\'\nssl_key_file = \'${PGDATA}/server.key\'\nssl_prefer_server_ciphers = on\nEOF\n'})})]})}function d(e={}){let{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},917776:function(e,s,t){t.d(s,{R:()=>o,x:()=>i});var n=t(7378);let r={},l=n.createContext(r);function o(e){let s=n.useContext(l);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(l.Provider,{value:s},e.children)}}}]);