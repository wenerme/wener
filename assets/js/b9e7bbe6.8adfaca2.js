"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["125922"],{19765:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>r,toc:()=>d,default:()=>a,metadata:()=>t,assets:()=>h,contentTitle:()=>c});var t=JSON.parse('{"id":"service/document/sheet/sheetjs","title":"SheetJS","description":"- SheetJS/sheetjs","source":"@site/../notes/service/document/sheet/sheetjs.md","sourceDirName":"service/document/sheet","slug":"/service/document/sheet/sheetjs","permalink":"/notes/service/document/sheet/sheetjs","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/document/sheet/sheetjs.md","tags":[{"inline":true,"label":"JavaScript","permalink":"/notes/tags/java-script"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1733281920000,"frontMatter":{"tags":["JavaScript"]},"sidebar":"docs","previous":{"title":"sheet-ref","permalink":"/notes/service/document/sheet/ref"},"next":{"title":"univer","permalink":"/notes/service/document/univer"}}'),l=s(486106),i=s(917776);let r={tags:["JavaScript"]},c="SheetJS",h={},d=[{value:"types",id:"types",level:2},{value:"Date",id:"date",level:2}];function o(e){let n={a:"a",admonition:"admonition",code:"code",del:"del",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"sheetjs",children:"SheetJS"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/SheetJS/sheetjs",children:"SheetJS/sheetjs"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Apache-2.0, JS"}),"\n",(0,l.jsxs)(n.li,{children:["git -> ",(0,l.jsx)(n.a,{href:"https://git.sheetjs.com/sheetjs/sheetjs",children:"sheetjs"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u4E0D\u5728 npm ",(0,l.jsx)(n.a,{href:"https://github.com/SheetJS/sheetjs/issues/2667",children:"https://github.com/SheetJS/sheetjs/issues/2667"})]}),"\n",(0,l.jsx)(n.li,{children:"\u5F00\u53D1\u4E5F\u4E0D\u5728 Github \u4E0A\u4E86"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://cdn.sheetjs.com/",children:"https://cdn.sheetjs.com/"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/protobi/js-xlsx",children:"protobi/js-xlsx"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://sheetjs.com/pro/",children:"https://sheetjs.com/pro/"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/Siemienik/XToolset",children:"Siemienik/XToolset"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"MIT, TS"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"pnpm add https://cdn.sheetjs.com/xlsx-0.20.3/xlsx-0.20.3.tgz\n# pnpm add https://cdn.sheetjs.com/xlsx-latest/xlsx-latest.tgz # for latest\n"})}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u63A8\u8350\u4F7F\u7528 dense \u6A21\u5F0F"}),"\n"]})}),"\n",(0,l.jsx)(n.admonition,{title:"CE \u7248\u672C\u9650\u5236",type:"caution",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E0D\u652F\u6301 formula \u6C42\u503C"}),"\n",(0,l.jsxs)(n.li,{children:["\u4E0D\u652F\u6301 Style\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/gitbrent/xlsx-js-style",children:"https://github.com/gitbrent/xlsx-js-style"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/ShanaMaid/sheetjs-style",children:"https://github.com/ShanaMaid/sheetjs-style"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u652F\u6301 images/graphs/PivotTables"}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"types",children:"types"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"// b Boolean, n Number, e error, s String, d Date, z Stub\nexport type ExcelDataType = 'b' | 'n' | 'e' | 's' | 'd' | 'z';\nexport interface Comments extends Array<Comment> {\n  /** Hide comment by default */\n  hidden?: boolean;\n}\nexport interface Hyperlink {\n  /** Target of the link (HREF) */\n  Target: string;\n  /** Plaintext tooltip to display when mouse is over cell */\n  Tooltip?: string;\n}\nexport type NumberFormat = string | number;\n\n/** \u5DE5\u4F5C\u8868\u5355\u5143\u683C\u5BF9\u8C61 */\nexport interface CellObject {\n  /**\n   * \u5355\u5143\u683C\u7684Excel\u6570\u636E\u7C7B\u578B\u3002\n   * b Boolean, n Number, e Error, s String, d Date, z Empty\n   */\n  t: ExcelDataType;\n  /** \u5355\u5143\u683C\u7684\u539F\u59CB\u503C\u3002\u5982\u679C\u6307\u5B9A\u4E86\u516C\u5F0F\uFF0C\u53EF\u4EE5\u7701\u7565 */\n  v?: string | number | boolean | Date;\n\n  /** \u683C\u5F0F\u5316\u6587\u672C\uFF08\u5982\u679C\u9002\u7528\uFF09 */\n  w?: string;\n\n  /** \u5355\u5143\u683C\u516C\u5F0F\uFF08\u5982\u679C\u9002\u7528\uFF09 */\n  f?: string;\n\n  /** \u5982\u679C\u516C\u5F0F\u662F\u6570\u7EC4\u516C\u5F0F\uFF0C\u5305\u56F4\u6570\u7EC4\u7684\u8303\u56F4\uFF08\u5982\u679C\u9002\u7528\uFF09 */\n  F?: string;\n\n  /** \u5982\u679C\u4E3Atrue\uFF0C\u5355\u5143\u683C\u662F\u52A8\u6001\u6570\u7EC4\u516C\u5F0F\uFF08\u5BF9\u4E8E\u652F\u6301\u7684\u6587\u4EF6\u683C\u5F0F\uFF09 */\n  D?: boolean;\n\n  /** \u5BCC\u6587\u672C\u7F16\u7801\uFF08\u5982\u679C\u9002\u7528\uFF09 */\n  r?: any;\n\n  /** \u5BCC\u6587\u672C\u7684HTML\u6E32\u67D3\uFF08\u5982\u679C\u9002\u7528\uFF09 */\n  h?: string;\n\n  /** \u4E0E\u5355\u5143\u683C\u5173\u8054\u7684\u6CE8\u91CA */\n  c?: Comments;\n\n  /** \u4E0E\u5355\u5143\u683C\u5173\u8054\u7684\u6570\u5B57\u683C\u5F0F\u5B57\u7B26\u4E32\uFF08\u5982\u679C\u9700\u8981\uFF09 */\n  z?: NumberFormat;\n\n  /** \u5355\u5143\u683C\u8D85\u94FE\u63A5\u5BF9\u8C61\uFF08.Target\u4FDD\u5B58\u94FE\u63A5\uFF0C.tooltip\u662F\u5DE5\u5177\u63D0\u793A\uFF09 */\n  l?: Hyperlink;\n\n  /** \u5355\u5143\u683C\u7684\u6837\u5F0F/\u4E3B\u9898\uFF08\u5982\u679C\u9002\u7528\uFF09 */\n  s?: any;\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "t": "s",\n  "v": "\u4FDD \u7BA1\\n\u671F \u9650",\n  "r": "<t>\u4FDD \u7BA1&#10;\u671F \u9650</t>",\n  "h": "\u4FDD \u7BA1<br/>\u671F \u9650",\n  "w": "\u4FDD \u7BA1\\n\u671F \u9650"\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"v \u8303\u56F4 0~60000"}),"\n",(0,l.jsx)(n.li,{children:"v \u5982\u679C\u5305\u542B\u5C0F\u6570\u70B9\uFF0C\u5219\u5305\u542B\u65F6\u95F4\u90E8\u5206"}),"\n",(0,l.jsx)(n.li,{children:"\u5982\u679C cellDates=true, \u5219 v \u4F1A\u88AB\u8F6C\u6362\u4E3A Date"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.sheetjs.com/docs/csf/cell",children:"https://docs.sheetjs.com/docs/csf/cell"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"date",children:"Date"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"if (!wb?.Workbook?.WBProps?.date1904) {\n  /* uses 1904 date system */\n} else {\n  /* uses 1900 date system */\n}\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "t": "n",\n  "v": 44234,\n  "w": "2/7/21"\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"t=d"})," \u8868\u793A date&time"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"n"})," - number\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6807\u51C6\u505A\u6CD5"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"d"})," - ISO 8601 date string"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"w"})," \u4E3A\u683C\u5F0F\u5316\u6587\u672C"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.sheetjs.com/docs/csf/features/dates/",children:"https://docs.sheetjs.com/docs/csf/features/dates/"})}),"\n"]}),"\n",(0,l.jsx)(n.h1,{id:"common-spreadsheet-format",children:"Common Spreadsheet Format"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://docs.sheetjs.com/docs/csf/",children:"https://docs.sheetjs.com/docs/csf/"})}),"\n",(0,l.jsxs)(n.li,{children:["4 \u79CD\u7C7B\u578B sheet\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"worksheets"}),"\n",(0,l.jsxs)(n.li,{children:["chartsheets - ",(0,l.jsx)(n.code,{children:"!type=chart"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.del,{children:"macrosheets"})," - ",(0,l.jsx)(n.code,{children:"!type=macro"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.del,{children:"dialogsheets"})," - ",(0,l.jsx)(n.code,{children:"!type=dialog"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"A1-style"}),"\n",(0,l.jsxs)(n.li,{children:["dense \u6A21\u5F0F - \u5F71\u54CD sheet \u5728\u5185\u5B58\u7684\u5B58\u50A8\u65B9\u5F0F\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"cells \u5B58\u50A8\u4E3A AoA - Array of Arrays"}),"\n",(0,l.jsx)(n.li,{children:"\u6570\u636E\u91CF\u5927\u7684\u65F6\u5019\u66F4\u8282\u7701\u5185\u5B58"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:'sheet["!data"][R][C]'})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:'sheet["B7"]'})," -> ",(0,l.jsx)(n.code,{children:'sheet["!data"]?.[6]?.[1]'})]}),"\n",(0,l.jsxs)(n.li,{children:["\u7279\u6B8A key\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!ref"})," - ",(0,l.jsx)(n.code,{children:"A1:B7"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!merges"})," - \u5408\u5E76\u5355\u5143\u683C"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!cols"})," - \u5217\u5BBD"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!rows"})," - \u884C\u9AD8"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!autofilter"})," - \u81EA\u52A8\u7B5B\u9009"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!outline"})," - \u5206\u7EC4"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"!protect"})," - \u4FDD\u62A4"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"XLSX.utils.decode_cell(addr)"})," -> ",(0,l.jsx)(n.code,{children:"{r,c}"})]}),"\n"]})]})}function a(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},917776:function(e,n,s){s.d(n,{R:()=>r,x:()=>c});var t=s(7378);let l={},i=t.createContext(l);function r(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);