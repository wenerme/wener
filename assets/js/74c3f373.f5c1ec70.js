"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["79200"],{72697:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>i,toc:()=>c,default:()=>h,metadata:()=>r,assets:()=>d,contentTitle:()=>o});var r=JSON.parse('{"id":"web/react/react-patterns","title":"React Patterns","description":"| name                                                      | note                                         |","source":"@site/../notes/web/react/react-patterns.md","sourceDirName":"web/react","slug":"/web/react/patterns","permalink":"/notes/web/react/patterns","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/react/react-patterns.md","tags":[{"inline":true,"label":"Pattern","permalink":"/notes/tags/pattern"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1737304142000,"frontMatter":{"title":"React Patterns","tags":["Pattern"]},"sidebar":"docs","previous":{"title":"React Native FAQ","permalink":"/notes/web/react/native-faq"},"next":{"title":"React Practice","permalink":"/notes/web/react/practice"}}'),s=t(86106),l=t(17776);let i={title:"React Patterns",tags:["Pattern"]},o="React Patterns",d={},c=[{value:"Sidecar",id:"sidecar",level:2},{value:"Raw State vs State Wrapper",id:"raw-state-vs-state-wrapper",level:2},{value:"Composable Primitive",id:"composable-primitive",level:2},{value:"Non-Rendering State Management Components",id:"non-rendering-state-management-components",level:2},{value:"Portal cross boundary",id:"portal-cross-boundary",level:2},{value:"\u63A7\u5236\u5C5E\u6027",id:"control-props",level:2},{value:"flex render",id:"flex-render",level:2},{value:"out of tree state",id:"out-of-tree-state",level:2},{value:"as props",id:"as-props",level:2},{value:"\u9AD8\u9636\u7EC4\u4EF6",id:"hoc",level:2},{value:"\u4EE3\u7406\u7EC4\u4EF6",id:"proxy-component",level:2},{value:"\u6E32\u67D3\u5C5E\u6027",id:"render-props",level:2},{value:"\u7EC4\u5408\u7EC4\u4EF6",id:"compound-components",level:2},{value:"\u5E03\u5C40\u7EC4\u4EF6",id:"layout-components",level:2},{value:"Provider and Context",id:"provider-and-context",level:2},{value:"Controlled and Uncontrolled Components",id:"controlled-and-uncontrolled-components",level:2},{value:"Prsentational and Container Components",id:"prsentational-and-container-components",level:2},{value:"\u6761\u4EF6\u6E32\u67D3",id:"conditonal-rendering",level:2},{value:"Hooks from Context",id:"hooks-from-context",level:2},{value:"Slot Pattern",id:"slot-pattern",level:2}];function a(n){let e={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"react-patterns",children:"React Patterns"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"name"}),(0,s.jsx)(e.th,{children:"note"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.em,{children:"\u57FA\u7840"})}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#conditonal-rendering",children:"\u6761\u4EF6\u6E32\u67D3"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"?:"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#provider-and-context",children:"\u4E0A\u4E0B\u6587"})}),(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.code,{children:"createContext"}),", ",(0,s.jsx)(e.code,{children:"useContext"})]})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.a,{href:"#custom-hooks",children:"\u81EA\u5B9A\u4E49 Hooks"})," \u590D\u7528\u903B\u8F91"]}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"useXxx"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#hoc",children:"\u9AD8\u9636\u7EC4\u5EFA"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"withProps(Comp)"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#render-props",children:"\u6E32\u67D3\u5C5E\u6027"})}),(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.code,{children:"render"}),", ",(0,s.jsx)(e.code,{children:"children"})]})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#layout-components",children:"\u5E03\u5C40\u7EC4\u4EF6"})}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#compound-components",children:"\u7EC4\u5408\u7EC4\u4EF6"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"Layout.Sidebar"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#prsentational-and-container-components",children:"\u5C55\u73B0\u548C\u5BB9\u5668\u7EC4\u5EFA"})}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#proxy-component",children:"\u4EE3\u7406\u7EC4\u4EF6"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"const Btn = (props)=> <button {...props}/>"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#controlled-and-uncontrolled-components",children:"\u53D7\u63A7\u7EC4\u5EFA"})}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.em,{children:"\u9AD8\u7EA7"})}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.a,{href:"#as-props",children:"as \u5C5E\u6027"})," \u81EA\u5B9A\u4E49\u7EC4\u5EFA"]}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"<Button as='a'/>"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.a,{href:"#control-props",children:"control \u5C5E\u6027"})," \u4F20\u9012\u4E0D\u900F\u660E\u4E0A\u4E0B\u6587"]}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"<Controller control={control}/>"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.a,{href:"#flex-render",children:"flexRender"})," \u7075\u6D3B\u6E32\u67D3\u7EC4\u5EFA\u548C\u5143\u7D20"]}),(0,s.jsx)(e.td,{})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.a,{href:"#out-of-tree-state",children:"\u7EC4\u5EFA\u5916\u72B6\u6001"})," \u7EC6\u7C92\u5EA6\u63A7\u5236\u72B6\u6001\u548C\u6E32\u67D3"]}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"useStore()"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#hooks-from-context",children:"Hooks from Context"})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"useTableHooks()"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.a,{href:"#portal-cross-boundary",children:"Portal cross boundary"})}),(0,s.jsx)(e.td,{})]})]})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"innerRef"}),", ",(0,s.jsx)(e.code,{children:"elementRef"})," - forwardRef \u900F\u4F20\u5185\u90E8\u5F15\u7528"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"mergeRefs"})," - \u5408\u5E76\u591A\u4E2A ref\uFF0C\u4F7F\u5F97\u5916\u90E8\u548C\u5185\u90E8\u90FD\u80FD\u62FF\u5230 ref"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.code,{children:"defaultValue"}),", ",(0,s.jsx)(e.code,{children:"defaultValues"}),", ",(0,s.jsx)(e.code,{children:"initialValues"})," - \u521D\u59CB\u72B6\u6001 props"]}),"\n",(0,s.jsxs)(e.li,{children:["Prop Collections and Getters\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4F20\u9012 getXyzProps \u8FD4\u56DE\u7684 props \u5230 Component"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["State Initializers - \u72B6\u6001\u521D\u59CB\u5668 - ",(0,s.jsx)(e.code,{children:"<Comp createState={()=>({})}/>"})]}),"\n",(0,s.jsx)(e.li,{children:"Array as children"}),"\n",(0,s.jsx)(e.li,{children:"Style component - \u540C Proxy component \u4F46\u5173\u6CE8\u6837\u5F0F\u5C5E\u6027"}),"\n",(0,s.jsxs)(e.li,{children:["Container component\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u83B7\u53D6\u6570\u636E\uFF0C\u4F20\u9012\u7ED9\u5177\u4F53\u7EC4\u4EF6"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["State hoisting\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u63D0\u5347\u72B6\u6001\u5012\u4E0A\u5C42"}),"\n",(0,s.jsx)(e.li,{children:"\u4F8B\u5982: \u8868\u5355"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["State reducer pattern\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u57FA\u4E8E Command \u64CD\u4F5C\u72B6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5 Rewind"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u5168\u5C40\u72B6\u6001 - \u53EF\u8DDF\u8E2A"}),"\n",(0,s.jsx)(e.li,{children:"\u5199\u8D77\u6765\u76F8\u5BF9\u7E41\u7410"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://reactpatterns.com/",children:"https://reactpatterns.com/"})}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"sidecar",children:"Sidecar"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5206\u79BB\u4E1A\u52A1\u903B\u8F91\u548C\u6E32\u67D3"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const ResourceList = () => {\n  return (\n    <Root>\n      <Sidecar />\n      List Content\n    </Root>\n  );\n};\n\n// \u5C01\u88C5\u6240\u6709\u4E1A\u52A1\u903B\u8F91\uFF0C\u4E0D\u6E32\u67D3\u5185\u5BB9\nconst Sidecar = () => {\n  const store = useRootStore();\n  const { pageSize } = useStore(\n    store,\n    useShallow(({ pageSize }) => ({ pageSize })),\n  );\n\n  const { data, loading, error } = useQuery({\n    variables: { pageSize },\n  });\n  useEffect(() => {\n    store.setState({ data, loading, error });\n  }, [data, loading, error]);\n  return null;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"raw-state-vs-state-wrapper",children:"Raw State vs State Wrapper"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Raw State\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u76F4\u63A5\u3001\u6613\u4E8E\u7406\u89E3\u3001\u7075\u6D3B"}),"\n",(0,s.jsx)(e.li,{children:"\u76F4\u63A5\u66B4\u9732 state \u548C\u64CD\u4F5C\u65B9\u6CD5"}),"\n",(0,s.jsx)(e.li,{children:"actions \u5C01\u88C5\u90E8\u5206\u9884\u8BBE\u7684\u64CD\u4F5C\u903B\u8F91"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["State Wrapper\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5C01\u88C5\u3001\u53EF\u7EF4\u62A4\uFF08\u6CA1\u6709\u66B4\u9732\u8FC7\u591A\u7EC6\u8282\uFF09\u3001\u6613\u6269\u5C55\u3001\u9002\u7528\u4E8E\u590D\u6742\u573A\u666F"}),"\n",(0,s.jsx)(e.li,{children:"\u672C\u8D28\u8FD8\u662F\u7EF4\u62A4\u548C\u64CD\u4F5C state"}),"\n",(0,s.jsx)(e.li,{children:"\u4F46\u662F\u4F7F\u7528\u4F53\u9A8C\u4E0A\u611F\u89C9\u662F\u5728\u64CD\u4F5C\u7EC4\u4EF6"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"// Raw State\ntype StoreState = {\n  active: any;\n\n  actions: {\n    setActive: (active: any) => void;\n  };\n};\n\n// State Wrapper\ntype ReactTable = {\n  state: any;\n  getOptions: () => any;\n  setPageSize: (size: number) => void;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"composable-primitive",children:"Composable Primitive"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u539F\u5B50\u7EC4\u4EF6"}),"\n",(0,s.jsx)(e.li,{children:"\u7EC4\u5408\u3001\u590D\u7528"}),"\n",(0,s.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"cmdk"}),"\n",(0,s.jsx)(e.li,{children:"radix-ui"}),"\n",(0,s.jsx)(e.li,{children:"base-ui"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const MyList = ()=>{\n  return (\n    <List.Root>\n      <List.Header>Header</List.Header>\n      <List.Search></List.Search>\n      <List.Item>1</List.Item>\n      <List.Item>2</List.Item>\n    </List>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"non-rendering-state-management-components",children:"Non-Rendering State Management Components"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u907F\u514D rerender"}),"\n",(0,s.jsx)(e.li,{children:"\u72B6\u6001/hook \u590D\u7528"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"export const CurrentListTableQueryReactor = () => {\n  let store = useReactTableStore();\n  let { useListQuery } = useListQueryContext();\n  const { data } = useListQuery();\n\n  useEffect(() => {\n    if (!data) return;\n    store.getState().setOptions((prev) => ({\n      ...prev,\n      data: data.data,\n      rowCount: data.total,\n    }));\n  }, [data]);\n\n  return null;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"portal-cross-boundary",children:"Portal cross boundary"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"createPortal \u53EF\u4EE5\u8DE8\u8D8A\u8FB9\u754C, \u4E14\u5171\u4EAB\u72B6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u76F4\u63A5\u6E32\u67D3\u5230 window.open \u7684\u7A97\u53E3"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u76F4\u63A5\u6E32\u67D3\u5230 iframe"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u76F4\u63A5\u6E32\u67D3\u5230 shadow dom"}),"\n"]}),"\n",(0,s.jsx)(e.h1,{id:"custom-hooks",children:"\u81EA\u5B9A\u4E49 Hooks"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Custom Hook Pattern"}),"\n",(0,s.jsx)(e.li,{children:"\u903B\u8F91\u590D\u7528"}),"\n",(0,s.jsx)(e.li,{children:"\u5C01\u88C5\u516C\u5171\u4E1A\u52A1\u903B\u8F91"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"control-props",children:"\u63A7\u5236\u5C5E\u6027"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Control Props Pattern"}),"\n",(0,s.jsx)(e.li,{children:"\u4F20\u9012\u4E00\u4E2A opaque/\u4E0D\u900F\u660E \u7684 controller"}),"\n",(0,s.jsx)(e.li,{children:"\u9690\u85CF\u5185\u90E8\u5B9E\u73B0"}),"\n",(0,s.jsx)(e.li,{children:"\u4F8B\u5982: react-hook-form \u7684 control \u53C2\u6570"}),"\n",(0,s.jsx)(e.li,{children:"\u4F8B\u5982: \u76F4\u63A5\u4F20\u9012 zustand \u7684 store"}),"\n",(0,s.jsx)(e.li,{children:"Material UI"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"flex-render",children:"flex render"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5141\u8BB8\u4F20 Component \u6216\u8005 ReactElement"}),"\n",(0,s.jsx)(e.li,{children:"\u5141\u8BB8\u8986\u76D6\u6216\u5408\u5E76 props"}),"\n",(0,s.jsx)(e.li,{children:"\u4F8B\u5982: react-table"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"import React, { ReactElement, ReactNode } from 'react';\nimport { mergeProps as defaultMergeProps } from '@wener/reaction';\nimport { isReactComponent } from '@wener/reaction';\n\n/**\n * FlexRenderable maybe a component maybe an element\n *\n * The Component doesn't have to match the props type\n */\nexport type FlexRenderable<TProps> = React.ReactNode | React.ComponentType<Partial<TProps>>;\n\n/**\n * flexRender will try to render a component or a React node\n *\n * When passing a {@link mergeProps}, will clone the element and merge the props.\n *\n * @param Comp component or react node\n * @param props props to pass to component\n * @param mergeProps merge props to pass to component\n * @see {@link https://github.com/TanStack/table/blob/af00c821b7943bc0f6d62a19b3ad514e3f315d75/packages/react-table/src/index.tsx TanStack/table}\n */\nexport function flexRender<TProps extends object>(\n  Comp: FlexRenderable<TProps>,\n  props: TProps,\n  mergeProps?: ((a: TProps, b: TProps) => TProps) | true,\n): ReactNode | ReactElement {\n  if (!Comp) {\n    return null;\n  }\n  if (isReactComponent<TProps>(Comp)) {\n    return <Comp {...props} />;\n  }\n  // for mergeProps\n  {\n    if (mergeProps === true) {\n      mergeProps = flexRender.mergeProps;\n    }\n    if (typeof mergeProps === 'function' && typeof Comp === 'object' && 'props' in Comp) {\n      return React.cloneElement(Comp, (mergeProps as any)(Comp.props, props));\n    }\n  }\n  // various ReactNode types\n  return Comp as any;\n}\n\nflexRender.mergeProps = defaultMergeProps;\n"})}),"\n",(0,s.jsx)(e.h2,{id:"out-of-tree-state",children:"out of tree state"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u5728 React \u7EC4\u5EFA\u5916\u63A7\u5236\u72B6\u6001"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u7EC6\u7C92\u5EA6\u63A7\u5236 \u6E32\u67D3"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u6309\u9700\u76D1\u542C\u53D8\u5316"}),"\n",(0,s.jsx)(e.li,{children:"\u62BD\u53D6\u4E1A\u52A1\u903B\u8F91"}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.a,{href:"/notes/web/react/zustand",children:"zustand"}),", ",(0,s.jsx)(e.a,{href:"/notes/web/react/valtio",children:"valtio"}),", ",(0,s.jsx)(e.a,{href:"/notes/web/react/jotai",children:"jotai"})]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const CounterStore = createStore(0);\n\nconst Counter = () => {\n  const count = useStore(CounterStore);\n  return <div onClick={() => CounterStore.setState((s) => s + 1)}>{count}</div>;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"as-props",children:"as props"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5141\u8BB8\u81EA\u5B9A\u4E49\u7EC4\u4EF6\u7C7B\u578B"}),"\n",(0,s.jsx)(e.li,{children:"\u4F8B\u5982 Button \u7EC4\u4EF6\u53EF\u4EE5\u662F button, a, div, Link \u7B49"}),"\n",(0,s.jsx)(e.li,{children:"\u4F8B\u5982 Container \u7EC4\u5EFA\u53EF\u4EE5\u65F6 form, div, fieldset \u7B49"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Button: React.FC<{ as?: any }> = ({ as: As = 'button', ...props }) => {\n  return <As {...props} />;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"hoc",children:"\u9AD8\u9636\u7EC4\u4EF6"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"HOC - Higher Order Components"}),"\n",(0,s.jsx)(e.li,{children:"\u9884\u8BBE props"}),"\n",(0,s.jsx)(e.li,{children:"\u5BF9 \u7EC4\u5EFA\u8FDB\u884C \u4FEE\u9970/wrapper/decorator"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const MyButton = withStyle(Button, { className: '' });\n"})}),"\n",(0,s.jsx)(e.h2,{id:"proxy-component",children:"\u4EE3\u7406\u7EC4\u4EF6"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5B9E\u73B0\u81EA\u5B9A\u4E49\u4E3B\u9898\u3001\u6837\u5F0F"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Button = (props) => <button type='button' {...props} />;\n"})}),"\n",(0,s.jsx)(e.h2,{id:"render-props",children:"\u6E32\u67D3\u5C5E\u6027"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Node = (\n  <Comp\n    // render props\n    render={({ isActive }) => (isActive ? 'Active' : '')}\n    // props based on state\n    className={{ isActive } ? 'active' : ''}\n  >\n    {/* render props as children */}\n    {/* \u51FD\u6570\u505A\u4E3A\u5B50\u5143\u7D20 - function as children */}\n    {({ isActive }) => (isActive ? 'Active' : 'Inactive')}\n  </Comp>\n);\n"})}),"\n",(0,s.jsx)(e.h2,{id:"compound-components",children:"\u7EC4\u5408\u7EC4\u4EF6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Layout = ({ children }) => {\n  return <div>{children}</div>;\n};\nLayout.Sidebar = ({ children }) => {\n  return <aside>{children}</aside>;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"layout-components",children:"\u5E03\u5C40\u7EC4\u4EF6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Layout = ({ sidebar, status, menu,children }) => (\n  <div>\n    <menu>{menu}</menu>\n    <aside>{sidebar}</aside>\n    <main>{children}</main>\n    <footer>{status}</aside>\n  </div>\n);\n"})}),"\n",(0,s.jsx)(e.h2,{id:"provider-and-context",children:"Provider and Context"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"React \u7684 IoC"}),"\n",(0,s.jsx)(e.li,{children:"Provider/Context"}),"\n",(0,s.jsxs)(e.li,{children:["createContext\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u6309\u9700\u521B\u5EFA Context"}),"\n",(0,s.jsx)(e.li,{children:"\u591A\u4E2A\u76F8\u540C Context \u5E76\u5B58"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.admonition,{type:"caution",children:(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"memo \u4F1A\u5BFC\u81F4 Context \u53D8\u5316\u65E0\u6CD5\u88AB\u68C0\u6D4B\u5230"}),"\n",(0,s.jsxs)(e.li,{children:["useContext \u4E0D\u652F\u6301 select \u53EF\u80FD\u5BFC\u81F4\u6027\u80FD\u95EE\u9898 - \u5927\u72B6\u6001\u9700\u8981\u6CE8\u610F\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u4F7F\u7528 out of tree state \u89E3\u51B3"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(e.h2,{id:"controlled-and-uncontrolled-components",children:"Controlled and Uncontrolled Components"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"// state = value\nconst MyComp = ({ state, onStateChange }) => {\n  return <div></div>;\n};\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u53EF\u63A7\u7EC4\u4EF6"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const MyComp: React.FC<{\n  value: any;\n  onChange?: (value: any) => void;\n  defaultValue?: any;\n}> = (props) => {\n  const [value, setValue] = useControllable(props);\n  return <div></div>;\n};\n"})}),"\n",(0,s.jsx)(e.h2,{id:"prsentational-and-container-components",children:"Prsentational and Container Components"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4E1A\u52A1\u903B\u8F91\u548C\u5C55\u73B0\u903B\u8F91\u5206\u79BB"}),"\n",(0,s.jsx)(e.li,{children:"\u4E1A\u52A1\u903B\u8F91\u653E\u5230 Container Components"}),"\n",(0,s.jsx)(e.li,{children:"\u5C55\u73B0\u903B\u8F91\u653E\u5230 Prsentational Components"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"conditonal-rendering",children:"\u6761\u4EF6\u6E32\u67D3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Comp = ({ condition }) => {\n  return <>{condition ? <div>True</div> : <div>False</div>}</>;\n};\n"})}),"\n",(0,s.jsx)(e.admonition,{title:"\u76F8\u540C\u4F4D\u7F6E\u7EC4\u5EFA\u4F1A\u4FDD\u7559\u72B6\u6001",type:"tip",children:(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const Comp = ({ condition }) => {\n  return (\n    <>\n      {/* \u4F1A\u4FDD\u7559\u72B6\u6001: \u56E0\u4E3A\u76F8\u540C\u7EC4\u5EFA\uFF0C\u4F4D\u7F6E\u76F8\u540C */}\n      {condition ? <Counter name='YES' /> : <Counter name='NO' />}\n\n      {/* \u4E0D\u4F1A\u4FDD\u7559\u72B6\u6001: \u4F4D\u7F6E\u4E0D\u540C  */}\n      {condition && <Counter name='YES' />}\n      {condition || <Counter name='NO' />}\n    </>\n  );\n};\n"})})}),"\n",(0,s.jsx)(e.h2,{id:"hooks-from-context",children:"Hooks from Context"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u907F\u514D\u4F20\u9012\u975E\u5E38\u6DF1\u7684 props"}),"\n",(0,s.jsx)(e.li,{children:"\u901A\u8FC7 Context \u4F20\u9012 Hooks"}),"\n",(0,s.jsx)(e.li,{children:"\u8BA9\u7EC4\u4EF6\u53EF\u4EE5\u81EA\u884C\u9009\u62E9\u662F\u5426\u4F7F\u7528 Hooks"}),"\n",(0,s.jsx)(e.li,{children:"\u62BD\u53D6\u516C\u5171\u7EC4\u5EFA\u903B\u8F91"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4FEE\u6539 children \u7684\u903B\u8F91"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"interface TableHooks<T extends {id:string}>{\n  // react-query\n  useQuery: (opts) => UseQueryResult<T>;\n  useSelected: () => T[];\n}\n\nconst useTableHooks(){\n  return useContext(TableHooksContext);\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"slot-pattern",children:"Slot Pattern"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u7EC4\u4EF6\u4F20\u9012\u903B\u8F91\u5C42\u7684 IoC"}),"\n",(0,s.jsx)(e.li,{children:"\u7C7B\u4F3C WebComponents \u7684 slot \u5C5E\u6027"}),"\n",(0,s.jsxs)(e.li,{children:["Pros\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u89E3\u5076 \u9700\u8981\u81EA\u4E0A\u800C\u4E0B \u4F20\u53C2\u6570\u7684\u95EE\u9898"}),"\n",(0,s.jsx)(e.li,{children:"\u601D\u7EF4\u5C42\u66F4\u76F4\u89C2 - \u4E0D\u9700\u8981\u5173\u5FC3\u5982\u4F55\u5C55\u73B0\u7684\uFF0C\u53EA\u9700\u8981\u5173\u5FC3\u9700\u8981\u5C55\u73B0"}),"\n",(0,s.jsx)(e.li,{children:"\u903B\u8F91\u901A\u7528"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["Cons\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Slot \u5982\u679C\u4E0D\u9650\u5B9A\u4E0A\u4E0B\u6587\u53EF\u80FD\u4F1A\u6DF7\u6DC6 - \u901A\u8FC7 ",(0,s.jsx)(e.code,{children:"createSlotContext"})," + Compound Component \u65B9\u5F0F\u907F\u514D"]}),"\n",(0,s.jsxs)(e.li,{children:["\u76F4\u63A5\u4F20\u9012 children \u5230\u522B\u7684\u8282\u70B9\u4F1A\u4E22\u5931 Context\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5B9E\u9645 Context \u4E0D\u662F Slot \u4F4D\u7F6E\u7684 Context"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u7528 Portal \u89E3\u51B3"}),"\n",(0,s.jsx)(e.li,{children:"\u53EF\u4EE5\u628A Context \u653E\u5230\u66F4\u4E0A\u5C42\u89E3\u51B3"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_templates_and_slots",children:"Web Components > Using templates and slots"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-tsx",children:"const SlotDemo = (\n  <Layout>\n    <Layout.Slot name='Sidebar' placement='top'>\n      Menus\n    </Layout.Slot>\n    <Layout.Slot name='Footer' placement='right'>\n      Copyright\n    </Layout.Slot>\n    <h3>Layout Title</h3>\n    <section>Content</section>\n  </Layout>\n);\n"})})]})}function h(n={}){let{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},17776:function(n,e,t){t.d(e,{R:()=>i,x:()=>o});var r=t(7378);let s={},l=r.createContext(s);function i(n){let e=r.useContext(l);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);