"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["60354"],{19615:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>i,toc:()=>o,default:()=>u,metadata:()=>r,assets:()=>c,contentTitle:()=>a});var r=JSON.parse('{"id":"devops/kubernetes/app/lens","title":"Lens","description":"- lensapp/lens","source":"@site/../notes/devops/kubernetes/app/lens.md","sourceDirName":"devops/kubernetes/app","slug":"/devops/kubernetes/app/lens","permalink":"/notes/devops/kubernetes/app/lens","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/kubernetes/app/lens.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1725936322000,"frontMatter":{"title":"Lens"},"sidebar":"docs","previous":{"title":"KubeVirt","permalink":"/notes/devops/kubernetes/app/kubevirt"},"next":{"title":"MinIO Kubernetes Operator","permalink":"/notes/devops/kubernetes/app/minio-operator"}}'),l=s(86106),t=s(17776);let i={title:"Lens"},a="Lens",c={},o=[{value:"extensions/metrics-cluster-feature",id:"extensionsmetrics-cluster-feature",level:2},{value:"kube-prometheus",id:"kube-prometheus",level:3},{value:"features/user-mode",id:"featuresuser-mode",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"lens",children:"Lens"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens",children:"lensapp/lens"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["2024-01-23 \u95ED\u6E90 ",(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/commit/e1fc8869a9e0033fb22665a990e07a6b72756630",children:"https://github.com/lensapp/lens/commit/e1fc8869a9e0033fb22665a990e07a6b72756630"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u66FF\u4EE3\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"k9s"}),"\n",(0,l.jsx)(n.li,{children:"kdash"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/headlamp-k8s/headlamp",children:"headlamp"})}),"\n",(0,l.jsx)(n.li,{children:"seabird"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/kubenav/kubenav",children:"kubenav/kubenav"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Lens - The Kubernetes IDE"}),"\n",(0,l.jsx)(n.li,{children:"by Mirantis"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/MuhammedKalkan/OpenLens",children:"MuhammedKalkan/OpenLens"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E0D\u8981\u6C42\u767B\u9646 - \u4ECE lens \u79FB\u9664\u76F8\u5173\u903B\u8F91"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/tree/master/extensions/metrics-cluster-feature",children:"extensions/metrics-cluster-feature"})}),"\n",(0,l.jsxs)(n.li,{children:["src/features/user-mode\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ClusterRole lens-user\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"LIST namespace"}),"\n",(0,l.jsx)(n.li,{children:"system:authenticated"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u5141\u8BB8\u975E\u7BA1\u7406\u5458\u80FD\u8BBF\u95EE\u6709\u6743\u9650\u8BBF\u95EE\u7684\u7A7A\u95F4"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"caution",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u65E0\u6CD5\u4F7F\u7528\u5916\u90E8 prometheus - ",(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/issues/909",children:"#909"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53EF\u4EE5\u7528 promxy \u4EE3\u7406\u73B0\u6709\u7684\u5916\u90E8 prometheus - \u5728\u5185\u90E8\u4F7F\u7528"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,l.jsx)(n.h2,{id:"extensionsmetrics-cluster-feature",children:"extensions/metrics-cluster-feature"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Namespace lens-metrics\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["StatefulSet prometheus\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["prometheus\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"--storage.tsdb.retention.time=2d"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"--storage.tsdb.retention.size=5GB"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"ServiceAccount prometheus"}),"\n",(0,l.jsxs)(n.li,{children:["Service prometheus\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"80 -> 9090"}),"\n",(0,l.jsx)(n.li,{children:"prometheus.io/scrape: 'true'"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ConfigMap prometheus-config\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"prometheus.yaml"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ConfigMap prometheus-rules\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"alertmanager.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"etcd3.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"general.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"kube-state-metrics.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"kubelet.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"kubernetes.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"node.rules.yaml"}),"\n",(0,l.jsx)(n.li,{children:"prometheus.rules.yaml"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ClusterRole - lens-prometheus\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"ServiceAccount prometheus"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["DaemonSet - node-exporter\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Service 80 -> 9100"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Deployment - kube-state-metrics"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/blob/master/troubleshooting/custom-prometheus.md",children:"Using Custom Prometheus"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u53EF\u4EE5\u4F7F\u7528 HELM \u5B89\u88C5\u7684 - \u9700\u8981\u6293\u53D6\u65F6\u95F4\u5C0F\u4E8E 1 \u5206\u949F\nhelm upgrade --set server.global.scrape_interval=30s prometheus stable/prometheus\n"})}),"\n",(0,l.jsx)(n.h3,{id:"kube-prometheus",children:"kube-prometheus"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u652F\u6301\u9700\u8981 ",(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/blob/master/troubleshooting/custom-prometheus.md#kube-prometheus",children:"relabel"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8BE5\u8BF4\u660E\u6709\u95EE\u9898"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u9009\u62E9 helm \u5B89\u88C5\uFF0C\u6307\u5B9A ",(0,l.jsx)(n.code,{children:"monitoring/kube-prometheus-prometheus:9090"})]}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{type:"tip",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/issues/180",children:"#180"})," - Documentation is incorrect for Prometheus troubleshooting"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/lensapp/lens/issues/656",children:"#656"})," - What are the requirements to make my prometheus deployment compatible with Lens?"]}),"\n"]})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",metastring:'title="bitnam/kube-prometheus/values.yaml"',children:"# Lens\n# ====\nnode-exporter:\n  serviceMonitor:\n    # interval: 10s\n    relabelings:\n      - action: replace\n        regex: (.*)\n        replacement: $1\n        sourceLabels:\n          - __meta_kubernetes_pod_node_name\n        targetLabel: kubernetes_node\n\nkubelet:\n  serviceMonitor:\n    # interval: 15s\n    metricRelabelings:\n      - action: replace\n        sourceLabels:\n          - node\n        targetLabel: instance\n\n# limit & request works\nkube-state-metrics:\n  serviceMonitor:\n    honorLabels: true\n"})}),"\n",(0,l.jsx)(n.h2,{id:"featuresuser-mode",children:"features/user-mode"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: lens-user\nrules:\n  - verbs:\n      - list\n    apiGroups:\n      - ''\n    resources:\n      - namespaces\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: lens-user\nsubjects:\n  - kind: Group\n    apiGroup: rbac.authorization.k8s.io\n    name: 'system:authenticated'\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: lens-user\n"})})]})}function u(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},17776:function(e,n,s){s.d(n,{R:()=>i,x:()=>a});var r=s(7378);let l={},t=r.createContext(l);function i(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);