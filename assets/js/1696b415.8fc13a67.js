"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["76716"],{57780:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>s,toc:()=>p,default:()=>d,metadata:()=>r,assets:()=>c,contentTitle:()=>a});var r=JSON.parse('{"id":"devops/web/haproxy/haproxy-tuning","title":"HAProxy Tuning","description":"- maxconn","source":"@site/../notes/devops/web/haproxy/haproxy-tuning.md","sourceDirName":"devops/web/haproxy","slug":"/devops/web/haproxy/tuning","permalink":"/notes/devops/web/haproxy/tuning","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/web/haproxy/haproxy-tuning.md","tags":[{"inline":true,"label":"Tuning","permalink":"/notes/tags/tuning"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1688543048000,"frontMatter":{"tags":["Tuning"]},"sidebar":"docs","previous":{"title":"SPOE","permalink":"/notes/devops/web/haproxy/spoe"},"next":{"title":"HAProxy Version","permalink":"/notes/devops/web/haproxy/version"}}'),i=t(86106),o=t(17776);let s={tags:["Tuning"]},a="HAProxy Tuning",c={},p=[];function l(n){let e={a:"a",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",ul:"ul",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"haproxy-tuning",children:"HAProxy Tuning"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:'haproxy -vv\necho "show info" | socat stdio /run/haproxy-runtime-api.sock\n'})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"maxconn"}),"\n",(0,i.jsxs)(e.li,{children:["CPU Pinning\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"nbproc"}),"\n",(0,i.jsx)(e.li,{children:"nbthread"}),"\n",(0,i.jsx)(e.li,{children:"cpu-map"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-ini",metastring:'title="/etc/sysctl.d/30-haproxy.conf"',children:"net.ipv4.tcp_rmem            = 4096 16060 262144\nnet.ipv4.tcp_wmem            = 4096 16384 262144\nnet.ipv4.tcp_tw_reuse        = 1\nnet.ipv4.ip_local_port_range = 1024 65023\nnet.ipv4.tcp_max_syn_backlog = 60000\n#net.ipv4.tcp_fin_timeout     = 30\nnet.ipv4.tcp_synack_retries  = 3\nnet.core.somaxconn           = 60000\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.haproxy.com/documentation/hapee/latest/getting-started/system-tuning/",children:"https://www.haproxy.com/documentation/hapee/latest/getting-started/system-tuning/"})}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"# CPU Pinning\nnbproc 2\ncpu-map 1 0\ncpu-map 2 1\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.haproxy.com/blog/multithreading-in-haproxy",children:"https://www.haproxy.com/blog/multithreading-in-haproxy"})}),"\n"]})]})}function d(n={}){let{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}},17776:function(n,e,t){t.d(e,{R:()=>s,x:()=>a});var r=t(7378);let i={},o=r.createContext(i);function s(n){let e=r.useContext(o);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),r.createElement(o.Provider,{value:e},n.children)}}}]);