"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["5299"],{72595:function(n,e,t){t.r(e),t.d(e,{frontMatter:()=>r,toc:()=>l,default:()=>m,metadata:()=>i,assets:()=>d,contentTitle:()=>o});var i=JSON.parse('{"id":"web/editor/tiptap/tiptap-inside","title":"Tiptap Inside","description":"- \u4F20\u53C2\u4F7F\u7528\u5BF9\u8C61\uFF0C prosemirror \u4F7F\u7528\u72EC\u7ACB\u53C2\u6570","source":"@site/../notes/web/editor/tiptap/tiptap-inside.md","sourceDirName":"web/editor/tiptap","slug":"/web/editor/tiptap/inside","permalink":"/notes/web/editor/tiptap/inside","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/editor/tiptap/tiptap-inside.md","tags":[{"inline":true,"label":"Insight","permalink":"/notes/tags/insight"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1704307832000,"frontMatter":{"tags":["Insight"]},"sidebar":"docs","previous":{"title":"Tiptap Extension","permalink":"/notes/web/editor/tiptap/extension"},"next":{"title":"unifiedjs","permalink":"/notes/web/editor/unifiedjs"}}'),s=t(86106),a=t(17776);let r={tags:["Insight"]},o="Tiptap Inside",d={},l=[];function c(n){let e={code:"code",h1:"h1",header:"header",li:"li",mermaid:"mermaid",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"tiptap-inside",children:"Tiptap Inside"})}),"\n",(0,s.jsx)(e.mermaid,{value:"classDiagram\nEventEmitter <|-- Editor\nEditor *-- CommandManager\nEditor *-- ExtensionManager\nEditor -- EditorState\nEditor *-- EditorView\nclass Editor {\n    +commandManager CommandManager\n    +extensionManager ExtensionManager\n    +schema Schema\n    +view EditorView\n    +state EditorState\n\n    +setOptions()\n    +setEditable()\n}\n\nclass ExtensionManager {\n    +editor Editor\n    +schema Schema\n    +extensions Extensions\n    commands() RawCommands\n    plugins() Plugin[]\n    attributes()\n    nodeViews()\n}\nCommandManager -- EditorState\nclass CommandManager {\n    +editor Editor\n    +rawCommands AnyCommands\n    +state EditorState\n\n    +commands() SingleCommands\n    +can() CanCpmmands\n    +chain() CanCpmmands\n}\nEditorView *-- EditorState\nclass EditorView{\n    <<prosemirror-view>>\n    +state EditorState\n    +setProps()\n    +updateState(state EditorState)\n    +dispatch(tr Transaction)\n}\n\nclass EditorState{\n    <<prosemirror-state>>\n    +doc Node\n    +selection Selection\n    +storedMarks Mark[]\n    +schema() Schema\n    +plugins() Plugin[]\n    +apply(tr Transaction) EditorState\n    +tr() Transaction\n    +reconfigure(config)\n}\n\nclass EventEmitter{\n    +on()\n    +off()\n    +emit()\n}"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4F20\u53C2\u4F7F\u7528\u5BF9\u8C61\uFF0C prosemirror \u4F7F\u7528\u72EC\u7ACB\u53C2\u6570"}),"\n",(0,s.jsxs)(e.li,{children:["Editor\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5C01\u88C5\u6240\u6709\u76F8\u5173\u5BF9\u8C61"}),"\n",(0,s.jsx)(e.li,{children:"EditorView, Extension, Command"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["ExtensionManager\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u63D2\u4EF6\u7CFB\u7EDF"}),"\n",(0,s.jsx)(e.li,{children:"\u5305\u542B\u4E86 prosemirror \u7684 Plugin \u903B\u8F91"}),"\n",(0,s.jsxs)(e.li,{children:["Extension \u5305\u542B\u4E86\u975E prosemirror Plugin \u7684\u529F\u80FD\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u6DFB\u52A0 command"}),"\n",(0,s.jsx)(e.li,{children:"\u4E8B\u4EF6"}),"\n",(0,s.jsx)(e.li,{children:"\u4E00\u4E9B\u989D\u5916 hook"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\u4E8B\u4EF6\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"beforeCreate, create, update, selectionUpdate, transaction"}),"\n",(0,s.jsx)(e.li,{children:"focus, blur"}),"\n",(0,s.jsx)(e.li,{children:"destroy"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["CommandManager\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u5C06\u79BB\u6563\u7684 commands \u5C01\u88C5\u5728\u4E00\u8D77"}),"\n",(0,s.jsx)(e.li,{children:"\u63D0\u4F9B can \u548C chain \u8F85\u52A9\u64CD\u4F5C"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-ts",children:"import { EditorView } from 'prosemirror-view';\n\nclass Editor extends EventEmitter<EditorEvents> {\n  commandManager!: CommandManager;\n  extensionManager!: ExtensionManager;\n  css!: HTMLStyleElement;\n  schema!: Schema;\n  view!: EditorView;\n  isFocused = false;\n  extensionStorage: Record<string, any> = {};\n\n  options: EditorOptions;\n\n  get storage(): Record<string, any>;\n  get commands(): SingleCommands;\n  chain(): ChainedCommands;\n  can(): CanCommands;\n  setOptions(options: Partial<EditorOptions> = {}): void;\n  setEditable(editable: boolean): void;\n  get isEditable(): boolean;\n  get state(): EditorState;\n\n  registerPlugin(plugin: Plugin, handlePlugins?: (newPlugin: Plugin, plugins: Plugin[]) => Plugin[]): void;\n  unregisterPlugin(nameOrPluginKey: string | PluginKey): void;\n\n  getJSON(): JSONContent {\n    return this.state.doc.toJSON();\n  }\n  getHTML(): string;\n  getText(options?: { blockSeparator?: string; textSerializers?: Record<string, TextSerializer> }): string;\n  get isEmpty(): boolean;\n  destroy(): void;\n  get isDestroyed(): boolean;\n}\n\nclass ExtensionManager {\n  editor: Editor;\n  schema: Schema;\n  extensions: Extensions;\n  constructor(extensions: Extensions, editor: Editor);\n  get commands(): RawCommands;\n  get plugins(): Plugin[]; // inputRules, pasteRules, others\n  get attributes();\n  get nodeViews();\n\n  static resolve(extensions: Extensions): Extensions;\n  static flatten(extensions: Extensions): Extensions;\n  static sort(extensions: Extensions): Extensions;\n}\nclass CommandManager {\n  editor: Editor;\n  rawCommands: AnyCommands;\n  customState?: EditorState;\n  constructor(props: { editor: Editor; state?: EditorState });\n  get state(): EditorState;\n  get commands(): SingleCommands;\n  get chain(): () => ChainedCommands;\n  get can(): () => CanCommands;\n}\n\ntype CommandProps = {\n  tr: Transaction;\n  editor: Editor;\n  view;\n  state: ChainableState;\n  dispatch?;\n  chain: () => ChainCommands;\n  can: () => CanCommands;\n  get commands();\n};\n"})})]})}function m(n={}){let{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}},17776:function(n,e,t){t.d(e,{R:()=>r,x:()=>o});var i=t(7378);let s={},a=i.createContext(s);function r(n){let e=i.useContext(a);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);