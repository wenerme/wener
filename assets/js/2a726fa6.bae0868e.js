"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["184379"],{886486:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>a,toc:()=>j,default:()=>d,metadata:()=>t,assets:()=>i,contentTitle:()=>l});var t=JSON.parse('{"id":"os/linux/shell/jq","title":"jq","description":"- https://jqplay.org/","source":"@site/../notes/os/linux/shell/jq.md","sourceDirName":"os/linux/shell","slug":"/os/linux/shell/jq","permalink":"/notes/os/linux/shell/jq","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/shell/jq.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1731048203000,"frontMatter":{"title":"jq"},"sidebar":"docs","previous":{"title":"fping","permalink":"/notes/os/linux/shell/fping"},"next":{"title":"lsof","permalink":"/notes/os/linux/shell/lsof"}}'),o=s(486106),r=s(917776);let a={title:"jq"},l="jq",i={},j=[{value:"composer auth.json",id:"composer-authjson",level:2},{value:"parse error: Invalid numeric literal at line 1, column 3",id:"parse-error-invalid-numeric-literal-at-line-1-column-3",level:2}];function c(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,r.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"jq",children:"jq"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://jqplay.org/",children:"https://jqplay.org/"})}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://stedolan.github.io/jq/manual/",children:"https://stedolan.github.io/jq/manual/"})}),"\n"]}),"\n",(0,o.jsx)(e.admonition,{type:"tip",children:(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"jq \u4E0D\u652F\u6301 inplace \u4FEE\u6539"}),"\n"]})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:'jq \'.components.rows|=sort_by(.id)|.components.rows[].properties|=sort_by(.name)\' file.json\n\n# inplace edit\njqi() {\n  cat <<< "$(jq "$1" < "$2")" > "$2"\n}\njqi ".a=1" test.json\n\n# merge\njq -s add a.json b.json c.json\n\n# deep merge\njq -s \'reduce .[] as $x ({}; . * $x)\' a.json b.json\n\n# array\n# \u975E\u5BF9\u8C61\u573A\u666F\njq -c \'.[]\' names.json | xargs -L 1 echo\n# \u5BF9\u8C61\u573A\u666F\njq -j \'.[] | tostring + "\\u0000"\' names.json | xargs -0 -n1 -I {} jq -n {}\n# \u4FBF\u5229\u6570\u7EC4\u5BF9\u8C61\u5B57\u6BB5\njq -j \'.builds[] | tostring + "\\u0000"\' build.json | xargs -0 -n1 -I {} sh -c "jq -n \'{}\' | jq -r .name"\n\n\nmapfile -t configArr < <(jq -c \'.[]\'  < app-cnfg.json)\nfor config in "${configArr[@]}"; do\n    aws dynamodb put-item --table-name "xxx" --item "$config"\ndone\n\nwhile IFS= read -r config; do\n    aws dynamodb put-item --table-name "xxx" --item "$config"\ndone< <(jq -c \'.[]\' < app-cnfg.json)\n\n# arg\njq --arg v "$PRJNAME" \'.dev.projects[$v]\' config.json\n\n\n# \u901A\u8FC7 redirect\njq \'.key\' <<< "$json_data"\n# \u901A\u8FC7 arg\njq -n --argjson data "$json_data" \'$data.key\'\n# \u901A\u8FC7\u73AF\u5883\u53D8\u91CF\njson_data="$json_data" jq -n \'env.json_data | fromjson.key\'\n# \u901A\u8FC7\u53D8\u91CF\njq -n "$json_data" | jq .key\n\n# jsonl\njq -c \'.[]\'                           # array to jsonl\njq -n \'[inputs]\' <in.jsonl >out.json  # jsonl to array\njq --slurp . <in.jsonl >out.json      # jsonl to array\n'})}),"\n",(0,o.jsx)(e.h2,{id:"composer-authjson",children:"composer auth.json"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"COMPOSER_REPO=$(cat composer.json | jq '.repositories[0].url' -r | sed -r 's|https?://([^/]+).*|\\1|')\necho '{}' | jq '.\"http-basic\".\"code.dev.wener.me\" = { \"username\": $ENV.COMPOSER_USER, \"password\": $ENV.COMPOSER_PASS }' > auth.json\n"})}),"\n",(0,o.jsx)(e.h2,{id:"parse-error-invalid-numeric-literal-at-line-1-column-3",children:"parse error: Invalid numeric literal at line 1, column 3"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u53EF\u80FD\u662F\u56E0\u4E3A\u6709 BOM"}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"dos2unix in.json\n"})})]})}function d(n={}){let{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(c,{...n})}):c(n)}},917776:function(n,e,s){s.d(e,{R:()=>a,x:()=>l});var t=s(7378);let o={},r=t.createContext(o);function a(n){let e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:a(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);