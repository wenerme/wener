"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["839464"],{458777:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>l,toc:()=>a,default:()=>p,metadata:()=>i,assets:()=>d,contentTitle:()=>o});var i=JSON.parse('{"id":"web/nodejs/node-gyp","title":"node-gyp","description":"- \u6700\u597D\u4F7F\u7528 prebuild","source":"@site/../notes/web/nodejs/node-gyp.md","sourceDirName":"web/nodejs","slug":"/web/nodejs/node-gyp","permalink":"/notes/web/nodejs/node-gyp","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/nodejs/node-gyp.md","tags":[{"inline":true,"label":"Interop","permalink":"/notes/tags/interop"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1772243505000,"frontMatter":{"tags":["Interop"]},"sidebar":"docs","previous":{"title":"MikroORM Version","permalink":"/notes/web/nodejs/mikro-orm/version"},"next":{"title":"Nodejs Awesome","permalink":"/notes/web/nodejs/awesome"}}'),t=r(486106),s=r(917776);let l={tags:["Interop"]},o="node-gyp",d={},a=[];function c(e){let n={a:"a",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"node-gyp",children:"node-gyp"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u6700\u597D\u4F7F\u7528 prebuild"}),"\n",(0,t.jsx)(n.li,{children:"\u5982\u679C\u51FA\u73B0\u4E86\u4ECE\u6E90\u7801\u6784\u5EFA\uFF0C\u5148\u6392\u67E5\u4E3A\u4EC0\u4E48\u4F1A\u5BFC\u81F4\u6784\u5EFA"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# node gyp \u4F9D\u8D56\napk add python3 g++ gcc make\n\n# \u5F3A\u5236\u4ECE\u6E90\u7801\u6784\u5EFA\nnpm install sqlite3 --build-from-source=sqlite3\n\n# \u67E5\u770B binary \u5730\u5740\n# \u6CE8\u610F module_name \u53EF\u80FD\u4E0D\u540C\u4E8E npm \u5305\u540D\nnpm view sqlite3@3.1.3 binary             # aws\nnpm view sqlite3@5.1.0 binary.module_name # github\n\n# install \u5305\u542B platform \u548C libc \u6761\u4EF6\nnpm install --platform=linux --libc=libc --registry https://npm.wener.me/\n\nnpm install sqlite3 --node_sqlite3_binary_host_mirror=https://npmmirror.com/mirrors/sqlite3\n\n# \u6839\u636E\u5E73\u53F0 rebuild\nnode-pre-gyp rebuild --target=0.30.2 --arch=x32 --target_platform=win32 --dist-url=https://atom.io/download/atom-shell\n\nnpm add -g @mikro-orm/better-sqlite --better_sqlite3_binary_host_mirror=https://npmmirror.com/mirrors/better-sqlite3\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"--{module_name}_binary_host_mirror"})}),"\n",(0,t.jsx)(n.li,{children:"prebuildify"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/prebuild/prebuild-install",children:"prebuild/prebuild-install"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\u914D\u7F6E\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"%package%_binary_host_mirror"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"%package%_binary_host"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\u7F13\u5B58\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"${npm_config_cache}/_prebuilds"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"${APP_DATA}/npm-cache/_prebuilds"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"${HOME}/.npm/_prebuilds"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["binary\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"binary_mirror_host"}),"\n"]}),"\n"]}),"\n"]})]})}function p(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},917776:function(e,n,r){r.d(n,{R:()=>l,x:()=>o});var i=r(7378);let t={},s=i.createContext(t);function l(e){let n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);