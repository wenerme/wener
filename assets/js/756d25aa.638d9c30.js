"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["29577"],{62352:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>l,toc:()=>c,default:()=>h,metadata:()=>r,assets:()=>o,contentTitle:()=>t});var r=JSON.parse('{"id":"dev/design/design-auth-api","title":"Auth API","description":"- API Keys","source":"@site/../notes/dev/design/design-auth-api.md","sourceDirName":"dev/design","slug":"/dev/design/auth-api","permalink":"/notes/dev/design/auth-api","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/design/design-auth-api.md","tags":[{"inline":true,"label":"API","permalink":"/notes/tags/api"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1710413103000,"frontMatter":{"tags":["API"]},"sidebar":"docs","previous":{"title":"Accounting","permalink":"/notes/dev/design/accounting"},"next":{"title":"Auth","permalink":"/notes/dev/design/auth"}}'),i=s(86106),d=s(17776);let l={tags:["API"]},t="Auth API",o={},c=[{value:"strapi",id:"strapi",level:2},{value:"directus",id:"directus",level:2},{value:"access token",id:"access-token",level:3},{value:"login",id:"login",level:3},{value:"refresh",id:"refresh",level:3},{value:"logout",id:"logout",level:3},{value:"password reset",id:"password-reset",level:3},{value:"providers",id:"providers",level:3}];function a(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"auth-api",children:"Auth API"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"API Keys"}),"\n",(0,i.jsx)(n.li,{children:"Basic Auth"}),"\n",(0,i.jsx)(n.li,{children:"OAuth 2.0"}),"\n",(0,i.jsx)(n.li,{children:"HMAC"}),"\n",(0,i.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/simov/grant",children:"simov/grant"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JS"}),"\n",(0,i.jsx)(n.li,{children:"OAuth Proxy"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/simov/purest",children:"simov/purest"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"REST API Client Library"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.strapi.io/dev-docs/plugins/users-permissions",children:"https://docs.strapi.io/dev-docs/plugins/users-permissions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.directus.io/reference/authentication.html",children:"https://docs.directus.io/reference/authentication.html"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"strapi",children:"strapi"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Login /api/auth/local"}),"\n",(0,i.jsx)(n.li,{children:"/connect/github/redirect"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/api/connect/${provider}"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/api/auth/${provider}/callback"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/api/auth/forgot-password"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/api/auth/reset-password"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/api/auth/send-email-confirmation"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/api/auth/email-confirmation?confirmation=TOKEN"})}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /api/auth/local/register\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "username": "Strapi user",\n  "email": "user@strapi.io",\n  "password": "strapiPassword"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4FEE\u6539\u5BC6\u7801"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /api/auth/change-password\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "currentPassword": "currentPassword",\n  "password": "userNewPassword",\n  "passwordConfirmation": "userNewPassword"\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"directus",children:"directus"}),"\n",(0,i.jsx)(n.h3,{id:"access-token",children:"access token"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"by header"}),"\n",(0,i.jsx)(n.li,{children:"by cookie"}),"\n",(0,i.jsx)(n.li,{children:"by query"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Authorization: Bearer <token>\nCookie: directus_session_token=<token>\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"?access_token=<token>\n"})}),"\n",(0,i.jsx)(n.h3,{id:"login",children:"login"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /auth/login\nPOST /auth/login/provider\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "email": "example@wener.com",\n  "password": "password",\n  "otp": "123456",\n  "mode": "jsoncookie|session"\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "access_token": "",\n  "expires": 7200,\n  "refresh_token": ""\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"refresh",children:"refresh"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /auth/refresh\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "refresh_token": "refresh_token_string",\n  "mode": "json|cookie|session"\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "access_token": "",\n  "expires": 7200,\n  "refresh_token": ""\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"logout",children:"logout"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /auth/logout\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "refresh_token": "refresh_token",\n  "mode": "json"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"password-reset",children:"password reset"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /auth/password/request\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "email": "user_email",\n  "reset_url": ""\n}\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"POST /auth/password/reset\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "token": "password_reset_token",\n  "password": "password"\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"providers",children:"providers"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GET /auth\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "data": [\n    {\n      "name": "GitHub",\n      "driver": "oauth2",\n      "icon": "github"\n    },\n    {\n      "name": "Google",\n      "driver": "openid",\n      "icon": "google"\n    },\n    {\n      "name": "Okta",\n      "driver": "openid"\n    }\n  ],\n  "disableDefault": false\n}\n'})})]})}function h(e={}){let{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},17776:function(e,n,s){s.d(n,{R:()=>l,x:()=>t});var r=s(7378);let i={},d=r.createContext(i);function l(e){let n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);