"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["653676"],{628872:function(n,e,r){r.r(e),r.d(e,{frontMatter:()=>s,toc:()=>a,default:()=>p,metadata:()=>t,assets:()=>c,contentTitle:()=>l});var t=JSON.parse('{"id":"service/network/proxy/privoxy","title":"Privoxy","description":"- unisx/privoxy","source":"@site/../notes/service/network/proxy/privoxy.md","sourceDirName":"service/network/proxy","slug":"/service/network/proxy/privoxy","permalink":"/notes/service/network/proxy/privoxy","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/network/proxy/privoxy.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1694402622000,"frontMatter":{"title":"Privoxy"},"sidebar":"docs","previous":{"title":"Privoxy Action","permalink":"/notes/service/network/proxy/privoxy-action"},"next":{"title":"Proxy Awesome","permalink":"/notes/service/network/proxy/awesome"}}'),o=r(486106),i=r(917776);let s={title:"Privoxy"},l="Privoxy",c={},a=[{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:2}];function d(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"privoxy",children:"Privoxy"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"https://github.com/unisx/privoxy",children:"unisx/privoxy"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"GPLv2, C"}),"\n",(0,o.jsx)(e.li,{children:"2016\u5E74\u540E\u505C\u6B62\u5F00\u53D1"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.li,{children:"\u63D0\u4F9B HTTP \u4EE3\u7406"}),"\n",(0,o.jsxs)(e.li,{children:["\u652F\u6301\u5C06\u4E8C\u7EA7\u4EE3\u7406\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"\u4F8B\u5982\u5C06 SOCKS \u4EE3\u7406\u8F6C\u4E3A HTTP \u4EE3\u7406"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://www.privoxy.org/",children:"privoxy"})}),"\n",(0,o.jsxs)(e.li,{children:["\u652F\u6301\u901A\u8FC7\u6D4F\u89C8\u5668\u914D\u7F6E - \u9700\u8981\u5B89\u88C5\u4E86\u6A21\u677F\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"http://config.privoxy.org",children:"http://config.privoxy.org"})}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"http://p.p",children:"http://p.p"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://www.privoxy.org/user-manual/index.html",children:"https://www.privoxy.org/user-manual/index.html"})}),"\n",(0,o.jsxs)(e.li,{children:["\u6CE8\u610F\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:["\u4E0D\u652F\u6301 auth\uFF0C\u53EF\u4EE5\u8F6C\u53D1 auth\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.code,{children:"enable-proxy-authentication-forwarding"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"# macOS\n# macOS \u4E0B\u7684\u914D\u7F6E\u76EE\u5F55\u4E3A /usr/local/etc/privoxy\nbrew install privoxy\n\n# \u76D1\u542C 7777 \u8F6C\u53D1\u5230 8888 SOCKS \u7AEF\u53E3\ncat <<CONF > privoxy.conf\nlisten-address 0.0.0.0:7777\nforward-socks5t / 127.0.0.1:8888 .\nCONF\n\n# \u914D\u7F6E\u6587\u4EF6\u6821\u9A8C\nprivoxy --config-test privoxy.conf\n# \u5728\u524D\u53F0\u8FD0\u884C\nprivoxy --no-daemon privoxy.conf\n\n# Docker \u542F\u52A8\ndocker run -d --restart always \\\n  -p 127.0.0.1:7777:7777 \\\n  --name privoxy wener/privoxy\n\n# AlpineLinux\napk add privoxy\ncat <<CONF > /etc/privoxy/config\nlisten-address 0.0.0.0:7777\n# forward-socks5t / 127.0.0.1:8888 .\nCONF\nservice privoxy start\ncurl 127.0.0.1:7777 icanhazip.com\n\nrc-update add privoxy\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://www.privoxy.org/faq/configuration.html",children:"https://www.privoxy.org/faq/configuration.html"})}),"\n"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-conf",children:"# \u914D\u7F6E\u76EE\u5F55\nconfdir /etc/privoxy\n# \u6A21\u677F\u76EE\u5F55 - \u9ED8\u8BA4\u4E3A confdir/template\n# templdir /etc/privoxy/templates\n# \u4E34\u65F6\u76EE\u5F55\n# temporary-directory /tmp\n# \u65E5\u5FD7\u76EE\u5F55\nlogdir /var/log/privoxy\n\n# \u52A8\u4F5C\u6587\u4EF6 - confdir \u7684\u76F8\u5BF9\u4F4D\u7F6E\nactionsfile default.action\n# \u8FC7\u6EE4\u6587\u4EF6 - confdir \u7684\u76F8\u5BF9\u4F4D\u7F6E\nfilterfile default.filter\n# \u65E5\u5FD7\u6587\u4EF6 - logdir \u76F8\u5BF9\u4F4D\u7F6E\nlogdir logfile\n# \u4FE1\u4EFB\u6587\u4EF6 - confdir \u7684\u76F8\u5BF9\u4F4D\u7F6E\n# trustfile trustfile\n\n# \u65E5\u5FD7\u7B49\u7EA7 - bit \u4F4D \u6216 \u5199\u591A\u884C\ndebug 0\n# \u662F\u5426\u5355\u7EBF\u7A0B\u8FD0\u884C\nsingle-threaded 0\n# CGI \u9875\u9762\u663E\u793A\u7684\u4E3B\u673A\u540D\n# hostname example.com\n\n# \u5E2E\u52A9\u6587\u6863\u76EE\u5F55\nuser-manual  /usr/share/doc/privoxy/user-manual\n# \u5F53\u8BBF\u95EE\u4E0D\u4FE1\u4EFB\u7F51\u7AD9\u65F6\u663E\u793A\u7684\u5730\u5740\n# trust-info-url http://wener.me\n# \u5728\u9875\u9762\u4E0A\u663E\u793A\u7684\u7BA1\u7406\u5458\u5730\u5740\n# admin-address admin@example.com\n# \u5728\u9875\u9762\u4E0A\u663E\u793A\u7684\u4EE3\u7406\u4FE1\u606F\n# proxy-info-url https://proxy.example.com\n\n\n# \u76D1\u542C\u914D\u7F6E - \u53EF\u5199\u591A\u6B21\nlisten-address 127.0.0.1:8118\n\n# \u4EE3\u7406\u529F\u80FD\u5F00\u5173\u9ED8\u8BA4\u503C - \u5E7F\u544A\u62E6\u622A\u3001\u5185\u5BB9\u8FC7\u6EE4\ntoggle 1\n# \u662F\u5426\u5141\u8BB8\u8FDC\u7A0B\u4FEE\u6539 - http://config.privoxy.org/toggle\nenable-remote-toggle 0\n# \u662F\u5426\u8BC6\u522B HTTP \u5934\u6765\u63A7\u5236\u5F00\u5173 - X-Filter: No\nenable-remote-http-toggle 0\n\n# \u662F\u5426\u5141\u8BB8\u7F16\u8F91 action\nenable-edit-actions 0\n\n# \u662F\u5426\u5F3A\u5236\u963B\u585E - \u9ED8\u8BA4\u5728\u963B\u585E\u9875\u9762\u5305\u542B\u7EE7\u7EED\u8BBF\u95EE\u64CD\u4F5C\nenforce-blocks 0\n\n# ACLs\n# ==========\n# \u6765\u6E90-\u76EE\u6807\n# src_addr[:port][/src_masklen] [dst_addr[:port][/dst_masklen]]\n# \u5141\u8BB8\u8BBF\u95EE\npermit-access 192.168.2.0/24\npermit-access www.privoxy.org/24 www.example.com/32\n\n# \u7981\u6B62\u8BBF\u95EE\ndeny-access 192.168.3.0/24\ndeny-access pornhub.com\n\n# \u5185\u5BB9\u8FC7\u6EE4\u7684\u7F13\u51B2\nbuffer-limit 4096\n# \u662F\u5426\u8F6C\u53D1\u6388\u6743\u4FE1\u606F\nenable-proxy-authentication-forwarding 0\n\n# \u53EF\u4FE1\u4EFB\u7684\u7BA1\u7406\u9875 referer \u5730\u5740\n# trusted-cgi-referer wener.me\n\n# \u8F6C\u53D1\n# ==========\n# HTTP \u8F6C\u53D1\n# forward target_pattern http_parent[:port]\n# `.\u2018 \u8868\u793A\u76F4\u63A5\u8BF7\u6C42\n# \u6240\u6709\u7684\u8BF7\u6C42\u8FDB\u884C\u8F6C\u53D1\nforward   /      external-proxy.example.org:8080\n# 443 \u4E0D\u8F6C\u53D1\nforward   :443   .\n# \u57DF\u540D\u63A7\u5236\u8F6C\u53D1\nforward   .google.com   .\n\n# \u672C\u5730\u76F4\u63A5\u8BF7\u6C42\nforward 192.168.*.*/  .\nforward 10.*.*.*/     .\nforward 127.*.*.*/    .\nforward localhost/    .\n\n# \u9ED8\u8BA4\u4E0D\u8F6C\u53D1\uFF0C\u53EA\u8F6C\u53D1\u56FA\u5B9A\u683C\u5F0F\u6587\u4EF6\nforward   /                          .\nforward   /.*\\.(exe|com|dll|zip)$    antivir.example.com:8010\n\n# SOCKS \u8F6C\u53D1\n# forward-socks4, forward-socks4a, forward-socks5 and forward-socks5t\n# \u503C\u683C\u5F0F target_pattern socks_proxy[:port] http_parent[:port]\n# \u5C06\u6240\u6709\u8BF7\u6C42\u8F6C\u53D1 127.0.0.1:8888\nforward-socks5t / 127.0.0.1:8888 .\n\n# \u8F6C\u53D1\u94FE\u63A5\u91CD\u8BD5\nforwarded-connect-retries 0\n\n# \u6742\u9879\n# ==========\n# \u63A5\u53D7\u88AB\u62E6\u622A\u7684\u8BF7\u6C42\naccept-intercepted-requests 0\n# \u62E6\u622A\u662F\u5426\u5BF9 CGI \u751F\u6548\nallow-cgi-request-crunching 0\n# GCI \u662F\u5426\u5206\u79BB\u5927\u8868\u5355\nsplit-large-forms 0\n# \u94FE\u63A5\u4FDD\u6D3B\u65F6\u95F4\nkeep-alive-timeout 0\n# \u662F\u5426\u652F\u6301\u7BA1\u9053\u8BF7\u6C42 - \u4E00\u6B21\u8BF7\u6C42\u591A\u4E2A\u8FD4\u56DE\ntolerate-pipelining 0\n# \u670D\u52A1\u7AEF\u94FE\u63A5\u8D85\u65F6\u65F6\u95F4\ndefault-server-timeout 0\n# \u4FDD\u6D3B\u7684\u94FE\u63A5\u662F\u5426\u5171\u4EAB\nconnection-sharing 0\n# Socket \u672A\u63A5\u6536\u5230\u6570\u636E\u7684\u8D85\u65F6\u65F6\u95F4\nsocket-timeout 300\n# \u6700\u5927\u94FE\u63A5\u6570\nmax-client-connections 128\n# \u8BF7\u6C42\u94FE\u63A5\u961F\u5217\u6570\nlisten-backlog 128\n# \u63A5\u6536\u8FC7\u6EE4\nenable-accept-filter 0\n\nhandle-as-empty-doc-returns-ok 0\n# \u542F\u7528\u538B\u7F29\nenable-compression 0\n# \u538B\u7F29\u7EA7\u522B\ncompression-level 1\n# HTTP \u5934\u987A\u5E8F\n# client-header-order Contet-Type,X-Token\n# \u5BA2\u6237\u7AEF\u76F8\u5173\u6807\u7B7E - http://config.privoxy.org/client-tags\n# client-specific-tag admin-block \u63A7\u5236\u7BA1\u7406\u5458\u7684\u8BBF\u95EE\n# \u6807\u7B7E\u751F\u547D\u5468\u671F\nclient-tag-lifetime 60\n# \u662F\u5426\u4FE1\u4EFB X-Forwarded-For\ntrust-x-forwarded-for 0\n# \u63A5\u6536\u7F13\u5B58\u5927\u5C0F\nreceive-buffer-size 5000\n"})})]})}function p(n={}){let{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}},917776:function(n,e,r){r.d(e,{R:()=>s,x:()=>l});var t=r(7378);let o={},i=t.createContext(o);function s(n){let e=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);