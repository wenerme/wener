"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["57759"],{66512:function(e,t,n){n.r(t),n.d(t,{frontMatter:()=>s,toc:()=>l,default:()=>u,metadata:()=>r,assets:()=>d,contentTitle:()=>i});var r=JSON.parse('{"id":"web/react/react-tracked","title":"react-tracked","description":"- dai-shi/react-tracked","source":"@site/../notes/web/react/react-tracked.md","sourceDirName":"web/react","slug":"/web/react/tracked","permalink":"/notes/web/react/tracked","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/react/react-tracked.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1666880007000,"frontMatter":{"title":"react-tracked"},"sidebar":"docs","previous":{"title":"React Test","permalink":"/notes/web/react/test"},"next":{"title":"React Version","permalink":"/notes/web/react/version"}}'),c=n(86106),a=n(17776);let s={title:"react-tracked"},i="react-tracked",d={},l=[];function o(e){let t={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.header,{children:(0,c.jsx)(t.h1,{id:"react-tracked",children:"react-tracked"})}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:[(0,c.jsx)(t.a,{href:"https://github.com/dai-shi/react-tracked",children:"dai-shi/react-tracked"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsxs)(t.li,{children:["\u901A\u8FC7 proxy \u8DDF\u8E2A\u53D8\u5316 - \u7C7B\u4F3C ",(0,c.jsx)(t.a,{href:"/notes/web/react/valtio",children:"valtio"})]}),"\n",(0,c.jsxs)(t.li,{children:["\u53EF\u4EE5\u7528\u4E8E useState, zustand ",(0,c.jsx)(t.a,{href:"/notes/web/react/zustand",children:"useStore"}),", redux useSelector, \u4E3B\u8981\u63D0\u4F9B\u4E00\u4E2A\u5339\u914D\u7684\u65B9\u6CD5\u5373\u53EF"]}),"\n",(0,c.jsxs)(t.li,{children:["\u4F7F\u7528 proxy-compare\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"getUntracked, createProxy, isChanged"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["createTrackedSelector - useSelector -> useTrackedSelector\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"\u8BBF\u95EE\u5C5E\u6027\u4F1A\u88AB watch\u3001select"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(t.li,{children:["createContainer\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"\u63D0\u4F9B\u7C7B\u4F3C useReducer \u7684 hook"}),"\n",(0,c.jsx)(t.li,{children:"\u8FD4\u56DE Provider, useTracked, useUpdate, useTrackedState, useSelector,"}),"\n",(0,c.jsxs)(t.li,{children:["concurrentMode -> useContextUpdate ",(0,c.jsx)(t.a,{href:"/notes/web/react/use-context-selector",children:"use-context-selector"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:(0,c.jsx)(t.a,{href:"https://github.com/reactjs/rfcs/pull/119",children:"useContextUpdate"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(t.li,{children:"memo - \u4F1A\u5904\u7406 proxy \u5BF9\u8C61\u503C\u53D8\u5316"}),"\n",(0,c.jsx)(t.li,{children:"getUntrackedObject - \u83B7\u53D6\u539F\u59CB\u503C"}),"\n"]}),"\n",(0,c.jsx)(t.admonition,{type:"caution",children:(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"useTrackedState \u6BCF\u6B21\u8FD4\u56DE\u65B0\u7684 proxy \u5BF9\u8C61 - \u4E0D\u7B49"}),"\n",(0,c.jsx)(t.li,{children:"React.memo \u65E0\u6CD5\u5904\u7406\u4F20\u5165 proxy \u5BF9\u8C61\uFF0C\u5BFC\u81F4\u503C\u53D8\u5316\u4F46\u4E0D rerender"}),"\n",(0,c.jsx)(t.li,{children:"\u4F20\u503C\u5230 render \u4E4B\u5916\u65F6\u8BB0\u5F97 getUntrackedObject"}),"\n"]})}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-tsx",children:"const reducer = () => {};\nconst { Provider, useTracked } = createContainer(({ reducer, initialState, init }) =>\n  useReducer(reducer, initialState, init),\n);\n\n// \u76F4\u63A5\u4F7F\u7528\u72B6\u6001\u7684\u65B9\u5F0F\nconst {} = createContainer(({ initialState = {} }) => useState(initialState));\n\n// \u4F7F\u7528 immer \u66F4\u65B0\nimport produce from 'immer';\nconst useTrackedWithImmer = () => {\n  const [state, setState] = useTracked();\n  const update = useCallback(\n    (updater) => {\n      setState((oldVal) => produce(oldVal, updater));\n    },\n    [setState],\n  );\n  return [state, update];\n};\n\nconst App = ({ initialState }) => (\n  <Provider reducer={reducer} initialState={initialState}>\n    ...\n  </Provider>\n);\n"})})]})}function u(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,c.jsx)(t,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},17776:function(e,t,n){n.d(t,{R:()=>s,x:()=>i});var r=n(7378);let c={},a=r.createContext(c);function s(e){let t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);