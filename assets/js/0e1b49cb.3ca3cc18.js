"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["18326"],{40409:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>l,toc:()=>d,default:()=>h,metadata:()=>i,assets:()=>o,contentTitle:()=>c});var i=JSON.parse('{"id":"devops/storage/README","title":"Storage","description":"Tips","source":"@site/../notes/devops/storage/README.md","sourceDirName":"devops/storage","slug":"/devops/storage/","permalink":"/notes/devops/storage/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/storage/README.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1693463269000,"frontMatter":{"title":"Storage"},"sidebar":"docs","previous":{"title":"Status","permalink":"/notes/devops/status"},"next":{"title":"Fiber Channel","permalink":"/notes/devops/storage/block/fc"}}'),r=s(86106),t=s(17776);let l={title:"Storage"},c="Storage",o={},d=[{value:"Tips",id:"tips",level:2},{value:"Transfer",id:"transfer",level:2},{value:"Disk",id:"disk",level:2}];function a(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"storage",children:"Storage"})}),"\n",(0,r.jsx)(e.h2,{id:"tips",children:"Tips"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/restic/restic",children:"restic/restic"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://restic.github.io/",children:"restic"})}),"\n",(0,r.jsx)(e.li,{children:"Fast, secure, efficient backup program"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://rclone.org/",children:"Rclone"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/ncw/rclone",children:"ncw/rclone"})}),"\n",(0,r.jsx)(e.li,{children:"Rclone is a command line program to sync files and directories to and from"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://mountainduck.io/",children:"Mountain Duck"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"mount server and cloud storage as a local disk"}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://mountainduck.io/comparison/",children:"comparison"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://cyberduck.io/",children:"Cyberduck"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/iterate-ch/cyberduck",children:"iterate-ch/cyberduck"})}),"\n",(0,r.jsx)(e.li,{children:"Cyberduck is a libre FTP, SFTP, WebDAV, Amazon S3, OpenStack Swift, Backblaze B2, Microsoft Azure & OneDrive, Google Drive and Dropbox browser for Mac and Windows."}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://cryptomator.org/",children:"Cryptomator"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/cryptomator/cryptomator",children:"cryptomator/cryptomator"})}),"\n",(0,r.jsx)(e.li,{children:"Free client-side encryption for your cloud files. Open source software: No backdoors, no registration."}),"\n",(0,r.jsx)(e.li,{children:"Transparent encryption"}),"\n",(0,r.jsx)(e.li,{children:"Files get encrypted individually"}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/cryptomator/cryptofs",children:"cryptomator/cryptofs"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Java Filesystem Provider with integrated encryption"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Java\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/lookfirst/sardine",children:"lookfirst/sardine"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"an easy to use webdav client for java"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/dCache/nfs4j",children:"dCache/nfs4j"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Pure Java NFSv3 and NFSv4.1 implementation"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/hierynomus/sshj",children:"ssh, scp and sftp for java"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Golang\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/spf13/afero",children:"spf13/afero"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["S3\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/s3fs-fuse/s3fs-fuse",children:"s3fs-fuse/s3fs-fuse"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u9650\u5236\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u968F\u673A\u5199\u6216 append \u4F1A\u91CD\u5199\u6574\u4E2A\u6587\u4EF6"}),"\n",(0,r.jsx)(e.li,{children:"list \u6574\u4E2A\u76EE\u5F55\u7684\u6027\u80FD\u8F83\u5DEE, \u53D6\u51B3\u4E8E\u7F51\u7EDC\u5EF6\u8FDF"}),"\n",(0,r.jsx)(e.li,{children:"\u6700\u7EC8\u4E00\u81F4\u6027\u53EF\u80FD\u4F1A\u5BFC\u81F4\u8BFB\u53D6\u8FC7\u671F\u6570\u636E"}),"\n",(0,r.jsx)(e.li,{children:"\u91CD\u547D\u540D\u4E0D\u662F\u539F\u5B50\u6027\u7684"}),"\n",(0,r.jsx)(e.li,{children:"\u591A\u4E2A\u7AEF\u6302\u8F7D\u4E0D\u4F1A\u8FDB\u884C\u534F\u8C03"}),"\n",(0,r.jsx)(e.li,{children:"\u4E0D\u652F\u6301\u786C\u8FDE\u63A5"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/kahing/goofys",children:"kahing/goofys"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Goofys is a high-performance, POSIX-ish Amazon S3 file system written in Go"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["B2 Cloud Storage\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.backblaze.com/b2/cloud-storage-pricing.html",children:"Pricing"})}),"\n",(0,r.jsx)(e.li,{children:"\u975E\u5E38\u4FBF\u5B9C\u7684\u4E91\u5B58\u50A8"}),"\n",(0,r.jsx)(e.li,{children:"\u5B58\u50A8 0.005$/GB/Month"}),"\n",(0,r.jsx)(e.li,{children:"\u4E0B\u8F7D 0.02$/GB"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["FS\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/kahing/catfs",children:"kahing/catfs"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Catfs is a caching filesystem written in Rust"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://www.snia.org/sites/default/files/SDC/2016/presentations/erasure_coding/DrorGoldenberg_Optimize_Storage_Efficiency-v2.pdf",children:"Optimize Storage Efficiency"})}),"\n",(0,r.jsxs)(e.li,{children:["\u4E0D\u80FD\u4F7F\u7528\u7684\u6587\u4EF6\u540D\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Windows ",(0,r.jsx)(e.code,{children:'\\/:*?"<>|'})]}),"\n",(0,r.jsxs)(e.li,{children:["Linux, macOS ",(0,r.jsx)(e.code,{children:"null"})," \u6216 ",(0,r.jsx)(e.code,{children:"/"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"brew install s3fs\n\nbrew install goofys\n\nexport AWS_ACCESS_KEY_ID=${ID}\nexport AWS_SECRET_ACCESS_KEY=${KEY}\n# goofys <bucket> <mountpoint>\n# goofys <bucket:prefix> <mountpoint>\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'find dir/ -name "offender1" -mtime -1 -print0 | du --files0-from=- -hc | tail -n1\n'})}),"\n",(0,r.jsx)(e.h2,{id:"transfer",children:"Transfer"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u4E24\u4E2A\u670D\u52A1\u5668\u4E4B\u95F4\u4F20\u8F93\u5927\u91CF\u5C0F\u6587\u4EF6\u65F6\u975E\u5E38\u5FEB\n# \u89C9\u5F97 gzip \u6162\u53EF\u4EE5\u4F7F\u7528 pigz\ntar c some/dir/ | gzip - | ssh host2 tar xz -C /other/dir/\n# \u5168\u91CF\u540C\u6B65\u540E\u518D\u8FDB\u884C\u589E\u91CF\u540C\u6B65\nrsync -azv some/dir/ user@host:/other/dir/\n\n"})}),"\n",(0,r.jsx)(e.h2,{id:"disk",children:"Disk"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Disk_cloning",children:"Disk cloning"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#\nlsblk --output NAME,SIZE,VENDOR,FSTYPE,LABEL,UUID,MODE\n\n# \u514B\u9686\u5355\u4E2A\u78C1\u76D8\ndd if=/dev/sda1 of=/dev/sdb1 bs=64K conv=noerror,sync status=progress\n# \u514B\u9686\u6574\u4E2A\u78C1\u76D8\ndd if=/dev/sdX of=/dev/sdY bs=64K conv=noerror,sync status=progress\n\n# \u5907\u4EFD\n# \u5907\u4EFD\u6574\u4E2A\u7CFB\u7EDF\nrsync -aAXv --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found"} / /path/to/backup/folder\n# \u4F7F\u7528 --info=progress2 \u663E\u793A\u603B\u4F53\u7684\u8FDB\u5EA6, \u800C\u4E0D\u662F\u6BCF\u4E2A\u6587\u4EF6\nrsync -aAX --info=progress2 --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/lost+found"} / /path/to/backup/folder\n\n# \u5907\u4EFD\u542F\u52A8\u5206\u533A\n# https://wiki.archlinux.org/index.php/disk_cloning\ndd if=/dev/sda1 of=/mnt/dst/bios-boot bs=64K conv=noerror,sync status=progress\n\n# \u5907\u4EFD\u5206\u533A\nsfdisk -d /dev/sda > part_table\n# \u6062\u590D\u5206\u533A\nsfdisk /dev/sda < part_table\n# wipefs \u4E5F\u53EF\u4EE5\n'})})]})}function h(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},17776:function(n,e,s){s.d(e,{R:()=>l,x:()=>c});var i=s(7378);let r={},t=i.createContext(r);function l(n){let e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);