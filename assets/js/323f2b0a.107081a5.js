"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["195739"],{443947:function(e,n,l){l.r(n),l.d(n,{frontMatter:()=>d,toc:()=>o,default:()=>a,metadata:()=>r,assets:()=>c,contentTitle:()=>t});var r=JSON.parse('{"id":"web/framework/electron/electron-dev","title":"Electron Dev","description":"- preload","source":"@site/../notes/web/framework/electron/electron-dev.md","sourceDirName":"web/framework/electron","slug":"/web/framework/electron/dev","permalink":"/notes/web/framework/electron/dev","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/framework/electron/electron-dev.md","tags":[{"inline":true,"label":"Devlopment","permalink":"/notes/tags/devlopment"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1690946986000,"frontMatter":{"title":"Electron Dev","tags":["Devlopment"]},"sidebar":"docs","previous":{"title":"electron-builder","permalink":"/notes/web/framework/electron/builder"},"next":{"title":"Electron FAQ","permalink":"/notes/web/framework/electron/faq"}}'),s=l(486106),i=l(917776);let d={title:"Electron Dev",tags:["Devlopment"]},t="Electron Dev",c={},o=[{value:"Debug app",id:"debug-app",level:2},{value:"\u4E3B\u8FDB\u7A0B\u6A21\u5757",id:"\u4E3B\u8FDB\u7A0B\u6A21\u5757",level:2},{value:"\u6E32\u67D3\u8FDB\u7A0B\u6A21\u5757",id:"\u6E32\u67D3\u8FDB\u7A0B\u6A21\u5757",level:2},{value:"\u516C\u5171\u6A21\u5757",id:"\u516C\u5171\u6A21\u5757",level:2},{value:"\u65E0\u6846\u7A97\u53E3",id:"\u65E0\u6846\u7A97\u53E3",level:3}];function h(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"electron-dev",children:"Electron Dev"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["preload\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["modules\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"electron - renderer process modules"}),"\n",(0,s.jsx)(n.li,{children:"events"}),"\n",(0,s.jsx)(n.li,{children:"timers"}),"\n",(0,s.jsx)(n.li,{children:"url"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["polyfills\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Buffer"}),"\n",(0,s.jsx)(n.li,{children:"process"}),"\n",(0,s.jsx)(n.li,{children:"clearImmediate"}),"\n",(0,s.jsx)(n.li,{children:"setImmediate"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["sandboxed\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"app.enableSandbox()"}),"\n",(0,s.jsx)(n.li,{children:"webPreferences.sandbox"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"process.sandboxed"}),"\n",(0,s.jsx)(n.li,{children:"process.contextIsolated"}),"\n",(0,s.jsx)(n.li,{children:"\u6BCF\u4E2A JS \u4E3A\u4E00\u4E2A \u4E0A\u4E0B\u6587"}),"\n",(0,s.jsxs)(n.li,{children:["app\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"web-contents-created"}),"\n",(0,s.jsx)(n.li,{children:"before-input-event"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"BrowserWindow.getFocusedWindow()"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"ipcMain"}),(0,s.jsx)(n.th,{children:"ipcRenderer"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"on,once"}),(0,s.jsx)(n.td,{children:"send"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"on,once"}),(0,s.jsx)(n.td,{children:"postMessage"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"on,once"}),(0,s.jsx)(n.td,{children:"sendSync"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"on,once"}),(0,s.jsx)(n.td,{children:"sendTo"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"on,once"}),(0,s.jsx)(n.td,{children:"sendToHost"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"handle"}),(0,s.jsx)(n.td,{children:"invoke"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"debug-app",children:"Debug app"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u81EA\u5B9A\u4E49\u4E00\u4E2A DEBUG_PROD \u53D8\u91CF\u505A\u7279\u6B8A\u5904\u7406"}),"\n",(0,s.jsx)(n.li,{children:"remote inspect"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# https://localhost:8315\nopen /Applications/WhatsApp.app --args --remote-debugging-port=8315\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u4E3B\u8FDB\u7A0B\u6A21\u5757",children:"\u4E3B\u8FDB\u7A0B\u6A21\u5757"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"BrowserWindow - \u7A97\u53E3"}),"\n",(0,s.jsx)(n.li,{children:"BrowserView - \u89C6\u56FE"}),"\n",(0,s.jsx)(n.li,{children:"ipcMain - \u901A\u8BAF"}),"\n",(0,s.jsx)(n.li,{children:"webContents - \u9875\u9762\u6E32\u67D3\u548C\u63A7\u5236"}),"\n",(0,s.jsx)(n.li,{children:"webFrame - \u81EA\u5B9A\u4E49\u5F53\u524D\u9875\u9762\u6E32\u67D3"}),"\n",(0,s.jsx)(n.li,{children:"webFrameMain - \u63A7\u5236\u9875\u9762\u4E5F iframe"}),"\n",(0,s.jsx)(n.li,{children:"WebRequest - \u62E6\u622A\u548C\u4FEE\u6539\u8BF7\u6C42"}),"\n",(0,s.jsx)(n.li,{children:"session - \u7BA1\u7406\u6D4F\u89C8\u5668\u4F1A\u8BDD\u3001cookie\u3001\u7F13\u5B58\u3001\u4EE3\u7406\u8BBE\u7F6E"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u6E32\u67D3\u8FDB\u7A0B\u6A21\u5757",children:"\u6E32\u67D3\u8FDB\u7A0B\u6A21\u5757"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["contextBridge - \u9694\u79BB\u4E0A\u4E0B\u6587\u4E4B\u95F4\u7684\u53CC\u5411\u540C\u6B65\u6865\u63A5\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"preload <-> renderer"}),"\n",(0,s.jsx)(n.li,{children:"electron 12+ \u9ED8\u8BA4\u542F\u7528 contextIsolation"}),"\n",(0,s.jsxs)(n.li,{children:["isolated \u4E0A\u4E0B\u6587 - preload \u4E0A\u4E0B\u6587 - \u5728\u6E32\u67D3\u8FDB\u7A0B\u4E2D\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53EF\u4F7F\u7528 node \u6A21\u5757"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["ipcRenderer - renderer \u548C main \u8FDB\u7A0B\u5F02\u6B65\u901A\u8BAF\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"EventEmitter + MessageChannel + invoke/sendSync + sendTo/sendToHost"}),"\n",(0,s.jsx)(n.li,{children:"invoke \u8FD4\u56DE Promise \u53EF\u7528\u4E8E RPC"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["webFrame - \u81EA\u5B9A\u4E49\u6E32\u67D3\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u7F29\u653E\u3001\u62FC\u5199\u68C0\u67E5\u3001CSS \u4FEE\u6539\u3001\u6267\u884C JS\u3001\u8D44\u6E90\u4F7F\u7528\u60C5\u51B5\u3001\u7F13\u5B58"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u516C\u5171\u6A21\u5757",children:"\u516C\u5171\u6A21\u5757"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"main \u548C renderer \u90FD\u53EF\u4EE5\u4F7F\u7528\u7684\u6A21\u5757"}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"clipboard"}),"\n",(0,s.jsx)(n.li,{children:"crashReporter"}),"\n",(0,s.jsx)(n.li,{children:"desktopCapturer"}),"\n",(0,s.jsx)(n.li,{children:"nativeImage"}),"\n",(0,s.jsx)(n.li,{children:"shell"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"\u65E0\u6846\u7A97\u53E3",children:"\u65E0\u6846\u7A97\u53E3"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.electronjs.org/docs/api/frameless-window",children:"frameless-window"})}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-css",children:".titlebar {\n  /* \u62D6\u52A8 - \u5B50\u5143\u7D20\u53EF\u8BBE\u7F6E no-drag */\n  -webkit-app-region: drag;\n  /* \u907F\u514D\u62D6\u52A8\u548C\u9009\u62E9\u51B2\u7A81 */\n  -webkit-user-select: none;\n}\n"})})]})}function a(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},917776:function(e,n,l){l.d(n,{R:()=>d,x:()=>t});var r=l(7378);let s={},i=r.createContext(s);function d(e){let n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);