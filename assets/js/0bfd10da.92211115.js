"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["38370"],{68974:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>r,toc:()=>o,default:()=>u,metadata:()=>i,assets:()=>c,contentTitle:()=>d});var i=JSON.parse('{"id":"dev/build/just","title":"just","description":"- just \u80FD\u89E3\u51B3 Makefile \u9700\u8981 escape ${} \u7684\u95EE\u9898","source":"@site/../notes/dev/build/just.md","sourceDirName":"dev/build","slug":"/dev/build/just","permalink":"/notes/dev/build/just","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/dev/build/just.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1759516997000,"frontMatter":{"title":"just"},"sidebar":"docs","previous":{"title":"earthly","permalink":"/notes/dev/build/earthly"},"next":{"title":"LLVM IR","permalink":"/notes/dev/build/llvm"}}'),l=s(86106),t=s(17776);let r={title:"just"},d="just",c={},o=[{value:"justfile",id:"justfile",level:2}];function j(n){let e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"just",children:"just"})}),"\n",(0,l.jsx)(e.admonition,{type:"caution",children:(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["just \u80FD\u89E3\u51B3 Makefile \u9700\u8981 escape ",(0,l.jsx)(e.code,{children:"${}"})," \u7684\u95EE\u9898"]}),"\n",(0,l.jsxs)(e.li,{children:["just \u9700\u8981\u5904\u7406 ",(0,l.jsx)(e.code,{children:"{{"}),",",(0,l.jsx)(e.code,{children:"}}"})," \u7684 escape \u95EE\u9898 -> ",(0,l.jsx)(e.code,{children:"{{{{}}}}"})]}),"\n"]})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"https://github.com/casey/just",children:"casey/just"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"CC0-1.0, Rust"}),"\n",(0,l.jsxs)(e.li,{children:["command runner, ",(0,l.jsx)(e.strong,{children:"\u4E0D\u662F"})," \u6784\u5EFA\u5DE5\u5177\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u4E0D\u9700\u8981 make \u7684 .PHONY"}),"\n",(0,l.jsx)(e.li,{children:"\u4E0D\u9700\u8981 \u6587\u4EF6\u4F9D\u8D56\u7BA1\u7406"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:"\u80FD\u63A5\u6536 \u547D\u4EE4\u884C\u53C2\u6570"}),"\n",(0,l.jsx)(e.li,{children:"\u4F1A\u52A0\u8F7D .env"}),"\n",(0,l.jsx)(e.li,{children:"\u652F\u6301\u81EA\u5B9A\u4E49\u8BED\u8A00\u7684 \u4EFB\u52A1\u8FD0\u884C"}),"\n",(0,l.jsx)(e.li,{children:"\u80FD\u591F\u4ECE\u5B50\u76EE\u5F55\u6267\u884C"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["Jetbrains ",(0,l.jsx)(e.a,{href:"https://plugins.jetbrains.com/plugin/18658-just",children:"Just"})," \u63D2\u4EF6"]}),"\n",(0,l.jsxs)(e.li,{children:["VSC ",(0,l.jsx)(e.a,{href:"https://marketplace.visualstudio.com/items?itemName=nefrob.vscode-just-syntax",children:"Just"})," \u63D2\u4EF6\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.a,{href:"https://github.com/nefrob/vscode-just",children:"nefrob/vscode-just"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"brew install just # macOS brew\napk add just      # AlpineLinux\n\njust --list\njust --list PATH # PATH \u652F\u6301 :: \u5206\u5272\u591A\u4E2A\njust --summary   # \u7A7A\u683C\u5206\u5272\u7684\u6240\u6709 target\n\njust os=bsd # \u4FEE\u6539\u53D8\u91CF\njust --set os bsd\n\njust --choose # \u9009\u62E9 target - \u4F9D\u8D56 fzf\n# \u8C03\u7528\u5176\u4ED6\u76EE\u5F55\n(cd foo && just build)\njust foo/build\njust foo/\n\njust bar::b # \u641C\u7D22 foo.just, foo/mod.just, foo/justfile, foo/.justfile\n\njust --fmt --check --unstable\njust --dump                                                  # --dump-format json\njust --timestamp recipe --timestamp-format '%H:%M:%S%.3f %Z' # strftime\n"})}),"\n",(0,l.jsx)(e.h2,{id:"justfile",children:"justfile"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"justfile, .justfile"}),"\n",(0,l.jsxs)(e.li,{children:["global - ",(0,l.jsx)(e.code,{children:"just --global-justfile"}),", ",(0,l.jsx)(e.code,{children:"just -g"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"$XDG_CONFIG_HOME/just/justfile"}),"\n",(0,l.jsx)(e.li,{children:"$HOME/.config/just/justfile"}),"\n",(0,l.jsx)(e.li,{children:"$HOME/justfile"}),"\n",(0,l.jsx)(e.li,{children:"$HOME/.justfile"}),"\n"]}),"\n"]}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"opt"}),(0,l.jsx)(e.th,{children:"for"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"quite"}),(0,l.jsx)(e.td,{children:"\u9759\u9ED8\u6A21\u5F0F"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"fallback"}),(0,l.jsx)(e.td,{children:"\u5982\u679C recipe \u4E0D\u5B58\u5728\uFF0C\u5C1D\u8BD5\u5411\u4E0A\u627E justfile"})]})]})]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-justfile",children:'mod bar # \u5B9A\u4E49\u6A21\u5757\u540D\u5B57 - \u4F5C\u4E3A\u5B50\u547D\u4EE4\u8FD0\u884C just bar b\nmod foo \'PATH\' # \u4ECE\u7ED9\u5B9A\u7684 path \u52A0\u8F7D\u6A21\u5757 mod.just, justfile, .justfile\nmod? foo\n\n# \u5F15\u5165\u5176\u4ED6 justfile\nimport \'foo/bar.just\'\nimport? \'foo/bar.just\'\n\n# for Node.js\nexport PATH := "./node_modules/.bin:" + env_var(\'PATH\')\n\n# \u542F\u7528 unstable \u7279\u6027\n# JUST_UNSTABLE\n# \u4F8B\u5982 [script(COMMAND)]\nset unstable\n\n# \u4FEE\u6539\u9ED8\u8BA4\u5DE5\u4F5C\u76EE\u5F55\nset working-directory := \'bar\'\n\nalias b := build # \u8BBE\u7F6E\u522B\u540D\n\nset shell := ["bash", "-uc"]\nset shell := ["zsh", "-cu"] # \u4FEE\u6539 shell\n\n[private]\ndefault:\n  @just --list --justfile {{justfile()}}\n\n# \u6CE8\u91CA\njs:\n  #!/usr/bin/env node\n  console.log(\'Greetings from JavaScript!\')\n\n# \u8FD9\u79CD\u65B9\u5F0F\u4E5F\u4FDD\u8BC1\u6240\u6709\u90FD\u5728\u4E00\u4E2A shell \u8FD0\u884C\u800C\u4E0D\u662F\u4E00\u884C\u4E00\u4E2A shell\nsh:\n  #!/usr/bin/env sh\n  hello=\'Yo\'\n  echo "$hello from a shell script!"\n\n# \u9ED8\u8BA4\u6587\u6863\u5185\u5BB9\n[doc(\'Say hello to someone.\')]\nhello name:\n  @echo "Hello, {{name}}!"\n\n[no-cd] # \u907F\u514D cd \u5230 justfile \u6240\u5728\u76EE\u5F55\nbuild name:\n  @echo "Building {{name}}..."\n\n# \u4F1A\u8BFB\u53D6 TEST_NAME \u73AF\u5883\u53D8\u91CF\ntest $TEST_NAME="1":\n\n# \u4F9D\u8D56\u53EF\u4EE5\u5E26\u53C2\u6570\nxbuild: (build "main")\n# \u900F\u4F20\u53C2\u6570\uFF0C\u9ED8\u8BA4\u53C2\u6570\npush target=xyz: (build target)\n# \u590D\u6742\u9ED8\u8BA4\u53C2\u6570\ntest triple=(arch + "-unknown-unknown") input=(arch / "input.dat"):\n\n# varidic \u53C2\u6570 / \u53EF\u53D8\u53C2\u6570\nbackup +FILES:\nbackup *FILES:\n\n[working-directory: \'bar\'] # \u9488\u5BF9\u547D\u4EE4\u4FEE\u6539\u5DE5\u4F5C\u76EE\u5F55\n@bar:\n\n# \u6267\u884C\u987A\u5E8F\u662F a b c d\nb: a && c d\n\n[no-exit-message]\ngit *args:\n    @git {{args}}\n'})}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["recipe\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["private\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u4EE5 ",(0,l.jsx)(e.code,{children:"_"})," \u5F00\u5934\u4E3A private"]}),"\n",(0,l.jsxs)(e.li,{children:["\u8005\u4F7F\u7528 ",(0,l.jsx)(e.code,{children:"[private]"})," \u6807\u8BB0\u4E3A private"]}),"\n",(0,l.jsx)(e.li,{children:"\u4E0D\u4F1A\u5728 list \u663E\u793A"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["quite\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"set quiet"})}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"[no-quiet]"})," \u53D6\u6D88 quite"]}),"\n",(0,l.jsx)(e.li,{children:(0,l.jsx)(e.code,{children:"@line"})}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"@recipe:"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u9ED8\u8BA4 quiet,"}),"\n",(0,l.jsxs)(e.li,{children:["\u5728\u884C\u9996\u52A0 ",(0,l.jsx)(e.code,{children:"@"})," \u53D6\u6D88 quiet"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:"Shebang recipes \u9ED8\u8BA4 quite"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u5185\u7F6E\u51FD\u6570\u522B\u540D\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"_directory"})," -> ",(0,l.jsx)(e.code,{children:"_dir"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.code,{children:"home_directory()"})," -> ``home_dir()`"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u5185\u7F6E\u51FD\u6570\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"arch, num_cpus, os, os_family"}),"\n",(0,l.jsx)(e.li,{children:"shell"}),"\n",(0,l.jsx)(e.li,{children:"env(key) / env_var(key), env(key, default) / env_var_or_default(key, default)"}),"\n",(0,l.jsx)(e.li,{children:"is_dependency() - \u5F53\u524D recipe \u4F5C\u4E3A\u4F9D\u8D56 \u8FD0\u884C"}),"\n",(0,l.jsx)(e.li,{children:"invocation_directory(), invocation_directory_native()"}),"\n",(0,l.jsx)(e.li,{children:"justfile(), justfile_directory()"}),"\n",(0,l.jsx)(e.li,{children:"source_file(), source_directory()"}),"\n",(0,l.jsx)(e.li,{children:"just_executable()"}),"\n",(0,l.jsx)(e.li,{children:"just_pid()"}),"\n",(0,l.jsx)(e.li,{children:"error"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.li,{children:"\u5B57\u7B26\u4E32\u51FD\u6570\u3001 case \u8F6C\u6362\u51FD\u6570\u3001\u8DEF\u5F84\u51FD\u6570\u3001\u968F\u673A\u3001hash\u3001\u65E5\u671F\u3001\u7248\u672C\u53F7\u3001 XDG \u76EE\u5F55"}),"\n",(0,l.jsx)(e.li,{children:"console \u989C\u8272\u5E38\u91CF"}),"\n",(0,l.jsxs)(e.li,{children:["recipe \u5C5E\u6027\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"confirm, doc, extension, group, no-cd, no-exit-message, no-quiet, private, script"}),"\n",(0,l.jsx)(e.li,{children:"working-directory"}),"\n",(0,l.jsx)(e.li,{children:"positional-arguments"}),"\n",(0,l.jsx)(e.li,{children:"linux, macos, unix, windows, openbsd"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\u8BED\u6CD5\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"if/else"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",children:"# \u786E\u4FDD\u662F\u5355\u4E2A\u547D\u4EE4 - \u4EE5\u514D\u628A serve \u5F53\u6210\u53C2\u6570\njust --one build serve\n"})})]})}function u(n={}){let{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(j,{...n})}):j(n)}},17776:function(n,e,s){s.d(e,{R:()=>r,x:()=>d});var i=s(7378);let l={},t=i.createContext(l);function r(n){let e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:r(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);