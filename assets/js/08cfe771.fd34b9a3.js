"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["22241"],{21846:function(n,r,e){e.r(r),e.d(r,{frontMatter:()=>c,toc:()=>p,default:()=>m,metadata:()=>s,assets:()=>l,contentTitle:()=>o});var s=JSON.parse('{"id":"web/nodejs/npm","title":"NPM - Registry","description":"- npm download size","source":"@site/../notes/web/nodejs/npm.md","sourceDirName":"web/nodejs","slug":"/web/nodejs/npm","permalink":"/notes/web/nodejs/npm","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/nodejs/npm.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1717644328000,"frontMatter":{"title":"NPM - Registry"},"sidebar":"docs","previous":{"title":"NPM Version","permalink":"/notes/web/nodejs/npm-version"},"next":{"title":"npmrc","permalink":"/notes/web/nodejs/npmrc"}}'),i=e(86106),t=e(17776);let c={title:"NPM - Registry"},o="NPM",l={},p=[{value:".npmrc",id:"npmrc",level:2},{value:"registry",id:"registry",level:2},{value:"scope",id:"scope",level:2},{value:"workspaces",id:"workspaces",level:2},{value:"corepack",id:"corepack",level:2},{value:"Package",id:"package",level:2},{value:"Registry",id:"registry-1",level:2}];function d(n){let r={a:"a",admonition:"admonition",code:"code",del:"del",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"npm",children:"NPM"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://arve0.github.io/npm-download-size/",children:"npm download size"})}),"\n",(0,i.jsxs)(r.li,{children:["cache\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"$HOME/.npm"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"%AppData%/npm-cache"})}),"\n",(0,i.jsx)(r.li,{children:"--cache"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://www.runpkg.com/",children:"https://www.runpkg.com/"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://deps.dev/",children:"https://deps.dev/"})}),"\n"]}),"\n",(0,i.jsx)(r.admonition,{type:"tip",children:(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["NODE_ENV=production \u6216 --production \u65F6 npm ci/install \u4E0D\u4F1A\u5B89\u88C5\u5F00\u53D1\u4F9D\u8D56\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"npm ci --include=dev"})," \u5F3A\u5236\u5B89\u88C5 dev"]}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",metastring:'title="\u5EFA\u8BAE\u9650\u5B9A\u7248\u672C"',children:'{\n  "engines": {\n    "node": "14",\n    "npm": "8"\n  }\n}\n'})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"du -hs ~/.npm/_cacache/ # \u67E5\u770B\u672C\u5730\u7F13\u5B58\u5927\u5C0F\nnpm config get prefix   # bin \u76EE\u5F55\nnpm list -g --depth=0   # \u5168\u5C40\u6A21\u5757 - \u7B2C\u4E00\u884C\u4E3A\u76EE\u5F55\uFF0C\u4F8B\u5982 /usr/local/lib\nnpm root -g\n\nexport NODE_PATH=$(npm root -g) # \u80FD import \u5168\u5C40\u7684\u5305\nnode -p process.config.variables.node_prefix\n"})}),"\n",(0,i.jsx)(r.h2,{id:"npmrc",children:".npmrc"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"~/.npmrc"}),"\n",(0,i.jsx)(r.li,{children:"/etc/npmrc"}),"\n",(0,i.jsx)(r.li,{children:"/usr/lib/node_modules/npm/npmrc"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ini",children:"# \u6709\u65F6\u5019\u955C\u50CF\u4E0D\u5339\u914D\n# registry=https://registry.npmmirror.com/\n# \u901F\u5EA6\u8FD8\u884C\nregistry=https://registry.npmjs.org\n\ndisturl=https://npmmirror.com/mirrors/node/\nsharp_binary_host=https://npmmirror.com/mirrors/sharp/\nsharp_libvips_binary_host=https://npmmirror.com/mirrors/sharp-libvips/\nnode_sqlite3_binary_host_mirror=https://npmmirror.com/mirrors/sqlite3/\nbetter-sqlite3_binary_host=https://npmmirror.com/mirrors/sharp-libvips/\n"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-ini",children:'# \u4E0D\u63A8\u8350 - \u7ECF\u5E38\u51FA\u73B0\u56E0\u4E3A\u955C\u50CF\u95EE\u9898\u6784\u5EFA\u5931\u8D25\n#registry="https://registry.npmmirror.com"\ndisturl=https://npmmirror.com/mirrors/node\nchromedriver_cdnurl=https://npmmirror.com/mirrors/chromedriver\nelectron_mirror=https://npmmirror.com/mirrors/electron/\nfse_binary_host_mirror=https://npmmirror.com/mirrors/fsevents\nnode_inspector_cdnurl=https://npmmirror.com/mirrors/node-inspector\nnodejs_org_mirror=https://npmmirror.com/mirrors/node\nnvm_nodejs_org_mirror=https://npmmirror.com/mirrors/node\noperadriver_cdnurl=https://npmmirror.com/mirrors/operadriver\nphantomjs_cdnurl=https://npmmirror.com/mirrors/phantomjs\nprofiler_binary_host_mirror=https://npmmirror.com/mirrors/node-inspector/\npuppeteer_download_host=https://npmmirror.com/mirrors/\nsass_binary_site=https://npmmirror.com/mirrors/node-sass\nselenium_cdnurl=https://npmmirror.com/mirrors/selenium\nSQLITE3_BINARY_SITE=https://npmmirror.com/mirrors/sqlite3\nsharp_binary_host=https://npmmirror.com/mirrors/sharp\nsharp_libvips_binary_host=https://npmmirror.com/mirrors/sharp-libvips\ncanvas_binary_host=https://npmmirror.com/mirrors/node-canvas-prebuilt/\n'})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# _binary_host_mirror\n# npm view sqlite3 binary.module_name\nnode_sqlite3_binary_host_mirror=https://npmmirror.com/mirrors/sqlite3\n"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["disturl\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["gyp \u4E0B\u8F7D\u6784\u5EFA\u4F9D\u8D56 ",(0,i.jsx)(r.a,{href:"https://nodejs.org/download/release/v16.16.0/node-v16.16.0-headers.tar.gz",children:"https://nodejs.org/download/release/v16.16.0/node-v16.16.0-headers.tar.gz"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://registry.npmmirror.com/binary.html",children:"https://registry.npmmirror.com/binary.html"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://docs.npmjs.com/cli/v6/configuring-npm/npmrc",children:"https://docs.npmjs.com/cli/v6/configuring-npm/npmrc"})}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"registry",children:"registry"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"url"}),(0,i.jsx)(r.th,{children:"from"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.a,{href:"https://registry.npmjs.org",children:"https://registry.npmjs.org"})}),(0,i.jsx)(r.td,{children:"\u5B98\u65B9"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.a,{href:"https://mirrors.sjtug.sjtu.edu.cn/npm-registry",children:"https://mirrors.sjtug.sjtu.edu.cn/npm-registry"})}),(0,i.jsx)(r.td,{children:"\u4E0A\u6D77\u4EA4\u5927"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.a,{href:"https://registry.npmmirror.com",children:"https://registry.npmmirror.com"})}),(0,i.jsx)(r.td,{children:"\u6DD8\u5B9D"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.del,{children:(0,i.jsx)(r.a,{href:"https://r.cnpmjs.org",children:"https://r.cnpmjs.org"})})}),(0,i.jsx)(r.td,{})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.del,{children:(0,i.jsx)(r.a,{href:"https://registry.npm.taobao.org",children:"https://registry.npm.taobao.org"})})}),(0,i.jsx)(r.td,{children:"\u6DD8\u5B9D"})]})]})]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["npmmirror\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.a,{href:"https://registry.npmmirror.com/binary.html",children:"https://registry.npmmirror.com/binary.html"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"\u955C\u50CF\u7684\u4E00\u4E9B\u4E8C\u8FDB\u5236"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\u89E6\u53D1\u540C\u6B65\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://npmmirror.com/sync/ohm-grammar-miniquery",children:"https://npmmirror.com/sync/ohm-grammar-miniquery"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://npmmirror.com/sync/@wener/reaction",children:"https://npmmirror.com/sync/@wener/reaction"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# \u539F\u59CB\nnpm_config_registry=https://registry.npmjs.org\nnpm i --registry=https://registry.npmjs.org\n\n# \u6DD8\u5B9D\u955C\u50CF\nnpm i --registry=https://registry.npm.taobao.org\n# \u4E0A\u6D77\u4EA4\u5927\u955C\u50CF\nnpm ci --registry=https://mirrors.sjtug.sjtu.edu.cn/npm-registry\n# npx \u4F7F\u7528\u955C\u50CF\nnpm_config_registry=https://registry.npm.taobao.org npx @scoped/package\n#\nnpx --registry=https://registry.npmjs.org -y cubejs-cli create demo-cube -d postgres\n\n# musl \u624B\u52A8\u5B89\u88C5 sharp\n# \u6709\u53EF\u80FD\u6700\u65B0\u7248\u7684 libvips \u65E0\u955C\u50CF\uFF0C\u56E0\u6B64\u6CE8\u610F\u7248\u672C\u9009\u62E9\n# libvips v8.13.1 \u65E0\u955C\u50CF\n# https://registry.npmmirror.com/binary.html?path=sharp-libvips/v8.13.1/\nnpm install --verbose --platform=linux --libc=musl sharp@^0.30\n"})}),"\n",(0,i.jsx)(r.h2,{id:"scope",children:"scope"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://docs.npmjs.com/getting-started/scoped-packages",children:"https://docs.npmjs.com/getting-started/scoped-packages"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://docs.npmjs.com/private-modules/intro",children:"https://docs.npmjs.com/private-modules/intro"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://docs.npmjs.com/misc/scope",children:"https://docs.npmjs.com/misc/scope"})}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# \u6DFB\u52A0\u4E00\u4E2A scope\nnpm login --registry=https://reg.wener.me/nexus/repository/npm-internal/ --scope=@wener\n# \u6DFB\u52A0\u540E\u53EF\u4FEE\u6539\u5173\u8054\u7684\u4ED3\u5E93\nnpm config set @wener:registry https://reg.wener.me/nexus/repository/npm-internal/\n# \u521D\u59CB\u5316\u65F6\u53EF\u4EE5\u4F7F\u7528\u6307\u5B9A\u7684 scope, \u5305\u540D\u4E2D\u4F1A\u52A0\u4E0A  @wener\nnpm init --scope=wener\n# \u53D1\u5E03\u662F\u4F1A\u53D1\u5F80 @wener \u7684\u4ED3\u5E93\u4E2D\nnpm publish\n# \u5B89\u88C5\u6307\u5B9A scope \u4E2D\u7684\u6A21\u5757\nnpm install @wener/wener-test\n# \u53EF\u4EE5\u8BBE\u7F6E\u5F53\u524D\u7684\u5168\u5C40 scope\nnpm config set scope wener\n"})}),"\n",(0,i.jsx)(r.h2,{id:"workspaces",children:"workspaces"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://github.com/npm/rfcs/blob/latest/implemented/0026-workspaces.md",children:"npm workspaces"})}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",children:'{\n  "name": "workspace-example",\n  "version": "1.0.0",\n  // \u4E24\u79CD\u683C\u5F0F\n  "workspaces": ["packages/*"],\n  "workspaces": {\n    "packages": ["packages/*"]\n  }\n}\n'})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"npm ls\n# \u6DFB\u52A0\u4F9D\u8D56\u5230 workspace\nnpm add -w @wener/apis-weaver systemjs\n# \u4F9D\u8D56\u53E6\u5916\u4E00\u4E2A workspace - \u4E0D\u80FD\u5728 module add - \u4F1A\u62A5\u627E\u4E0D\u5230\nnpm add -w @wener/apis-weaver @wener/apis-core\n# npx \u5728 ws \u4E0B\u6267\u884C\nnpx -w @wener/apis-weaver typesync\n# run \u5728 ws \u4E0B\u6267\u884C - \u6CE8\u610F path.resolve \u8FD8\u662F\u57FA\u4E8E ws \u8DEF\u5F84\u800C\u4E0D\u662F\u5F53\u524D\u8DEF\u5F84\nnpm run -w @wener/apis-weaver build\n"})}),"\n",(0,i.jsx)(r.h2,{id:"corepack",children:"corepack"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"corepack enable\n"})}),"\n",(0,i.jsx)(r.h2,{id:"package",children:"Package"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-json",metastring:'title="package.json"',children:'{\n  // cjs\n  "main": "./main.js",\n  // esm\n  "module": "./index.js",\n  "types": "./index.d.ts",\n  "unpkg": "./umd/react-router-dom.production.min.js",\n\n  // \u591A\u4E2A entry - \u8BBF\u95EE\u9664\u6B64\u4E4B\u5916\u7684\u4F1A\u88AB\u62D2\u7EDD\n  "exports": {\n    ".": {\n      "require": "./index.cjs",\n      "import": "./index.mjs",\n      "default": "./index.js"\n    },\n    "./package.json": "./package.json",\n    "./extra": "./jsx-runtime.cjs"\n  },\n\n  // \u662F\u5426\u6709\u5168\u5C40\u64CD\u4F5C\n  "sideEffects": false\n}\n'})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-js",metastring:'title="main.js"',children:"'use strict';\n\n/* eslint-env node */\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./umd/react-router-dom.production.min.js');\n} else {\n  module.exports = require('./umd/react-router-dom.development.js');\n}\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["Pure ESM package\n",(0,i.jsx)(r.a,{href:"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c",children:"https://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c"})]}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"registry-1",children:"Registry"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"curl -sfL 'https://registry.npmmirror.com/@wener/reaction' | jq -r '.\"dist-tags\".latest'\ncurl -sfL 'https://registry.npmmirror.com/@wener/reaction/latest' | jq -r '.version'\n"})}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:["\u5143\u6570\u636E\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"GET /"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"GET /-/all"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"GET /-/"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:["\u5305\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"GET /{package}"})}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"GET /{package}/{version}"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"version \u53EF\u4EE5\u662F latest"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"GET /-/v1/search"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"text, size, from, quality, popularity, maintenance"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://github.com/npm/registry/blob/master/docs/REGISTRY-API.md",children:"https://github.com/npm/registry/blob/master/docs/REGISTRY-API.md"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.a,{href:"https://github.com/npm/registry/blob/master/docs/user/authentication.md",children:"https://github.com/npm/registry/blob/master/docs/user/authentication.md"})}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'# basic \u652F\u6301\u8BBF\u95EE private \u5185\u5BB9\ncurl -u username:password https://registry.npmjs.org/@org/pkg\n\ncurl -u user:pass https://registry.npmjs.org/-/npm/v1/tokens\ncurl -u user:pass -X POST \\\n  --json \'{"password":"","readonly":true}\' \\\n  https://registry.npmjs.org/-/npm/v1/tokens\n'})})]})}function m(n={}){let{wrapper:r}={...(0,t.R)(),...n.components};return r?(0,i.jsx)(r,{...n,children:(0,i.jsx)(d,{...n})}):d(n)}},17776:function(n,r,e){e.d(r,{R:()=>c,x:()=>o});var s=e(7378);let i={},t=s.createContext(i);function c(n){let r=s.useContext(t);return s.useMemo(function(){return"function"==typeof n?n(r):{...r,...n}},[r,n])}function o(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:c(n.components),s.createElement(t.Provider,{value:r},n.children)}}}]);