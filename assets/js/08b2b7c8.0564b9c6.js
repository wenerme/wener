"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["2996"],{89016:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>c,toc:()=>o,default:()=>E,metadata:()=>r,assets:()=>t,contentTitle:()=>a});var r=JSON.parse('{"id":"service/data/crawler/archivebox","title":"archivebox","description":"- ArchiveBox/ArchiveBox","source":"@site/../notes/service/data/crawler/archivebox.md","sourceDirName":"service/data/crawler","slug":"/service/data/crawler/archivebox","permalink":"/notes/service/data/crawler/archivebox","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/data/crawler/archivebox.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1629271390000,"frontMatter":{"title":"archivebox"},"sidebar":"docs","previous":{"title":"Cralwer","permalink":"/notes/service/data/crawler/"},"next":{"title":"crawl4ai","permalink":"/notes/service/data/crawler/crawl4ai"}}'),s=i(86106),l=i(17776);let c={title:"archivebox"},a="archivebox",t={},o=[{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:2},{value:"\u6570\u636E\u7ED3\u6784",id:"\u6570\u636E\u7ED3\u6784",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"archivebox",children:"archivebox"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/ArchiveBox/ArchiveBox",children:"ArchiveBox/ArchiveBox"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"MIT, Python"}),"\n",(0,s.jsx)(n.li,{children:"\u9488\u5BF9\u552F\u4E00 URL \u552F\u4E00\u63D0\u53D6\u7C7B\u578B \u8FDB\u884C Archive"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528 chromium/chrome \u751F\u6210 \u622A\u5C4F\u3001PDF\u3001DOM HTML\u3001headless JS"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528 node & npm \u751F\u6210 Readability, Mercury, SingleFile"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528 wget \u751F\u6210 \u7EAF HTML, \u9759\u6001\u6587\u4EF6, WARC"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528 curl \u83B7\u53D6 \u5934\u3001favicon\u3001\u8BF7\u6C42 archibe.org"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528 youtube-dl \u5904\u7406\u89C6\u9891\u3001\u97F3\u9891\u3001\u5B57\u5E55"}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528 git \u514B\u9686\u4ED3\u5E93"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u8F93\u51FA\u683C\u5F0F\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Chrome SingleFile\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/gildas-lormeau/SingleFile",children:"https://github.com/gildas-lormeau/SingleFile"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Chrome PDF"}),"\n",(0,s.jsx)(n.li,{children:"Chrome Screenshot"}),"\n",(0,s.jsx)(n.li,{children:"Wget HTML"}),"\n",(0,s.jsx)(n.li,{children:"Archive.org"}),"\n",(0,s.jsx)(n.li,{children:"Original"}),"\n",(0,s.jsx)(n.li,{children:"Headers"}),"\n",(0,s.jsx)(n.li,{children:"Chrome HTML"}),"\n",(0,s.jsxs)(n.li,{children:["Readability\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/mozilla/readability",children:"https://github.com/mozilla/readability"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Mercury"}),"\n",(0,s.jsx)(n.li,{children:"Media"}),"\n",(0,s.jsx)(n.li,{children:"Git"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://raw.githubusercontent.com/ArchiveBox/ArchiveBox/master/docker-compose.yml",children:"ArchiveBox/ArchiveBox/docker-compose.yml"})}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u76F4\u63A5\u9884\u89C8\u4F1A\u6267\u884C JS - \u53EF\u80FD\u5BFC\u81F4\u4FE1\u606F\u6CC4\u6F0F\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53EA\u6709 wget \u4F1A\u63D0\u53D6 js\uFF0C\u53EF\u4EE5\u5173\u95ED\u96C6\u6210"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u907F\u514D\u4F7F\u7528 EXT3/FAT \u4E4B\u7C7B\u7684 FS - \u5BF9\u5355\u76EE\u5F55\u6709 50k \u7684\u9650\u5236"}),"\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301\u6293\u5168\u7AD9 - \u76EE\u524D depth=0/1 ",(0,s.jsx)(n.a,{href:"https://github.com/ArchiveBox/ArchiveBox/issues/191",children:"ArchiveBox/ArchiveBox#191"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4E0D\u652F\u6301\u5355 URL \u591A\u5FEB\u7167 ",(0,s.jsx)(n.a,{href:"https://github.com/ArchiveBox/ArchiveBox/issues/179",children:"#179"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u76EE\u524D\u901A\u8FC7\u6DFB\u52A0 Hash \u5B9E\u73B0\u91CD\u5199\u5FEB\u7167"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u6CA1\u6709 rest \u63A5\u53E3 ",(0,s.jsx)(n.a,{href:"https://github.com/ArchiveBox/ArchiveBox/issues/496",children:"#496"})]}),"\n"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --rm -it \\\n  -v $PWD/archivebox:/data -p 8000:8000 \\\n  --name archivebox archivebox/archivebox\n# \u521B\u5EFA\u7BA1\u7406\u5458\u8D26\u53F7\ndocker exec -it -u archivebox archivebox archivebox manage createsuperuser\n\n# \u547D\u4EE4\u884C\u64CD\u4F5C\n# \u7BA1\u7406\u96C6\u5408 archivebox setup/init/config/status/manage\n# \u7BA1\u7406\u5FEB\u7167 archivebox add/schedule/remove/update/list/shell/oneshot\n# archivebox schedule\n\narchivebox server 0.0.0.0:8000          # \u542F\u52A8 Web\narchivebox add 'https://example.com'    # \u6DFB\u52A0\u5F52\u6863\narchivebox list 'https://example.com'   # \u67E5\u770B\narchivebox add 'https://example.com#2020-10-24' # \u4FDD\u5B58\u591A\u4EFD\u5FEB\u7167\n\narchivebox schedule --every=day --depth=1 https://example.com/rss.xml\n\n# \u5BFC\u51FA\u7D22\u5F15\narchivebox list --html --with-headers > index.html\narchivebox list --json --with-headers > index.json\narchivebox list --csv=timestamp,url,title > index.csv\n\n# --parser auto,pocket_api,wallabag_atom,pocket_html,pinboard_rss,shaarli_rss,medium_rss,netscape_html,rss,json,html,txt,url_list\n# --extract title,favicon,headers,singlefile,pdf,screenshot,dom,wget,readability,mercury,git,media,archive_org\n# --depth 0,1\n# --update-all \u540C\u65F6\u6267\u884C update\n# --tags\n# --index-only \u53EA\u6DFB\u52A0\u5230 index \u4E0D\u6267\u884C\n# --overwrite \u4ECE\u65B0\u5F52\u6863\narchivebox add\n\n# \u66F4\u65B0\u5355\u4E2A\narchivebox update -t timestamp 1629214695.204162\n# \u66F4\u65B0\u6240\u6709 pending\n# \u91CD\u542F archivebox \u540E\u9700\u8981\u6267\u884C\narchivebox update\n# \u4ECE\u67D0\u4E2A\u65F6\u95F4\u70B9\u5F00\u59CB\narchivebox update --resume 1629218154.996784\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/ArchiveBox/ArchiveBox/blob/master/archivebox/config.py",children:"archivebox/config.py"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/ArchiveBox/ArchiveBox/wiki/Configuration",children:"Configuration"})}),"\n",(0,s.jsx)(n.li,{children:"ArchiveBox.conf"}),"\n",(0,s.jsx)(n.li,{children:"\u914D\u7F6E\u4F18\u5148\u7EA7 - cli flag, env, config file, defaults"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"archivebox config --set MEDIA_TIMEOUT=600\nenv MEDIA_TIMEOUT=600 USE_COLOR=False archivebox server\n\n# \u907F\u514D\u89E6\u53D1 archive.org \u4FDD\u5B58\narchivebox config --set SAVE_ARCHIVE_DOT_ORG=False\n# \u907F\u514D\u5916\u90E8\u8BBF\u95EE\narchivebox config --set PUBLIC_INDEX=False\narchivebox config --set PUBLIC_SNAPSHOTS=False\narchivebox config --set PUBLIC_ADD_VIEW=False\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[SHELL_CONFIG]\nIS_TTY                   =#lambda _: sys.stdout.isatty()\nUSE_COLOR                =#lambda c: c['IS_TTY']\nSHOW_PROGRESS            =#lambda c: (c['IS_TTY'] and platform.system() != 'Darwin') # progress bars are buggy on mac\nIN_DOCKER                =False\n# TODO: SHOW_HINTS      =True\n\n[GENERAL_CONFIG]\nOUTPUT_DIR               =None\nCONFIG_FILE              =None\nONLY_NEW                 =True\nTIMEOUT                  =60\nMEDIA_TIMEOUT            =3600\nOUTPUT_PERMISSIONS       ='755'\nRESTRICT_FILE_NAMES      ='windows'\nURL_BLACKLIST            =r'\\.(css|js|otf|ttf|woff|woff2|gstatic\\.com|googleapis\\.com/css)(\\?.*)?$'  # to avoid downloading code assets as their own pages\n\n[SERVER_CONFIG]\n# SECRET_KEY =\nSECRET_KEY               =\nBIND_ADDR                =# lambda c: ['127.0.0.1:8000', '0.0.0.0:8000'][c['IN_DOCKER']]\nALLOWED_HOSTS            ='*'\nDEBUG                    =False\nPUBLIC_INDEX             =True\nPUBLIC_SNAPSHOTS         =True\nPUBLIC_ADD_VIEW          =False\nFOOTER_INFO              ='Content is hosted for personal archiving purposes only.  Contact server owner for any takedown requests.'\nSNAPSHOTS_PER_PAGE       =40\nCUSTOM_TEMPLATES_DIR     =\nTIME_ZONE                ='UTC'\n\n\n[ARCHIVE_METHOD_TOGGLES]\nSAVE_TITLE               =True\n# \u4F9D\u8D56 Google \u670D\u52A1 https://www.google.com/s2/favicons?domain={domain}\nSAVE_FAVICON             =True\nSAVE_WGET                =True\n# images/css/js\nSAVE_WGET_REQUISITES     =True\n# \u4ECE\u5DF2\u7ECF\u4E0B\u8F7D\u7684\u5185\u5BB9\u63D0\u53D6\u6587\u672C\n# https://github.com/mozilla/readability\nSAVE_READABILITY         =True\n# \u529F\u80FD\u540C READABILITY\n# https://github.com/postlight/mercury-parser\nSAVE_MERCURY             =True\n\nSAVE_HEADERS             =True\nSAVE_WARC                =True\nSAVE_GIT                 =True\n# youtube-dl \u4E0B\u8F7D\u89C6\u9891\u97F3\u9891\nSAVE_MEDIA               =True\n# \u63D0\u4EA4\u5230 Archive.org\nSAVE_ARCHIVE_DOT_ORG     =True\n# \u4F9D\u8D56 Chrome\n# https://github.com/gildas-lormeau/SingleFile\nSAVE_SINGLEFILE          =True\nSAVE_PDF                 =True\nSAVE_SCREENSHOT          =True\n# dump DOM\nSAVE_DOM                 =True\n\n[ARCHIVE_METHOD_OPTIONS]\nRESOLUTION               ='1440,2000'\nGIT_DOMAINS              ='github.com,bitbucket.org,gitlab.com,gist.github.com'\nCHECK_SSL_VALIDITY       =True\nMEDIA_MAX_SIZE           ='750m'\nCURL_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36 ArchiveBox/{VERSION} (+https://github.com/ArchiveBox/ArchiveBox/) curl/{CURL_VERSION}'\nWGET_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36 ArchiveBox/{VERSION} (+https://github.com/ArchiveBox/ArchiveBox/) wget/{WGET_VERSION}'\nCHROME_USER_AGENT        ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36 ArchiveBox/{VERSION} (+https://github.com/ArchiveBox/ArchiveBox/)'\nCOOKIES_FILE             =None\nCHROME_USER_DATA_DIR     =None\nCHROME_HEADLESS          =True\nCHROME_SANDBOX           = # lambda c: not c['IN_DOCKER']\n\nYOUTUBEDL_ARGS           =\nWGET_ARGS           =\nCURL_ARGS           =\nGIT_ARGS           =\n\n\n[SEARCH_BACKEND_CONFIG]\nUSE_INDEXING_BACKEND     =True\nUSE_SEARCHING_BACKEND    =True\n#\nSEARCH_BACKEND_ENGINE    ='ripgrep'\nSEARCH_BACKEND_HOST_NAME ='localhost'\nSEARCH_BACKEND_PORT      =1491\nSEARCH_BACKEND_PASSWORD  ='SecretPassword'\n# sonic\n# SEARCH_BACKEND_ENGINE=sonic\n# SEARCH_BACKEND_HOST_NAME=sonic\n# SEARCH_BACKEND_PASSWORD=SecretPassword\nSONIC_COLLECTION         ='archivebox'\nSONIC_BUCKET             ='snapshots'\nSEARCH_BACKEND_TIMEOUT   =90\n\n[DEPENDENCY_CONFIG]\nUSE_CURL                 =True\nUSE_WGET                 =True\nUSE_SINGLEFILE           =True\nUSE_READABILITY          =True\nUSE_MERCURY              =True\nUSE_GIT                  =True\nUSE_CHROME               =True\nUSE_NODE                 =True\nUSE_YOUTUBEDL            =True\nUSE_RIPGREP              =True\nCURL_BINARY              ='curl'\nGIT_BINARY               ='git'\nWGET_BINARY              ='wget'\nSINGLEFILE_BINARY        =# bin_path('single-file')\nREADABILITY_BINARY       =# bin_path('readability-extractor')\nMERCURY_BINARY           =# bin_path('mercury-parser')\nYOUTUBEDL_BINARY         ='youtube-dl'\nNODE_BINARY              ='node'\nRIPGREP_BINARY           ='rg'\nCHROME_BINARY            =None\nPOCKET_CONSUMER_KEY      =None\nPOCKET_ACCESS_TOKENS     ={}\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[GENERAL_CONFIG]\n# \u9ED8\u8BA4 60 \u6709\u65F6\u5019\u592A\u77ED\u4E86\nTIMEOUT =180\n[SERVER_CONFIG]\n# SECRET_KEY =\n\nPUBLIC_INDEX    =False\nPUBLIC_SNAPSHOTS=False\nPUBLIC_ADD_VIEW =False\n\n[ARCHIVE_METHOD_TOGGLES]\n# \u9700\u8981\u4EE3\u7406\nSAVE_FAVICON             =False\nSAVE_ARCHIVE_DOT_ORG     =False\n# \u4E00\u822C\u7528\u4E0D\u4E0A\nSAVE_WARC                =False\n# \u6709 SINGLEFILE \u5BF9 PDF \u548C SCREENSHOT \u9700\u6C42\u4E0D\u5927\nSAVE_PDF                 =False\nSAVE_SCREENSHOT          =False\n\n[ARCHIVE_METHOD_OPTIONS]\nCURL_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36'\nWGET_USER_AGENT          ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36'\nCHROME_USER_AGENT        ='Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.61 Safari/537.36'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u6570\u636E\u7ED3\u6784",children:"\u6570\u636E\u7ED3\u6784"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["./\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"index.sqlite3"}),"\n",(0,s.jsx)(n.li,{children:"ArchiveBox.conf"}),"\n",(0,s.jsx)(n.li,{children:"static/"}),"\n",(0,s.jsx)(n.li,{children:"sources/"}),"\n",(0,s.jsx)(n.li,{children:"logs/"}),"\n",(0,s.jsxs)(n.li,{children:["archive/\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["1617687755/ - timestamp\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"index.html - \u63CF\u8FF0\u6027\u5185\u5BB9"}),"\n",(0,s.jsx)(n.li,{children:"index.json - \u63CF\u8FF0\u6027\u5185\u5BB9"}),"\n",(0,s.jsx)(n.li,{children:"screenshot.png"}),"\n",(0,s.jsx)(n.li,{children:"media/"}),"\n",(0,s.jsx)(n.li,{children:"warc/"}),"\n",(0,s.jsx)(n.li,{children:"git/"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function E(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},17776:function(e,n,i){i.d(n,{R:()=>c,x:()=>a});var r=i(7378);let s={},l=r.createContext(s);function c(e){let n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);