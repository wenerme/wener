"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["244254"],{401845:function(e,n,i){i.r(n),i.d(n,{frontMatter:()=>r,toc:()=>d,default:()=>h,metadata:()=>l,assets:()=>c,contentTitle:()=>a});var l=JSON.parse('{"id":"service/forge/gitlab/gitlab-faq","title":"Gitlab FAQ","description":"go get \u4E0D\u652F\u6301\u5B50\u7FA4\u7EC4","source":"@site/../notes/service/forge/gitlab/gitlab-faq.md","sourceDirName":"service/forge/gitlab","slug":"/service/forge/gitlab/faq","permalink":"/notes/service/forge/gitlab/faq","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/forge/gitlab/gitlab-faq.md","tags":[{"inline":true,"label":"FAQ","permalink":"/notes/tags/faq"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1756282044000,"frontMatter":{"title":"Gitlab FAQ","tags":["FAQ"]},"sidebar":"docs","previous":{"title":"GitLab\u914D\u7F6E","permalink":"/notes/service/forge/gitlab/config"},"next":{"title":"Gitlab Get Started","permalink":"/notes/service/forge/gitlab/get-started"}}'),s=i(486106),t=i(917776);let r={title:"Gitlab FAQ",tags:["FAQ"]},a="Gitlab FAQ",c={},d=[{value:"go get \u4E0D\u652F\u6301\u5B50\u7FA4\u7EC4",id:"go-get-\u4E0D\u652F\u6301\u5B50\u7FA4\u7EC4",level:2},{value:"badage",id:"badage",level:2},{value:"\u8986\u76D6\u5EA6",id:"\u8986\u76D6\u5EA6",level:2},{value:"\u8986\u76D6\u53EF\u89C6\u5316",id:"\u8986\u76D6\u53EF\u89C6\u5316",level:2},{value:"\u624B\u52A8\u89E6\u53D1\u90E8\u7F72",id:"\u624B\u52A8\u89E6\u53D1\u90E8\u7F72",level:2},{value:"2FA SSH \u751F\u6210\u6062\u590D\u7801",id:"2fa-ssh-\u751F\u6210\u6062\u590D\u7801",level:2},{value:"gitlab runner \u7F13\u5B58\u8017\u65F6\u957F",id:"gitlab-runner-\u7F13\u5B58\u8017\u65F6\u957F",level:2},{value:"Docker build cache",id:"docker-build-cache",level:2},{value:"RBAC",id:"rbac",level:2},{value:"pipeline failed due to the user not being verified",id:"pipeline-failed-due-to-the-user-not-being-verified",level:2}];function o(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"gitlab-faq",children:"Gitlab FAQ"})}),"\n",(0,s.jsx)(n.h2,{id:"go-get-\u4E0D\u652F\u6301\u5B50\u7FA4\u7EC4",children:"go get \u4E0D\u652F\u6301\u5B50\u7FA4\u7EC4"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'# \u4F1A\u6307\u5411 gitlab.com/random/xyz \u800C\u4E0D\u662F gitlab.com/random/xyz/something\ncurl "https://gitlab.com/random/xyz/something?go-get=1"\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["go get \u80FD\u8BC6\u522B gitlab.com/random/xyz/something.git\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4F46\u8981\u6C42 module \u540D\u5B57\u4E5F\u5F97\u5339\u914D"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53EF\u4EE5\u4F7F\u7528 deploy token + .netrc \u6DFB\u52A0 auth\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4F46\u65E0\u6CD5\u7ED5\u5F00 ssh \u7684\u95EE\u9898"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab/-/issues/196007",children:"https://gitlab.com/gitlab-org/gitlab/-/issues/196007"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab-foss/-/issues/30785",children:"https://gitlab.com/gitlab-org/gitlab-foss/-/issues/30785"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/golang/go/issues/34094",children:"https://github.com/golang/go/issues/34094"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"badage",children:"badage"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"https://gitlab.com/%{project_path}/badges/%{default_branch}/pipeline.svg"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"/pipeline.svg"}),"\n",(0,s.jsx)(n.li,{children:"/coverage.svg"}),"\n",(0,s.jsx)(n.li,{children:"style=flat-square,flat"}),"\n",(0,s.jsx)(n.li,{children:"job=karma&key_text=Frontend+Coverage&key_width=130"}),"\n",(0,s.jsx)(n.li,{children:"\u53EF\u80FD\u72B6\u6001 pending, running, passed, failed, skipped, canceled, unknown"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/pipelines/settings.html#pipeline-status-badge",children:"Pipeline status badge"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u8986\u76D6\u5EA6",children:"\u8986\u76D6\u5EA6"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CI/CD \u901A\u7528\u8BBE\u7F6E - \u914D\u7F6E\u68C0\u6D4B log \u7684\u89C4\u5219"}),"\n"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"tool"}),(0,s.jsx)(n.th,{children:"conf"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"go test -cover"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"coverage: \\d+.\\d+% of statements"})})]})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/pipelines/settings.html#test-coverage-examples",children:"https://docs.gitlab.com/ee/ci/pipelines/settings.html#test-coverage-examples"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u8986\u76D6\u53EF\u89C6\u5316",children:"\u8986\u76D6\u53EF\u89C6\u5316"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u53EA\u6709\u5728 MR \u53EF\u89C1\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u9700\u8981\u7B49\u5168\u90E8 pipeline \u8DD1\u5B8C\u624D\u53EF\u89C1 ",(0,s.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab/-/issues/236248",children:"https://gitlab.com/gitlab-org/gitlab/-/issues/236248"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.gitlab.com/ee/user/project/merge_requests/test_coverage_visualization.html",children:"https://docs.gitlab.com/ee/user/project/merge_requests/test_coverage_visualization.html"})}),"\n",(0,s.jsxs)(n.li,{children:["\u9700\u8981\u8F93\u51FA\u4E3A ",(0,s.jsx)(n.a,{href:"https://github.com/cobertura/cobertura",children:"cobertura/cobertura"})]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"go install github.com/boumenot/gocover-cobertura@latest\ngocover-cobertura < coverage.txt > coverage.xml\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"test:\n  script:\n    - npm install\n    - npx nyc --reporter cobertura mocha\n  artifacts:\n    reports:\n      cobertura: coverage/cobertura-coverage.xml\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u624B\u52A8\u89E6\u53D1\u90E8\u7F72",children:"\u624B\u52A8\u89E6\u53D1\u90E8\u7F72"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"deploy:prod:manually:\n  extends:\n    - .deploy\n  when: manual\n"})}),"\n",(0,s.jsx)(n.h2,{id:"2fa-ssh-\u751F\u6210\u6062\u590D\u7801",children:"2FA SSH \u751F\u6210\u6062\u590D\u7801"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ssh git@gitlab.com 2fa_recovery_codes\n"})}),"\n",(0,s.jsx)(n.h2,{id:"gitlab-runner-\u7F13\u5B58\u8017\u65F6\u957F",children:"gitlab runner \u7F13\u5B58\u8017\u65F6\u957F"}),"\n",(0,s.jsxs)(n.p,{children:["\u4E0D\u7F13\u5B58\uFF0C\u4E0D\u505A ",(0,s.jsx)(n.code,{children:"git clean -ffdx"}),"\u3002\u975E\u5E38\u9002\u7528\u4E8E\u5927\u4ED3\u5E93\u6216\u751F\u6210\u975E\u5E38\u591A\u6587\u4EF6\u7684\u65F6\u5019\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"variables:\n  GIT_STRATEGY: fetch\n  GIT_CLEAN_FLAGS: none\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["GIT_CLEAN_FLAGS - GitLab Runner 11.10\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/yaml/#git-clean-flags",children:"https://docs.gitlab.com/ee/ci/yaml/#git-clean-flags"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.gitlab.com/ee/ci/large_repositories/#git-clean-flags",children:"https://docs.gitlab.com/ee/ci/large_repositories/#git-clean-flags"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/1281",children:"https://gitlab.com/gitlab-org/gitlab-runner/-/merge_requests/1281"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u95EE\u9898\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/280#note_39937930",children:"https://gitlab.com/gitlab-org/gitlab-runner/-/issues/280#note_39937930"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"docker-build-cache",children:"Docker build cache"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"Build:\n  extends: .docker\n  stage: build\n  script:\n    - docker pull $CI_REGISTRY_IMAGE:build || true\n    - >\n      docker build\n      --pull\n      --cache-from $CI_REGISTRY_IMAGE:build\n      --tag build-env\n      -f Dockerfile.build\n      .\n    - docker tag build-env $CI_REGISTRY_IMAGE:build\n    - docker push $CI_REGISTRY_IMAGE:build\n"})}),"\n",(0,s.jsx)(n.h2,{id:"rbac",children:"RBAC"}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Developer \u9ED8\u8BA4\u4E0D\u53EF\u4EE5\u64CD\u4F5C\u4FDD\u62A4\u5206\u652F\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u53EF\u914D\u7F6E\u5141\u8BB8\u64CD\u4F5C"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Guest"}),"\n",(0,s.jsx)(n.li,{children:"Reporter"}),"\n",(0,s.jsx)(n.li,{children:"Developer"}),"\n",(0,s.jsx)(n.li,{children:"Maintainer"}),"\n",(0,s.jsx)(n.li,{children:"Owner"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://docs.gitlab.com/ee/user/permissions.html",children:"https://docs.gitlab.com/ee/user/permissions.html"})}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"pipeline-failed-due-to-the-user-not-being-verified",children:"pipeline failed due to the user not being verified"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u4F7F\u7528\u5171\u4EAB Runner\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u9700\u8981\u7528\u6237\u9A8C\u8BC1 - \u8BBE\u7F6E\u4FE1\u7528\u5361\u3001\u4E0D\u4F1A\u6536\u8D39"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u4F7F\u7528\u81EA\u5DF1\u7684 Runner\uFF0C\u53EF\u4EE5\u5173\u95ED\u5171\u4EAB\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Setting -> CICD -> Runner (Expand) -> disable Shared runner."}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},917776:function(e,n,i){i.d(n,{R:()=>r,x:()=>a});var l=i(7378);let s={},t=l.createContext(s);function r(e){let n=l.useContext(t);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),l.createElement(t.Provider,{value:n},e.children)}}}]);