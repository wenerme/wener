"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["751101"],{538847:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>l,toc:()=>d,default:()=>o,metadata:()=>t,assets:()=>c,contentTitle:()=>a});var t=JSON.parse('{"id":"service/bi/superset","title":"Apache Superset","description":"- apache/superset","source":"@site/../notes/service/bi/superset.md","sourceDirName":"service/bi","slug":"/service/bi/superset","permalink":"/notes/service/bi/superset","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/bi/superset.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1706956646000,"frontMatter":{"title":"Apache Superset"},"sidebar":"docs","previous":{"title":"echarts","permalink":"/notes/service/bi/echarts"},"next":{"title":"veta lite","permalink":"/notes/service/bi/vega-lite"}}'),r=s(486106),i=s(917776);let l={title:"Apache Superset"},a="Apache Superset",c={},d=[{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:2},{value:"Roles",id:"roles",level:2},{value:"SQL Macro",id:"sql-macro",level:2},{value:"K8S",id:"k8s",level:2},{value:"\u524D\u7AEF\u663E\u793A\u7684 UTC \u65E5\u671F",id:"\u524D\u7AEF\u663E\u793A\u7684-utc-\u65E5\u671F",level:2},{value:"Hide menus",id:"hide-menus",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"apache-superset",children:"Apache Superset"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/apache/superset",children:"apache/superset"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"by Airbnb"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://medium.com/@sairamkrish/8217956273c1",children:"\u81EA\u5B9A\u4E49\u6388\u6743\u5B9E\u73B0\u5206\u4EAB"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://stackoverflow.com/questions/54219101/apache-superset-dashboard-in-webpage",children:"Apache superset dashboard in webpage"})}),"\n",(0,r.jsxs)(n.li,{children:["Helm ",(0,r.jsx)(n.a,{href:"https://github.com/apache/incubator-superset/tree/master/helm/superset",children:"chart"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/amancevice/docker-superset",children:"amancevice/docker-superset"})," - \u5355 docker \u542F\u52A8 superset\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/amancevice/docker-superset/tree/main/examples",children:"\u542F\u52A8\u793A\u4F8B"})}),"\n",(0,r.jsxs)(n.li,{children:["\u7BA1\u7406\u5DE5\u5177 ",(0,r.jsx)(n.code,{children:"/usr/local/bin/superset"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u5B89\u88C5\u4F4D\u7F6E ",(0,r.jsx)(n.code,{children:"/usr/local/lib/python3.6/site-packages/superset/"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://preset.io/blog/2020-07-02-hello-world/",children:"\u5982\u4F55\u65B0\u589E\u63D2\u4EF6"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Dashboard \u53EA\u8BFB\u57FA\u7840\u6743\u9650\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"can explore json on Superset"}),"\n",(0,r.jsx)(n.li,{children:"can dashboard on Superset"}),"\n",(0,r.jsxs)(n.li,{children:["can read on CssTemplateModelView\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u6CA1\u6709\u6743\u9650\u4F1A\u51FA\u4E00\u4E2A\u9519\u8BEF\u4FE1\u606F"}),"\n",(0,r.jsx)(n.li,{children:"\u65E7\u7248\u672C\u4E3A can list on CssTemplateModelView"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"datasource access on xxx.xxx"}),"\n",(0,r.jsx)(n.li,{children:"can csrf token on Superset"}),"\n",(0,r.jsx)(n.li,{children:"can show on DashboardModelView"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u5206\u4EAB\u6DFB\u52A0 ",(0,r.jsx)(n.code,{children:"?standalone=true"})," \u53EF\u4EE5\u9690\u85CF\u4E0D\u5FC5\u8981\u7684\u5185\u5BB9"]}),"\n"]})}),"\n",(0,r.jsx)(n.admonition,{type:"caution",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u524D\u7AEF\u4F1A\u663E\u793A\u4E3A UTC\uFF0C\u5BFC\u81F4\u65F6\u95F4 -8\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/apache/incubator-superset/issues/3928",children:"#3928"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["Calendar Heatmap \u65F6\u95F4\u504F\u5DEE\u4E00\u5929\n",(0,r.jsx)(n.a,{href:"https://github.com/apache-superset/superset-ui/issues/409",children:"apache-superset/superset-ui#409"})]}),"\n",(0,r.jsxs)(n.li,{children:["\u4E0D\u80FD\u94FE\u63A5 prometheus ",(0,r.jsx)(n.a,{href:"https://github.com/apache/superset/discussions/18381",children:"#18381"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u53EF\u4EE5\u8003\u8651\u5468 trino \u6216\u8005 postgresql"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,r.jsx)(n.h2,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://superset.apache.org/docs/installation/cache",children:"\u7F13\u5B58\u914D\u7F6E"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/apache/superset/blob/master/superset/config.py",children:"config.py"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:"PUBLIC_ROLE_LIKE_GAMMA = True\nSESSION_COOKIE_SAMESITE = None\nSESSION_COOKIE_HTTPONLY = False\n#HTTP_HEADERS = {'X-Frame-Options': 'ALLOW-FROM http://localhost:8080'}\n#HTTP_HEADERS = {'Content-Security-Policy': 'frame-ancestors \\'self\\' localhost:8081','Access-Control-Allow-Origin':'*'}\n\n#\nROW_LIMIT = 5000\nSUPERSET_WORKERS = 2\n\nSUPERSET_WEBSERVER_PORT = 8088\n\n# Flask App Builder configuration\n# Your App secret key\nSECRET_KEY = '\\2\\1thisismyscretkey\\1\\2\\e\\y\\y\\h'\n\n# The SQLAlchemy connection string to your database backend\n# This connection defines the path to the database that stores your\n# superset metadata (slices, connections, tables, dashboards, ...).\n# Note that the connection information to connect to the datasources\n# you want to explore are managed directly in the web UI\nSQLALCHEMY_DATABASE_URI = 'sqlite:////var/lib/superset/superset.db'\n\n# Flask-WTF flag for CSRF\nWTF_CSRF_ENABLED = True\n# Add endpoints that need to be exempt from CSRF protection\nWTF_CSRF_EXEMPT_LIST = []\nMAPBOX_API_KEY = ''\n\n#\nMAPBOX_API_KEY = os.getenv('MAPBOX_API_KEY', '')\n\n# Flask \u7F13\u5B58\n# https://flask-caching.readthedocs.io/en/latest/#configuring-flask-caching\n# Superset \u81EA\u5DF1\u7F13\u5B58\nCACHE_CONFIG = {\n    'CACHE_TYPE': 'redis',\n    'CACHE_DEFAULT_TIMEOUT': 300,\n    'CACHE_KEY_PREFIX': 'superset_',\n    'CACHE_REDIS_HOST': 'redis',\n    'CACHE_REDIS_PORT': 6379,\n    'CACHE_REDIS_DB': 1,\n    'CACHE_REDIS_URL': 'redis://redis:6379/1'}\n\n# \u6570\u636E\u5E93\u7F13\u5B58\nDATA_CACHE_CONFIG = {\n    'CACHE_TYPE': 'redis',\n    'CACHE_DEFAULT_TIMEOUT': 60 * 60 * 24, # 1 day default (in secs)\n    'CACHE_KEY_PREFIX': 'superset_results',\n    'CACHE_REDIS_URL': 'redis://localhost:6379/0',\n}\n\n# SQL Lab \u67E5\u8BE2\u7ED3\u679C\u5B58\u50A8\n# RESULTS_BACKEND\n\nSQLALCHEMY_DATABASE_URI = 'postgresql+psycopg2://superset:superset@postgresql:5432/superset'\nSQLALCHEMY_TRACK_MODIFICATIONS = True\nSECRET_KEY = ''\n\n# \u8DF3\u8F6C\u5230 https\nENABLE_PROXY_FIX = True\nPREFERRED_URL_SCHEME = 'https'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"roles",children:"Roles"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Admin"}),"\n",(0,r.jsx)(n.li,{children:"Alpha"}),"\n",(0,r.jsx)(n.li,{children:"Gamma"}),"\n",(0,r.jsx)(n.li,{children:"sql_lab"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"sql-macro",children:"SQL Macro"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://superset.incubator.apache.org/sqllab.html#templating-with-jinja",children:"https://superset.incubator.apache.org/sqllab.html#templating-with-jinja"})}),"\n",(0,r.jsxs)(n.li,{children:["\u547D\u540D\u7A7A\u95F4 ",(0,r.jsx)(n.code,{children:"superset.jinja_context"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jinja",children:"{% set date_ref =   filter_values('my_date')[0] %}\nAND date >= DATE_ADD({{date_ref}}, INTERVAL -7 DAYS)\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Macro"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Describe"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current_user_id()"}),(0,r.jsx)(n.td,{children:"int?"}),(0,r.jsx)(n.td,{children:"\u5F53\u524D\u7528\u6237 ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"current_username()"}),(0,r.jsx)(n.td,{children:"str?"}),(0,r.jsx)(n.td,{children:"\u5F53\u524D\u7528\u6237\u540D"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"url_param(param, default=None)"}),(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"URL \u53C2\u6570"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"filter_values(column, default=None)"}),(0,r.jsx)(n.td,{children:"any"}),(0,r.jsx)(n.td,{children:"form_data \u91CC\u7684\u6570\u636E"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"k8s",children:"K8S"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u7EC4\u4EF6\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"CeleryBeat"}),"\n",(0,r.jsx)(n.li,{children:"CeleryFlower"}),"\n",(0,r.jsx)(n.li,{children:"Node"}),"\n",(0,r.jsx)(n.li,{children:"Websockets"}),"\n",(0,r.jsx)(n.li,{children:"worker"}),"\n",(0,r.jsx)(n.li,{children:"redis"}),"\n",(0,r.jsx)(n.li,{children:"postgresql"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"helm repo add superset https://apache.github.io/superset\n"})}),"\n",(0,r.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(n.h2,{id:"\u524D\u7AEF\u663E\u793A\u7684-utc-\u65E5\u671F",children:"\u524D\u7AEF\u663E\u793A\u7684 UTC \u65E5\u671F"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/apache/incubator-superset/issues/3928",children:"#3928"})," - Timestamps are not displayed in the client's local timezone"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/apache/incubator-superset/issues/9304#issuecomment-609524741",children:"#9304"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Superset decided to always UTC time to keep things simple. It'd be quite some work if we want to add custom timezone support."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-py",children:'SUPERSET_D3_LOCALE = """\n{\n  "decimal": ".",\n  "thousands": ",",\n  "grouping": [3],\n  "currency": ["\xa3", ""],\n  "dateTime": "%a %e %b %X %Y",\n  "date": "%d/%m/%Y",\n  "time": "%H:%M:%S",\n  "periods": ["AM", "PM"],\n  "days": ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],\n  "shortDays": ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],\n  "months": ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],\n  "shortMonths": ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]\n} """\n\nSUPERSET_D3_LOCALE = """\n{\n  "decimal": ".",\n  "thousands": ",",\n  "grouping": [3],\n  "currency": ["\xa5", ""],\n  "dateTime": "%a %b %e %X %Y",\n  "date": "%Y-%d-%m",\n  "time": "%H:%M:%S",\n  "periods": ["\u4E0A\u5348", "\u4E0B\u5348"],\n  "days": ["\u5468\u65E5", "\u5468\u4E00", "\u5468\u4E8C", "\u5468\u4E09", "\u5468\u56DB", "\u5468\u4E94", "\u5468\u516D"],\n  "shortDays": ["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"],\n  "months": ["\u4E00\u6708", "\u4E8C\u6708", "\u4E09\u6708", "\u56DB\u6708", "\u4E94\u6708", "\u516D\u6708", "\u4E03\u6708", "\u516B\u6708", "\u4E5D\u6708", "\u5341\u6708", "\u5341\u4E00\u6708", "\u5341\u4E8C\u6708"],\n  "shortMonths": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"]\n} """\n'})}),"\n",(0,r.jsx)(n.h2,{id:"hide-menus",children:"Hide menus"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-css",children:"html:not([mode='edit']) .dashboard-header > .button-container {\n  display: none !important;\n}\nhtml:not([mode='edit']) header.top {\n  display: none;\n}\nhtml:not([mode='edit']) .chart-header > .header > .dropdown {\n  display: none !important;\n}\nhtml:not([mode='edit']) .dragdroppable-tab .anchor-link-container {\n  display: none !important;\n}\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"// \u663E\u793A\n$('html').attr('mode', 'edit');\n"})})]})}function o(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},917776:function(e,n,s){s.d(n,{R:()=>l,x:()=>a});var t=s(7378);let r={},i=t.createContext(r);function l(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);