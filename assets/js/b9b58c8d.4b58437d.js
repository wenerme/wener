"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["365729"],{267274:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>t,toc:()=>h,default:()=>o,metadata:()=>i,assets:()=>c,contentTitle:()=>d});var i=JSON.parse('{"id":"os/linux/sys/usb","title":"USB","description":"- libusb","source":"@site/../notes/os/linux/sys/usb.md","sourceDirName":"os/linux/sys","slug":"/os/linux/sys/usb","permalink":"/notes/os/linux/sys/usb","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/sys/usb.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1652772118000,"frontMatter":{"title":"USB"},"sidebar":"docs","previous":{"title":"Trace","permalink":"/notes/os/linux/sys/trace"},"next":{"title":"zram","permalink":"/notes/os/linux/sys/zram"}}'),r=s(486106),l=s(917776);let t={title:"USB"},d="USB",c={},h=[{value:"usbids",id:"usbids",level:2},{value:"\u52A0\u5BC6\u72D7",id:"\u52A0\u5BC6\u72D7",level:2},{value:"sniffing",id:"sniffing",level:2},{value:"usbip",id:"usbip",level:2},{value:"usbredir",id:"usbredir",level:2},{value:"usbkey",id:"usbkey",level:2}];function u(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"usb",children:"USB"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"libusb"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://github.com/gregkh/usbutils",children:"gregkh/usbutils"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pkgs.alpinelinux.org/package/edge/main/x86_64/usbutils",children:"edge/main/x86_64/usbutils"})}),"\n",(0,r.jsx)(n.li,{children:"usb-devices"}),"\n",(0,r.jsx)(n.li,{children:"usbhid-dump"}),"\n",(0,r.jsx)(n.li,{children:"lsusb"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"http://www.draisberghof.de/usb_modeswitch/",children:"usb-modeswitch"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pkgs.alpinelinux.org/package/edge/main/x86_64/usb-modeswitch",children:"edge/main/x86_64/usb-modeswitch"})}),"\n",(0,r.jsx)(n.li,{children:"usb_modeswitch"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://www.usblyzer.com/usb-topology.htm",children:"USB Topology"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67E5\u770B\u8BBE\u5907\u6811\nlsusb -t\n# \u67E5\u770B\u5355\u4E2A\u8BBE\u5907\nlsusb -s 2:2\n# \u8BBE\u5907\u8BE6\u7EC6\u4FE1\u606F\n# bcdUSB USB version of the port\nlsusb -s 2:2 -vvv\n"})}),"\n",(0,r.jsx)(n.h2,{id:"usbids",children:"usbids"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://www.linux-usb.org/usb-ids.html",children:"http://www.linux-usb.org/usb-ids.html"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"curl -O http://www.linux-usb.org/usb.ids\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u52A0\u5BC6\u72D7",children:"\u52A0\u5BC6\u72D7"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Software_protection_dongle",children:"Software protection dongle"})}),"\n",(0,r.jsxs)(n.li,{children:["\u5B89\u5168\u4EE4\u724C/",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Security_token",children:"Security token"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"sniffing",children:"sniffing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://freeusbanalyzer.com/",children:"Free USB Analyzer"})}),"\n",(0,r.jsxs)(n.li,{children:["Wireshark ",(0,r.jsx)(n.a,{href:"https://wiki.wireshark.org/CaptureSetup/USB",children:"USB capture"})]}),"\n",(0,r.jsxs)(n.li,{children:["Linux module ",(0,r.jsx)(n.a,{href:"https://www.kernel.org/doc/Documentation/usb/usbmon.txt",children:"usbmon"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"http://tjworld.net/wiki/Linux/Ubuntu/USBmonitoring",children:"USB Monitoring"})}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"usbip",children:"usbip"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.kernel.org/doc/Documentation/usb/usbip_protocol.txt",children:"usbip_protocol"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.kernel.org/doc/readme/tools-usb-usbip-README",children:"tools-usb-usbip-README"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://github.com/torvalds/linux/tree/master/tools/usb/usbip",children:"tools/usb/usbip"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u65B0\u7684 usbip \u4EE3\u7801"}),"\n",(0,r.jsx)(n.li,{children:"2017 \u5E74\u4F3C\u4E4E\u6709\u4E9B\u4FEE\u6539"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"http://web.archive.org/web/20160403200320/http://blog.3mdeb.com/2015/10/27/linux/",children:"Linux, RPi and USB over IP updated"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"usbip-utils"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/alpinelinux/aports/tree/master/unmaintained/usbip-utils",children:"unmaintained/usbip-utils"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Wireless_USB",children:"https://en.wikipedia.org/wiki/Wireless_USB"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"usbip-vhci"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5BA2\u6237\u7AEF\u5185\u6838\u6A21\u5757"}),"\n",(0,r.jsx)(n.li,{children:"\u63D0\u4F9B\u865A\u62DF USB Host Controller \u7528\u4E8E\u4ECE\u8FDC\u7A0B\u5BFC\u5165\u8BBE\u5907"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"usbip-host (stub driver)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u670D\u52A1\u7AEF\u6A21\u5757"}),"\n",(0,r.jsx)(n.li,{children:"\u63D0\u4F9B\u8BBE\u5907\u9A71\u52A8\u7ED1\u5B9A\u5230\u7269\u7406 USB \u8BBE\u5907, \u4F7F\u5F97\u8BBE\u5907\u53EF\u88AB\u66B4\u9732"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"usbip-vudc"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u670D\u52A1\u7AEF\u6A21\u5757"}),"\n",(0,r.jsx)(n.li,{children:"\u63D0\u4F9B\u865A\u62DF\u7684 USB Device Controller, \u5C06\u4F7F\u7528 USB Gadget Subsystem \u521B\u5EFA\u7684\u8BBE\u5907\u8FDB\u884C\u66B4\u9732"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"usbip-utils"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7528\u6237\u7A7A\u95F4\u5DE5\u5177"}),"\n",(0,r.jsx)(n.li,{children:"\u7528\u4E8E\u7BA1\u7406\u548C\u5904\u7406\u94FE\u63A5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67E5\u770B\u5185\u6838\u914D\u7F6E\ngrep USBIP /boot/config*\n# \u5982\u679C\u4E0A\u9762\u7684\u914D\u7F6E, \u5219\u52A0\u8F7D configs \u67E5\u770B\nmodprobe configs\nzcat /proc/config.gz |grep USBIP\n# CONFIG_USBIP_CORE=m\n# CONFIG_USBIP_VHCI_HCD=m\n# CONFIG_USBIP_HOST=m\n\n# \u670D\u52A1\u7AEF\n# ==========\n# \u52A0\u8F7D\u5185\u6838\u6A21\u5757\nmodprobe usbip-core\nmodprobe usbip-host\n# \u542F\u52A8\u670D\u52A1\u7AEF\nusbipd -D\n# \u67E5\u770B\u8BBE\u5907\nusbip list -l\n# \u7ED1\u5B9A\u66B4\u9732\nusbip --debug bind -b 1-1.2\n# \u67E5\u770B\u7AEF\u53E3\u4FE1\u606F\n# \u88AB\u8FDC\u7A0B\u6302\u8F7D\u540E\u4F1A\u663E\u793A\u76F8\u5173\u4FE1\u606F\nusbip port\n# \u53D6\u6D88\u7ED1\u5B9A\nusbip unbind -b 1-1.3\n\n# \u5BA2\u6237\u7AEF\n# ==========\n# \u67E5\u770B\u8FDC\u7A0B\u670D\u52A1\u5668\u4E0A\u66B4\u9732\u7684\u8BBE\u5907\nusbip list -r 192.168.0.1\n# \u52A0\u8F7D\u5185\u6838\nmodprobe vhci-hcd\n# \u6302\u8F7D\u8FDC\u7A0B\u8BBE\u5907\nusbip attach -r 192.168.0.1 -b 1-1.3\n# \u67E5\u770B\u8FDC\u7A0B\u7684\u5206\u533A\u4FE1\u606F\n# \u5047\u8BBE\u6302\u8F7D\u540E\u7684\u8BBE\u5907\u4E3A /dev/sdd\nfdisk -l /dev/sdd\n# \u5378\u8F7D\nusbip detach -p 0\n"})}),"\n",(0,r.jsx)(n.h2,{id:"usbredir",children:"usbredir"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://github.com/SPICE/usbredir",children:"SPICE/usbredir"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://pkgs.alpinelinux.org/package/edge/main/x86_64/usbredir-server",children:"edge/main/x86_64/usbredir-server"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/OliRead/usbdmx",children:"https://github.com/OliRead/usbdmx"}),"\nA versatile USB DMX library written in Go for programatic show control and special effects."]}),"\n",(0,r.jsxs)(n.p,{children:["echi hdc\n",(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Host_controller_interface_(USB,_Firewire)",children:"https://en.wikipedia.org/wiki/Host_controller_interface_(USB,_Firewire)"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Message_Signaled_Interrupts",children:"https://en.wikipedia.org/wiki/Message_Signaled_Interrupts"})}),"\n",(0,r.jsx)(n.h2,{id:"usbkey",children:"usbkey"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"BOC"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"/dev/sr0"}),"\n",(0,r.jsx)(n.li,{children:"mnt/Setup.exe"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"usb 1-8: new full-speed USB device number 4 using xhci_hcd\nusb 1-8: New USB device found, idVendor=096e, idProduct=070a\nusb 1-8: New USB device strings: Mfr=1, Product=2, SerialNumber=0\nusb 1-8: Product: FT Interpass3000\nusb 1-8: Manufacturer: FS\nusb-storage 1-8:1.0: USB Mass Storage device detected\nscsi host7: usb-storage 1-8:1.0\nscsi 7:0:0:0: CD-ROM            FT BOC   Interpass3000    1.00 PQ: 0 ANSI: 2\nsr 7:0:0:0: [sr0] scsi3-mmc drive: 0x/0x caddy\ncdrom: Uniform CD-ROM driver Revision: 3.20\nsr 7:0:0:0: Attached scsi CD-ROM sr0\n"})})]})}function o(e={}){let{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},917776:function(e,n,s){s.d(n,{R:()=>t,x:()=>d});var i=s(7378);let r={},l=i.createContext(r);function t(e){let n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);