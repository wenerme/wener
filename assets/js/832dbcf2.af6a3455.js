"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["495220"],{960890:function(s,e,n){n.r(e),n.d(e,{frontMatter:()=>l,toc:()=>p,default:()=>d,metadata:()=>a,assets:()=>o,contentTitle:()=>r});var a=JSON.parse('{"id":"os/linux/sys/swap","title":"Linux Swap \u7BA1\u7406 (Swap Management)","description":"linux-swap-management}","source":"@site/../notes/os/linux/sys/swap.md","sourceDirName":"os/linux/sys","slug":"/os/linux/sys/swap","permalink":"/notes/os/linux/sys/swap","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/sys/swap.md","tags":[{"inline":true,"label":"Linux","permalink":"/notes/tags/linux"},{"inline":true,"label":"SysAdmin","permalink":"/notes/tags/sys-admin"},{"inline":true,"label":"Swap","permalink":"/notes/tags/swap"},{"inline":true,"label":"Memory","permalink":"/notes/tags/memory"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"Linux Swap \u7BA1\u7406 (Swap Management)","tags":["Linux","SysAdmin","Swap","Memory"]},"sidebar":"docs","previous":{"title":"shadow","permalink":"/notes/os/linux/sys/shadow"},"next":{"title":"Tuning","permalink":"/notes/os/linux/sys/tuning"}}'),i=n(486106),t=n(917776);let l={title:"Linux Swap \u7BA1\u7406 (Swap Management)",tags:["Linux","SysAdmin","Swap","Memory"]},r="Linux Swap \u7BA1\u7406 (Swap Management) {#linux-swap-management}",o={},p=[{value:"\u6DFB\u52A0 swap",id:"\u6DFB\u52A0-swap",level:2},{value:"\u5220\u9664 swap",id:"\u5220\u9664-swap",level:2},{value:"\u53C2\u8003",id:"\u53C2\u8003",level:2}];function c(s){let e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"linux-swap-management",children:"Linux Swap \u7BA1\u7406 (Swap Management)"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"apk add util-linux-misc # util-linux \u63D0\u4F9B\u5168\u529F\u80FD\u7684 swap \u5DE5\u5177\n\nswapon --show   # \u67E5\u770B\u4EA4\u6362\u533A\ncat /proc/swaps #\n"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Swap Files:\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Ubuntu: ",(0,i.jsx)(e.code,{children:"/swap.img"})]}),"\n",(0,i.jsxs)(e.li,{children:["macOS: ",(0,i.jsx)(e.code,{children:"/private/var/vm/swapfile*"})]}),"\n",(0,i.jsxs)(e.li,{children:["Windows: ",(0,i.jsx)(e.code,{children:"C:\\pagefile.sys"})]}),"\n",(0,i.jsxs)(e.li,{children:["Generic: ",(0,i.jsx)(e.code,{children:"/swapfile"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["Linux uses ",(0,i.jsx)(e.code,{children:"swappiness"})," to control swap usage."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"vm.swappiness"})," (0-100), default 60."]}),"\n",(0,i.jsx)(e.li,{children:"0: Avoid swap as much as possible."}),"\n",(0,i.jsx)(e.li,{children:"10: Use swap when 90% memory is filled (10% free)."}),"\n",(0,i.jsx)(e.li,{children:"100: Aggressive swapping."}),"\n"]}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsxs)(e.p,{children:["[!NOTE]\n",(0,i.jsx)(e.code,{children:"vm.swappiness"})," modification requires reboot or ",(0,i.jsx)(e.code,{children:"sysctl -p"})," to persist, but takes effect immediately if written to ",(0,i.jsx)(e.code,{children:"/proc"}),"."]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# Linux\n# \u6C38\u4E45\u4FEE\u6539 /etc/sysctl.conf -> sysctl -p\n# \u8FD0\u884C\u65F6\u4FEE\u6539:\nsysctl vm.swappiness=10\n\n# Operations\nswapoff -a        # Disable all swap\nswapon -a         # Enable all swap\ncat /proc/meminfo # Check memory/swap\nfree -h           # Show usage\ntop               # Monitor\ncat /proc/swaps   # List swap devices\nvmstat            # Virtual memory stats\n\n# macOS\nvm_stat                          # Virtual memory stats\nls -lh /private/var/vm/swapfile* # List swap files\n\n# Alpine Linux\necho vm.swappiness=10 > /etc/sysctl.d/swap.conf\n/etc/init.d/sysctl restart\nrc-update add swap boot\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6DFB\u52A0-swap",children:"\u6DFB\u52A0 swap"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# 4G \u4EA4\u6362\u533A\n# dd if=/dev/zero of=/sysswap count=512 bs=8MiB status=progress\nfallocate -l 4G /sysswap\n\nchmod 600 /sysswap\nmkswap /sysswap\nswapon /sysswap\n# \u5C06 swap \u6DFB\u52A0\u5230 fstab\necho /sysswap swap swap sw 0 0 >> /etc/fstab\n\nsysctl vm.swappiness=10\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5220\u9664-swap",children:"\u5220\u9664 swap"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u5148\u5173\u95ED swap\nswapoff /sysswap\n# \u5220\u9664 swap \u6587\u4EF6\nrm -f /sysswap\n# \u5220\u9664 fstab \u4E2D\u7684 swap\nsed -i '/\\/sysswap/d' /etc/fstab\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u53C2\u8003",children:"\u53C2\u8003"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-add-swap-on-centos-7",children:"How to add swap on CentOS 7"})}),"\n"]})]})}function d(s={}){let{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(c,{...s})}):c(s)}},917776:function(s,e,n){n.d(e,{R:()=>l,x:()=>r});var a=n(7378);let i={},t=a.createContext(i);function l(s){let e=a.useContext(t);return a.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:l(s.components),a.createElement(t.Provider,{value:e},s.children)}}}]);