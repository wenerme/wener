"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["77938"],{47731:function(n,e,i){i.r(e),i.d(e,{frontMatter:()=>t,toc:()=>d,default:()=>h,metadata:()=>l,assets:()=>c,contentTitle:()=>a});var l=JSON.parse('{"id":"network/loadbalance","title":"Load Balance","description":"- DPDK - Data Plane Development Kit","source":"@site/../notes/network/loadbalance.md","sourceDirName":"network","slug":"/network/loadbalance","permalink":"/notes/network/loadbalance","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/network/loadbalance.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1756282044000,"frontMatter":{"title":"Load Balance"},"sidebar":"docs","previous":{"title":"InfiniBand","permalink":"/notes/network/link/infiniband"},"next":{"title":"Glossary","permalink":"/notes/network/glossary"}}'),r=i(86106),s=i(17776);let t={title:"Load Balance"},a="Load Balance",c={},d=[{value:"\u7B56\u7565",id:"\u7B56\u7565",level:2},{value:"NOTE",id:"note",level:2}];function o(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"load-balance",children:"Load Balance"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Data_Plane_Development_Kit",children:"DPDK"})," - Data Plane Development Kit\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u76F4\u63A5\u5728\u7F51\u5361\u5F00\u53D1\u5E94\u7528\u5B9E\u73B0\u6293\u53D1\uFF0C\u7ED5\u8FC7\u5185\u6838\u5904\u7406\uFF0C\u505A\u5230\u6027\u80FD\u6700\u5927\u5316"}),"\n",(0,r.jsx)(e.li,{children:"\u7ED5\u8FC7\u5185\u6838"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Netfilter",children:"Netfilter"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Linux \u63D0\u4F9B\u7684\u5185\u6838\u673A\u5236\uFF0C\u7528\u4E8E\u7F51\u7EDC\u76F8\u5173\u5904\u7406"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://www.openonload.org/",children:"OpenOnload"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u7F51\u7EDC\u6808"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/FDio/vpp",children:"FDio/vpp"})," - ",(0,r.jsx)(e.a,{href:"https://fd.io/",children:"fd.io"})," \u7684\u9879\u76EE - The Fast Data Project\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"open source version of Cisco's Vector Packet Processing (VPP) technology"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://blog.cloudflare.com/kernel-bypass/",children:"Kernal bypass"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5982\u4F55\u7ED5\u8FC7\u5185\u6838\u4EE5\u63D0\u9AD8\u6027\u80FD"}),"\n",(0,r.jsx)(e.li,{children:"PACKET_MMAP - Linux \u63A5\u53E3\uFF0C\u5FEB\u901F\u7F51\u7EDC\u55C5\u63A2"}),"\n",(0,r.jsx)(e.li,{children:"PF_RING - \u52A0\u901F\u5305\u6355\u83B7\uFF0C\u4E0D\u5728 linux \u4E3B\u5E72"}),"\n",(0,r.jsx)(e.li,{children:"Snabbswitch - L2\uFF0C\u4F7F\u7528 Lua \u7F16\u5199\u7684\u6846\u67B6\uFF0C\u5BF9\u7F51\u5361\u7F16\u7A0B\uFF0C\u7ED5\u8FC7\u5185\u6838\u7F51\u7EDC\u6808"}),"\n",(0,r.jsx)(e.li,{children:"DPDK"}),"\n",(0,r.jsx)(e.li,{children:"Netmap"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://geekflare.com/open-source-load-balancer",children:"10 Open Source Load Balancer for HA and Improved Performance"})}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/iqiyi/dpvs",children:"iqiyi/dpvs"})," - high performance Layer-4 load balancer based on DPDK"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://news.ycombinator.com/item?id=13354546",children:"Building a Billion User Load Balancer"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u7B56\u7565",children:"\u7B56\u7565"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"roundrobin"}),"\n",(0,r.jsx)(e.li,{children:"WRR - \u52A0\u6743\u8F6E\u8BAD"}),"\n",(0,r.jsx)(e.li,{children:"SMA - simple moving average"}),"\n",(0,r.jsxs)(e.li,{children:["ewma - Exponentially Weighted Moving Average - \u6307\u6570\u52A0\u6743\u79FB\u52A8\u5E73\u5747\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5206\u6790\u548C\u9884\u6D4B\u65F6\u95F4\u5E8F\u5217\u6570\u636E"}),"\n",(0,r.jsx)(e.li,{children:"adopted by Linkerd, Apisix, NGINX Ingress"}),"\n",(0,r.jsxs)(e.li,{children:["\u4F18\u70B9\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u53CD\u5E94\u901F\u5EA6\u5FEB"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u7F3A\u70B9\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u8FB9\u754C\u6548\u5E94"}),"\n",(0,r.jsx)(e.li,{children:"\u6EDE\u540E\u6027"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://linkerd.io/2016/03/16/beyond-round-robin-load-balancing-for-latency/",children:"https://linkerd.io/2016/03/16/beyond-round-robin-load-balancing-for-latency/"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://doczhcn.gitbook.io/linkerd/index-1/beyond-round-robin-load-balancing-for-latency",children:"https://doczhcn.gitbook.io/linkerd/index-1/beyond-round-robin-load-balancing-for-latency"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Peak EWMA\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u4E13\u95E8\u8BBE\u8BA1\u6765\u8DDF\u8E2A\u548C\u5E73\u6ED1\u6570\u636E\u5E8F\u5217\u4E2D\u7684\u5CF0\u503C\u3002"}),"\n",(0,r.jsx)(e.li,{children:"\u5B83\u5728\u5904\u7406\u5177\u6709\u5C16\u5CF0\u6216\u6781\u7AEF\u503C\u7684\u65F6\u95F4\u5E8F\u5217\u6570\u636E\u65F6\u7279\u522B\u6709\u7528\uFF0C\u6BD4\u5982\u7F51\u7EDC\u6D41\u91CF\u3001\u4EA4\u6613\u91CF\u6216\u8D44\u6E90\u4F7F\u7528\u7387\u7B49\uFF0C\u5176\u4E2D\u5CF0\u503C\u7684\u5FEB\u901F\u68C0\u6D4B\u5BF9\u4E8E\u7CFB\u7EDF\u76D1\u63A7\u3001\u9884\u8B66\u548C\u8D44\u6E90\u89C4\u5212\u81F3\u5173\u91CD\u8981\u3002"}),"\n",(0,r.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://twitter.github.io/finagle/guide/Clients.html#power-of-two-choices-p2c-peak-ewma",children:"https://twitter.github.io/finagle/guide/Clients.html#power-of-two-choices-p2c-peak-ewma"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/envoyproxy/envoy/issues/20907",children:"envoyproxy/envoy#20907"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/haproxy/haproxy/issues/1570",children:"haproxy#1570"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"least_conn"}),"\n",(0,r.jsx)(e.li,{children:"chash"}),"\n",(0,r.jsx)(e.li,{children:"aperture"}),"\n",(0,r.jsx)(e.li,{children:"p2c - power of two choices"}),"\n",(0,r.jsxs)(e.li,{children:["HAProxy ",(0,r.jsx)(e.a,{href:"https://docs.haproxy.org/2.9/configuration.html#4.2-balance",children:"balance"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"roundrobin, static-rr, leastconn, first, hash, source, uri, url_param, hdr, random, rdp-cookie, log-hash, sticky"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["Finagle ",(0,r.jsx)(e.a,{href:"https://twitter.github.io/finagle/guide/Clients.html#load-balancing",children:"Load Balancing"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u8BA1\u7B97\u578B\u573A\u666F"}),"\n",(0,r.jsx)(e.li,{children:"Heap + Least Loaded"}),"\n",(0,r.jsx)(e.li,{children:"P2C + {Least Loaded, Peak EWMA}"}),"\n",(0,r.jsx)(e.li,{children:"Aperture + Least Loaded"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"# https://flugel.it/kubernetes/kubernetes-nginx-ingress-consistent-hash-subset-load-balancer/\nnginx.ingress.kubernetes.io/load-balance: ewma\nnginx.ingress.kubernetes.io/upstream-hash-by: ewma\n"})}),"\n",(0,r.jsx)(e.h2,{id:"note",children:"NOTE"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["LB \u9700\u8981\u8003\u8651\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u652F\u6301\u7684\u534F\u8BAE\u5C42\u7EA7"}),"\n",(0,r.jsx)(e.li,{children:"\u652F\u6301\u7684\u5E94\u7528\u534F\u8BAE"}),"\n",(0,r.jsx)(e.li,{children:"\u652F\u6301\u7684\u8D1F\u8F7D\u6743\u91CD\u56E0\u5B50"}),"\n"]}),"\n"]}),"\n"]})]})}function h(n={}){let{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},17776:function(n,e,i){i.d(e,{R:()=>t,x:()=>a});var l=i(7378);let r={},s=l.createContext(r);function t(n){let e=l.useContext(s);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),l.createElement(s.Provider,{value:e},n.children)}}}]);