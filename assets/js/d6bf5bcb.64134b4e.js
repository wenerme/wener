"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["91670"],{89296:function(n,a,e){e.r(a),e.d(a,{frontMatter:()=>s,toc:()=>c,default:()=>g,metadata:()=>r,assets:()=>o,contentTitle:()=>t});var r=JSON.parse('{"id":"service/observability/grafana/README","title":"Grafana","description":"- \u8981\u6C42","source":"@site/../notes/service/observability/grafana/README.md","sourceDirName":"service/observability/grafana","slug":"/service/observability/grafana/","permalink":"/notes/service/observability/grafana/","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/observability/grafana/README.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1684666307000,"frontMatter":{"title":"Grafana"},"sidebar":"docs","previous":{"title":"goaccess","permalink":"/notes/service/observability/goaccess"},"next":{"title":"Grafana \u914D\u7F6E","permalink":"/notes/service/observability/grafana/conf"}}'),l=e(86106),i=e(17776);let s={title:"Grafana"},t="Grafana",o={},c=[{value:"plugins",id:"plugins",level:2},{value:"FAQ",id:"faq",level:2},{value:"msg=&quot;Failed to look up user based on cookie&quot; logger=context error=&quot;user token not found&quot;",id:"msgfailed-to-look-up-user-based-on-cookie-loggercontext-erroruser-token-not-found",level:2}];function d(n){let a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.header,{children:(0,l.jsx)(a.h1,{id:"grafana",children:"Grafana"})}),"\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsxs)(a.li,{children:["\u8981\u6C42\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsx)(a.li,{children:"255 MB\uFF0C1 CPU"}),"\n",(0,l.jsxs)(a.li,{children:["\u6570\u636E\u5E93\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsx)(a.li,{children:"SQLite"}),"\n",(0,l.jsx)(a.li,{children:"MySQL"}),"\n",(0,l.jsx)(a.li,{children:"PostgreSQL"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(a.li,{children:(0,l.jsx)(a.a,{href:"https://grafana.com/grafana/plugins",children:"\u63D2\u4EF6\u5217\u8868"})}),"\n",(0,l.jsxs)(a.li,{children:["\u652F\u6301\u6388\u6743\u65B9\u5F0F\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsx)(a.li,{children:"basic\u3001generic oauth\u3001anonymous\u3001azuread\u3001github\u3001gitlab\u3001google\u3001grafana_com\u3001grafananet\u3001ldap\u3001okta\u3001proxy\u3001saml"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(a.li,{children:["\u4F01\u4E1A\u7248\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsx)(a.li,{children:"\u6570\u636E\u6E90\u6743\u9650"}),"\n",(0,l.jsx)(a.li,{children:"\u62A5\u8868"}),"\n",(0,l.jsx)(a.li,{children:"SAML"}),"\n",(0,l.jsx)(a.li,{children:"\u589E\u5F3A LDAP"}),"\n",(0,l.jsx)(a.li,{children:"\u56E2\u961F\u540C\u6B65 - LDAP, GitHub OAuth, Auth Proxy, Okta - Grafana \u4F5C\u4E3A IdP"}),"\n",(0,l.jsx)(a.li,{children:"White labeling"}),"\n",(0,l.jsx)(a.li,{children:"\u4F7F\u7528\u7EDF\u8BA1"}),"\n",(0,l.jsx)(a.li,{children:"\u9762\u677F\u70ED\u95E8\u6392\u5E8F"}),"\n",(0,l.jsx)(a.li,{children:"\u67E5\u627E\u672A\u4F7F\u7528\u9762\u677F"}),"\n",(0,l.jsx)(a.li,{children:"\u4F01\u4E1A\u63D2\u4EF6 - Oracle\u3001Splunk\u3001Service Now\u3001Dynatrace\u3001DataDog\u3001AppDynamics"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(a.admonition,{type:"caution",children:(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsxs)(a.li,{children:["Conditional formatting ",(0,l.jsx)(a.a,{href:"https://github.com/grafana/grafana/issues/11418",children:"#11418"})]}),"\n",(0,l.jsxs)(a.li,{children:["Legend \u65E0\u6CD5\u683C\u5F0F\u5316\uFF0C\u4F7F\u7528 prometheus \u53EF\u4EE5\u4FEE\u6539 label\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsx)(a.li,{children:(0,l.jsx)(a.code,{children:'label_replace(my_vector, "short_hostname", "$1", "hostname", "(.*):.*")'})}),"\n",(0,l.jsx)(a.li,{children:(0,l.jsx)(a.code,{children:'label_replace(up{instance=~"$instance"}, "instance_ip", "$2", "instance", "(192[.]168[.])?([0-9.+]+|.*).*")'})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(a.li,{children:["\u65E0\u6CD5\u9690\u85CF Table \u7684 Filter for value ",(0,l.jsx)(a.a,{href:"https://github.com/grafana/grafana/issues/11170",children:"#11170"})]}),"\n",(0,l.jsx)(a.li,{children:"OAuth \u65E0\u6CD5\u5173\u8054 org"}),"\n",(0,l.jsx)(a.li,{children:"LDAP \u53EF\u80FD\u662F\u552F\u4E00\u591A\u79DF\u6237\u767B\u9646\u65B9\u4FBF\u7684\u65B9\u5F0F - \u6216\u8005\u6BCF\u4E2A\u79DF\u6237\u90E8\u7F72\u4E00\u4E2A"}),"\n",(0,l.jsx)(a.li,{children:"Dashboard Value Mapping \u4E0D\u652F\u6301\u6587\u672C\u5339\u914D"}),"\n"]})}),"\n",(0,l.jsx)(a.pre,{children:(0,l.jsx)(a.code,{className:"language-bash",children:'brew install grafana\n\n# \u624B\u52A8\u5B89\u88C5\nwget https://dl.grafana.com/oss/release/grafana-7.1.1.darwin-amd64.tar.gz\ntar -zxvf grafana-7.1.1.darwin-amd64.tar.gz\n\n# docker\n# https://grafana.com/docs/grafana/latest/installation/docker/\n# \u63D2\u4EF6\n# -e "GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource"\n# \u53EF\u6307\u5B9A\u7248\u672C\n# -e "GF_INSTALL_PLUGINS=grafana-clock-panel 1.0.1,grafana-simple-json-datasource 1.3.5"\n# \u81EA\u5B9A\u4E49\u6765\u6E90\n# -e "GF_INSTALL_PLUGINS=http://plugin-domain.com/my-custom-plugin.zip;custom-plugin"\n# \u9ED8\u8BA4\u914D\u7F6E /usr/share/grafana/conf/defaults.ini /etc/grafana/grafana.ini\n# default.paths.data=/var/lib/grafana\n# default.paths.logs=/var/log/grafana\n# default.paths.plugins=/var/lib/grafana/plugins\n# default.paths.provisioning=/etc/grafana/provisioning\n# default.log.mode=console\ndocker run --rm -it -e TZ=Asia/Shanghai \\\n  -p 3000:3000 \\\n  --name=grafana grafana/grafana\n\n# \u9ED8\u8BA4\u670D\u52A1\u7AEF\u914D\u7F6E\ngrafana-server \\\n  --config=/opt/grafana/grafana.ini \\\n  --homepath /usr/local/share/grafana \\\n  --packaging=brew cfg:default.paths.logs=/usr/local/var/log/grafana cfg:default.paths.data=/usr/local/var/lib/grafana cfg:default.paths.plugins=/usr/local/var/lib/grafana/plugins\n\n# \u542F\u52A8\u670D\u52A1\nbrew services start grafana\n\ncode /opt/grafana/grafana.ini\ngrafana-server --config /opt/grafana/grafana.ini --homepath /usr/local/share/grafana --packaging=brew\n'})}),"\n",(0,l.jsx)(a.p,{children:(0,l.jsx)(a.strong,{children:"\u57FA\u672C\u914D\u7F6E"})}),"\n",(0,l.jsx)(a.pre,{children:(0,l.jsx)(a.code,{className:"language-ini",children:"[path]\ndata = /opt/grafana\nlogs = /opt/grafana\nplugins = /usr/local/var/lib/grafana/plugins\n\n[server]\nhttp_port = 3030\n\n[database]\ntype=sqlite3\n\n[remote_cache]\n\n[analytics]\n# \u5173\u95ED telemetry\nreporting_enabled = false\n"})}),"\n",(0,l.jsx)(a.h2,{id:"plugins",children:"plugins"}),"\n",(0,l.jsxs)(a.ul,{children:["\n",(0,l.jsx)(a.li,{children:(0,l.jsx)(a.a,{href:"https://grafana.com/grafana/plugins/",children:"https://grafana.com/grafana/plugins/"})}),"\n",(0,l.jsx)(a.li,{children:"grafana-clock-panel"}),"\n",(0,l.jsx)(a.li,{children:"grafana-polystat-panel"}),"\n",(0,l.jsx)(a.li,{children:"marcusolsson-hexmap-panel"}),"\n"]}),"\n",(0,l.jsx)(a.h2,{id:"faq",children:"FAQ"}),"\n",(0,l.jsx)(a.h2,{id:"msgfailed-to-look-up-user-based-on-cookie-loggercontext-erroruser-token-not-found",children:'msg="Failed to look up user based on cookie" logger=context error="user token not found"'})]})}function g(n={}){let{wrapper:a}={...(0,i.R)(),...n.components};return a?(0,l.jsx)(a,{...n,children:(0,l.jsx)(d,{...n})}):d(n)}},17776:function(n,a,e){e.d(a,{R:()=>s,x:()=>t});var r=e(7378);let l={},i=r.createContext(l);function s(n){let a=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(a):{...a,...n}},[a,n])}function t(n){let a;return a=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:s(n.components),r.createElement(i.Provider,{value:a},n.children)}}}]);