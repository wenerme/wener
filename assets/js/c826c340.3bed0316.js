"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["83769"],{38298:function(e,s,n){n.r(s),n.d(s,{frontMatter:()=>l,toc:()=>o,default:()=>u,metadata:()=>t,assets:()=>c,contentTitle:()=>a});var t=JSON.parse('{"id":"service/storage/s3/s3fs","title":"s3fs","description":"- use_cache \u4F1A\u7F13\u5B58\u6574\u4E2A\u6587\u4EF6\u800C\u4E0D\u662F\u8BBF\u95EE\u5230\u7684\u90E8\u5206","source":"@site/../notes/service/storage/s3/s3fs.md","sourceDirName":"service/storage/s3","slug":"/service/storage/s3/s3fs","permalink":"/notes/service/storage/s3/s3fs","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/storage/s3/s3fs.md","tags":[{"inline":true,"label":"FUSE","permalink":"/notes/tags/fuse"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1741072966000,"frontMatter":{"tags":["FUSE"]},"sidebar":"docs","previous":{"title":"garage","permalink":"/notes/service/storage/s3/garage"},"next":{"title":"versitygw","permalink":"/notes/service/storage/s3/versitygw"}}'),r=n(86106),i=n(17776);let l={tags:["FUSE"]},a="s3fs",c={},o=[];function d(e){let s={a:"a",admonition:"admonition",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"s3fs",children:"s3fs"})}),"\n",(0,r.jsx)(s.admonition,{type:"caution",children:(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["use_cache \u4F1A\u7F13\u5B58\u6574\u4E2A\u6587\u4EF6\u800C\u4E0D\u662F\u8BBF\u95EE\u5230\u7684\u90E8\u5206\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u548C \u81EA\u5DF1\u7EF4\u6301\u7F13\u5B58\u6CA1\u533A\u522B"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["s3fs \u9650\u5236 - \u6709\u4E9B\u9650\u5236\u6765\u81EA s3, \u6709\u4E9B\u9650\u5236\u6765\u81EA fuse\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"\u4E0D\u80FD append"}),"\n",(0,r.jsx)(s.li,{children:"stat \u6027\u80FD\u5DEE"}),"\n",(0,r.jsx)(s.li,{children:"\u7531\u4E8E\u5927\u591A\u5B58\u50A8\u662F\u6700\u7EC8\u4E00\u81F4\uFF0C\u53EF\u80FD\u4F1A\u5BFC\u81F4 stale read - \u90E8\u5206 provider \u652F\u6301 read-after-write consistency"}),"\n",(0,r.jsx)(s.li,{children:"\u4E0D\u80FD\u539F\u5B50 rename"}),"\n",(0,r.jsx)(s.li,{children:"\u591A\u4E2A\u5BA2\u6237\u7AEF\u4E0D\u80FD\u4FDD\u6301\u4E00\u81F4"}),"\n",(0,r.jsx)(s.li,{children:"\u6CA1\u6709 link"}),"\n",(0,r.jsx)(s.li,{children:"\u6CA1\u6709 inotify \u529F\u80FD"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.a,{href:"https://github.com/s3fs-fuse/s3fs-fuse",children:"s3fs-fuse/s3fs-fuse"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"GPLv2, C++"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"https://github.com/s3fs-fuse/s3fs-fuse#limitations",children:"https://github.com/s3fs-fuse/s3fs-fuse#limitations"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# S3 -> FS\napk add s3fs-fuse\n\necho $ACCESS_KEY_ID:$SECRET_ACCESS_KEY > ${HOME}/.passwd-s3fs\nchmod 600 ${HOME}/.passwd-s3fs\ns3fs mybucket $PWD/mnt -o passwd_file=${HOME}/.passwd-s3fs\n\ns3fs $PWD/buckets/assets -o passwd_file=.passwd-s3fs -o use_path_request_style -o url=http://127.0.0.1:3900 -o bucket=assets -o use_cache=$PWD/cache -o max_stat_cache_size=1000000 -o endpoint=cn-sh -o enable_content_md5 -o allow_other -d -f\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-fstab",children:"mybucket /path/to/mountpoint fuse.s3fs _netdev,allow_other 0 0\n\nmybucket /path/to/mountpoint fuse.s3fs _netdev,allow_other,use_path_request_style,url=https://url.to.s3/ 0 0\n\npublic /data/public fuse.s3fs _netdev,allow_other,use_path_request_style,endpoint=garage,passwd_file=/etc/secrets/public.passwd-s3fs,retries=100,use_cache=/tmp/s3,bucket=public,url=http://127.0.0.1:3900 0 0\n"})})]})}function u(e={}){let{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},17776:function(e,s,n){n.d(s,{R:()=>l,x:()=>a});var t=n(7378);let r={},i=t.createContext(r);function l(e){let s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);