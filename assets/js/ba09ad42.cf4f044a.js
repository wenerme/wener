"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["618729"],{513191:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>d,toc:()=>t,default:()=>h,metadata:()=>i,assets:()=>o,contentTitle:()=>c});var i=JSON.parse('{"id":"web/nodejs/nodejs-faq","title":"NodeJS FAQ","description":"- \u6301\u4E45\u5316 DB \u5B58\u50A8\u662F NodeJS \u7684\u5F31\u9879","source":"@site/../notes/web/nodejs/nodejs-faq.md","sourceDirName":"web/nodejs","slug":"/web/nodejs/faq","permalink":"/notes/web/nodejs/faq","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/nodejs/nodejs-faq.md","tags":[{"inline":true,"label":"FAQ","permalink":"/notes/tags/faq"}],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1767451770000,"frontMatter":{"title":"NodeJS FAQ","tags":["FAQ"]},"sidebar":"docs","previous":{"title":"Debug","permalink":"/notes/web/nodejs/debug"},"next":{"title":"NodeJS \u7248\u672C","permalink":"/notes/web/nodejs/version"}}'),l=s(486106),r=s(917776);let d={title:"NodeJS FAQ",tags:["FAQ"]},c="NodeJS FAQ",o={},t=[{value:"typescript",id:"typescript",level:2},{value:"env",id:"env",level:2},{value:"Tool Chain",id:"tool-chain",level:2},{value:"Node Dev",id:"node-dev",level:2},{value:"\u9009\u62E9\u5305\u7BA1\u7406\u5668",id:"choose-pm",level:2},{value:"shebang",id:"shebang",level:2},{value:"performance",id:"performance",level:2},{value:"musl",id:"musl",level:2},{value:"sqlite3",id:"sqlite3",level:2},{value:"source map",id:"source-map",level:2},{value:"cjs <code>__dirname</code>",id:"cjs-__dirname",level:2},{value:"\u76F4\u63A5\u6267\u884C typescript \u6216 esnext",id:"\u76F4\u63A5\u6267\u884C-typescript-\u6216-esnext",level:2},{value:"Package &#39;OpenEXR&#39;, required by &#39;vips&#39;, not found",id:"package-openexr-required-by-vips-not-found",level:2},{value:"libtool: unrecognized option -static when building",id:"libtool-unrecognized-option--static-when-building",level:2},{value:"require() of ES modules is not supported",id:"require-of-es-modules-is-not-supported",level:2},{value:"NodeJS v18 fetch proxy",id:"nodejs-v18-fetch-proxy",level:2},{value:"RequestInit: duplex option is required when sending a body",id:"requestinit-duplex-option-is-required-when-sending-a-body",level:2},{value:"Critical dependency: require function is used in a way in which dependencies cannot be statically extracted",id:"critical-dependency-require-function-is-used-in-a-way-in-which-dependencies-cannot-be-statically-extracted",level:2},{value:"Undefined variable module_name in binding.gyp while trying to load binding.gyp",id:"undefined-variable-module_name-in-bindinggyp-while-trying-to-load-bindinggyp",level:2},{value:"Custom ESM Loaders is an experimental feature. This feature could change at any time",id:"custom-esm-loaders-is-an-experimental-feature-this-feature-could-change-at-any-time",level:2},{value:"Reached heap limit Allocation failed - JavaScript heap out of memory",id:"reached-heap-limit-allocation-failed---javascript-heap-out-of-memory",level:2},{value:"Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory",id:"ineffective-mark-compacts-near-heap-limit-allocation-failed---javascript-heap-out-of-memory",level:2},{value:"Can&#39;t resolve &#39;pg-native&#39;",id:"cant-resolve-pg-native",level:2},{value:"REPL load",id:"repl-load",level:2},{value:"error:0308010C envelope routines::unsupported",id:"error0308010c-envelope-routinesunsupported",level:2},{value:"snapshot / compile",id:"snapshot--compile",level:2},{value:"fastify vs express",id:"fastify-vs-express",level:2},{value:"import npm global",id:"import-npm-global",level:2},{value:"ERR_OSSL_EVP_UNSUPPORTED",id:"err_ossl_evp_unsupported",level:2},{value:"getaddrinfo ENOTFOUND undefined",id:"getaddrinfo-enotfound-undefined",level:2},{value:"\u547D\u4EE4\u884C\u83B7\u53D6 package \u6240\u5728\u76EE\u5F55",id:"\u547D\u4EE4\u884C\u83B7\u53D6-package-\u6240\u5728\u76EE\u5F55",level:2},{value:"ioredis vs redis",id:"ioredis-vs-redis",level:2},{value:"The operation failed for an operation-specific reason: Cipher job failed",id:"the-operation-failed-for-an-operation-specific-reason-cipher-job-failed",level:2},{value:"Failed to execute &#39;digest&#39; on &#39;SubtleCrypto&#39;: 2nd argument is not instance of ArrayBuffer, Buffer, TypedArray, or DataView.",id:"failed-to-execute-digest-on-subtlecrypto-2nd-argument-is-not-instance-of-arraybuffer-buffer-typedarray-or-dataview",level:2},{value:"detect runtime",id:"detect-runtime",level:2},{value:"unhandled",id:"unhandled",level:2},{value:"The &quot;windows-1252&quot; encoding is not supported",id:"the-windows-1252-encoding-is-not-supported",level:2},{value:"Download",id:"download",level:2},{value:"shell scripting",id:"shell-scripting",level:2},{value:"RSA_PKCS1_PADDING is no longer supported for private decryption at privateDecrypt (native) at decrypt",id:"rsa_pkcs1_padding-is-no-longer-supported-for-private-decryption-at-privatedecrypt-native-at-decrypt",level:2},{value:"Error ShellJSInternalError: spawn EBADF",id:"error-shelljsinternalerror-spawn-ebadf",level:2},{value:"The requested module &#39;globby&#39; does not provide an export named &#39;globby&#39;",id:"the-requested-module-globby-does-not-provide-an-export-named-globby",level:2}];function a(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"nodejs-faq",children:"NodeJS FAQ"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6301\u4E45\u5316 DB \u5B58\u50A8\u662F NodeJS \u7684\u5F31\u9879\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5B98\u65B9 \u6B63\u5728\u5C1D\u8BD5\u652F\u6301\u96C6\u6210 SQLite\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"v22.5.0+"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"node:sqlite"})}),"\n",(0,l.jsx)(n.li,{children:"--experimental-sqlite"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://nodejs.org/api/sqlite.html",children:"Node.js SQLite API"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u7EAF JS \u6CA1\u6709\u597D\u7684\u5B58\u50A8\u5B9E\u73B0"}),"\n",(0,l.jsx)(n.li,{children:"SQLite \u4F9D\u8D56 addon"}),"\n",(0,l.jsx)(n.li,{children:"SQLite over WASM \u8FD8\u4E0D\u6210\u719F"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/knex/knex/issues/6162",children:"knex#6162"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["FFI \u662F NodeJS \u7684\u5F31\u9879\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53EF\u4EE5\u5C1D\u8BD5 bun:ffi"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/zhangyuang/node-ffi-rs",children:"zhangyuang/node-ffi-rs"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"MIT, Rust, JS"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/Koromix/koffi",children:"Koromix/koffi"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["source ",(0,l.jsx)(n.a,{href:"https://github.com/Koromix/rygel/tree/master/src/koffi",children:"https://github.com/Koromix/rygel/tree/master/src/koffi"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/pull/46905",children:"nodejs/node#46905"})," ffi implementation"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/46233",children:"nodejs/node#46233 Reconsider adding FFI to the core"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"tinycc does not support all of the platforms that node does"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"import.meta.main"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/pull/32223",children:"nodejs/node#32223"})}),"\n",(0,l.jsxs)(n.li,{children:["\u4EE5\u524D ",(0,l.jsx)(n.code,{children:"require.main"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"module === process.mainModule"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"NODE_COMPILE_CACHE"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npx envinfo --binaries --system\n\n# native \u7684 module\nfind node_modules -name '*.node'\n"})}),"\n",(0,l.jsx)(n.h2,{id:"typescript",children:"typescript"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["2024\u5E744\u6708 Node v22+ \u652F\u6301\u76F4\u63A5\u8FD0\u884C typescript\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"--experimental-strip-types"})}),"\n",(0,l.jsx)(n.li,{children:"\u6CE8\u610F\u53EA\u662F strip types"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u652F\u6301 enum, namespace, experimentalDecorators, emitDecoratorMetadata \u7B49\u9700\u8981 transpile \u7684\u7279\u6027"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"env",children:"env"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"NODE_OPTIONS"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"tool-chain",children:"Tool Chain"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9759\u6001\u9879\u76EE - ViteJS"}),"\n",(0,l.jsxs)(n.li,{children:["\u524D\u7AEF\u9879\u76EE - NextJS+trpc+NestJS - \u590D\u6742\u9879\u76EE\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u90E8\u5206 NestJS \u903B\u8F91\u5171\u7528"}),"\n",(0,l.jsx)(n.li,{children:"\u8F93\u51FA standalone \u6A21\u5F0F - \u76F4\u63A5\u62F7\u8D1D\u5230\u5BB9\u5668\u5373\u53EF"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u540E\u7AEF\u9879\u76EE - NestJS+fastify\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5F00\u53D1: ts-node --swc --esm --transpileOnly --watch src/main.ts\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"tsx \u4E0D\u652F\u6301 decorator\uFF0C\u4E0D\u7136\u53EF\u4EE5\u7528 tsx"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u6784\u5EFA: esbuild --bundle --external=sharp src/main.ts\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u8F93\u51FA\u4E00\u4E2A js \u653E\u5230\u5BB9\u5668\u5373\u53EF"}),"\n",(0,l.jsx)(n.li,{children:"\u6CE8\u610F\u52A0 tsc \u63D2\u4EF6\u5904\u7406 decorator"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u57FA\u7840\u4F9D\u8D56\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"zod"}),"\n",(0,l.jsx)(n.li,{children:"valtio, zustand"}),"\n",(0,l.jsx)(n.li,{children:"daisyui, styled-components"}),"\n",(0,l.jsx)(n.li,{children:"dayjs"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"pnpm node --loader ts-node/esm --watch ./src/apps/ve-contract-server/main.ts\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",metastring:'title="tsconfig.json"',children:'{\n  "ts-node": {\n    "transpileOnly": true,\n    "swc": true,\n    "esm": true,\n    "files": true,\n    "experimentalSpecifierResolution": "node"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"node-dev",children:"Node Dev"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ts+watch - tsx, ts-node, swc-node\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["+decorator\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"ts-node+swc"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["+tsconfig.paths\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"tsx, ts-node+tsconfig-paths"}),"\n",(0,l.jsxs)(n.li,{children:["+esm\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"tsx"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u76EE\u524D\u8FD8\u6CA1\u6709 esm+tsconfig.paths+decorator \u7684"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ts-node+swc \u95EE\u9898\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4E0D\u52A0\u8F7D swcrc \u5BFC\u81F4 paths \u65E0\u6548 ",(0,l.jsx)(n.a,{href:"https://github.com/TypeStrong/ts-node/issues/1856",children:"https://github.com/TypeStrong/ts-node/issues/1856"})]}),"\n",(0,l.jsx)(n.li,{children:"pnpm patch \u4E34\u65F6\u89E3\u51B3"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["esbuild decorator \u95EE\u9898\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/evanw/esbuild/issues/104",children:"https://github.com/evanw/esbuild/issues/104"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nuxt/nuxt/issues/21756",children:"https://github.com/nuxt/nuxt/issues/21756"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/unjs/nitro/issues/1345",children:"https://github.com/unjs/nitro/issues/1345"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["swc-node \u5904\u7406 .ts \u95EE\u9898\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/swc-project/swc-node/pull/744",children:"https://github.com/swc-project/swc-node/pull/744"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/swc-project/swc-node/issues/710",children:"https://github.com/swc-project/swc-node/issues/710"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["tsconfig-paths esm \u95EE\u9898\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/dividab/tsconfig-paths/issues/243",children:"https://github.com/dividab/tsconfig-paths/issues/243"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"choose-pm",children:"\u9009\u62E9\u5305\u7BA1\u7406\u5668"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u9009\u62E9 pnpm"}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["pnpm\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u901F\u5EA6\u5FEB"}),"\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528 hardlink - \u8282\u7701\u7A7A\u95F4\uFF0C\u901F\u5EA6\u5FEB\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5982\u679C\u5728 wsl \u53EF\u80FD\u7528\u4E0D\u4E86 hardlink\uFF0C\u56DE\u9000\u4E3A softlink \u6216\u8005 copy \u65B9\u5F0F"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u610F\u5916\u60C5\u51B5\u6BD4\u8F83\u5C11"}),"\n",(0,l.jsx)(n.li,{children:"workspace \u652F\u6301\u5B8C\u5584"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["npm\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"node_modules \u592A\u5927"}),"\n",(0,l.jsx)(n.li,{children:"\u5B89\u88C5\u6162"}),"\n",(0,l.jsx)(n.li,{children:"\u5982\u679C pnpm \u4E0D\u517C\u5BB9\u7684\u60C5\u51B5\u53EF\u4EE5\u8003\u8651 npm"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["yarn v1\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6BD4 npm \u597D\u4E00\u70B9 - \u533A\u522B\u8D8A\u6765\u8D8A\u5C0F"}),"\n",(0,l.jsx)(n.li,{children:"\u652F\u6301 workspace"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["yarn berry\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5F88\u591A\u5DE5\u5177\u4E0D\u652F\u6301"}),"\n",(0,l.jsx)(n.li,{children:"pnp \u65B9\u5F0F\u751F\u6001\u63A8\u8FDB\u6162"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u5EFA\u8BAE\u4F7F\u7528"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"shebang",children:"shebang"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"CJS"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"#!/usr/bin/env node\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"ESM"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'#!/usr/bin/env bash\n":" //# comment\nexec /usr/bin/env node --input-type=module - "$@" < "$0"\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"NodeJS 20.10+"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"node --experimental-default-type=module cli\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"node --input-type=module --eval 'console.log(\"Hello, world!\")'\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["ESM\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u589E\u52A0 mjs \u6587\u4EF6\u540E\u7F00\u5373\u53EF"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/49444",children:"https://github.com/nodejs/node/issues/49444"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/orgs/nodejs/discussions/37857",children:"https://github.com/orgs/nodejs/discussions/37857"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"--experimental-default-type"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"performance",children:"performance"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["UV_THREADPOOL_SIZE=4\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6700\u5927 1024"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["knex\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"pool min:2, max: 10"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"fastify"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/fastify/fast-json-stringify",children:"fast-json-stringify"})}),"\n",(0,l.jsx)(n.li,{children:"find-my-way"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"musl",children:"musl"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u975E\u5B98\u65B9\u6784\u5EFA ",(0,l.jsx)(n.a,{href:"https://unofficial-builds.nodejs.org/download/release/v20.11.1/",children:"https://unofficial-builds.nodejs.org/download/release/v20.11.1/"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6784\u5EFA\u4ED3\u5E93 ",(0,l.jsx)(n.a,{href:"https://github.com/nodejs/unofficial-builds",children:"nodejs/unofficial-builds"})]}),"\n",(0,l.jsx)(n.li,{children:"\u53EA\u6709 x64-musl"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["arm64/aarch64\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6682\u65E0"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/pull/45756",children:"https://github.com/nodejs/node/pull/45756"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/unofficial-builds/pull/59",children:"https://github.com/nodejs/unofficial-builds/pull/59"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/unofficial-builds/issues/104",children:"nodejs/unofficial-builds#104"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"sqlite3",children:"sqlite3"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# ./node_modules/sqlite3/build/Release/node_sqlite3.node\nfind ./node_modules/sqlite3/ -iname '*.node'\n\nnpm install sqlite3 --build-from-source\n"})}),"\n",(0,l.jsx)(n.h2,{id:"source-map",children:"source map"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"sourcemap \u5927\u4E86\u8FC7\u540E\u975E\u5E38\u6162"}),"\n",(0,l.jsxs)(n.li,{children:["\u4F8B\u5982: main.mjs 10mb, main.mjs.map 20mb\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"--enable-source-maps \u542F\u52A8 40s"}),"\n",(0,l.jsx)(n.li,{children:"\u76F4\u63A5\u542F\u52A8 2s"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"-r @cspotcode/source-map-support/register"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["NodeJS 12.12.0 ",(0,l.jsx)(n.a,{href:"https://nodejs.org/docs/latest-v16.x/api/cli.html#--enable-source-maps",children:"--enable-source-maps"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/evanw/node-source-map-support",children:"https://github.com/evanw/node-source-map-support"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/cspotcode/source-map-performance-demo#example-output",children:"https://github.com/cspotcode/source-map-performance-demo#example-output"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/cspotcode/node-source-map-support",children:"https://github.com/cspotcode/node-source-map-support"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6027\u80FD\u66F4\u597D"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["esbuild\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6392\u9664 node_modules ",(0,l.jsx)(n.a,{href:"https://github.com/evanw/esbuild/issues/1685#issuecomment-944916409",children:"https://github.com/evanw/esbuild/issues/1685#issuecomment-944916409"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u6392\u9664 sourcesContent\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5305\u542B\u5B8C\u6574 source code - \u5982\u679C\u53EA\u7528\u4E8E stack trace \u5219\u4E0D\u9700\u8981"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://esbuild.github.io/api/#sources-content",children:"https://esbuild.github.io/api/#sources-content"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"import '@cspotcode/source-map-support/register';\n"})}),"\n",(0,l.jsxs)(n.h2,{id:"cjs-__dirname",children:["cjs ",(0,l.jsx)(n.code,{children:"__dirname"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"import * as url from 'url';\nconst __filename = url.fileURLToPath(import.meta.url);\nconst __dirname = url.fileURLToPath(new URL('.', import.meta.url));\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u76F4\u63A5\u6267\u884C-typescript-\u6216-esnext",children:"\u76F4\u63A5\u6267\u884C typescript \u6216 esnext"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"tsx"}),"\n",(0,l.jsx)(n.li,{children:"ts-node"}),"\n",(0,l.jsx)(n.li,{children:"babel"}),"\n",(0,l.jsx)(n.li,{children:"tsm"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# tsx\n# ==========\nnpx tsx app.ts\nnode --loader tsx app.ts\nnode --loader @esbuild-kit/esm-loader app.ts\n\n# ts-node\n# ==========\nnode -r @ts-node/register app.ts\n# tsconfig \u91CC\u7684 path \u80FD\u751F\u6548\nnode -r @ts-node/register -r tsconfig-paths/register app.ts\n\n# babel\n# ==========\nnode -r @babel/register app.js\n"})}),"\n",(0,l.jsx)(n.h2,{id:"package-openexr-required-by-vips-not-found",children:"Package 'OpenEXR', required by 'vips', not found"}),"\n",(0,l.jsx)(n.p,{children:"\u627E\u4E0D\u5230 brew \u5B89\u88C5\u7684 pkgconfig"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"PKG_CONFIG_PATH=/usr/local/opt/vips/lib/pkgconfig:/usr/local/opt/glib/lib/pkgconfig:/usr/local/opt/openexr/lib/pkgconfig:/usr/local/opt/imath/lib/pkgconfig npm i\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"/usr/local/include/vips/vips8:35:10: fatal error: 'glib-object.h' file not found\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# export CC\nexport CXX="$(which g++) -I/usr/local/opt/glib/include/glib-2.0/ -I/usr/local/opt/glib/lib/glib-2.0/include/"\n\nexport CXX="$(which g++) $(pkg-config --cflags glib-2.0)"\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"sharp -> libvips version 8.12.2+ is required"}),"\n",(0,l.jsxs)(n.li,{children:["ubuntu 22.04 jammy\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://packages.ubuntu.com/search?searchon=sourcenames&keywords=vips",children:"https://packages.ubuntu.com/search?searchon=sourcenames&keywords=vips"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"libtool-unrecognized-option--static-when-building",children:"libtool: unrecognized option -static when building"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"libtool:   error: unrecognised option: '-static'\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"brew unlink libtool\nrm -rf /usr/local/bin/libtool\nwhich libtool\n\n# \u5982\u679C\u6DFB\u52A0\u4E86 /usr/local/opt/libtool/libexec/gnubin\nexport PATH=$(echo $PATH | sed -r 's/:[^:]*?libtool[^:]*:/:/')\n"})}),"\n",(0,l.jsx)(n.h2,{id:"require-of-es-modules-is-not-supported",children:"require() of ES modules is not supported"}),"\n",(0,l.jsx)(n.p,{children:"\u5C1D\u8BD5\u964D\u7EA7\u4F9D\u8D56"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:'ts \u53EF\u914D\u7F6E "module": "esnext"'}),"\n",(0,l.jsxs)(n.li,{children:["\u7136\u540E package.json \u4FEE\u6539 type: module\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5F71\u54CD\u5F88\u5927"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/node-fetch/node-fetch/issues/1266",children:"node-fetch/node-fetch#1266"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"nodejs-v18-fetch-proxy",children:"NodeJS v18 fetch proxy"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u4E0D\u652F\u6301 Agent"}),"\n",(0,l.jsx)(n.li,{children:"\u7528 node-fetch \u6216\u8005 undici"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"const Undici = requuire('undici');\nconst ProxyAgent = Undici.ProxyAgent;\nconst setGlobalDispatcher = Undici.setGlobalDispatcher;\n\nsetGlobalDispatcher(new ProxyAgent(process.env.HTTP_PROXY));\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/43187",children:"node#43187"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/gajus/global-agent/issues/52#issuecomment-1134525621",children:"gajus/global-agent#52"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"requestinit-duplex-option-is-required-when-sending-a-body",children:"RequestInit: duplex option is required when sending a body"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"TypeError: Cannot set property duplex of #<Request> which has only a getter\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"let init: RequestInit & Record<string, any> = {\n  get duplex() {\n    return 'half';\n  },\n};\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/46221",children:"https://github.com/nodejs/node/issues/46221"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/whatwg/fetch/issues/1254",children:"https://github.com/whatwg/fetch/issues/1254"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"critical-dependency-require-function-is-used-in-a-way-in-which-dependencies-cannot-be-statically-extracted",children:"Critical dependency: require function is used in a way in which dependencies cannot be statically extracted"}),"\n",(0,l.jsx)(n.p,{children:"\u68C0\u67E5\u4E0B\u662F\u4E0D\u662F import \u8DEF\u5F84\u9519\u8BEF\uFF0C\u53EF\u80FD\u56E0\u4E3A IDE \u81EA\u52A8\u5BFC\u5165\uFF0C\u6307\u5411\u4E86\u9519\u8BEF\u8DEF\u5F84\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"undefined-variable-module_name-in-bindinggyp-while-trying-to-load-bindinggyp",children:"Undefined variable module_name in binding.gyp while trying to load binding.gyp"}),"\n",(0,l.jsx)(n.p,{children:"\u53EF\u80FD npm \u95EE\u9898\uFF0C\u4F7F\u7528 pnpm \u6784\u5EFA\u6CA1\u95EE\u9898"}),"\n",(0,l.jsx)(n.h2,{id:"custom-esm-loaders-is-an-experimental-feature-this-feature-could-change-at-any-time",children:"Custom ESM Loaders is an experimental feature. This feature could change at any time"}),"\n",(0,l.jsx)(n.p,{children:"\u76EE\u524D\u65E0\u6CD5 supress \u8B66\u544A, \u53EA\u80FD\u901A\u8FC7 require \u6CE8\u5165\u907F\u514D"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"node --require suppress-experimental.cjs --loader tsx app.ts\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",metastring:'title="suppress-experimental.cjs"',children:"'use strict';\n// When using the ESM loader Node.js prints either of the following warnings\n//\n// - ExperimentalWarning: --experimental-loader is an experimental feature. This feature could change at any time\n// - ExperimentalWarning: Custom ESM Loaders is an experimental feature. This feature could change at any time\n//\n// Having this warning show up once is \"fine\" but it's also printed\n// for each Worker that is created so it ends up spamming stderr.\n// Since that doesn't provide any value we suppress the warning.\nconst originalEmit = process.emit;\n// @ts-expect-error - TS complains about the return type of originalEmit.apply\nprocess.emit = function (name, data, ...args) {\n  if (\n    name === `warning` &&\n    typeof data === `object` &&\n    data.name === `ExperimentalWarning` &&\n    (data.message.includes(`--experimental-loader`) ||\n      data.message.includes(`Custom ESM Loaders is an experimental feature`))\n  )\n    return false;\n\n  // return originalEmit.apply(process, arguments as unknown as Parameters<typeof process.emit>);\n  return originalEmit.apply(process, arguments);\n};\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/30810",children:"https://github.com/nodejs/node/issues/30810"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"reached-heap-limit-allocation-failed---javascript-heap-out-of-memory",children:"Reached heap limit Allocation failed - JavaScript heap out of memory"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'NODE_OPTIONS="--max-old-space-size=8192" eslint --fix\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"DEBUG=*"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"DEBUG=typescript-eslint"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"TIMING=1"})}),"\n",(0,l.jsxs)(n.li,{children:["max-old-space-size\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9ED8\u8BA4 4144MB"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u83B7\u53D6\u5F53\u524D\u5185\u5B58\u9650\u5236\nnode -e 'console.log(v8.getHeapStatistics().heap_size_limit/(1024*1024))'\n"})}),"\n",(0,l.jsx)(n.h2,{id:"ineffective-mark-compacts-near-heap-limit-allocation-failed---javascript-heap-out-of-memory",children:"Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u53EF\u589E\u52A0"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"node -e 'console.log(v8.getHeapStatistics().heap_size_limit/(1024*1024))'\nNODE_OPTIONS=\"--max-old-space-size=8192\" node -e 'console.log(v8.getHeapStatistics().heap_size_limit/(1024*1024))'\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"2048"}),"\n",(0,l.jsx)(n.li,{children:"4096"}),"\n",(0,l.jsx)(n.li,{children:"4144"}),"\n",(0,l.jsx)(n.li,{children:"5120"}),"\n",(0,l.jsx)(n.li,{children:"6144"}),"\n",(0,l.jsx)(n.li,{children:"7168"}),"\n",(0,l.jsx)(n.li,{children:"8192"}),"\n",(0,l.jsx)(n.li,{children:"16384"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://nodejs.org/api/cli.html#--max-old-space-sizesize-in-megabytes",children:"Node.js CLI: max-old-space-size"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://chromium.googlesource.com/v8/v8.git/+/refs/tags/10.3.129/src/heap/heap.cc#314",children:"V8 Heap Implementation"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"../browser/v8.md",children:"v8"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"cant-resolve-pg-native",children:"Can't resolve 'pg-native'"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7528\u4E2A\u5047\u7684\u6A21\u5757\u66FF\u4EE3\uFF0C\u907F\u514D\u7F16\u8BD1"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/brianc/node-postgres/issues/838",children:"https://github.com/brianc/node-postgres/issues/838"}),"\nwhen using babel, pg-native is always required"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"// webpack\nexport default {\n  resolve: {\n    alias: {\n      'pg-native': path.join(__dirname, 'pg-native'),\n    },\n  },\n};\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"pg-native"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "name": "pg-native",\n  "private": true,\n  "main": "index.js"\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "name": "your-module",\n  "private": true,\n  "dependencies": {\n    "pg": "^8.3.3",\n    "pg-native": "file:./modules/pg-native"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"module.exports = null;\n"})}),"\n",(0,l.jsx)(n.h2,{id:"repl-load",children:"REPL load"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'node -i -e "$(< rc.js)"\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:".load"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://nodejs.org/api/repl.html#repl_design_and_features",children:"REPL Design and Features"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"error0308010c-envelope-routinesunsupported",children:"error:0308010C:digital envelope routines::unsupported"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"export NODE_OPTIONS=--openssl-legacy-provider\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://stackoverflow.com/questions/69692842",children:"StackOverflow: error:0308010C:digital envelope routines::unsupported"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"snapshot--compile",children:"snapshot / compile"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F7F\u7528 snapshot \u52A0\u901F\u542F\u52A8\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4F8B\u5982: main.mjs 10mb, main.mjs.map 20mb\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"--enable-source-maps \u542F\u52A8 40s"}),"\n",(0,l.jsxs)(n.li,{children:["\u65E0 ",(0,l.jsx)(n.code,{children:"enable-source-maps"})," \u542F\u52A8 2s"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["NODE_COMPILE_CACHE\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"v22.1.0+"}),"\n",(0,l.jsx)(n.li,{children:"\u652F\u6301 cjs & esm"}),"\n",(0,l.jsxs)(n.li,{children:["\u5F53\u6587\u4EF6\u975E\u5E38\u591A\u7684\u65F6\u5019\uFF0C\u76EE\u524D\u53EF\u80FD\u6CA1\u6709 cache \u6240\u6709\u5185\u5BB9 ",(0,l.jsx)(n.a,{href:"https://github.com/nodejs/help/issues/4484",children:"https://github.com/nodejs/help/issues/4484"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"echo \"globalThis.foo = 'I am from the snapshot'\" > snapshot.js\nnode --snapshot-blob snapshot.blob --build-snapshot snapshot.js\necho \"console.log(globalThis.foo)\" > index.js\nnode --snapshot-blob snapshot.blob index.js\n\necho \"require('v8').startupSnapshot.setDeserializeMainFunction(() => console.log('I am from the snapshot'))\" > snapshot.js\nnode --snapshot-blob snapshot.blob --build-snapshot snapshot.js\nnode --snapshot-blob snapshot.blob\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4E0D\u652F\u6301 ESM ",(0,l.jsx)(n.a,{href:"https://github.com/nodejs/help/issues/3981",children:"https://github.com/nodejs/help/issues/3981"})]}),"\n",(0,l.jsxs)(n.li,{children:["RFC: speeding up Node.js startup using V8 snapshot ",(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/17058",children:"#17058"})]}),"\n",(0,l.jsxs)(n.li,{children:["Ideas for faster cold compiler start-up ",(0,l.jsx)(n.a,{href:"https://github.com/microsoft/TypeScript/issues/25658",children:"microsoft/TypeScript#25658"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/zertosh/v8-compile-cache",children:"zertosh/v8-compile-cache"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://github.com/bytenode/bytenode",children:"bytenode/bytenode"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7F16\u8BD1\u4E3A v8 \u5B57\u8282\u7801"}),"\n",(0,l.jsxs)(n.li,{children:["\u79FB\u9664\u6E90\u7801\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Function.prototype.toString \u5931\u6548"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["Package\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"pkg"}),"\n",(0,l.jsx)(n.li,{children:"ncc"}),"\n",(0,l.jsx)(n.li,{children:"nexe"}),"\n",(0,l.jsx)(n.li,{children:"NodeJS SAE"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"bytenode --compile server.js\nbytenode server.jsc\n"})}),"\n",(0,l.jsx)(n.h2,{id:"fastify-vs-express",children:"fastify vs express"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["fastify\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u66F4\u5FEB\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"fast-json-stringify"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"\u6A21\u5757\u5316"}),"\n",(0,l.jsx)(n.li,{children:"\u66F4\u6613\u7528"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["express\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u66F4\u6210\u719F\uFF1F"}),"\n",(0,l.jsx)(n.li,{children:"monolithic"}),"\n",(0,l.jsx)(n.li,{children:"\u751F\u6001\u66F4\u5927 - \u529F\u80FD\u66F4\u591A"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"import-npm-global",children:"import npm global"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"export NODE_PATH=$(npm root --quiet -g)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"err_ossl_evp_unsupported",children:"ERR_OSSL_EVP_UNSUPPORTED"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"Error: error:0308010C:digital envelope routines::unsupported\n    at new Hash (node:internal/crypto/hash:71:19)\n    at Object.createHash (node:crypto:133:10)\n    at BulkUpdateDecorator.hashFactory (~/node_modules/.pnpm/webpack@5.39.0_webpack-cli@4.7.2/node_modules/webpack/lib/util/createHash.js:145:18)\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"pnpm \u5B89\u88C5\u6709\u95EE\u9898\uFF0C\u6362 npm \u540E\u597D\u4E86"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"getaddrinfo-enotfound-undefined",children:"getaddrinfo ENOTFOUND undefined"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"fetch(`http://example.com`);\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u547D\u4EE4\u884C\u83B7\u53D6-package-\u6240\u5728\u76EE\u5F55",children:"\u547D\u4EE4\u884C\u83B7\u53D6 package \u6240\u5728\u76EE\u5F55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"pnpm pwd\npnpm node -e 'process.stdout.write(path.resolve(__dirname))'\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-makefile",children:"PKG_ROOT ?= $(shell pnpm node -e 'process.stdout.write(path.resolve(__dirname))')\n"})}),"\n",(0,l.jsx)(n.h2,{id:"ioredis-vs-redis",children:"ioredis vs redis"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u26A0\uFE0F ioredis \u5728\u88AB redis \u6536\u7F16\u540E\u4E0D\u5728\u600E\u4E48\u7EF4\u62A4"}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["@redis/client\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5B98\u65B9\u4E3B\u63A8"}),"\n",(0,l.jsx)(n.li,{children:"\u5F00\u53D1\u76F8\u5BF9\u6D3B\u8DC3"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["ioredis\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u66F4\u597D\u7528"}),"\n",(0,l.jsx)(n.li,{children:"\u63A5\u53E3\u66F4\u53CB\u597D"}),"\n",(0,l.jsx)(n.li,{children:"\u66F4\u5FEB"}),"\n",(0,l.jsxs)(n.li,{children:["Is this package still actively maintained? ",(0,l.jsx)(n.a,{href:"https://github.com/redis/ioredis/issues/1870",children:"redis/ioredis#1870"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["iovalkey\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"fork ioredis"}),"\n",(0,l.jsx)(n.li,{children:"\u76EE\u524D\u5F00\u53D1\u8FD8\u4E0D\u592A\u6D3B\u8DC3"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/valkey-io/iovalkey",children:"valkey-io/iovalkey"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://www.reddit.com/r/node/comments/uymb7w/redis_vs_ioredis/",children:"Reddit: Redis vs IORedis"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://ably.com/blog/migrating-from-node-redis-to-ioredis",children:"Ably: Migrating from node-redis to ioredis"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"ably \u4ECE node-redis \u8FC1\u79FB\u4E3A ioredis"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"the-operation-failed-for-an-operation-specific-reason-cipher-job-failed",children:"The operation failed for an operation-specific reason: Cipher job failed"}),"\n",(0,l.jsx)(n.h2,{id:"failed-to-execute-digest-on-subtlecrypto-2nd-argument-is-not-instance-of-arraybuffer-buffer-typedarray-or-dataview",children:"Failed to execute 'digest' on 'SubtleCrypto': 2nd argument is not instance of ArrayBuffer, Buffer, TypedArray, or DataView."}),"\n",(0,l.jsx)(n.p,{children:"\u591A\u534A\u662F\u4F20\u5165\u4E86 undefined"}),"\n",(0,l.jsx)(n.h2,{id:"detect-runtime",children:"detect runtime"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"bun \u4E5F\u4F1A\u8BBE\u7F6E process.versions.node"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"console.log(process.release.name); // \u603B\u662F node\n\n// bun\nif (process.versions.bun) {\n}\nif (typeof Bun !== 'undefined') {\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"unhandled",children:"unhandled"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"uncaughtException"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"process\n  .on('unhandledRejection', (reason, p) => {\n    console.error('Unhandled Rejection at Promise', reason, p);\n  })\n  .on('uncaughtException', (err, origin) => {\n    fs.writeSync(process.stderr.fd, `Caught exception: ${err}\\n` + `Exception origin: ${origin}\\n`);\n    console.log(`ERROR`, err);\n    process.exit(1);\n  });\n"})}),"\n",(0,l.jsx)(n.h2,{id:"the-windows-1252-encoding-is-not-supported",children:'The "windows-1252" encoding is not supported'}),"\n",(0,l.jsx)(n.p,{children:"Throug"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-js",children:"new TextDecoder('latin1');\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# icu-data-en \u4E0D\u591F\n# 11.53 MB / 29.38 MB\napk add icu-data-full\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["nodejs latin1/windows-1252\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9700\u8981\u5B8C\u6574\u7684 icu-data"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/28190",children:"https://github.com/nodejs/node/issues/28190"})}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://www.npmjs.com/package/windows-1252",children:"npm:windows-1252"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u68C0\u6D4B\u7F16\u7801"}),"\n",(0,l.jsx)(n.li,{children:"ansi_x3.4-1968, ascii, cp1252, cp819, csisolatin1, ibm819, iso-8859-1, iso-ir-100, iso8859-1, iso88591, iso_8859-1, iso_8859-1:1987, l1, latin1, us-ascii, windows-1252, x-cp1252"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://encoding.spec.whatwg.org/#windows-1252",children:"https://encoding.spec.whatwg.org/#windows-1252"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"download",children:"Download"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://nodejs.org/download/release/latest-v20.x/win-x64/",children:"https://nodejs.org/download/release/latest-v20.x/win-x64/"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["node.exe - \u7528\u4E8E\u8FD0\u884C\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"static"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"node.lib - \u7528\u4E8E\u7F16\u8BD1"}),"\n",(0,l.jsx)(n.li,{children:"node_pdb.7z"}),"\n",(0,l.jsx)(n.li,{children:"node_pdb.zip - \u7528\u4E8E\u8C03\u8BD5"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"shell-scripting",children:"shell scripting"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"#!/usr/bin/env -S npx tsx\nimport { Command } from '@commander-js/extra-typings';\n\nconst program = new Command()\n  .name('word-count')\n  .description('CLI to count words')\n  .version('1.0.0')\n  .argument('<file>')\n  .parse();\n"})}),"\n",(0,l.jsx)(n.h2,{id:"rsa_pkcs1_padding-is-no-longer-supported-for-private-decryption-at-privatedecrypt-native-at-decrypt",children:"RSA_PKCS1_PADDING is no longer supported for private decryption at privateDecrypt (native) at decrypt"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["node 22+ ",(0,l.jsx)(n.code,{children:"--security-revert=CVE-2024-PEND"})]}),"\n",(0,l.jsxs)(n.li,{children:["node < 22 ",(0,l.jsx)(n.code,{children:"--security-revert=CVE-2023-46809"})]}),"\n",(0,l.jsxs)(n.li,{children:["Bun\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6700\u540E\u53EF\u7528\u7248\u672C 1.1.27"}),"\n",(0,l.jsxs)(n.li,{children:["\u76EE\u524D\u4E0D\u652F\u6301 --security-revert ",(0,l.jsx)(n.a,{href:"https://github.com/oven-sh/bun/issues/14770",children:"https://github.com/oven-sh/bun/issues/14770"})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://nvd.nist.gov/vuln/detail/CVE-2023-46809",children:"https://nvd.nist.gov/vuln/detail/CVE-2023-46809"})}),"\n",(0,l.jsxs)(n.li,{children:["node ",(0,l.jsx)(n.a,{href:"https://nodejs.org/en/blog/vulnerability/february-2024-security-releases#nodejs-is-vulnerable-to-the-marvin-attack-timing-variant-of-the-bleichenbacher-attack-against-pkcs1-v15-padding-cve-2023-46809---medium",children:"Wednesday February 14 2024 Security Releases"})]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/nodejs/node/issues/52017#issuecomment-1987369610",children:"https://github.com/nodejs/node/issues/52017#issuecomment-1987369610"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"// \u89E6\u53D1\u9519\u8BEF\ncrypto.privateDecrypt(\n  {\n    key: privateKey,\n    padding: crypto.constants.RSA_PKCS1_PADDING,\n  },\n  buffer,\n);\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:"\u53EF\u4EE5\u4F7F\u7528 node-rsa"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5927\u7EA6\u6162 10 \u500D"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"import NodeRSA from 'node-rsa';\n\nconst key = new NodeRSA(privateKey);\nkey.setOptions({ encryptionScheme: 'pkcs1' });\nconst decrypted = key.decrypt(buffer);\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/rzcoder/node-rsa",children:"rzcoder/node-rsa"})}),"\n",(0,l.jsx)(n.li,{children:"node-forge"}),"\n",(0,l.jsx)(n.li,{children:"JSEncrypt"}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/orgs/vercel/discussions/6630",children:"https://github.com/orgs/vercel/discussions/6630"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"error-shelljsinternalerror-spawn-ebadf",children:"Error ShellJSInternalError: spawn EBADF"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "errno": -9,\n  "code": "EBADF",\n  "syscall": "spawn"\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"the-requested-module-globby-does-not-provide-an-export-named-globby",children:"The requested module 'globby' does not provide an export named 'globby'"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u65B0\u65E7\u7248\u672C globby \u533A\u522B"}),"\n",(0,l.jsx)(n.li,{children:"v12+ \u4F7F\u7528 ESM"}),"\n",(0,l.jsx)(n.li,{children:"v11- \u4F7F\u7528 CJS"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-ts",children:"// v12+\nimport { globby } from 'globby';\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/sindresorhus/globby/issues/193",children:"https://github.com/sindresorhus/globby/issues/193"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},917776:function(e,n,s){s.d(n,{R:()=>d,x:()=>c});var i=s(7378);let l={},r=i.createContext(l);function d(e){let n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);