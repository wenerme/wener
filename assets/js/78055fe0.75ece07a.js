"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["27554"],{47155:function(e,n,s){s.r(n),s.d(n,{frontMatter:()=>l,toc:()=>c,default:()=>d,metadata:()=>r,assets:()=>a,contentTitle:()=>o});var r=JSON.parse('{"id":"ai/ml/libs/transformers","title":"transformers","description":"---","source":"@site/../notes/ai/ml/libs/transformers.md","sourceDirName":"ai/ml/libs","slug":"/ai/ml/libs/transformers","permalink":"/notes/ai/ml/libs/transformers","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/ai/ml/libs/transformers.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1757294976000,"frontMatter":{"title":"transformers"},"sidebar":"docs","previous":{"title":"ML Libs Awesome","permalink":"/notes/ai/ml/libs/awesome"},"next":{"title":"ML Awesome","permalink":"/notes/ai/ml/awesome"}}'),i=s(86106),t=s(17776);let l={title:"transformers"},o="transformers",a={},c=[{value:"\u6A21\u578B\u6587\u4EF6\u7ED3\u6784",id:"\u6A21\u578B\u6587\u4EF6\u7ED3\u6784",level:2},{value:"Latest Version",id:"latest-version",level:2},{value:"cannot import name &#39;get_full_repo_name&#39; from &#39;huggingface_hub&#39;",id:"cannot-import-name-get_full_repo_name-from-huggingface_hub",level:2},{value:"Message has tool role, but there was no previous assistant message with a tool call",id:"message-has-tool-role-but-there-was-no-previous-assistant-message-with-a-tool-call",level:2}];function h(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"transformers",children:"transformers"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"uv add transformers torch torchvision pillow accelerate\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-py",children:'from transformers import AutoConfig, AutoModel, AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained("bert-base-uncased", use_fast=True)\nprint(tokenizer.is_fast)\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["attn_implementation\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["flash_attention_2\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"fp16, bf16"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["sdpa\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"default for PyTorch v2.1.1"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://huggingface.co/docs/transformers/perf_infer_gpu_one",children:"https://huggingface.co/docs/transformers/perf_infer_gpu_one"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Fast Tokenizer\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AutoTokenizer.from_pretrained(..., use_fast=True)"}),"\n",(0,i.jsx)(n.li,{children:"rust \u5B9E\u73B0\uFF0C\u66F4\u5FEB, 10-100 \u500D"}),"\n",(0,i.jsx)(n.li,{children:"\u652F\u6301\u5E76\u884C\u5904\u7406\u548C\u6279\u91CF\u5206\u8BCD"}),"\n",(0,i.jsx)(n.li,{children:"\u5927\u90E8\u5206\u6A21\u578B\u90FD\u652F\u6301"}),"\n",(0,i.jsx)(n.li,{children:"\u8BFB\u53D6\u7EDF\u4E00\u7684 tokenizer.json \u683C\u5F0F"}),"\n",(0,i.jsx)(n.li,{children:"\u652F\u6301\u6240\u6709\u4E3B\u6D41\u5206\u8BCD\u7B97\u6CD5\uFF08BPE\u3001WordPiece\u3001SentencePiece\uFF09"}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://huggingface.co/docs/tokenizers/python/latest/quicktour.html#fast-vs-slow-tokenizers",children:"https://huggingface.co/docs/tokenizers/python/latest/quicktour.html#fast-vs-slow-tokenizers"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/dottxt-ai/outlines",children:"https://github.com/dottxt-ai/outlines"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7ED3\u6784\u5316\u6587\u672C"}),"\n",(0,i.jsxs)(n.li,{children:["Vision ",(0,i.jsx)(n.a,{href:"https://dottxt-ai.github.io/outlines/latest/cookbook/atomic_caption/",children:"https://dottxt-ai.github.io/outlines/latest/cookbook/atomic_caption/"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u6A21\u578B\u6587\u4EF6\u7ED3\u6784",children:"\u6A21\u578B\u6587\u4EF6\u7ED3\u6784"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"config.json"})," - \u6A21\u578B\u67B6\u6784\u914D\u7F6E\uFF0C\u5305\u542B\u5C42\u6570\u3001\u9690\u85CF\u5355\u5143\u6570\u3001\u6CE8\u610F\u529B\u5934\u6570\u7B49\u8D85\u53C2\u6570\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u88AB ",(0,i.jsx)(n.code,{children:"AutoConfig.from_pretrained()"})," \u8BFB\u53D6"]}),"\n",(0,i.jsx)(n.li,{children:"\u7528\u4E8E\u6A21\u578B\u521D\u59CB\u5316\u548C\u63A8\u7406\u914D\u7F6E"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"tokenizer_config.json"})," - \u5206\u8BCD\u5668\u914D\u7F6E\u6587\u4EF6\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5B9A\u4E49\u5206\u8BCD\u5668\u7C7B\u578B\u3001\u7279\u6B8A\u6807\u8BB0\u5904\u7406\u65B9\u5F0F\u3001\u9884\u5904\u7406\u53C2\u6570"}),"\n",(0,i.jsxs)(n.li,{children:["\u88AB ",(0,i.jsx)(n.code,{children:"AutoTokenizer.from_pretrained()"})," \u8BFB\u53D6"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"vocab.json"})," - \u8BCD\u6C47\u8868\u6620\u5C04\u6587\u4EF6\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5C06\u8BCD\u6C47/\u5B50\u8BCD\u6620\u5C04\u5230\u6570\u5B57ID\uFF0C\u5B9A\u4E49\u6A21\u578B\u8BCD\u6C47\u7A7A\u95F4"}),"\n",(0,i.jsx)(n.li,{children:"\u5206\u8BCD\u5668\u521D\u59CB\u5316\u65F6\u8BFB\u53D6\uFF0C\u7528\u4E8E\u6587\u672C\u7F16\u7801\u89E3\u7801"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"special_tokens_map.json"})," - \u7279\u6B8A\u6807\u8BB0\u6620\u5C04\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5B9A\u4E49 [CLS]\u3001[SEP]\u3001[PAD]\u3001[UNK] \u7B49\u7279\u6B8A\u6807\u8BB0\u7684\u5177\u4F53\u503C"}),"\n",(0,i.jsx)(n.li,{children:"\u5206\u8BCD\u5668\u8BFB\u53D6\uFF0C\u7528\u4E8E\u5E8F\u5217\u6807\u8BB0\u548C\u586B\u5145"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"merges.txt"})," - BPE(Byte Pair Encoding)\u5408\u5E76\u89C4\u5219\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u7528\u4E8E\u5B50\u8BCD\u5206\u5272\u7684\u5408\u5E76\u64CD\u4F5C\u5E8F\u5217"}),"\n",(0,i.jsx)(n.li,{children:"BPE\u5206\u8BCD\u5668\u8BFB\u53D6\uFF0C\u6267\u884C\u5B50\u8BCD\u5207\u5206\u7B97\u6CD5"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"tokenizer.json"})," - \u7EDF\u4E00\u5206\u8BCD\u5668\u5B9A\u4E49\u6587\u4EF6\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5305\u542B\u5B8C\u6574\u5206\u8BCD\u903B\u8F91\u7684\u6807\u51C6\u5316\u683C\u5F0F(HuggingFace Tokenizers\u5E93\u683C\u5F0F)"}),"\n",(0,i.jsx)(n.li,{children:"\u88AB\u5FEB\u901F\u5206\u8BCD\u5668(Fast Tokenizer)\u8BFB\u53D6\uFF0C\u63D0\u4F9B\u9AD8\u6027\u80FD\u5206\u8BCD"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"chat_template.json"})," - \u5BF9\u8BDD\u6A21\u677F\u914D\u7F6E\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5B9A\u4E49\u591A\u8F6E\u5BF9\u8BDD\u7684\u683C\u5F0F\u5316\u89C4\u5219\u548C\u7CFB\u7EDF\u63D0\u793A\u8BCD"}),"\n",(0,i.jsx)(n.li,{children:"\u7528\u4E8E\u804A\u5929\u6A21\u578B\u7684\u5BF9\u8BDD\u5386\u53F2\u683C\u5F0F\u5316"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"preprocessor_config.json"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u56FE\u50CF\u9884\u5904\u7406\uFF0C\u4E5F\u53EF\u80FD\u5305\u542B\u97F3\u9891\u7B49\u5176\u4ED6\u6A21\u6001\u7684\u9884\u5904\u7406\u914D\u7F6E"}),"\n",(0,i.jsx)(n.li,{children:"\u88AB AutoImageProcessor.from_pretrained() \u6216 AutoProcessor.from_pretrained() \u8BFB\u53D6"}),"\n",(0,i.jsx)(n.li,{children:"\u5E38\u89C1\u4E8E\u89C6\u89C9-\u8BED\u8A00\u6A21\u578B\uFF08\u5982 CLIP\u3001BLIP\u3001LLaVA\uFF09"}),"\n",(0,i.jsxs)(n.li,{children:["\u5305\u542B\u7684\u53C2\u6570\u4F8B\u5982\uFF1A\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"size: \u56FE\u50CF\u5C3A\u5BF8"}),"\n",(0,i.jsx)(n.li,{children:"mean/std: \u5F52\u4E00\u5316\u53C2\u6570"}),"\n",(0,i.jsx)(n.li,{children:"do_resize/do_normalize: \u9884\u5904\u7406\u6B65\u9AA4\u5F00\u5173"}),"\n",(0,i.jsx)(n.li,{children:"image_processor_type: \u5904\u7406\u5668\u7C7B\u578B"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"latest-version",children:"Latest Version"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u5148\u5C1D\u8BD5\u4F7F\u7528\u6700\u65B0\u7248\npip install --upgrade transformers\n\n# \u4E0D\u884C\u5219\u53EF\u4EE5\u5C1D\u8BD5\u4F7F\u7528 source\npip install https://github.com/huggingface/transformers/archive/refs/heads/main.zip\n"})}),"\n",(0,i.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(n.h2,{id:"cannot-import-name-get_full_repo_name-from-huggingface_hub",children:"cannot import name 'get_full_repo_name' from 'huggingface_hub'"}),"\n",(0,i.jsx)(n.h2,{id:"message-has-tool-role-but-there-was-no-previous-assistant-message-with-a-tool-call",children:"Message has tool role, but there was no previous assistant message with a tool call"})]})}function d(e={}){let{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},17776:function(e,n,s){s.d(n,{R:()=>l,x:()=>o});var r=s(7378);let i={},t=r.createContext(i);function l(e){let n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);