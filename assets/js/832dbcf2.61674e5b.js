"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["95220"],{60890:function(s,n,e){e.r(n),e.d(n,{frontMatter:()=>l,toc:()=>r,default:()=>d,metadata:()=>a,assets:()=>c,contentTitle:()=>p});var a=JSON.parse('{"id":"os/linux/sys/swap","title":"Swap","description":"- swap \u6587\u4EF6","source":"@site/../notes/os/linux/sys/swap.md","sourceDirName":"os/linux/sys","slug":"/os/linux/sys/swap","permalink":"/notes/os/linux/sys/swap","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/os/linux/sys/swap.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1750997941000,"frontMatter":{"title":"Swap"},"sidebar":"docs","previous":{"title":"shadow","permalink":"/notes/os/linux/sys/shadow"},"next":{"title":"Tuning","permalink":"/notes/os/linux/sys/tuning"}}'),t=e(86106),i=e(17776);let l={title:"Swap"},p="Swap",c={},r=[{value:"\u6DFB\u52A0 swap",id:"\u6DFB\u52A0-swap",level:2},{value:"\u5220\u9664 swap",id:"\u5220\u9664-swap",level:2},{value:"\u53C2\u8003",id:"\u53C2\u8003",level:2}];function o(s){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...s.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"swap",children:"Swap"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"apk add util-linux-misc # util-linux \u63D0\u4F9B\u5168\u529F\u80FD\u7684 swap \u5DE5\u5177\n\nswapon --show   # \u67E5\u770B\u4EA4\u6362\u533A\ncat /proc/swaps #\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["swap \u6587\u4EF6\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Ubuntu /swap.img"}),"\n",(0,t.jsxs)(n.li,{children:["macOS ",(0,t.jsx)(n.code,{children:"/private/var/vm/swapfile*"})]}),"\n",(0,t.jsx)(n.li,{children:"Windows C:\\pagefile.sys"}),"\n",(0,t.jsx)(n.li,{children:"/swapfile"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Linux \u4E2D\u7684\u4EA4\u6362\u6587\u4EF6\u79F0\u4E3A ",(0,t.jsx)(n.code,{children:"swappiness"}),",swappiness \u7684\u503C\u4E3A\u5F53\u5185\u5B58\u8FBE\u5230\u67D0\u4E2A\u767E\u5206\u6BD4\u65F6\u4F1A\u8FDB\u884C\u4EA4\u6362. 0 \u4E3A\u4E0D\u4F7F\u7528\u4EA4\u6362, 10 \u4E3A \u5F53\u5185\u5B58\u8FBE\u5230 90% \u540E\u4F1A\u4F7F\u7528\u4EA4\u6362."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u8BE5\u503C\u4FEE\u6539\u540E\u9700\u8981\u91CD\u542F"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Linux\n# \u53EF\u76F4\u63A5\u4FEE\u6539 /etc/sysctl.conf \u4E2D\u7684\u503C,\u4E4B\u540E\u9700\u8981 sysctl -p \u52A0\u8F7D\u65B0\u7684\u914D\u7F6E\n# \u5728\u7CFB\u7EDF\u8FD0\u884C\u65F6\u4FEE\u6539\u4EA4\u6362\n# \u9ED8\u8BA4 60\n# \u5F53\u5185\u5B58\u8FD8\u6709\u591A\u5C11\u7A7A\u95F2\u65F6\u4F7F\u7528\u4EA4\u6362\u533A - 10 \u5219\u65F6\u5F53\u5185\u5B58\u8FD8\u6709 10% \u7A7A\u95F2 - \u5373\u5DF2\u7ECF\u4F7F\u7528 90% \u7684\u65F6\u5019\u6FC0\u6D3B\u4EA4\u6362\nsysctl vm.swappiness=10\n\n# \u6E05\u9664\u6240\u6709\u4EA4\u6362\nswapoff -a\n# \u542F\u7528\u6240\u6709\u4EA4\u6362.\nswapon -a\n# \u67E5\u770B\u4EA4\u6362\u533A\u7684\u4F7F\u7528\ncat /proc/meminfo\nfree\ntop\n# \u67E5\u770B\u54EA\u4E9B\u8BBE\u5907\u4F5C\u4E3A\u4EA4\u6362\ncat /proc/swaps\n# \u5F53\u524D\u865A\u62DF\u5185\u5B58\u7684\u4F7F\u7528\u7EDF\u8BA1\nvmstat\n\n# \u67E5\u770B\u5F53\u524D swap\ncat /proc/swaps\n# \u67E5\u770B swap \u8BBE\u5907\u548C\u5927\u5C0F\nswapon -s\n# \u865A\u62DF\u5185\u5B58\u7EDF\u8BA1\nvmstat\n\n# macOS\n# \u67E5\u770B\u865A\u62DF\u5185\u5B58\u4F7F\u7528\u91CF\u5373\u4EA4\u6362\u533A\nvm_stat\n# \u67E5\u770B\u4F7F\u7528\u7684\u4EA4\u6362\u6587\u4EF6\nls -lh /private/var/vm/swapfile*\n\n# AlpineLinux\n# \u81EA\u52A8\u8BBE\u7F6E\u53C2\u6570\necho vm.swappiness=10 > /etc/sysctl.d/swap.conf\n# \u53EF\u4EE5\u91CD\u65B0\u52A0\u8F7D\n/etc/init.d/sysctl rstart\n# \u5F00\u673A\u6302\u8F7D swap\nrc-update add swap\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u6DFB\u52A0-swap",children:"\u6DFB\u52A0 swap"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# 4G \u4EA4\u6362\u533A\n# dd if=/dev/zero of=/sysswap count=512 bs=8MiB status=progress\nfallocate -l 4G /sysswap\n\nchmod 600 /sysswap\nmkswap /sysswap\nswapon /sysswap\n# \u5C06 swap \u6DFB\u52A0\u5230 fstab\necho /sysswap swap swap sw 0 0 >> /etc/fstab\n\nsysctl vm.swappiness=10\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u5220\u9664-swap",children:"\u5220\u9664 swap"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u5148\u5173\u95ED swap\nswapoff /sysswap\n# \u5220\u9664 swap \u6587\u4EF6\nrm -f /sysswap\n# \u5220\u9664 fstab \u4E2D\u7684 swap\nsed -i '/\\/sysswap/d' /etc/fstab\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u53C2\u8003",children:"\u53C2\u8003"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-add-swap-on-centos-7",children:"How to add swap on CentOS 7"})}),"\n"]})]})}function d(s={}){let{wrapper:n}={...(0,i.R)(),...s.components};return n?(0,t.jsx)(n,{...s,children:(0,t.jsx)(o,{...s})}):o(s)}},17776:function(s,n,e){e.d(n,{R:()=>l,x:()=>p});var a=e(7378);let t={},i=a.createContext(t);function l(s){let n=a.useContext(i);return a.useMemo(function(){return"function"==typeof s?s(n):{...n,...s}},[n,s])}function p(s){let n;return n=s.disableParentContext?"function"==typeof s.components?s.components(t):s.components||t:l(s.components),a.createElement(i.Provider,{value:n},s.children)}}}]);