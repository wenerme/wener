"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["665987"],{573234:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>o,toc:()=>d,default:()=>h,metadata:()=>t,assets:()=>c,contentTitle:()=>l});var t=JSON.parse('{"id":"devops/docker/docker-network","title":"Docker \u7F51\u7EDC","description":"* \u6CE8\u610F","source":"@site/../notes/devops/docker/docker-network.md","sourceDirName":"devops/docker","slug":"/devops/docker/network","permalink":"/notes/devops/docker/network","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/devops/docker/docker-network.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1602516815000,"frontMatter":{"id":"docker-network","title":"Docker \u7F51\u7EDC"},"sidebar":"docs","previous":{"title":"DockerHub","permalink":"/notes/devops/docker/hub"},"next":{"title":"Docker \u4ED3\u5E93","permalink":"/notes/devops/docker/registry"}}'),s=r(486106),i=r(917776);let o={id:"docker-network",title:"Docker \u7F51\u7EDC"},l="Docker Network",c={},d=[];function a(e){let n={a:"a",code:"code",h1:"h1",header:"header",li:"li",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"docker-network",children:"Docker Network"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u6CE8\u610F\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u521B\u5EFA\u7684\u7F51\u7EDC\u5185\u90E8\u90FD\u4F1A\u542F\u52A8 DHCP \u65E0\u6CD5\u4F7F\u7528\u5916\u90E8 DHCP\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://gist.github.com/nerdalert/3d2b891d41e0fa8d688c",children:"Experimental Docker Libnetwork DHCP Driver"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"\u4F7F\u7528\u5916\u90E8 DHCP \u9700\u8981\u5B9E\u73B0 IPAM - \u76EE\u524D\u7248\u672C\u6CA1\u6709 DHCP \u7684 IPAM"}),"\n",(0,s.jsx)(n.li,{children:"\u5982\u679C\u60F3\u8981\u521B\u5EFA interface \u5219\u9700\u8981 NET_ADMIN \u7136\u540E\u6620\u5C04\u8BBE\u5907 - \u4F8B\u5982 /dev/net/tun"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u7F51\u7EDC\u6A21\u5F0F\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"host - \u4F7F\u7528\u4E3B\u673A\u7F51\u7EDC"}),"\n",(0,s.jsxs)(n.li,{children:["macvlan - \u4F7F\u7528\u4E3B\u673A\u7684\u4E00\u5F20\u7F51\u5361\u505A macvlan\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4E0D\u9700\u8981\u989D\u5916\u7684 bridge"}),"\n",(0,s.jsx)(n.li,{children:"\u4F46\u4E3B\u673A\u4E0E\u5BB9\u5668\u65E0\u6CD5\u4F7F\u7528\u8BE5\u7F51\u5361\u4E92\u901A"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"bridge - \u6865\u63A5 - \u9ED8\u8BA4\u6A21\u5F0F"}),"\n",(0,s.jsx)(n.li,{children:"overlay - \u4E00\u822C\u7528\u4E8E\u8DE8\u4E3B\u673A\u7F51\u7EDC"}),"\n",(0,s.jsx)(n.li,{children:"none - \u4E0D\u9700\u8981\u7F51\u7EDC"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["IPAM\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u76EE\u524D\u5185\u5EFA\u7684 IPAM \u9A71\u52A8 ",(0,s.jsx)(n.a,{href:"https://github.com/docker/libnetwork/tree/master/ipams",children:"docker/libnetwork/ipams"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"default - \u9ED8\u8BA4\u6309\u987A\u5E8F\u83B7\u53D6 IP"}),"\n",(0,s.jsx)(n.li,{children:"null - \u7F51\u7EDC\u4E3A none \u65F6\u4F7F\u7528"}),"\n",(0,s.jsx)(n.li,{children:"remote - \u6307\u5B9A\u4E0D\u5B58\u5728\u7684\u5219\u4F1A\u5C1D\u8BD5\u4F5C\u4E3A IPAM \u63D2\u4EF6\u8FDB\u884C\u521D\u59CB\u5316"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\u53C2\u8003\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://pc.nanog.org/static/published/meetings/NANOG72/1552/20180219_Greenberg_Docker_Libnetwork_Drivers__v1.pdf",children:"Docker LibNetwork Plugins - Explorer\u2019s Tale"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u4E0D\u6307\u5B9A subnet \u5219\u662F\u4ECE 172.17 \u7EE7\u7EED\u5F80\u540E\u589E\u52A0\ndocker network create appnet -o 'com.docker.network.bridge.name=appnet'\n# \u6DFB\u52A0 slave \u7F51\u5361\u4EE5\u4FBF\u4E92\u901A\n# ip li set dev mynet master appnet\n\n# \u4F7F\u7528 eth1 \u4F5C\u4E3A\u4E0A\u7EA7 - \u65E0\u6CD5\u901A\u8FC7 eth1 \u4E92\u901A - \u5982\u679C\u6709 host \u6709\u4E24\u4E2A\u7F51\u53E3\u5219\u53EF\u4EE5\n# \u53EF\u4EE5\u4E0E\u4E3B\u673A\u4E92\u901A\u7684\u5BB9\u5668\u7F51\u7EDC\uFF0C\u4F46\u4F1A\u81EA\u884C\u8BBE\u7F6E ip \u800C\u4E0D\u662F\u4F7F\u7528 dhcp\ndocker network create -d macvlan --subnet=192.168.1.0/24 --gateway=192.168.1.1 -o parent=eth1 appnet\n\n# \u67E5\u770B\u5BB9\u5668\u76D1\u542C\npid=$(docker inspect -f '{{.State.Pid}}' container_name_or_id)\nsudo nsenter -t $pid -n netstat\n"})})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},917776:function(e,n,r){r.d(n,{R:()=>o,x:()=>l});var t=r(7378);let s={},i=t.createContext(s);function o(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);