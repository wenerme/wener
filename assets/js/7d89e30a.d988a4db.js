"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["676499"],{96819:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>r,toc:()=>l,default:()=>u,metadata:()=>s,assets:()=>a,contentTitle:()=>c});var s=JSON.parse('{"id":"service/forge/github/github-action","title":"Github Action","description":"- actions/virtual-environments","source":"@site/../notes/service/forge/github/github-action.md","sourceDirName":"service/forge/github","slug":"/service/forge/github/action","permalink":"/notes/service/forge/github/action","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/service/forge/github/github-action.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1696577752000,"frontMatter":{"title":"Github Action"},"sidebar":"docs","previous":{"title":"Github","permalink":"/notes/service/forge/github/"},"next":{"title":"gh","permalink":"/notes/service/forge/github/cli"}}'),i=t(486106),o=t(917776);let r={title:"Github Action"},c="Github Action",a={},l=[{value:"step",id:"step",level:2},{value:"uses",id:"uses",level:3},{value:"pnpm template",id:"pnpm-template",level:2},{value:"compile: version does not match go tool version",id:"compile-version-does-not-match-go-tool-version",level:2}];function h(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"github-action",children:"Github Action"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/actions/virtual-environments",children:"actions/virtual-environments"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions",children:"https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/actions",children:"https://github.com/actions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://gitea.com/actions",children:"https://gitea.com/actions"})}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4E0D\u652F\u6301\u5141\u8BB8\u9519\u8BEF ",(0,i.jsx)(n.a,{href:"https://github.com/actions/toolkit/issues/399",children:"#399"})]}),"\n"]})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["golangci-lint-action CI \u8017\u65F6\u975E\u5E38\u957F ",(0,i.jsx)(n.a,{href:"https://github.com/golangci/golangci-lint-action/issues/297",children:"#297"})]}),"\n"]})}),"\n",(0,i.jsx)(n.h2,{id:"step",children:"step"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"id"}),"\n",(0,i.jsx)(n.li,{children:"if name uses run shell with env continue-on-error timeout-minutes"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"uses",children:"uses"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"# {owner}/{repo}@{ref}\n# {owner}/{repo}/{path}@{ref}\n- uses: actions/checkout@v3\n- uses: actions/aws/ec2@main\n\n# \u76F8\u540C\u4ED3\u5E93 - \u9700\u8981\u5148 checkout\n# ./path/to/dir\n- uses: ./.github/actions/my-action\n# docker://{image}:{tag}\n# docker://{host}/{image}:{tag}\n- uses: docker://alpine:3.8\n- uses: docker://ghcr.io/OWNER/IMAGE_NAME\n- uses: docker://gcr.io/cloud-builders/gradle\n\n# private repo\n- uses: actions/checkout@v3\n  with:\n    repository: octocat/my-private-repo\n    ref: v1.0\n    token: ${{ secrets.PERSONAL_ACCESS_TOKEN }}\n    path: ./.github/actions/my-private-repo\n# from private repo\n- uses: ./.github/actions/my-private-repo/my-action\n"})}),"\n",(0,i.jsx)(n.h2,{id:"pnpm-template",children:"pnpm template"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"name: Build\n\non:\n  push:\n    branches: [master]\n  pull_request:\n    branches: [master]\n\njobs:\n  build:\n    runs-on: ubuntu-22.04\n\n    steps:\n      - uses: actions/checkout@v3\n      - name: Install Node.js\n        uses: actions/setup-node@v3\n        with:\n          node-version: 16\n      - uses: pnpm/action-setup@v2.0.1\n        name: Install pnpm\n        id: pnpm-install\n        with:\n          version: 7\n          run_install: false\n      - name: Get pnpm store directory\n        id: pnpm-cache\n        run: |\n          echo \"::set-output name=pnpm_cache_dir::$(pnpm store path)\"\n      - name: Build Cache\n        id: build-cache\n        uses: actions/cache@v2\n        with:\n          path: ${{ steps.pnpm-cache.outputs.pnpm_cache_dir }}\n          key: ${{ runner.os }}-pnpm-store-${{ hashFiles('**/pnpm-lock.yaml') }}\n          restore-keys: |\n            ${{ runner.os }}-pnpm-store-\n\n      # Real build\n      - run: make ci\n\n      - name: Deploy Pages\n        uses: JamesIves/github-pages-deploy-action@releases/v4\n        with:\n          branch: gh-pages\n          folder: out\n          single-commit: true\n"})}),"\n",(0,i.jsx)(n.h1,{id:"faq",children:"FAQ"}),"\n",(0,i.jsx)(n.h2,{id:"compile-version-does-not-match-go-tool-version",children:"compile: version does not match go tool version"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- name: Run CI\n  run: |\n    export PATH=${GOROOT}/bin:$PATH\n    go version\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/actions/setup-go/issues/107#issuecomment-854071850",children:"https://github.com/actions/setup-go/issues/107#issuecomment-854071850"})}),"\n"]})]})}function u(e={}){let{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},917776:function(e,n,t){t.d(n,{R:()=>r,x:()=>c});var s=t(7378);let i={},o=s.createContext(i);function r(e){let n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);