"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["356819"],{55356:function(n,e,s){s.r(e),s.d(e,{frontMatter:()=>o,toc:()=>d,default:()=>h,metadata:()=>i,assets:()=>t,contentTitle:()=>c});var i=JSON.parse('{"id":"web/script/lib/osjs","title":"OS.js","description":"- os-js/OS.js","source":"@site/../notes/web/script/lib/osjs.md","sourceDirName":"web/script/lib","slug":"/web/script/lib/osjs","permalink":"/notes/web/script/lib/osjs","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/script/lib/osjs.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1663838677000,"frontMatter":{"title":"OS.js"},"sidebar":"docs","previous":{"title":"orpc","permalink":"/notes/web/script/lib/orpc"},"next":{"title":"path-to-regexp","permalink":"/notes/web/script/lib/path-to-regexp"}}'),r=s(486106),l=s(917776);let o={title:"OS.js"},c="OS.js",t={},d=[{value:"Notes",id:"notes",level:2},{value:"CoreBase",id:"corebase",level:2}];function j(n){let e={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"osjs",children:"OS.js"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/os-js/OS.js",children:"os-js/OS.js"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"BSD-2, JS"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u53C2\u8003\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://demo.os-js.org/",children:"https://demo.os-js.org/"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"@osjs/event-emitter"}),"\n",(0,r.jsxs)(e.li,{children:["@osjs/common\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["class CoreBase\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"deepmerge, omit-deep \u5408\u5E76\u9009\u9879"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"interface ServiceProvider"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"notes",children:"Notes"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u533A\u5206 Client \u548C Server\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"@osjs/client"}),"\n",(0,r.jsx)(e.li,{children:"@osjs/server"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"\u52A8\u6001\u52A0\u8F7D\u7684\u5185\u5BB9\u6709 Client \u548C Server \u90E8\u5206"}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/os-js/OS.js",children:"os-js/OS.js"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["client ",(0,r.jsx)(e.a,{href:"https://github.com/os-js/OS.js/blob/0aa874455e1ca5a31e7be193b3be14080300c2c1/src/client/index.js#L57-L72",children:"Bootstrap"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"CoreServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"DesktopServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"VFSServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"NotificationServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"SettingsServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"AuthServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"PanelServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"DialogServiceProvider"}),"\n",(0,r.jsx)(e.li,{children:"GUIServiceProvider"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u914D\u7F6E ",(0,r.jsx)(e.a,{href:"https://github.com/os-js/osjs-client/blob/master/src/config.js",children:"https://github.com/os-js/osjs-client/blob/master/src/config.js"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/os-js/osjs-event-emitter",children:"@osjs/event-emitter"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u975E\u5E38\u7B80\u5355\u7684 EventEmitter"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"https://github.com/os-js/osjs-common",children:"@osjs/common"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["CoreBase\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u4F5C\u4E3A OS \u7684\u6838\u5FC3 \u5BB9\u5668/IoC \u5BB9\u5668/\u8FD0\u884C\u4E0A\u4E0B\u6587"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["providerHandler - \u521B\u5EFA\u5BB9\u5668\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"IoC \u4F9D\u8D56\u5BB9\u5668"}),"\n",(0,r.jsxs)(e.li,{children:["\u57FA\u4E8E ",(0,r.jsx)(e.a,{href:"https://github.com/chriswoodle/async-dependency-graph",children:"async-dependency-graph"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"async-dependency-graph - 5.3kB 1.5kB"}),"\n",(0,r.jsx)(e.li,{children:"\u5BF9\u6BD4 inversify - 50kB, 11kB"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["@osjs/client\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Core extends CoreBase\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["window.OSjs = this.createGlobalApi()\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u66B4\u9732\u5230\u5168\u5C40\u7684 API"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.li,{children:"Application - \u5E94\u7528\u7BA1\u7406"}),"\n",(0,r.jsx)(e.li,{children:"Window - \u7A97\u53E3\u7BA1\u7406\u5668"}),"\n",(0,r.jsx)(e.li,{children:"Session - \u4F1A\u8BDD"}),"\n",(0,r.jsx)(e.li,{children:"Packages - \u52A8\u6001\u52A0\u8F7D\u5305"}),"\n",(0,r.jsx)(e.li,{children:"Tray"}),"\n",(0,r.jsx)(e.li,{children:"Websocket - ws \u901A\u8BAF"}),"\n",(0,r.jsx)(e.li,{children:"Clickboard"}),"\n",(0,r.jsx)(e.li,{children:"Middleware"}),"\n",(0,r.jsxs)(e.li,{children:["locale\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/os-js/osjs-client/blob/master/src/locale/zh_CN.js",children:"https://github.com/os-js/osjs-client/blob/master/src/locale/zh_CN.js"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["CoreServiceProvider\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"osjs/application"}),"\n",(0,r.jsx)(e.li,{children:"osjs/basic-application"}),"\n",(0,r.jsx)(e.li,{children:"osjs/window"}),"\n",(0,r.jsx)(e.li,{children:"osjs/windows"}),"\n",(0,r.jsx)(e.li,{children:"osjs/event-handler"}),"\n",(0,r.jsx)(e.li,{children:"osjs/window-behaviour"}),"\n",(0,r.jsx)(e.li,{children:"osjs/dnd"}),"\n",(0,r.jsx)(e.li,{children:"osjs/dom"}),"\n",(0,r.jsx)(e.li,{children:"osjs/clipboard"}),"\n",(0,r.jsx)(e.li,{children:"osjs/middleware"}),"\n",(0,r.jsx)(e.li,{children:"osjs/tray"}),"\n",(0,r.jsx)(e.li,{children:"osjs/locale"}),"\n",(0,r.jsx)(e.li,{children:"osjs/packages"}),"\n",(0,r.jsx)(e.li,{children:"osjs/websocket"}),"\n",(0,r.jsx)(e.li,{children:"osjs/session"}),"\n",(0,r.jsx)(e.li,{children:"osjs/theme"}),"\n",(0,r.jsx)(e.li,{children:"osjs/sounds"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5E94\u7528 \u6CE8\u518C\u903B\u8F91\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u7C7B\u578B: theme, icons, sounds, application"}),"\n",(0,r.jsxs)(e.li,{children:["\u5148 preload\uFF0C\u7136\u540E\u5E94\u7528\u5185\u901A\u8FC7 ",(0,r.jsx)(e.code,{children:"osjs.register(name,callback)"})," \u6CE8\u518C\u56DE\u8C03\u5230 Packages"]}),"\n",(0,r.jsx)(e.li,{children:"Packages preload \u5B8C\u6210\u540E\u89E6\u53D1 \u6CE8\u518C\u7684 \u56DE\u8C03"}),"\n",(0,r.jsxs)(e.li,{children:["callback \u5165\u53C2\u4E3A ",(0,r.jsx)(e.code,{children:"core, args, options, metadata"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\u5E94\u7528\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u521B\u5EFA osjs/application \u4F5C\u4E3A\u4E3B\u8981 \u8FDB\u7A0B\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u901A\u8FC7 proc \u521B\u5EFA window - \u83B7\u53D6\u5230\u53EF\u6E32\u67D3\u7684 $content"}),"\n",(0,r.jsxs)(e.li,{children:["\u521B\u5EFA osjs/basic-application \u4F5C\u4E3A event-bus\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u63D0\u4F9B\u6807\u51C6\u64CD\u4F5C - dialog, vfs \u64CD\u4F5C"}),"\n",(0,r.jsx)(e.li,{children:"\u6E32\u67D3\u5230 $content"}),"\n",(0,r.jsxs)(e.li,{children:["vfs \u64CD\u4F5C\u89E6\u53D1\u4E8B\u4EF6\u5230 event\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"new-file"}),"\n",(0,r.jsx)(e.li,{children:"save-file - \u5B9E\u9645\u4FDD\u5B58\u64CD\u4F5C"}),"\n",(0,r.jsx)(e.li,{children:"open-file - \u5B9E\u9645\u8BFB\u53D6\u6587\u4EF6"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"corebase",children:"CoreBase"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ts",children:"export interface ServiceProviderOptions {\n  before?: boolean;\n  args?: object;\n}\n\nexport class ServiceProvider {\n  readonly core: CoreBase;\n  readonly options: any;\n  constructor(core: CoreBase, options: any);\n  // \u6240\u6709\u670D\u52A1\n  provides(): string[];\n  // \u521D\u59CB\u5316\n  init(): Promise<any>;\n  // \u542F\u52A8\n  start(): Promise<any>;\n  // \u9500\u6BC1\n  destroy(): void;\n}\n\nexport class CoreBase extends EventEmitter {\n  // \u9ED8\u8BA4 console\n  readonly logger: any;\n  readonly configuration: object;\n  readonly options: object;\n  booted: boolean;\n  started: boolean;\n  destroyd: boolean;\n  // Service Provider Handler\n  providers: any;\n\n  constructor(defaultConfiguration: object, configuration: object, options: object);\n\n  // \u9500\u6BC1\n  destroy(): void;\n  // \u542F\u52A8\n  boot(): Promise<boolean>;\n\n  // \u542F\u52A8\u6240\u6709\u6838\u5FC3\u670D\u52A1\n  // before?\n  // this.providers.init(false)\n  start(): Promise<boolean>;\n  // \u83B7\u53D6\u914D\u7F6E\n  config(key: string, defaultValue: any): any;\n\n  // \u6CE8\u518C service provider\n  // providers.push(new ref(core, options.args))\n  register(ref: typeof ServiceProvider, options: ServiceProviderOptions): void;\n\n  // \u6CE8\u518C instanciator provider\n  instance(name: string, callback: Function): void;\n  // \u6CE8\u518C \u5355\u4F8B provider\n  singleton(name: string, callback: Function): void;\n  // \u5B9E\u4F8B\u5316\u670D\u52A1\n  //\n  make<T>(name: string, ...args: any[]): T;\n\n  // \u670D\u52A1\u662F\u5426\u5B58\u5728\n  has(name: string): boolean;\n}\n\n"})})]})}function h(n={}){let{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(j,{...n})}):j(n)}},917776:function(n,e,s){s.d(e,{R:()=>o,x:()=>c});var i=s(7378);let r={},l=i.createContext(r);function o(n){let e=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:o(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);