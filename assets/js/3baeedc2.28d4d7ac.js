"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["4703"],{18898:function(e,n,t){t.r(n),t.d(n,{frontMatter:()=>r,toc:()=>o,default:()=>h,metadata:()=>s,assets:()=>c,contentTitle:()=>l});var s=JSON.parse('{"id":"web/dev/testing/ava","title":"Ava","description":"- avajs/ava","source":"@site/../notes/web/dev/testing/ava.md","sourceDirName":"web/dev/testing","slug":"/web/dev/testing/ava","permalink":"/notes/web/dev/testing/ava","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/web/dev/testing/ava.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1685890478000,"frontMatter":{"title":"Ava"},"sidebar":"docs","previous":{"title":"template","permalink":"/notes/web/dev/template"},"next":{"title":"jest","permalink":"/notes/web/dev/testing/jest"}}'),a=t(86106),i=t(17776);let r={title:"Ava"},l="Ava",c={},o=[{value:"\u6D4B\u8BD5\u6587\u4EF6\u5339\u914D\u903B\u8F91",id:"test-files",level:2},{value:"\u914D\u7F6E",id:"\u914D\u7F6E",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"ava",children:"Ava"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"https://github.com/avajs/ava",children:"avajs/ava"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5C0F\u3001\u5FEB\u3001\u7B80\u5355"}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.li,{children:"process.env.NODE_ENV=test"}),"\n",(0,a.jsx)(n.li,{children:"node_modules/.cache/ava"}),"\n",(0,a.jsxs)(n.li,{children:["React ",(0,a.jsx)(n.a,{href:"https://github.com/avajs/ava/blob/main/docs/recipes/react.md",children:"https://github.com/avajs/ava/blob/main/docs/recipes/react.md"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u914D\u5408 enzyme \u6D4B\u8BD5 react"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["pnpm \u4E0B ava \u4E3A shell, \u5B9E\u9645\u811A\u672C\u4E3A ",(0,a.jsx)(n.code,{children:"node_modules/ava/entrypoints/cli.mjs"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u5982\u679C\u4F7F\u7528\u4E86 WebStorm \u63D2\u4EF6\u53EF\u4EE5\u4FEE\u6539 ava \u8DEF\u5F84"}),"\n",(0,a.jsx)(n.li,{children:"\u5C06 ava \u5B89\u88C5\u5230 root \u53EF\u907F\u514D"}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u65E0 Suite/Group \u6982\u5FF5 ",(0,a.jsx)(n.a,{href:"https://github.com/avajs/ava/issues/222",children:"#222"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u6587\u4EF6\u7EAC\u5EA6\u5212\u5206"}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://thoughtbot.com/blog/mystery-guest",children:"https://thoughtbot.com/blog/mystery-guest"})}),"\n"]}),"\n"]}),"\n"]})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",metastring:'title="packages.json"',children:'{\n  "devDependencies": {\n    "ava": "*",\n    "tsx": "*"\n  },\n  "ava": {\n    "extensions": {\n      "ts": "module"\n    },\n    "nodeArguments": ["--conditions=typescript", "--loader=tsx"]\n  }\n}\n'})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"import test from 'ava';\n\ntest('foo', (t) => {\n  t.pass();\n});\n\ntest('bar', async (t) => {\n  const bar = Promise.resolve('bar');\n  t.is(await bar, 'bar');\n});\n\n// \u4E32\u884C\u6267\u884C\ntest.serial('passes serially', (t) => {\n  t.pass();\n});\n\ntest.only('will be run', (t) => {\n  t.pass();\n});\ntest.skip('will not be run', (t) => {\n  t.fail();\n});\n\ntest.todo('later');\ntest.serial.todo('later');\n\n// \u6807\u8BB0\u5931\u8D25\u6D4B\u8BD5\ntest.failing('demonstrate some bug', (t) => {\n  t.fail(); // Test will count as passed\n});\n\n// \u589E\u52A0\u8F93\u51FA\u5185\u5BB9\nimport util from 'util';\nutil.inspect.defaultOptions.depth = 5;\n"})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"test.{before,after,beforeEach,afterEach}"}),"\n",(0,a.jsx)(n.li,{children:"test.after.always"}),"\n",(0,a.jsx)(n.li,{children:"test.afterEach.always"}),"\n",(0,a.jsx)(n.li,{children:"t.context - \u6D4B\u8BD5\u4E0A\u4E0B\u6587"}),"\n",(0,a.jsx)(n.li,{children:"test.meta.file - \u5143\u4FE1\u606F"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'npx @ava/init\n\nnpx ava\nnpx ava src/hello.test.ts\n# match by title\nnpx ava src/hello.test.ts -m "db"\n\nnpx ava --watch\nDEBUG=ava:watcher npx ava --watch\n\n# tap report\nnpx ava --tap | npx tap-nyan\n'})}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/avajs/ava/blob/main/docs/06-configuration.md",children:"https://github.com/avajs/ava/blob/main/docs/06-configuration.md"})}),"\n",(0,a.jsxs)(n.li,{children:["\u4F7F\u7528 ",(0,a.jsx)(n.a,{href:"https://github.com/watson/is-ci",children:"watson/is-ci"})," \u68C0\u6D4B CI\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.a,{href:"https://github.com/watson/ci-info/blob/master/index.js",children:"https://github.com/watson/ci-info/blob/master/index.js"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"test-files",children:"\u6D4B\u8BD5\u6587\u4EF6\u5339\u914D\u903B\u8F91"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\u4EE5 ",(0,a.jsx)(n.code,{children:"_"})," \u5F00\u5934\u7684\u76EE\u5F55\u548C\u6587\u4EF6\u4F1A\u5FFD\u7565"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u9ED8\u8BA4\u6D4B\u8BD5\u6587\u4EF6\u5339\u914D\u903B\u8F91"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"test.js\nsrc/test.js\nsource/test.js\n**/test-*.js\n**/*.spec.js\n**/*.test.js\n**/test/**/*.js\n**/tests/**/*.js\n**/__tests__/**/*.js\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"\u6392\u9664\u903B\u8F91"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"**/__tests__/**/__helper__/**/*\n**/__tests__/**/__helpers__/**/*\n**/__tests__/**/__fixture__/**/*\n**/__tests__/**/__fixtures__/**/*\n**/test/**/helper/**/*\n**/test/**/helpers/**/*\n**/test/**/fixture/**/*\n**/test/**/fixtures/**/*\n**/tests/**/helper/**/*\n**/tests/**/helpers/**/*\n**/tests/**/fixture/**/*\n**/tests/**/fixtures/**/*\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u914D\u7F6E",children:"\u914D\u7F6E"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "ava": {\n    "files": ["test/**/*", "!test/exclude-files-in-this-directory", "!**/exclude-files-with-this-name.*"],\n    "ignoredByWatcher": "",\n    // --match\n    // "match": ["*oo", "!foo"],\n    // node_modules/.cache/ava\n    "cache": true,\n    // nproc\n    "concurrency": 5,\n    "workerThreads": true,\n    "failFast": true,\n    // \u6CA1\u6709 assert \u662F\u5426\u8BA4\u4E3A\u5931\u8D25\n    "failWithoutAssertions": false,\n    "environmentVariables": {\n      "MY_ENVIRONMENT_VARIABLE": "some value"\n    },\n    "tap": false,\n    "verbose": true,\n    // "snapshotDir":"",\n    "extensions": ["cjs", "mjs", "js"],\n    "require": ["./my-helper-module.js"],\n    "timeout": 0,\n    "nodeArguments": ["--trace-deprecation", "--napi-modules"],\n    // ava.config.*  \u4F7F\u7528\uFF0C\u5B9A\u4E49\u51FD\u6570\n    // sortTestFiles:"",\n    "utilizeParallelBuilds": true\n  }\n}\n'})})]})}function h(e={}){let{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},17776:function(e,n,t){t.d(n,{R:()=>r,x:()=>l});var s=t(7378);let a={},i=s.createContext(a);function r(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);