"use strict";(self.webpackChunkwener_website=self.webpackChunkwener_website||[]).push([["208169"],{305650:function(e,n,l){l.r(n),l.d(n,{frontMatter:()=>c,toc:()=>o,default:()=>h,metadata:()=>s,assets:()=>d,contentTitle:()=>r});var s=JSON.parse('{"id":"ai/dev/llama-swap","title":"llama-swap","description":"- mostlygeek/llama-swap","source":"@site/../notes/ai/dev/llama-swap.md","sourceDirName":"ai/dev","slug":"/ai/dev/llama-swap","permalink":"/notes/ai/dev/llama-swap","draft":false,"unlisted":false,"editUrl":"https://github.com/wenerme/wener/edit/master/notes/../notes/ai/dev/llama-swap.md","tags":[],"version":"current","lastUpdatedBy":"wener","lastUpdatedAt":1772429368000,"frontMatter":{"title":"llama-swap"},"sidebar":"docs","previous":{"title":"LiteLLM Inside","permalink":"/notes/ai/dev/litellm/insight"},"next":{"title":"LocalAI","permalink":"/notes/ai/dev/localai"}}'),i=l(486106),a=l(917776);let c={title:"llama-swap"},r="llama-swap",d={},o=[{value:"API",id:"api",level:2}];function t(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"llama-swap",children:"llama-swap"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/mostlygeek/llama-swap",children:"mostlygeek/llama-swap"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"MIT, Golang"}),"\n",(0,i.jsx)(n.li,{children:"\u63D0\u4F9B\u53CD\u5411\u4EE3\u7406"}),"\n",(0,i.jsx)(n.li,{children:"\u6309\u9700\u542F\u52A8 \u8FDB\u7A0B"}),"\n",(0,i.jsx)(n.li,{children:"\u53EF\u4EE5\u4F7F\u7528 proxy \u6307\u5411\u4E0A\u6E38\u670D\u52A1\uFF0Ccmd \u53EF\u4EE5\u662F docker \u542F\u52A8"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/mostlygeek/llama-swap:cuda\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"llama:\n  image: ghcr.io/mostlygeek/llama-swap:v172-cuda-b7062\n  container_name: llama\n  command:\n    - -watch-config\n    - -config\n    - /llama/llama-swap.yaml\n  volumes:\n    - ./models:/models\n    - ./models:/root/.cache/llama.cpp\n    # the user is app, home is /app, uid=10001\n    - ./models:/app/.cache/llama.cpp\n    - ./llama:/llama\n  ports:\n    - 11435:8080\n  environment:\n    HF_ENDPOINT: https://modelscope.cn\n  sysctls:\n    net.ipv6.conf.all.disable_ipv6: 1\n  deploy:\n    resources:\n      reservations:\n        devices:\n          - driver: nvidia\n            count: all\n            capabilities: [gpu]\n"})}),"\n",(0,i.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["OpenAI API\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"v1/completions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"v1/chat/completions"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"v1/embeddings"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"v1/audio/speech"}),", ",(0,i.jsx)(n.code,{children:"v1/audio/transcriptions"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"v1/images/generations"}),", ",(0,i.jsx)(n.code,{children:"v1/images/edits"})," (\u57FA\u4E8E\u4E0A\u6E38\u5F15\u64CE\u80FD\u529B\u900F\u4F20)"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u5BF9\u4E8E\u56FE\u7247\u751F\u6210 (",(0,i.jsx)(n.code,{children:"v1/images/*"}),")\uFF1A\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u539F\u7406"}),": llama-swap \u672C\u8EAB\u4E0D\u5B9E\u73B0\u4E5F\u4E0D\u4F9D\u8D56\u7279\u5B9A\u91CF\u5316\u5F15\u64CE\u5904\u7406\u56FE\u7247\u751F\u6210\uFF0C\u5B83\u53EA\u8D1F\u8D23\u4F9D\u636E\u8BF7\u6C42\u4E2D\u7684 model \u89E3\u6790\u5E76\u6309\u9700\u542F\u52A8/\u5524\u9192\u5728 ",(0,i.jsx)(n.code,{children:"llama-swap.yaml"})," \u91CC\u914D\u7F6E\u7684\u5BF9\u5E94\u7684\u4E0A\u6E38 ",(0,i.jsx)(n.code,{children:"cmd"})," \u6216 ",(0,i.jsx)(n.code,{children:"proxy"}),"\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5B9E\u73B0\u65B9\u5F0F"}),": \u53EF\u4EE5\u914D\u7F6E\u4E00\u4E2A\u5916\u90E8\u7A0B\u5E8F\uFF08\u5982 LocalAI\u3001Stable Diffusion WebUI \u52A0 OpenAI proxy\u3001\u6216\u8005\u662F\u4F7F\u7528 ComfyUI \u7684 OpenAI API \u5C01\u88C5\uFF09\uFF0C\u53EA\u8981\u4E0A\u6E38\u7AEF\u53E3\u80FD\u54CD\u5E94\u6807\u51C6\u7684 ",(0,i.jsx)(n.code,{children:"POST /v1/images/generations"})," \u8BF7\u6C42\u5373\u53EF\u88AB\u6210\u529F\u4EE3\u7406\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["llama-server\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"v1/rerank"}),", ",(0,i.jsx)(n.code,{children:"v1/reranking"}),", ",(0,i.jsx)(n.code,{children:"/rerank"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/infill"})," (\u4EE3\u7801\u8865\u5168)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/completion"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["llama-swap \u81EA\u8EAB\u7BA1\u7406\u63A5\u53E3\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/ui"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/upstream/:model_id"})," (\u76F4\u63A5\u8BBF\u95EE\u5BF9\u5E94\u4E0A\u6E38\u5B9E\u4F8B)"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"/models/unload"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/running"}),", ",(0,i.jsx)(n.code,{children:"/log"}),", ",(0,i.jsx)(n.code,{children:"/health"}),", ",(0,i.jsx)(n.code,{children:"/api/events"}),", ",(0,i.jsx)(n.code,{children:"/logs/stream"})]}),"\n",(0,i.jsx)(n.li,{children:"/health"}),"\n",(0,i.jsx)(n.li,{children:"/api/events"}),"\n",(0,i.jsx)(n.li,{children:"/logs/stream"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},917776:function(e,n,l){l.d(n,{R:()=>c,x:()=>r});var s=l(7378);let i={},a=s.createContext(i);function c(e){let n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);