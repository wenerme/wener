<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-voip/asterisk/asterisk-dialplain" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.1"><title data-rh=true>拨号计划 | Wener Live & Life</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://wener.me/notes/voip/asterisk/dialplain /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="拨号计划 | Wener Live & Life"/><meta data-rh=true name=description content="- dialplan reload 重载配置"/><meta data-rh=true property=og:description content="- dialplan reload 重载配置"/><link data-rh=true rel=icon href=/img/favicon.ico /><link data-rh=true rel=canonical href=https://wener.me/notes/voip/asterisk/dialplain /><link data-rh=true rel=alternate href=https://wener.me/notes/voip/asterisk/dialplain hreflang=en /><link data-rh=true rel=alternate href=https://wener.me/notes/voip/asterisk/dialplain hreflang=x-default /><link data-rh=true rel=preconnect href=https://37P8DMWBKF-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://wener.me/notes/voip/","name":"VoIP","position":1},{"@type":"ListItem","item":"https://wener.me/notes/voip/asterisk/","name":"Asterisk","position":2},{"@type":"ListItem","item":"https://wener.me/notes/voip/asterisk/dialplain","name":"拨号计划","position":3}]}</script><link rel=alternate type=application/rss+xml href=/story/rss.xml title="Wener Live & Life RSS Feed"><link rel=alternate type=application/atom+xml href=/story/atom.xml title="Wener Live & Life Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script><link rel=search type=application/opensearchdescription+xml title="Wener Live & Life" href=/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css><script src=https://static.cloudflareinsights.com/beacon.min.js async data-cf-beacon='{"token": "e9a1b931103044f3940ee67b78c7df70"}' defer></script><link rel=stylesheet href=/assets/css/styles.fa221ee1.css /><script src=/assets/js/runtime~main.72c320db.js defer></script><script src=/assets/js/main.c07313b6.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_jKDA href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/wener-logo-head.svg alt="Wener Logo" class="themedComponent_j2y5 themedComponent--light_v877"/><img src=/img/wener-logo-head.svg alt="Wener Logo" class="themedComponent_j2y5 themedComponent--dark_PUQY"/></div><b class="navbar__title text--truncate">Wener</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/notes>笔记</a><a class="navbar__item navbar__link" href=/story>故事</a><a class="navbar__item navbar__link" href=/notes/howto/network/dns-prevent-spoofing>指南</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/wenerme/wener target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_kUGX><use href=#theme-svg-external-link /></svg></a><div class="toggle_N7Mq colorModeToggle_vh_y"><button class="clean-btn toggleButton_PaHe toggleButtonDisabled_RC4w" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_Q188 lightToggleIcon_M1mU"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_Q188 darkToggleIcon_sEdo"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_Q188 systemToggleIcon_cOyE"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_d_Bn><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_c22C"><div class=docsWrapper_oymo><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ZPA9" type=button></button><div class=docRoot_ng2Q><aside class="theme-doc-sidebar-container docSidebarContainer_nyHU"><div class=sidebarViewport_rLoj><div class=sidebar_TmDF><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_jRin"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/notes><span title=笔记 class=linkLabel_JPPZ>笔记</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/adobe/photoshop><span title=adobe class=categoryLinkLabel_RkOu>adobe</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/ai><span title=AI class=categoryLinkLabel_RkOu>AI</span></a><button aria-label="Expand sidebar category 'AI'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/algorithm><span title=算法 class=categoryLinkLabel_RkOu>算法</span></a><button aria-label="Expand sidebar category '算法'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/blockchain><span title=区块链 class=categoryLinkLabel_RkOu>区块链</span></a><button aria-label="Expand sidebar category '区块链'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/cn><span title=CN class=categoryLinkLabel_RkOu>CN</span></a><button aria-label="Expand sidebar category 'CN'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/courses><span title=课程 class=categoryLinkLabel_RkOu>课程</span></a><button aria-label="Expand sidebar category '课程'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/culture><span title=文化 class=categoryLinkLabel_RkOu>文化</span></a><button aria-label="Expand sidebar category '文化'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/db><span title=数据库 class=categoryLinkLabel_RkOu>数据库</span></a><button aria-label="Expand sidebar category '数据库'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/dev><span title=开发 class=categoryLinkLabel_RkOu>开发</span></a><button aria-label="Expand sidebar category '开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/devops><span title=DevOps class=categoryLinkLabel_RkOu>DevOps</span></a><button aria-label="Expand sidebar category 'DevOps'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/economics><span title=经济学 class=categoryLinkLabel_RkOu>经济学</span></a><button aria-label="Expand sidebar category '经济学'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/electrical><span title=电学基础 class=categoryLinkLabel_RkOu>电学基础</span></a><button aria-label="Expand sidebar category '电学基础'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/embedded/awesome><span title=embedded class=categoryLinkLabel_RkOu>embedded</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/evolve><span title=自我成长 class=categoryLinkLabel_RkOu>自我成长</span></a><button aria-label="Expand sidebar category '自我成长'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/hardware><span title=硬件 class=categoryLinkLabel_RkOu>硬件</span></a><button aria-label="Expand sidebar category '硬件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/healthcare><span title=健康 class=categoryLinkLabel_RkOu>健康</span></a><button aria-label="Expand sidebar category '健康'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/howto/network/dns-prevent-spoofing><span title=howto class=categoryLinkLabel_RkOu>howto</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/java><span title=Java class=categoryLinkLabel_RkOu>Java</span></a><button aria-label="Expand sidebar category 'Java'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/languages><span title=语言 class=categoryLinkLabel_RkOu>语言</span></a><button aria-label="Expand sidebar category '语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/notes/linguistics><span title=Linguistics class=linkLabel_JPPZ>Linguistics</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/math><span title=数学 class=categoryLinkLabel_RkOu>数学</span></a><button aria-label="Expand sidebar category '数学'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/mgmt><span title=管理 class=categoryLinkLabel_RkOu>管理</span></a><button aria-label="Expand sidebar category '管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/network/application/dns><span title=network class=categoryLinkLabel_RkOu>network</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/ops><span title=运维 class=categoryLinkLabel_RkOu>运维</span></a><button aria-label="Expand sidebar category '运维'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/os><span title=操作系统 class=categoryLinkLabel_RkOu>操作系统</span></a><button aria-label="Expand sidebar category '操作系统'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/philosophy><span title=理念 class=categoryLinkLabel_RkOu>理念</span></a><button aria-label="Expand sidebar category '理念'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/photography><span title=摄影 class=categoryLinkLabel_RkOu>摄影</span></a><button aria-label="Expand sidebar category '摄影'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/platform><span title=平台 class=categoryLinkLabel_RkOu>平台</span></a><button aria-label="Expand sidebar category '平台'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/psychology/glossary><span title=psychology class=categoryLinkLabel_RkOu>psychology</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/queue><span title=Queue class=categoryLinkLabel_RkOu>Queue</span></a><button aria-label="Expand sidebar category 'Queue'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/security><span title=安全 class=categoryLinkLabel_RkOu>安全</span></a><button aria-label="Expand sidebar category '安全'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/service><span title=服务 class=categoryLinkLabel_RkOu>服务</span></a><button aria-label="Expand sidebar category '服务'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/software><span title=软件 class=categoryLinkLabel_RkOu>软件</span></a><button aria-label="Expand sidebar category '软件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/std><span title=标准数据 class=categoryLinkLabel_RkOu>标准数据</span></a><button aria-label="Expand sidebar category '标准数据'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--active" href=/notes/voip><span title=VoIP class=categoryLinkLabel_RkOu>VoIP</span></a><button aria-label="Collapse sidebar category 'VoIP'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--active" tabindex=0 href=/notes/voip/asterisk><span title=Asterisk class=categoryLinkLabel_RkOu>Asterisk</span></a><button aria-label="Collapse sidebar category 'Asterisk'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/agi><span title="Asterisk AGI" class=linkLabel_JPPZ>Asterisk AGI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/ami><span title="Asterisk AMI" class=linkLabel_JPPZ>Asterisk AMI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/air><span title=ARI class=linkLabel_JPPZ>ARI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/awesome><span title="Asterisk Awesome" class=linkLabel_JPPZ>Asterisk Awesome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/build><span title="Build Asterisk" class=linkLabel_JPPZ>Build Asterisk</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/cdr><span title="Asterisk CDR" class=linkLabel_JPPZ>Asterisk CDR</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/channel><span title="Asterisk 通道" class=linkLabel_JPPZ>Asterisk 通道</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/codec><span title="Asterisk 编码" class=linkLabel_JPPZ>Asterisk 编码</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/conf><span title="Asterisk 配置" class=linkLabel_JPPZ>Asterisk 配置</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/debian><span title="Asterisk Debian" class=linkLabel_JPPZ>Asterisk Debian</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/the-definitive-guide-4th><span title="Asterisk 权威指南,第四版" class=linkLabel_JPPZ>Asterisk 权威指南,第四版</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/dev><span title=开发 class=linkLabel_JPPZ>开发</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/notes/voip/asterisk/dialplain><span title=拨号计划 class=linkLabel_JPPZ>拨号计划</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/faq><span title=常见问题 class=linkLabel_JPPZ>常见问题</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/glossary><span title="Asterisk 词汇" class=linkLabel_JPPZ>Asterisk 词汇</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/inside><span title="Asterisk Inside" class=linkLabel_JPPZ>Asterisk Inside</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/ldap><span title="Asterisk LDAP" class=linkLabel_JPPZ>Asterisk LDAP</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/log><span title="Asterisk Log" class=linkLabel_JPPZ>Asterisk Log</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/moduels><span title="Asterisk Modules" class=linkLabel_JPPZ>Asterisk Modules</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/network><span title="Asterisk Network" class=linkLabel_JPPZ>Asterisk Network</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/qmi><span title="Asterisk QMI" class=linkLabel_JPPZ>Asterisk QMI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/reference><span title=参考 class=linkLabel_JPPZ>参考</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/troubleshoot><span title="Asterisk 故障排查" class=linkLabel_JPPZ>Asterisk 故障排查</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/version><span title="Asterisk 版本" class=linkLabel_JPPZ>Asterisk 版本</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/webrtc><span title="Asterisk WebRTC" class=linkLabel_JPPZ>Asterisk WebRTC</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/chan_dahdi><span title="DAHDi Channel" class=linkLabel_JPPZ>DAHDi Channel</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/chan_dongle><span title=chan_dongle class=linkLabel_JPPZ>chan_dongle</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/chan_extra><span title=chan_extra class=linkLabel_JPPZ>chan_extra</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/chan_iax><span title=chan_iax class=linkLabel_JPPZ>chan_iax</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/chan_pjsip><span title=chan_pjsip class=linkLabel_JPPZ>chan_pjsip</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/chan_sip><span title=chan_sip class=linkLabel_JPPZ>chan_sip</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/dahdi><span title=DAHDI class=linkLabel_JPPZ>DAHDI</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/iax><span title=IAX class=linkLabel_JPPZ>IAX</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/res_http><span title=res_http class=linkLabel_JPPZ>res_http</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/res_phoneprov><span title=phoneprov class=linkLabel_JPPZ>phoneprov</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/res_resolver_unbound><span title=res_resolver_unbound class=linkLabel_JPPZ>res_resolver_unbound</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/asterisk/res_sorcery><span title=res_sorcery class=linkLabel_JPPZ>res_sorcery</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/voip/dev/pjsip><span title=dev class=categoryLinkLabel_RkOu>dev</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/fonoster><span title=fonoster class=linkLabel_JPPZ>fonoster</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/freepbx><span title=FreePBX class=linkLabel_JPPZ>FreePBX</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/voip/freeswitch><span title=FreeSWITCH class=categoryLinkLabel_RkOu>FreeSWITCH</span></a><button aria-label="Expand sidebar category 'FreeSWITCH'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/hardware><span title=硬件设备 class=linkLabel_JPPZ>硬件设备</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/openvox-asterisk><span title="OpenVox Asterisk" class=linkLabel_JPPZ>OpenVox Asterisk</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/openvox><span title=OpenVox class=linkLabel_JPPZ>OpenVox</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/voip/sip/linphone><span title=sip class=categoryLinkLabel_RkOu>sip</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/awesome><span title="VoIP Awesome" class=linkLabel_JPPZ>VoIP Awesome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/faq><span title="VoIP FAQ" class=linkLabel_JPPZ>VoIP FAQ</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/voip/glossary><span title=词汇表 class=linkLabel_JPPZ>词汇表</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/web><span title=Web class=categoryLinkLabel_RkOu>Web</span></a><button aria-label="Expand sidebar category 'Web'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_NY7h"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_c8nQ><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_GAGP><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_YQ1L"><div class=docItemContainer_Wjg4><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_tiqF" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_WTWT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/notes/voip><span>VoIP</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/notes/voip/asterisk><span>Asterisk</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>拨号计划</span></ul></nav><div class="tocCollapsible_GvsH theme-doc-toc-mobile tocMobile_qJgM"><button type=button class="clean-btn tocCollapsibleButton_LnP0">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Asterisk Dialplan</h1></header>
<ul>
<li><code>dialplan reload</code> 重载配置</li>
<li><code>dialplan show 88888888@from-app</code> 测试匹配</li>
<li>cointext 名字长度为 80, 但有最后一位 null, 所以是 79</li>
<li>避免使用 <code>[general]</code>, <code>[default]</code>, 和 <code>[globals]</code> 作为名字</li>
<li>channel 中 context 名字是通道开始的点</li>
<li>搜索顺序
<ul>
<li>Explicit extensions</li>
<li>Pattern match extensions</li>
<li>Includes</li>
<li>Switches</li>
</ul>
</li>
<li>变量
<ul>
<li><code>${variable_name[:offset[:length]]}</code>
<ul>
<li>裁剪</li>
<li>offset,length 可以为负</li>
</ul>
</li>
<li>通道变量在转移后,变量不会被继承
<ul>
<li><code>_</code> 开始的变量会在单次转移后则会失效</li>
<li><code>__</code> 开始的变量会在转移后一直继承</li>
</ul>
</li>
</ul>
</li>
<li>表达式
<ul>
<li><code>$[1+1]</code></li>
<li>操作符
<ul>
<li><code>|</code>, <code>&</code>, <code>=</code>, <code>>=</code>, <code>&lt;=</code>, <code>!=</code>, <code>></code>, <code>&lt;</code>, <code>+</code>, <code>-</code></li>
<li><code>! exp</code>, <code>- exp</code></li>
<li><code>a : b</code> 字符串正则匹配
<ul>
<li>从头开始匹配</li>
<li>前后的引号会被去除</li>
<li>匹配成功, 如果有子表达式, 返回 <code>\1</code>, 否则返回匹配的字符数</li>
<li>匹配失败, 如果有字表达式, 返回 <code>null</code>, 否则返回 0</li>
</ul>
</li>
<li><code>a =~ b</code>
<ul>
<li>同 <code>:</code>, 但不从头开始匹配</li>
</ul>
</li>
<li><code>a ? b : c</code></li>
<li><code>a ~~ b</code>
<ul>
<li>字符串链接</li>
<li>会去除引号</li>
</ul>
</li>
</ul>
</li>
<li>所有的数字均为浮点数, 表达浮点数必须要以 <code>D.D</code> 的形式, 转换为整数 <code>TRUNC</code></li>
</ul>
</li>
<li>参考
<ul>
<li><a href=https://wiki.asterisk.org/wiki/display/AST/Dialplan target=_blank rel="noopener noreferrer">AST/Dialplan</a></li>
<li><a href=https://www.voip-info.org/wiki/view/Asterisk+Expressions target=_blank rel="noopener noreferrer">Asterisk Expressions</a></li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_phik alert alert--success"><div class=admonitionHeading_zxjO><span class=admonitionIcon_bSNx><svg viewBox="0 0 12 16"><path fill-rule=evenodd d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"/></svg></span>tip</div><div class=admonitionContent_R6P7><ul>
<li>使用非数字而是具体含义的名字作为不可拨号的扩展名</li>
<li>function 名字为 大写</li>
<li>application 名字 大小写无关</li>
<li>application 如果没有参数可以不写括号</li>
<li>不要使用 macro, 使用 sub routine</li>
</ul></div></div>
<div class="theme-admonition theme-admonition-caution admonition_phik alert alert--warning"><div class=admonitionHeading_zxjO><span class=admonitionIcon_bSNx><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>caution</div><div class=admonitionContent_R6P7><ul>
<li>很多 SIP 客户端在没 Answer 之前无法处理 DTMF</li>
</ul></div></div>
<div class="language-conf codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-conf codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">; ==========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 拨号计划格式</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; ==========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => name,priority,application([arg1[,arg2...]])</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; priority 可使用 n 替代 2,3,4,5,6..., 但 1 必须指定</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;   n 也可以做算术运算,例如 n+200, 但不推荐使用</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 相同的名字可以使用 same => 替代</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 123,1,Answer()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,do something</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,do something else</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,do one last thing</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 在扩展中可以给优先级指定标签,因此可以通过名字而不是一个数字来引用优先级</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 123,n(label),application()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 处理所有无效的号码</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => _.!,1,Verbose("Catch all for invalid numbers")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 处理所有号码</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => _.!,n,Verbose("Surprise - executed for all numbers!")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 引入其他上下文</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">include => context</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 变量继承</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => example,1,Set(_MyVariable=thisValue)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => example,1,Set(__MyVariable=thisValue)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 在别的通道使用变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => example,1,Verbose(1,Value of MyVariable is: ${MyVariable})</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=extensionconf>extension.conf<a href=#extensionconf class=hash-link aria-label="Direct link to extension.conf" title="Direct link to extension.conf" translate=no>​</a></h2>
<ul>
<li>general 默认配置, global 全局变量会在, 除此之外均为 context 定义</li>
<li>sip.conf allowguest=no 默认会使用 public context</li>
</ul>
<div class="language-conf codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-conf codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">[general]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 是否允许 pbx_config 修改文件 - 会丢失注释</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">static=yes</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 是否允许 dialplan save</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">writeprotect=no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 默认运行完成后会以 BUSY, CONGESTION, HANGUP 结束 - 而不是继续运行下一个匹配 extension</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">autofallthrough=no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 新的匹配算法 - extension 很多的时候速度更快 - 例如超过 50 个时可尝试开启</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; dialplan set extenpatternmatchnew false</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">extenpatternmatchnew=no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; reload 时是否重新解析全局变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">clearglobalvars=no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; user.conf 使用的 context</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">userscontext=default</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 全局变量定义</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 使用方式 ${GLOBAL(VARIABLE)}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; ${${GLOBAL(VARIABLE)}}, ${text${GLOBAL(VARIABLE)}}, ${ENV(VARIABLE)}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[globals]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">TENANT=demo</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[context]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 自动创建设备 hint extension</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">autohints=no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; extension 语法</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;exten => someexten,{priority|label{+|-}offset}[(alias)],application(arg1,arg2,...)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; hint 语法</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;exten => 6245,hint,SIP/Grandstream1&SIP/Xlite1(Joe Schmoe)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;exten => 6600,hint,park:701@parkedcalls</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;exten => 8502,hint,Queue:markq</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;exten => 8501,hint,Queue:markq_avail</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; include 语法</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 时间语法 &lt;time range>,&lt;days of week>,&lt;days of month>,&lt;months>[,&lt;timezone>]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;include => daytime,9:00-17:00,mon-fri,*,*</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;include => weekend,*,sat-sun,*,*</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">;include => weeknights,17:02-8:58,mon-fri,*,*</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; ignorepat => 9</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 使用远程的 PBX</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; switch => IAX2/user:password@bigserver/local</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; l->literal - 不处理变量，由远程处理</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; lswitch => Loopback/12${EXTEN}@othercontext</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; e-> evaluation - 处理变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; eswitch => IAX2/context@${CURSERVER}</span><br/></span></code></pre></div></div>





































<table><thead><tr><th>pattern<th>regex<tbody><tr><td><code>_</code><td>类似 JS 中的 <code>/</code>, e.g: <code>/.*/</code> <br/>将之后的内容作为模式匹配<tr><td>X<td><code>[0-9]</code><tr><td>Z<td><code>[1-9]</code><tr><td>N<td><code>[2-9]</code><tr><td>.<td><code>.*</code><tr><td>!<td><code>.+</code><tr><td><code>[15-7]</code><td>`1</table>

























<table><thead><tr><th>priority<th>mean<tbody><tr><td>1<td>1<tr><td>next,n<td>priority+1<tr><td>same,s<td>同上一个 priority<tr><td>s+1<td>=n</table>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=特殊-extension>特殊 Extension<a href=#特殊-extension class=hash-link aria-label="Direct link to 特殊 Extension" title="Direct link to 特殊 Extension" translate=no>​</a></h3>









































<table><thead><tr><th>exten<th>mean<tbody><tr><td>s<td>start<tr><td>h<td>hangup<tr><td>a<td>assistant<tr><td>e<td>exception<tr><td>i<td>invalid<tr><td>o<td>operator<tr><td>t<td>response timeout<tr><td>T<td>absolute timeout</table>
<p>[特殊 extension]</p>
<ul>
<li>a - Assistant extension
<ul>
<li>类似于 o, 只有在录语音邮件时按 <code>*</code> 触发, 主要用于访问助手.</li>
</ul>
</li>
<li>e - Exception Catchall extension
<ul>
<li>用于捕获 <code>i</code>, <code>t</code>, <code>T</code> 扩展. 可使用 <code>EXCEPTION</code> 来获取到具体异常信息</li>
</ul>
</li>
<li>h - Hangup extension
<ul>
<li>在挂断后会触发</li>
</ul>
</li>
<li>i - Invalid entry extension
<ul>
<li>当 <code>Background</code>, <code>WaitExten</code> 的输入在当前上下文中找不到匹配的扩展时触发</li>
</ul>
</li>
<li>o - Operator extension
<ul>
<li>当在录制语言邮件时按 <code>0</code> 触发, 主要用于访问操作员</li>
</ul>
</li>
<li>s - Start extension
<ul>
<li>当模拟通话接入时触发, 也可以再宏中使用</li>
<li>并不是用于捕获所有扩展, 只是简单的代表模拟通话和宏的开始.</li>
</ul>
</li>
<li>t - Response timeout extension
<ul>
<li><code>Background</code> 和 <code>WaitExten</code> 时超时</li>
</ul>
</li>
<li>T - Absolute timeout extension
<ul>
<li><code>absolute</code> 超时时触发</li>
<li><code>core show function TIMEOUT</code></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=变量>变量<a href=#变量 class=hash-link aria-label="Direct link to 变量" title="Direct link to 变量" translate=no>​</a></h2>
<ul>
<li><a href=https://wiki.asterisk.org/wiki/display/AST/Asterisk+Standard+Channel+Variables target=_blank rel="noopener noreferrer">标准的通道变量</a>
<ul>
<li><code>CALLERID(name)</code>, <code>CALLERID(name)</code> 拨号者的名字和号码, 在 Dial 之前</li>
<li><code>CHANNEL</code> 当前通道名</li>
<li><code>CONTEXT</code> 当前上下文</li>
<li><code>EXTEN</code> 当前扩展</li>
<li><code>ENV(VAR)</code> 环境变量</li>
<li><code>LEN(VAR)</code> 变量长度</li>
<li><code>PRIORITY</code> 当前拨号计划的优先级</li>
<li><code>UNIQUEID</code> 当前通话唯一标识符</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=应用控制流>应用控制流<a href=#应用控制流 class=hash-link aria-label="Direct link to 应用控制流" title="Direct link to 应用控制流" translate=no>​</a></h2>
<ul>
<li>Goto
<ul>
<li>参数 named_priority; <code>[[context,]extension,]priority</code></li>
<li>跳转失败执行 <code>i</code> (invalid) extension
<ul>
<li>不存在则执行 <code>h</code></li>
<li>不存在则直接 hangup</li>
</ul>
</li>
</ul>
</li>
<li>GotoIf(condition?label1:label2)</li>
<li>GotoIfTime(times,days_of_week,days_of_month,months?label)
<ul>
<li>time - 时间,24 小时制</li>
<li><code>GotoIfTime(09:00-17:59,mon-fri,*,*?open,s,1)</code></li>
<li><code>GotoIfTime(09:00-11:59,sat,*,*?open,s,1)</code></li>
</ul>
</li>
<li><code>Gosub([context,[exten,]]priority[(arg1,[...][argN]]))</code></li>
<li>GosubIf(condition?labeliftrue:labeliffalse)
<ul>
<li><code>GosubIf($["${CALLERID(num)}" = ""]?setcallerid,1)</code></li>
<li>label 为 <code>[[context,]extension,]priority</code></li>
</ul>
</li>
<li><code>Return([value])</code></li>
<li>Macro(macroname,arg1,arg2...)
<ul>
<li>实际执行为 <code>macro-macroname</code>, s extension</li>
<li>执行 macro 会将 context 变为当前 macro</li>
<li>最多 7 层</li>
<li>MACRO_EXTEN</li>
<li>MACRO_CONTEXT</li>
<li>MACRO_PRIORITY</li>
<li>ARG1...ARGN</li>
<li>MACRO_OFFSET - 结束时设置则会跳转到 MACRO_OFFSET+n+1 如果不存在调整 n+1</li>
<li>Macro 里不能使用 h - Gosub 可以</li>
</ul>
</li>
<li>MacroExit</li>
<li>StackPop
<ul>
<li>弹出栈 - 移除上一次 Gosub 位置</li>
</ul>
</li>
<li><code>Exec(appname(arguments))</code></li>
<li><code>ExecIf(expression?appiftrue:[appiffalse])</code></li>
<li><code>ExecIfTime(times,weekdays,mdays,months,[timezone]?appname[(appargs]))</code></li>
<li>TryExec(appname(arguments))</li>
</ul>
<div class="language-ini codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-ini codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token key attr-name" style="color:rgb(255, 203, 107)">same</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">=</span><span class="token value attr-value">> n,NoOp(Macro From ${MACRO_CONTEXT},${MACRO_EXTEN},${MACRO_PRIORITY})</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">; same => n,Goto(${MACRO_CONTEXT},${MACRO_EXTEN},${MATH(${MACRO_PRIORITY}+1,int)})</span><br/></span></code></pre></div></div>
<p><strong>Goto vs GoSub</strong></p>
<ul>
<li>Goto
<ul>
<li>修改当前上下文</li>
</ul>
</li>
<li>GoSub
<ul>
<li>保留当前上下文</li>
<li>可以 Return</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=函数控制流>函数控制流<a href=#函数控制流 class=hash-link aria-label="Direct link to 函数控制流" title="Direct link to 函数控制流" translate=no>​</a></h2>
<ul>
<li><code>IF(expr?[true][:false])</code>
<ul>
<li>例如 <code>exten => 123,1,Set(something=${IF($[2 > 1]?foo:bar)})</code></li>
</ul>
</li>
<li><code>IFTIME(times,days_of_week,days_of_month,months?[true][:false])</code></li>
<li>DIALPLAN_EXISTS(context,extension,priority)</li>
<li>EXISTS(data)</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=application>Application<a href=#application class=hash-link aria-label="Direct link to Application" title="Direct link to Application" translate=no>​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=dial>Dial<a href=#dial class=hash-link aria-label="Direct link to Dial" title="Direct link to Dial" translate=no>​</a></h3>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">Dial([Technology/Resource[&Technology2/Resource2[&...]]][,timeout[,options[,URL]]])</span><br/></span></code></pre></div></div>
<ul>
<li>A(x)
<ul>
<li>播放 announcement</li>
</ul>
</li>
<li>a
<ul>
<li>立即响应</li>
</ul>
</li>
<li><code>b([[context^]exten^]priority[(arg1[^...][^argN])])</code></li>
<li><code>B([[context^]exten^]priority[(arg1[^...][^argN])])</code>
<ul>
<li>dial 多个时</li>
</ul>
</li>
<li>C - 重置 CDR</li>
<li>c - 如果呼叫取消，将 HANGUPCAUSE 设置为 answered elsewhere</li>
<li>d</li>
<li><code>D([called][:calling[:progress]])</code>
<ul>
<li>被叫接通后发送 DTMF</li>
<li>called 发送给被叫，calling 发送给主叫，progress 接收到 PROGRESS 后发送</li>
</ul>
</li>
<li>e - 呼叫结束后执行 <code>h</code></li>
<li><code>f([x])</code></li>
<li><code>F([[context^]exten^]priority)</code></li>
<li>F</li>
<li>g - hangup 后继续执行</li>
<li><code>G([[context^]exten^]priority)</code> - 接通后跳转</li>
<li>h - 被叫发送 DTMF 挂断 - <code>features.conf</code> 定义</li>
<li>H - 主叫发送 DTMF 挂断 - <code>features.conf</code> 定义</li>
<li>i - 忽略 forward</li>
<li>I</li>
<li>k - 被叫发送 DTMF parking - <code>features.conf</code> 定义</li>
<li>K - 主叫发送 DTMF parking - <code>features.conf</code> 定义</li>
<li><code>L(x[:y[:z]])</code> - 呼叫时长限制
<ul>
<li>x 最大呼叫时间 - ms</li>
<li>y 到时间播放 warning - ms</li>
<li>z 播放 warning 重复时间 - ms</li>
<li>LIMIT_PLAYAUDIO_CALLER</li>
<li>LIMIT_PLAYAUDIO_CALLEE</li>
<li>LIMIT_TIMEOUT_FILE</li>
<li>LIMIT_CONNECT_FILE</li>
<li>LIMIT_WARNING_FILE</li>
</ul>
</li>
<li><code>m([class])</code>
<ul>
<li>Provide hold music</li>
</ul>
</li>
<li><code>M(macro[^arg[^...]])</code> - 在被叫接通前执行 macro</li>
<li><code>n([delete])</code>
<ul>
<li>delete=1 删除录音 introduction</li>
</ul>
</li>
<li>N</li>
<li><code>o([x])</code></li>
<li><code>O([mode])</code>
<ul>
<li>operator services</li>
</ul>
</li>
<li>p - screening mode</li>
<li><code>P([x])</code> - privacy mode</li>
<li>Q(cause)
<ul>
<li>未接通端返回指定结果 - 默认 ANSWERED_ELSEWHERE</li>
<li><code>Q.850/Q.931 &lt;cause></code> - NO_ANSWER, USER_BUSY, CALL_REJECTED, ANSWERED_ELSEWHERE</li>
</ul>
</li>
<li><code>r([tone])</code> - Indicate ringing to the calling party, even if the called party isn't actually ringing.
<ul>
<li>tone 在 indications.conf 定义</li>
</ul>
</li>
<li>R - 同 r, Allow interruption of the ringback if early media is received on the channel.</li>
<li>S(x) - 接通 x 秒后挂断</li>
<li>s(x) - outgoing CallerID tag parameter</li>
<li>t - DTMF transfer</li>
<li>T</li>
<li><code>U(x[^arg[^...]])</code></li>
<li>u(x)
<ul>
<li>x
'allowed_not_screened'
'allowed_passed_screen' 'allowed_failed_screen' 'allowed'
'prohib_not_screened' 'prohib_passed_screen' 'prohib_failed_screen'
'prohib' 'unavailable'</li>
</ul>
</li>
<li>w - one-touch recording</li>
<li>W - one-touch recording</li>
<li>x - 被叫发送 DTMF 录音 - one-touch automixmonitor</li>
<li>X - 主叫发送 DTMF 录音</li>
<li>z - when call forward, cancel any dial timeout</li>
</ul>

























































<table><thead><tr><th>var<th>desc<tbody><tr><td>DIALEDTIME<td>time from dialing a channel until when it is disconnected.<tr><td>DIALEDTIME_MS<td><tr><td>ANSWEREDTIME<td>实际通话时间<tr><td>ANSWEREDTIME_MS<td><tr><td>RINGTIME<td>第一个 RING 事件时间，如果没有响铃则没有<tr><td>RINGTIME_MS<td><tr><td>PROGRESSTIME<td>第一个 PROGRESS 事件<tr><td>PROGRESSTIME_MS<td><tr><td>DIALEDPEERNAME<td>name of the outbound channel that answered the call.<tr><td>DIALEDPEERNUMBER<td>number that was dialed for the answered outbound channel.<tr><td>FORWARDERNAME<td>If a call forward occurred, the name of the forwarded channel.<tr><td>DIALSTATUS<td>CHANUNAVAIL, CONGESTION, NOANSWER, BUSY, ANSWER, CANCEL, DONTCALL,TORTURE,INVALIDARGS</table>
<ul>
<li>DONTCALL
For the Privacy and Screening Modes. Will be set if the called
party chooses to send the calling party to the 'Go Away' script.</li>
<li>TORTURE
For the Privacy and Screening Modes. Will be set if the called
party chooses to send the calling party to the 'torture' script.</li>
</ul>
<div class="language-conf codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-conf codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># dial 两个 - 45s 超时</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Dial(PJSIP/alice&PJIP/bob,45)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 未接通的端返回 NO_ANSWER 而不是 ANSWERED_ELSEWHERE</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Dial(PJSIP/alice&PJSIP/bob,,Q(NO_ANSWER))</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=demo>Demo<a href=#demo class=hash-link aria-label="Direct link to Demo" title="Direct link to Demo" translate=no>​</a></h2>
<div class="language-conf codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-conf codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># 将拨打到 900X 的转发到 SIP, 并进行录音</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => _900X,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Verbose(2, Forward call ${EXTEN})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Verbose(2, Monitor file ${EXTEN}.${UNIQUEID}.wav)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,MixMonitor(${EXTEN}.${UNIQUEID}.wav,ab)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Dial(SIP/${EXTEN},30,m())</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Log(NOTICE, Forward call ${EXTEN} result: ${DIALSTATUS})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,StopMixMonitor()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,GotoIf($["${DIALSTATUS}" = "BUSY"]?busy:unavailable)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    ; 占线</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n(busy),NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Verbose(2, Failed Forward ${EXTEN}: Busy now)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Playback(vm-no)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Hangup()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    ; 无人接听</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n(unavailable),NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Verbose(2, Failed Forward ${EXTEN}: No body)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Playback(vm-nobodyavail)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    same => n,Hangup()</span><br/></span></code></pre></div></div>
<ul>
<li>简单用于测试的拨号计划</li>
</ul>
<div class="language-conf codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-conf codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">[default]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => _9XXXXXX!,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(DAHDI/g1/${EXTEN:1})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 1992,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Answer()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Playback(demo-instruct)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[from-pstn]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => _X!,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Answer()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Playback(demo-instruct)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=command>Command<a href=#command class=hash-link aria-label="Direct link to Command" title="Direct link to Command" translate=no>​</a></h2>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># 请求发起通话</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">channel originate SIP/9001 extension 9002@public</span><br/></span></code></pre></div></div>
<ul>
<li>channel
<ul>
<li><code>originate &lt;tech/data> application &lt;appname> [appdata]</code></li>
<li><code>originate &lt;tech/data> extension [exten@][context]</code>
<ul>
<li>发起通话</li>
<li>发起通话时的 CALLER 需要调用者进行设置, 或者在 extension 中设置, 否则默认为 asterisk</li>
<li>例如在 extension 中设置
<ul>
<li><code>same => n,Set(CALLERID(num)=54321)</code></li>
<li><code>same => n,Set(CALLERID(name)=Asterisk)</code></li>
</ul>
</li>
</ul>
</li>
<li><code>redirect &lt;channel> &lt;[[context,]exten,]priority></code>
<ul>
<li>重定向一个通道到一个扩展</li>
</ul>
</li>
<li><code>hangup &lt;channel>|&lt;all></code>
<ul>
<li>挂断所有或单个通道</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=ael>AEL<a href=#ael class=hash-link aria-label="Direct link to AEL" title="Direct link to AEL" translate=no>​</a></h3>
<ul>
<li><a href="https://wiki.asterisk.org/wiki/pages/viewpage.action?pageId=4620445" target=_blank rel="noopener noreferrer">Asterisk Extension Language</a></li>
<li><a href=https://wiki.asterisk.org/wiki/display/AST/AEL+version+2+BNF target=_blank rel="noopener noreferrer">AEL version 2 BNF</a></li>
<li><a href=https://github.com/asterisk/asterisk/blob/master/utils/conf2ael.c target=_blank rel="noopener noreferrer">conf2ael</a>
<ul>
<li>conf 转 ael 工具</li>
</ul>
</li>
<li><a href=https://github.com/asterisk/asterisk/tree/master/res/ael target=_blank rel="noopener noreferrer">res/ael</a>
<ul>
<li>源码</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=applications>Applications<a href=#applications class=hash-link aria-label="Direct link to Applications" title="Direct link to Applications" translate=no>​</a></h2>
<ul>
<li>Answer()
<ul>
<li>建立通道</li>
</ul>
</li>
<li>Playback(filename)
<ul>
<li>播放预先录制好的声音文件</li>
<li>预先附带的文件位于 /var/lib/asterisk/sounds, 但是是有语言限制的,主要注意</li>
<li>core show sounds 查看所有的, core show sound 查看单个</li>
<li>filename 可以是绝对路径,也可以是相对于音频文件夹的相对路径</li>
<li>filename 可以不带扩展类型,会尝试播放最好编码的文件</li>
</ul>
</li>
<li>Hangup([code])
<ul>
<li>code 为 ISDN cause code</li>
</ul>
</li>
<li>Progress()
<ul>
<li>主要用于返回通话过程信息给对方,部分服务提供商可能对此有要求,当遇到奇怪问题的时候可以试试</li>
</ul>
</li>
<li>Goto(context,extension,priority)</li>
<li>Goto(extension,priority)</li>
<li>Goto(priority)
<ul>
<li>跳转到其他的位置</li>
</ul>
</li>
<li>Background()
<ul>
<li>在后台播放音频,但是是会等待 DTMF</li>
<li>与 Playback 类似, 但用户马上可以做出操作而不是等待声音播放完成</li>
</ul>
</li>
<li>WaitExten([timeout])
<ul>
<li>当 Background 播放完成后使用改程序等待 DTMF 数字输入</li>
<li>timeout 如果不传则会使用默认的, 参考 TIMEOUT()</li>
<li>如果输入的扩展不存在则会使用 i 扩展</li>
<li>如果超时了则会使用 t</li>
</ul>
</li>
<li>Dial(destination[,timeout[,option[,URI]]])
<ul>
<li>destination
<ul>
<li>DAHDI/1 模拟电话的 FXS 通道. DAHDI 技术, 资源(通道标识符) 1</li>
<li>SIP/0004F2001122</li>
<li>IAX2/Softphone</li>
<li>同时多方拨号 DAHDI/1&SIP/0004F2001122&IAX2/Softphone, 但只会接通第一个</li>
<li>远程 VoIP <code>technology/user[:password]@remote_host[:port][/remote_extension]</code></li>
</ul>
</li>
<li>如果拨号失败会设置变量 DIALSTATUS 记录失败原因</li>
<li>DIALSTATUS
<ul>
<li>CHANUNAVAIL</li>
<li>CONGESTION</li>
<li>NOANSWER</li>
<li>BUSY</li>
<li>ANSWER</li>
<li>CANCEL</li>
<li>DONTCALL</li>
<li>TORTURE</li>
<li>INVALIDARGS</li>
</ul>
</li>
<li>Digium 演示服务 Dial(DAHDI/[gGrR]channel_or_group[/remote_extension])</li>
<li>例如 Dial(IAX2/guest@misery.digium.com/s)</li>
<li>如果拨号成功则会桥接过去,而不会继续执行</li>
</ul>
</li>
</ul>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 502,1,Dial(DAHDI/1,10)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  ; 无人接听</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Playback(vm-nobodyavail)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span></code></pre></div></div>
<ul>
<li>
<p>option</p>
<ul>
<li><code>A(x)</code> 播放提示音文件 <code>x</code></li>
<li><code>b([[context^]exten^]priority[(arg1[^...][^argN])])</code>
<ul>
<li>在呼出前跳转到指定位置, 使用新的通道</li>
</ul>
</li>
<li><code>B([[context^]exten^]priority[(arg1[^...][^argN])])</code>
<ul>
<li>在呼出前跳转到指定位置, 使用当前通道</li>
</ul>
</li>
<li><code>R</code>
<ul>
<li>重置当前 CDR</li>
</ul>
</li>
<li><code>c</code></li>
</ul>
<p>t: Allow the called party to transfer the calling party by sending the DTMF
sequence defined in "features.conf". This setting does not perform policy
enforcement on transfers initiated by other methods.</p>
<p>T: Allow the calling party to transfer the called party by sending the DTMF
sequence defined in "features.conf". This setting does not perform policy
enforcement on transfers initiated by other methods.</p>
<ul>
<li>m,当在拨号时使用 moh 而不是对方的声音</li>
</ul>
</li>
<li>
<p>URI 很少使用, 在支持的环境下可能会打开该 URI 指向的网页</p>
</li>
<li>
<p>没有的参数可以留空 Dial(DAHDI/1,,m)</p>
</li>
<li>
<p>Set()</p>
<ul>
<li>设置变量</li>
<li>全局变量</li>
<li>通道变量
<ul>
<li>${EXTEN} 通道名</li>
</ul>
</li>
<li>环境变量(${ENV(var)})</li>
<li>变量操作
<ul>
<li><code>${EXTEN:x}</code> 移除前面 x 位</li>
<li><code>${EXTEN:x:y}</code> y 为长度</li>
<li>x,y 可以为负</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="language-conf codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-conf codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 301,1,Set(LEIF=SIP/0000FFFF0001)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  ; 对变量的应用</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(${LEIF})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 全局变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[globals]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">LEIF=SIP/0000FFFF0001</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; 修改通道相关的变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; gives the choice of (1) French, (2) Spanish, or (3) German</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => s,1,Background(choose-language)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">   same => n,WaitExten(5)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 1,1,Set(CHANNEL(language)=fr)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 2,1,Set(CHANNEL(language)=es)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => 3,1,Set(CHANNEL(language)=de)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">; the next priority for extensions 1, 2, or 3 would be handled here</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">exten => _[123],n,Goto(menu,s,1)</span><br/></span></code></pre></div></div>
<ul>
<li>SayNumber(number)
<ul>
<li>报数, number 不能过大</li>
</ul>
</li>
<li>SayDigits(digits)
<ul>
<li>说出每个数字</li>
</ul>
</li>
<li>Verbose([level,]message)
<ul>
<li><code>Verbose(2, Call from VoIP network to ${EXTEN})</code></li>
<li>日志</li>
</ul>
</li>
<li>Monitor/StopMonitor</li>
<li>MixMonitor(filename.extension[,options[,command]])/StopMixMonitor
<ul>
<li>通话录音</li>
<li>建议使用 Mix, 因为 Monitor 只会录制进的或出的</li>
<li>建议录制为 wav , 每天归档时可考虑转换为 ogg</li>
<li>默认存放目录 <code>/var/spool/asterisk/monitor</code></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=dial-1>Dial<a href=#dial-1 class=hash-link aria-label="Direct link to Dial" title="Direct link to Dial" translate=no>​</a></h2>
<ul>
<li><code>Dial(PJSIP/${EXTEN})</code>
<ul>
<li>呼叫 aor 对应的第一个 contact</li>
</ul>
</li>
<li><code>Dial(${PJSIP_DIAL_CONTACTS(${EXTEN})})</code>
<ul>
<li>呼叫 aor 对应的所有 contact</li>
</ul>
</li>
<li><code>Dial(PJSIP/mytrunk/sip:${EXTEN:1}@203.0.113.1:5060)</code>
<ul>
<li>指定线路和 URL</li>
</ul>
</li>
<li><code>Dial(PJSIP/${EXTEN:1}@mytrunk)</code>
<ul>
<li>选择 aor 中匹配线路的 contact</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=dial-help>Dial Help<a href=#dial-help class=hash-link aria-label="Direct link to Dial Help" title="Direct link to Dial Help" translate=no>​</a></h3>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">-= Info about application 'Dial' =-</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[Synopsis]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Attempt to connect to another device or endpoint and bridge the call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[Description]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">This application will place calls to one or more specified channels. As soon as</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">one of the requested channels answers, the originating channel will be</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">answered, if it has not already been answered. These two channels will then be</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">active in a bridged call. All other channels that were requested will then be</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">hung up.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Unless there is a timeout specified, the Dial application will wait</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">indefinitely until one of the called channels answers, the user hangs up, or if</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">all of the called channels are busy or unavailable. Dialplan execution will</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">continue if no requested channels can be called, or if the timeout expires.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">This application will report normal termination if the originating channel</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">hangs up, or if the call is bridged and either of the parties in the bridge</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">ends the call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">If the ${OUTBOUND_GROUP} variable is set, all peer channels created by this</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">application will be put into that group (as in 'Set(GROUP()=...'). If the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${OUTBOUND_GROUP_ONCE} variable is set, all peer channels created by this</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">application will be put into that group (as in 'Set(GROUP()=...'). Unlike</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${OUTBOUND_GROUP}, however, the variable will be unset after use.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial with 30 second timeout</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,30)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Parallel dial with 45 second timeout</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice&PJIP/bob,45)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial with 'g' continuation option</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,,g)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Log(NOTICE, Alice call result: ${DIALSTATUS})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial with transfer/recording features for calling party</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,,TX)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial with call length limit</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,,L(60000:30000:10000))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial alice and bob and send NO_ANSWER to bob instead of</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">ANSWERED_ELSEWHERE when alice answers</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice&PJSIP/bob,,Q(NO_ANSWER))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial with pre-dial subroutines</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> [default]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> exten => callee_channel,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Log(NOTICE, I'm called on channel ${CHANNEL} prior to it starting</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  the dial attempt)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Return()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> exten => called_channel,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Log(NOTICE, I'm called on outbound channel ${CHANNEL} prior to it</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  being used to dial someone)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Return()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> exten => _X.,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,,b(default^called_channel^1)B(default^callee_chann</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  l^1))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial with post-answer subroutine executed on outbound channel</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> [default]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> exten => called_channel,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Playback(hello)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Return()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> exten => _X.,1,NoOp()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,,U(default^called_channel^1))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Hangup()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Example: Dial into ConfBridge using 'G' option</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Dial(PJSIP/alice,,G(jump_to_here))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n(jump_to_here),Goto(confbridge)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n,Goto(confbridge)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  same => n(confbridge),ConfBridge(${EXTEN})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">This application sets the following channel variables:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${DIALEDTIME}: This is the time from dialing a channel until when it is</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">disconnected.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${ANSWEREDTIME}: This is the amount of time for actual call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${DIALEDPEERNAME}: The name of the outbound channel that answered the call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${DIALEDPEERNUMBER}: The number that was dialed for the answered outbound</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${FORWARDERNAME}: If a call forward occurred, the name of the forwarded</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">${DIALSTATUS}: This is the status of the call</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    CHANUNAVAIL</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    CONGESTION</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOANSWER</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    BUSY</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    ANSWER</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    CANCEL</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    DONTCALL: For the Privacy and Screening Modes. Will be set if the called</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    party chooses to send the calling party to the 'Go Away' script.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    TORTURE: For the Privacy and Screening Modes. Will be set if the called</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    party chooses to send the calling party to the 'torture' script.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    INVALIDARGS</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[Syntax]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Dial(Technology/Resource[&Technology2/Resource2[&...]][,timeout[,options[,URL]]])</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[Arguments]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Technology/Resource</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Specification of the device(s) to dial.  These must be in the format of</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    'Technology/Resource', where &lt;Technology> represents a particular channel</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    driver, and &lt;Resource> represents a resource available to that particular</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    channel driver.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Technology2/Resource2</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Optional extra devices to dial in parallel</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    If you need more than one enter them as Technology2/Resource2&Technology3/R</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    source3&.....</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">timeout</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Specifies the number of seconds we attempt to dial the specified devices.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    If not specified, this defaults to 136 years.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">options</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    A(x):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        x - The file to play to the called party</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Play an announcement to the called party, where &lt;x> is the prompt to be played</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    a: Immediately answer the calling channel when the called channel answers</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    in all cases. Normally, the calling channel is answered when the called</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    channel answers, but when options such as 'A()' and 'M()' are used, the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    calling channel is not answered until all actions on the called channel</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    (such as playing an announcement) are completed.  This option can be used</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    to answer the calling channel before doing anything on the called channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    You will rarely need to use this option, the default behavior is adequate</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    in most cases.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    b([[context^]exten^]priority[(arg1[^...][^argN])]): Before initiating an</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    outgoing call, 'Gosub' to the specified location using the newly created</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    channel.  The 'Gosub' will be executed for each destination channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    B([[context^]exten^]priority[(arg1[^...][^argN])]): Before initiating the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    outgoing call(s), 'Gosub' to the specified location using the current</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    C: Reset the call detail record (CDR) for this call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    c: If the Dial() application cancels this call, always set ${HANGUPCAUSE}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    to 'answered elsewhere'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    d: Allow the calling user to dial a 1 digit extension while waiting for a</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    call to be answered. Exit to that extension if it exists in the current</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    context, or the context defined in the ${EXITCONTEXT} variable, if it</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    exists.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: Many SIP and ISDN phones cannot send DTMF digits until the call is</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    connected.  If you wish to use this option with these phones, you can use</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    the 'Answer' application before dialing.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    D([called][:calling[:progress]]): Send the specified DTMF strings *after*</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    the called party has answered, but before the call gets bridged.  The</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    &lt;called> DTMF string is sent to the called party, and the &lt;calling> DTMF</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string is sent to the calling party.  Both arguments can be used alone.  If</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    &lt;progress> is specified, its DTMF is sent to the called party immediately</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    after receiving a 'PROGRESS' message.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    See 'SendDTMF' for valid digits.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    e: Execute the 'h' extension for peer after the call ends</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    f([x]): If &lt;x> is not provided, force the CallerID sent on a call-forward</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    or deflection to the dialplan extension of this 'Dial()' using a dialplan</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    'hint'. For example, some PSTNs do not allow CallerID to be set to anything</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    other than the numbers assigned to you. If &lt;x> is provided, force the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    CallerID sent to &lt;x>.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    F([[context^]exten^]priority): When the caller hangs up, transfer the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    *called* party to the specified destination and *start* execution at that</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    location.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: Any channel variables you want the called channel to inherit from the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    caller channel must be prefixed with one or two underbars ('_').</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    F: When the caller hangs up, transfer the *called* party to the next</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    priority of the current extension and *start* execution at that location.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: Any channel variables you want the called channel to inherit from the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    caller channel must be prefixed with one or two underbars ('_').</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: Using this option from a Macro() or GoSub() might not make sense as</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    there would be no return points.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    g: Proceed with dialplan execution at the next priority in the current</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    extension if the destination channel hangs up.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    G([[context^]exten^]priority): If the call is answered, transfer the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    calling party to the specified &lt;priority> and the called party to the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    specified &lt;priority> plus one.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: You cannot use any additional action post answer options in</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    conjunction with this option.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    h: Allow the called party to hang up by sending the DTMF sequence defined</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    for disconnect in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    H: Allow the calling party to hang up by sending the DTMF sequence defined</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    for disconnect in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: Many SIP and ISDN phones cannot send DTMF digits until the call is</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    connected.  If you wish to allow DTMF disconnect before the dialed party</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    answers with these phones, you can use the 'Answer' application before</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    dialing.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    i: Asterisk will ignore any forwarding requests it may receive on this dial</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    attempt.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    I: Asterisk will ignore any connected line update requests or any</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    redirecting party update requests it may receive on this dial attempt.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    k: Allow the called party to enable parking of the call by sending the DTMF</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    sequence defined for call parking in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    K: Allow the calling party to enable parking of the call by sending the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    DTMF sequence defined for call parking in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    L(x[:y[:z]]):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        x - Maximum call time, in milliseconds</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        y - Warning time, in milliseconds</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        z - Repeat time, in milliseconds</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Limit the call to &lt;x> milliseconds. Play a warning when &lt;y> milliseconds are</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">left. Repeat the warning every &lt;z> milliseconds until time expires.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    This option is affected by the following variables:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${LIMIT_PLAYAUDIO_CALLER}:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            yes</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            If set, this variable causes Asterisk to play the prompts to the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            caller.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${LIMIT_PLAYAUDIO_CALLEE}:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            yes</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            no</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            If set, this variable causes Asterisk to play the prompts to the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            callee.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${LIMIT_TIMEOUT_FILE}:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            filename</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            If specified, &lt;filename> specifies the sound prompt to play when</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            the timeout is reached. If not set, the time remaining will be</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            announced.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${LIMIT_CONNECT_FILE}:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            filename</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            If specified, &lt;filename> specifies the sound prompt to play when</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            the call begins. If not set, the time remaining will be announced.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${LIMIT_WARNING_FILE}:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            filename</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            If specified, &lt;filename> specifies the sound prompt to play as a</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            warning when time &lt;x> is reached. If not set, the time remaining</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            will be announced.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    m([class]): Provide hold music to the calling party until a requested</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    channel answers. A specific music on hold &lt;class> (as defined in</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    "musiconhold.conf") can be specified.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    M(macro[^arg[^...]]):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        macro - Name of the macro that should be executed.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        arg - Macro arguments</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Execute the specified &lt;macro> for the *called* channel before connecting to the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">calling channel. Arguments can be specified to the Macro using '^' as a</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">delimiter. The macro can set the variable ${MACRO_RESULT} to specify the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">following actions after the macro is finished executing:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${MACRO_RESULT}: If set, this action will be taken after the macro</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        finished executing.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            ABORT: Hangup both legs of the call</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            CONGESTION: Behave as if line congestion was encountered</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            BUSY: Behave as if a busy signal was encountered</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            CONTINUE: Hangup the called party and allow the calling party to</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            continue dialplan execution at the next priority</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            GOTO:[[&lt;context>^]&lt;exten>^]&lt;priority>: Transfer the call to the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            specified destination.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: You cannot use any additional action post answer options in</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    conjunction with this option. Also, pbx services are run on the peer</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    (called) channel, so you will not be able to set timeouts via the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    'TIMEOUT()' function in this macro.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    WARNING!!!: Be aware of the limitations that macros have, specifically with</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    regards to use of the 'WaitExten' application. For more information, see</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    the documentation for 'Macro()'.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    n([delete]):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        delete - With &lt;delete> either not specified or set to '0', the recorded</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        introduction will not be deleted if the caller hangs up while the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        remote party has not yet answered.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> - With &lt;delete> set to '1', the introduction will always be deleted.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">This option is a modifier for the call screening/privacy mode. (See the 'p' and</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">'P' options.) It specifies that no introductions are to be saved in the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">"priv-callerintros" directory.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    N: This option is a modifier for the call screening/privacy mode. It</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    specifies that if CallerID is present, do not screen the call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    o([x]): If &lt;x> is not provided, specify that the CallerID that was present</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    on the *calling* channel be stored as the CallerID on the *called* channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    This was the behavior of Asterisk 1.0 and earlier. If &lt;x> is provided,</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    specify the CallerID stored on the *called* channel. Note that</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    'o(${CALLERID(all)})' is similar to option 'o' without the parameter.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    O([mode]):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        mode - With &lt;mode> either not specified or set to '1', the originator</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        hanging up will cause the phone to ring back immediately.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> - With &lt;mode> set to '2', when the operator flashes the trunk, it will ring</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"> their phone back.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Enables *operator services* mode.  This option only works when bridging a DAHDI</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">channel to another DAHDI channel only. if specified on non-DAHDI interfaces, it</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">will be ignored. When the destination answers (presumably an operator services</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">station), the originator no longer has control of their line. They may hang up,</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">but the switch will not release their line until the destination party (the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">operator) hangs up.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    p: This option enables screening mode. This is basically Privacy mode</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    without memory.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    P([x]): Enable privacy mode. Use &lt;x> as the family/key in the AstDB</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    database if it is provided. The current extension is used if a database</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    family/key is not specified.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Q(cause): Specify the Q.850/Q.931 &lt;cause> to send on unanswered channels</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    when another channel answers the call. As with 'Hangup()', &lt;cause> can be a</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    numeric cause code or a name such as 'NO_ANSWER', 'USER_BUSY',</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    'CALL_REJECTED' or 'ANSWERED_ELSEWHERE' (the default if Q isn't specified).</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    You can also specify '0' or 'NONE' to send no cause.  See the "causes.h"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    file for the full list of valid causes and names.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: chan_sip does not support setting the cause on a CANCEL to anything</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    other than ANSWERED_ELSEWHERE.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    r([tone]): Default: Indicate ringing to the calling party, even if the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    called party isn't actually ringing. Pass no audio to the calling party</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    until the called channel has answered.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        tone - Indicate progress to calling party. Send audio 'tone' from the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        "indications.conf" tonezone currently in use.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    R: Default: Indicate ringing to the calling party, even if the called party</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    isn't actually ringing.  Allow interruption of the ringback if early media</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    is received on the channel.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    S(x): Hang up the call &lt;x> seconds *after* the called party has answered</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    the call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    s(x): Force the outgoing CallerID tag parameter to be set to the string</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    &lt;x>.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    Works with the 'f' option.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    t: Allow the called party to transfer the calling party by sending the DTMF</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    sequence defined in "features.conf". This setting does not perform policy</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    enforcement on transfers initiated by other methods.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    T: Allow the calling party to transfer the called party by sending the DTMF</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    sequence defined in "features.conf". This setting does not perform policy</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    enforcement on transfers initiated by other methods.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    U(x[^arg[^...]]):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        x - Name of the subroutine to execute via 'Gosub'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        arg - Arguments for the 'Gosub' routine</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Execute via 'Gosub' the routine &lt;x> for the *called* channel before connecting</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">to the calling channel. Arguments can be specified to the 'Gosub' using '^' as</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">a delimiter. The 'Gosub' routine can set the variable ${GOSUB_RESULT} to</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">specify the following actions after the 'Gosub' returns.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        ${GOSUB_RESULT}:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            ABORT: Hangup both legs of the call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            CONGESTION: Behave as if line congestion was encountered.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            BUSY: Behave as if a busy signal was encountered.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            CONTINUE: Hangup the called party and allow the calling party to</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            continue dialplan execution at the next priority.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            GOTO:[[&lt;context>^]&lt;exten>^]&lt;priority>: Transfer the call to the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            specified destination.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    NOTE: You cannot use any additional action post answer options in</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    conjunction with this option. Also, pbx services are run on the peer</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    (called) channel, so you will not be able to set timeouts via the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    'TIMEOUT()' function in this routine.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    u(x):</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        x - Force the outgoing callerid presentation indicator parameter to be</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        set to one of the values passed in &lt;x>: 'allowed_not_screened'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        'allowed_passed_screen' 'allowed_failed_screen' 'allowed'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        'prohib_not_screened' 'prohib_passed_screen' 'prohib_failed_screen'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        'prohib' 'unavailable'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Works with the 'f' option.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    w: Allow the called party to enable recording of the call by sending the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    DTMF sequence defined for one-touch recording in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    W: Allow the calling party to enable recording of the call by sending the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    DTMF sequence defined for one-touch recording in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    x: Allow the called party to enable recording of the call by sending the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    DTMF sequence defined for one-touch automixmonitor in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    X: Allow the calling party to enable recording of the call by sending the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    DTMF sequence defined for one-touch automixmonitor in "features.conf".</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    z: On a call forward, cancel any dial timeout which has been set for this</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    call.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">URL</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    The optional URL will be sent to the called party if the channel driver</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    supports it.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">[See Also]</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">RetryDial(), SendDTMF(), Gosub(), Macro()</span><br/></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/wenerme/wener/edit/master/notes/../notes/voip/asterisk/asterisk-dialplain.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_A7Jz aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_Hg3U"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2021-06-10T08:21:52.000Z itemprop=dateModified>Jun 10, 2021</time></b> by <b>wener</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/notes/voip/asterisk/dev><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>开发</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/notes/voip/asterisk/faq><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>常见问题</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_wpyd thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#extensionconf class="table-of-contents__link toc-highlight">extension.conf</a><ul><li><a href=#特殊-extension class="table-of-contents__link toc-highlight">特殊 Extension</a></ul><li><a href=#变量 class="table-of-contents__link toc-highlight">变量</a><li><a href=#应用控制流 class="table-of-contents__link toc-highlight">应用控制流</a><li><a href=#函数控制流 class="table-of-contents__link toc-highlight">函数控制流</a><li><a href=#application class="table-of-contents__link toc-highlight">Application</a><ul><li><a href=#dial class="table-of-contents__link toc-highlight">Dial</a></ul><li><a href=#demo class="table-of-contents__link toc-highlight">Demo</a><li><a href=#command class="table-of-contents__link toc-highlight">Command</a><ul><li><a href=#ael class="table-of-contents__link toc-highlight">AEL</a></ul><li><a href=#applications class="table-of-contents__link toc-highlight">Applications</a><li><a href=#dial-1 class="table-of-contents__link toc-highlight">Dial</a><ul><li><a href=#dial-help class="table-of-contents__link toc-highlight">Dial Help</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>笔记</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/notes/java>Java</a><li class=footer__item><a class=footer__link-item href=/notes/os/alpine>AlpineLinux</a><li class=footer__item><a class=footer__link-item href=/notes/devops/kubernetes>Kubernates</a><li class=footer__item><a class=footer__link-item href=/notes/voip>VoIP</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Projects</div><ul class="footer__items clean-list"><li class=footer__item>
              <div>
              <a class=footer__link-item href=https://github.com/wenerme/wener>Wener</a>
              -
              <a class=footer__link-item href=https://github.com/wenerme/wener/actions title="wenerme/wener - ci">
              <img style="vertical-align: middle;opacity: .4;" src=https://github.com/wenerme/wener/workflows/Build/badge.svg />
              </a>
              </div>
              <li class=footer__item><a href=https://apis.wener.me target=_blank rel="noopener noreferrer" class=footer__link-item>Wener's Apis<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_kUGX><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Social</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/story>Blog</a><li class=footer__item><a href=https://github.com/wenerme target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub</a><li class=footer__item><a href=https://twitter.com/wenerme target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter</a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/img/wener-logo.svg alt="Wener Site" class="footer__logo themedComponent_j2y5 themedComponent--light_v877"/><img src=/img/wener-logo.svg alt="Wener Site" class="footer__logo themedComponent_j2y5 themedComponent--dark_PUQY"/></div><div class=footer__copyright>Copyright © 1992-2025 Wener - <img alt=cc-by-sa-4.0 src=https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg /> - Build @2025-10-09 13:46</div></div></div></footer></div></body>