<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-service/api/grpc/README" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.1"><title data-rh=true>gRPC | Wener Live & Life</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://wener.me/notes/service/api/grpc /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="gRPC | Wener Live & Life"/><meta data-rh=true name=description content="- gRPC"/><meta data-rh=true property=og:description content="- gRPC"/><link data-rh=true rel=icon href=/img/favicon.ico /><link data-rh=true rel=canonical href=https://wener.me/notes/service/api/grpc /><link data-rh=true rel=alternate href=https://wener.me/notes/service/api/grpc hreflang=en /><link data-rh=true rel=alternate href=https://wener.me/notes/service/api/grpc hreflang=x-default /><link data-rh=true rel=preconnect href=https://37P8DMWBKF-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://wener.me/notes/service/","name":"服务","position":1},{"@type":"ListItem","item":"https://wener.me/notes/service/api/grpc/","name":"gRPC","position":2}]}</script><link rel=alternate type=application/rss+xml href=/story/rss.xml title="Wener Live & Life RSS Feed"><link rel=alternate type=application/atom+xml href=/story/atom.xml title="Wener Live & Life Atom Feed"><link rel=preconnect href=https://www.google-analytics.com><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-30404720-1","auto"),ga("send","pageview")</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=UA-30404720-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-30404720-1",{})</script><link rel=search type=application/opensearchdescription+xml title="Wener Live & Life" href=/opensearch.xml><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css><script src=https://static.cloudflareinsights.com/beacon.min.js async data-cf-beacon='{"token": "e9a1b931103044f3940ee67b78c7df70"}' defer></script><link rel=stylesheet href=/assets/css/styles.fa221ee1.css /><script src=/assets/js/runtime~main.72c320db.js defer></script><script src=/assets/js/main.c07313b6.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_jKDA href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/wener-logo-head.svg alt="Wener Logo" class="themedComponent_j2y5 themedComponent--light_v877"/><img src=/img/wener-logo-head.svg alt="Wener Logo" class="themedComponent_j2y5 themedComponent--dark_PUQY"/></div><b class="navbar__title text--truncate">Wener</b></a><a aria-current=page class="navbar__item navbar__link navbar__link--active" href=/notes>笔记</a><a class="navbar__item navbar__link" href=/story>故事</a><a class="navbar__item navbar__link" href=/notes/howto/network/dns-prevent-spoofing>指南</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/wenerme/wener target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_kUGX><use href=#theme-svg-external-link /></svg></a><div class="toggle_N7Mq colorModeToggle_vh_y"><button class="clean-btn toggleButton_PaHe toggleButtonDisabled_RC4w" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_Q188 lightToggleIcon_M1mU"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_Q188 darkToggleIcon_sEdo"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_Q188 systemToggleIcon_cOyE"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_d_Bn><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_c22C"><div class=docsWrapper_oymo><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ZPA9" type=button></button><div class=docRoot_ng2Q><aside class="theme-doc-sidebar-container docSidebarContainer_nyHU"><div class=sidebarViewport_rLoj><div class=sidebar_TmDF><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_jRin"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/notes><span title=笔记 class=linkLabel_JPPZ>笔记</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/adobe/photoshop><span title=adobe class=categoryLinkLabel_RkOu>adobe</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/ai><span title=AI class=categoryLinkLabel_RkOu>AI</span></a><button aria-label="Expand sidebar category 'AI'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/algorithm><span title=算法 class=categoryLinkLabel_RkOu>算法</span></a><button aria-label="Expand sidebar category '算法'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/blockchain><span title=区块链 class=categoryLinkLabel_RkOu>区块链</span></a><button aria-label="Expand sidebar category '区块链'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/cn><span title=CN class=categoryLinkLabel_RkOu>CN</span></a><button aria-label="Expand sidebar category 'CN'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/courses><span title=课程 class=categoryLinkLabel_RkOu>课程</span></a><button aria-label="Expand sidebar category '课程'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/culture><span title=文化 class=categoryLinkLabel_RkOu>文化</span></a><button aria-label="Expand sidebar category '文化'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/db><span title=数据库 class=categoryLinkLabel_RkOu>数据库</span></a><button aria-label="Expand sidebar category '数据库'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/dev><span title=开发 class=categoryLinkLabel_RkOu>开发</span></a><button aria-label="Expand sidebar category '开发'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/devops><span title=DevOps class=categoryLinkLabel_RkOu>DevOps</span></a><button aria-label="Expand sidebar category 'DevOps'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/economics><span title=经济学 class=categoryLinkLabel_RkOu>经济学</span></a><button aria-label="Expand sidebar category '经济学'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/electrical><span title=电学基础 class=categoryLinkLabel_RkOu>电学基础</span></a><button aria-label="Expand sidebar category '电学基础'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/embedded/awesome><span title=embedded class=categoryLinkLabel_RkOu>embedded</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/evolve><span title=自我成长 class=categoryLinkLabel_RkOu>自我成长</span></a><button aria-label="Expand sidebar category '自我成长'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/hardware><span title=硬件 class=categoryLinkLabel_RkOu>硬件</span></a><button aria-label="Expand sidebar category '硬件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/healthcare><span title=健康 class=categoryLinkLabel_RkOu>健康</span></a><button aria-label="Expand sidebar category '健康'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/howto/network/dns-prevent-spoofing><span title=howto class=categoryLinkLabel_RkOu>howto</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/java><span title=Java class=categoryLinkLabel_RkOu>Java</span></a><button aria-label="Expand sidebar category 'Java'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/languages><span title=语言 class=categoryLinkLabel_RkOu>语言</span></a><button aria-label="Expand sidebar category '语言'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/notes/linguistics><span title=Linguistics class=linkLabel_JPPZ>Linguistics</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/math><span title=数学 class=categoryLinkLabel_RkOu>数学</span></a><button aria-label="Expand sidebar category '数学'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/mgmt><span title=管理 class=categoryLinkLabel_RkOu>管理</span></a><button aria-label="Expand sidebar category '管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/network/application/dns><span title=network class=categoryLinkLabel_RkOu>network</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/ops><span title=运维 class=categoryLinkLabel_RkOu>运维</span></a><button aria-label="Expand sidebar category '运维'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/os><span title=操作系统 class=categoryLinkLabel_RkOu>操作系统</span></a><button aria-label="Expand sidebar category '操作系统'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/philosophy><span title=理念 class=categoryLinkLabel_RkOu>理念</span></a><button aria-label="Expand sidebar category '理念'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/photography><span title=摄影 class=categoryLinkLabel_RkOu>摄影</span></a><button aria-label="Expand sidebar category '摄影'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/platform><span title=平台 class=categoryLinkLabel_RkOu>平台</span></a><button aria-label="Expand sidebar category '平台'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/notes/psychology/glossary><span title=psychology class=categoryLinkLabel_RkOu>psychology</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/queue><span title=Queue class=categoryLinkLabel_RkOu>Queue</span></a><button aria-label="Expand sidebar category 'Queue'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/security><span title=安全 class=categoryLinkLabel_RkOu>安全</span></a><button aria-label="Expand sidebar category '安全'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--active" href=/notes/service><span title=服务 class=categoryLinkLabel_RkOu>服务</span></a><button aria-label="Collapse sidebar category '服务'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/analytics><span title=统计 class=categoryLinkLabel_RkOu>统计</span></a><button aria-label="Expand sidebar category '统计'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true tabindex=0 href=/notes/service/api/awesome><span title=api class=categoryLinkLabel_RkOu>api</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/awesome><span title="API Awesome" class=linkLabel_JPPZ>API Awesome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/faq><span title="API FAQ" class=linkLabel_JPPZ>API FAQ</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/apolloconfig><span title="Apollo Config" class=linkLabel_JPPZ>Apollo Config</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/buf><span title=buf class=linkLabel_JPPZ>buf</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/dubbo><span title=Dubbo class=linkLabel_JPPZ>Dubbo</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/flatbuffers><span title=FlatBuffers class=linkLabel_JPPZ>FlatBuffers</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/api/graphql><span title=GraphQL class=categoryLinkLabel_RkOu>GraphQL</span></a><button aria-label="Expand sidebar category 'GraphQL'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--active" aria-current=page tabindex=0 href=/notes/service/api/grpc><span title=gRPC class=categoryLinkLabel_RkOu>gRPC</span></a><button aria-label="Collapse sidebar category 'gRPC'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/connect><span title=Connect class=linkLabel_JPPZ>Connect</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/awesome><span title="gRPC Awesome" class=linkLabel_JPPZ>gRPC Awesome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/channelz><span title=channelz class=linkLabel_JPPZ>channelz</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/faq><span title="gRPC FAQ" class=linkLabel_JPPZ>gRPC FAQ</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/gateway><span title=grpc-gateway class=linkLabel_JPPZ>grpc-gateway</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/go><span title="gRPC Go" class=linkLabel_JPPZ>gRPC Go</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/node><span title=grpc-node class=linkLabel_JPPZ>grpc-node</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/php><span title="gRPC PHP" class=linkLabel_JPPZ>gRPC PHP</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/python><span title="gRPC Python" class=linkLabel_JPPZ>gRPC Python</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/spec><span title="grpc spec" class=linkLabel_JPPZ>grpc spec</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/web><span title="grpc web" class=linkLabel_JPPZ>grpc web</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/grpc/grpcurl><span title=grpcurl class=linkLabel_JPPZ>grpcurl</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/hoppscotch><span title=hoppscotch class=linkLabel_JPPZ>hoppscotch</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/jsonrpc><span title=JSON-RPC class=linkLabel_JPPZ>JSON-RPC</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/nacos><span title=nacos class=linkLabel_JPPZ>nacos</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/api/openapi><span title=OpenAPI class=categoryLinkLabel_RkOu>OpenAPI</span></a><button aria-label="Expand sidebar category 'OpenAPI'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/api/protobuf><span title=protobuf class=categoryLinkLabel_RkOu>protobuf</span></a><button aria-label="Expand sidebar category 'protobuf'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/serialization-awesome><span title="Serialization Awesome" class=linkLabel_JPPZ>Serialization Awesome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/service-design><span title="Service Design" class=linkLabel_JPPZ>Service Design</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/slate><span title=Slate class=linkLabel_JPPZ>Slate</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/smithy><span title=smithy class=linkLabel_JPPZ>smithy</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/soap><span title=SOAP class=linkLabel_JPPZ>SOAP</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/twirp><span title=twirp class=linkLabel_JPPZ>twirp</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/api/xds><span title=xds class=linkLabel_JPPZ>xds</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/auth><span title=Auth class=categoryLinkLabel_RkOu>Auth</span></a><button aria-label="Expand sidebar category 'Auth'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/baas><span title="Backend as a Service" class=categoryLinkLabel_RkOu>Backend as a Service</span></a><button aria-label="Expand sidebar category 'Backend as a Service'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/bi/awesome><span title=bi class=categoryLinkLabel_RkOu>bi</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/business/glossary><span title=business class=categoryLinkLabel_RkOu>business</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/cctv><span title=CCTV class=linkLabel_JPPZ>CCTV</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/cms><span title="CMS 概览" class=categoryLinkLabel_RkOu>CMS 概览</span></a><button aria-label="Expand sidebar category 'CMS 概览'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/collaboration><span title=协同软件 class=categoryLinkLabel_RkOu>协同软件</span></a><button aria-label="Expand sidebar category '协同软件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/commerce><span title=电商 class=categoryLinkLabel_RkOu>电商</span></a><button aria-label="Expand sidebar category '电商'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/data><span title=数据 class=categoryLinkLabel_RkOu>数据</span></a><button aria-label="Expand sidebar category '数据'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/dev/backstage><span title=dev class=categoryLinkLabel_RkOu>dev</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/dns><span title="DNS Service" class=categoryLinkLabel_RkOu>DNS Service</span></a><button aria-label="Expand sidebar category 'DNS Service'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/document><span title=办公套件 class=categoryLinkLabel_RkOu>办公套件</span></a><button aria-label="Expand sidebar category '办公套件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/download><span title=下载器 class=categoryLinkLabel_RkOu>下载器</span></a><button aria-label="Expand sidebar category '下载器'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/edms><span title=档案管理 class=categoryLinkLabel_RkOu>档案管理</span></a><button aria-label="Expand sidebar category '档案管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/email><span title=EMail class=categoryLinkLabel_RkOu>EMail</span></a><button aria-label="Expand sidebar category 'EMail'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/erp><span title=ERP class=categoryLinkLabel_RkOu>ERP</span></a><button aria-label="Expand sidebar category 'ERP'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/forge><span title=Forge class=categoryLinkLabel_RkOu>Forge</span></a><button aria-label="Expand sidebar category 'Forge'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/forum/awesome><span title=forum class=categoryLinkLabel_RkOu>forum</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/geo/awesome><span title=geo class=categoryLinkLabel_RkOu>geo</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/im><span title=即时通讯 class=categoryLinkLabel_RkOu>即时通讯</span></a><button aria-label="Expand sidebar category '即时通讯'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/linear><span title=Linear class=linkLabel_JPPZ>Linear</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/lms><span title=LMS class=linkLabel_JPPZ>LMS</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/media><span title=媒体 class=categoryLinkLabel_RkOu>媒体</span></a><button aria-label="Expand sidebar category '媒体'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/messaging/centrifugo><span title=messaging class=categoryLinkLabel_RkOu>messaging</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/network><span title=网络服务 class=categoryLinkLabel_RkOu>网络服务</span></a><button aria-label="Expand sidebar category '网络服务'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/notification/novu><span title=notification class=categoryLinkLabel_RkOu>notification</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/notion><span title=Notion class=linkLabel_JPPZ>Notion</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/observability><span title=可观察性 class=categoryLinkLabel_RkOu>可观察性</span></a><button aria-label="Expand sidebar category '可观察性'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/p2p/ipfs><span title=p2p class=categoryLinkLabel_RkOu>p2p</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/password><span title=密码管理 class=categoryLinkLabel_RkOu>密码管理</span></a><button aria-label="Expand sidebar category '密码管理'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/placeholder><span title=Placeholder class=linkLabel_JPPZ>Placeholder</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/realtime><span title=Realtime class=categoryLinkLabel_RkOu>Realtime</span></a><button aria-label="Expand sidebar category 'Realtime'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/search/awesome><span title=search class=categoryLinkLabel_RkOu>search</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/security/infisical><span title=security class=categoryLinkLabel_RkOu>security</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/selfhost><span title=SelfHost class=categoryLinkLabel_RkOu>SelfHost</span></a><button aria-label="Expand sidebar category 'SelfHost'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/serverless><span title=Serverless class=categoryLinkLabel_RkOu>Serverless</span></a><button aria-label="Expand sidebar category 'Serverless'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/awesome><span title="Service Awesome" class=linkLabel_JPPZ>Service Awesome</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/notes/service/faq><span title="Service FAQ" class=linkLabel_JPPZ>Service FAQ</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/storage><span title=存储服务 class=categoryLinkLabel_RkOu>存储服务</span></a><button aria-label="Expand sidebar category '存储服务'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/telecom/device><span title=telecom class=categoryLinkLabel_RkOu>telecom</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/torrent><span title=Torrent class=categoryLinkLabel_RkOu>Torrent</span></a><button aria-label="Expand sidebar category 'Torrent'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/vpn/goproxy><span title=vpn class=categoryLinkLabel_RkOu>vpn</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/wiki><span title=Wiki class=categoryLinkLabel_RkOu>Wiki</span></a><button aria-label="Expand sidebar category 'Wiki'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" tabindex=0 href=/notes/service/workflow><span title=Workflow class=categoryLinkLabel_RkOu>Workflow</span></a><button aria-label="Expand sidebar category 'Workflow'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/notes/service/xaas/awesome><span title=xaas class=categoryLinkLabel_RkOu>xaas</span></a></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/software><span title=软件 class=categoryLinkLabel_RkOu>软件</span></a><button aria-label="Expand sidebar category '软件'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/std><span title=标准数据 class=categoryLinkLabel_RkOu>标准数据</span></a><button aria-label="Expand sidebar category '标准数据'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/voip><span title=VoIP class=categoryLinkLabel_RkOu>VoIP</span></a><button aria-label="Expand sidebar category 'VoIP'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_irRK menu__link menu__link--sublist" href=/notes/web><span title=Web class=categoryLinkLabel_RkOu>Web</span></a><button aria-label="Expand sidebar category 'Web'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul></nav><button type=button title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_NY7h"><svg width=20 height=20 aria-hidden=true class=collapseSidebarButtonIcon_c8nQ><g fill=#7a7a7a><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"/><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"/></g></svg></button></div></div></aside><main class=docMainContainer_GAGP><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_YQ1L"><div class=docItemContainer_Wjg4><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_tiqF" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_WTWT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/notes/service><span>服务</span></a><li class=breadcrumbs__item><span class=breadcrumbs__link>api</span><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>gRPC</span></ul></nav><div class="tocCollapsible_GvsH theme-doc-toc-mobile tocMobile_qJgM"><button type=button class="clean-btn tocCollapsibleButton_LnP0">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>gRPC</h1></header>
<ul>
<li><a href=https://github.com/grpc/ target=_blank rel="noopener noreferrer">gRPC</a></li>
<li><a href=https://github.com/grpc-ecosystem target=_blank rel="noopener noreferrer">gRPC Ecosystem</a></li>
<li><a href=https://github.com/google/protobuf/blob/master/docs/third_party.md target=_blank rel="noopener noreferrer">Third-Party Add-ons for Protocol Buffers</a></li>
<li>服务端暂不支持 PHP
<ul>
<li>可以跟踪该帖子 <a href=https://groups.google.com/forum/#!topic/grpc-io/F3IyYaI_6S0 target=_blank rel="noopener noreferrer">Servers in PHP?</a></li>
</ul>
</li>
<li>google.protobuf
<ul>
<li>默认定义</li>
<li>api.proto
<ul>
<li>对服务的轻量级定义</li>
</ul>
</li>
</ul>
</li>
<li>相关服务
<ul>
<li><a href=https://github.com/mwitkow/grpc-proxy target=_blank rel="noopener noreferrer">mwitkow/grpc-proxy</a>
<ul>
<li>grpc 反向代理</li>
</ul>
</li>
<li><a href=https://github.com/improbable-eng/grpc-web target=_blank rel="noopener noreferrer">improbable-eng/grpc-web</a>
<ul>
<li>gRPC Web implementation for Golang and TypeScript</li>
</ul>
</li>
</ul>
</li>
<li>案例参考
<ul>
<li><a href=https://github.com/grpc/grpc-proto target=_blank rel="noopener noreferrer">grpc/grpc-proto</a>
<ul>
<li>常用协议</li>
</ul>
</li>
<li>k8s 使用 go-to-protobuf 从 go 生成的 proto</li>
</ul>
</li>
<li>参考
<ul>
<li><a href=https://github.com/mfornos/awesome-microservices target=_blank rel="noopener noreferrer">mfornos/awesome-microservices</a></li>
<li><a href=https://goel.io/grpc-100/ target=_blank rel="noopener noreferrer">gRPC Practical Tutorial - Magic That Generates Code</a></li>
<li><a href=https://github.com/LogNet/grpc-spring-boot-starter target=_blank rel="noopener noreferrer">LogNet/grpc-spring-boot-starter</a></li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-caution admonition_phik alert alert--warning"><div class=admonitionHeading_zxjO><span class=admonitionIcon_bSNx><svg viewBox="0 0 16 16"><path fill-rule=evenodd d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg></span>痛点</div><div class=admonitionContent_R6P7><ul>
<li>官方 gRPC 实现非常复杂
<ul>
<li>因为同时考虑 Google 内部使用和 开源社区 使用</li>
<li>grpc-go 使用自己的 net/http</li>
</ul>
</li>
<li>gRPC 必须要求 HTTP2 trailer - 门槛相当高</li>
<li>gRPC Web 需要引入一层额外代理</li>
</ul></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=note>Note<a href=#note class=hash-link aria-label="Direct link to Note" title="Direct link to Note" translate=no>​</a></h2>
<ul>
<li>guides/<a href=https://grpc.io/docs/guides/concepts.html target=_blank rel="noopener noreferrer">concepts</a>
<ul>
<li>服务定义</li>
<li>使用方式</li>
<li>RPC 生命周期
<ul>
<li>单向 RPC</li>
<li>服务端流</li>
<li>客户端流</li>
<li>双向流</li>
<li>超时</li>
<li>终端</li>
<li>取消</li>
<li>元数据</li>
<li>通道</li>
</ul>
</li>
</ul>
</li>
<li>实现
<ul>
<li>使用 HTTP2 协议</li>
<li>使用 HTTP2 Trailler 来标识是否还有后续包
<ul>
<li>Web 无法获取到该信息, 所以无法实现和使用 gRPC</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=docker>Docker<a href=#docker class=hash-link aria-label="Direct link to Docker" title="Direct link to Docker" translate=no>​</a></h2>
<ul class="contains-task-list containsTaskList_tRRO">
<li>避免安装编译等繁杂的过程</li>
<li><a href=https://github.com/wenerme/dockerfiles/tree/master/grpc target=_blank rel="noopener noreferrer">Dockerfile</a></li>
<li>AlpineLinux Packages <a href=https://github.com/wenerme/statics/tree/master/abuild target=_blank rel="noopener noreferrer">grpc</a></li>
<li>grpc</li>
<li>grpc-java</li>
<li>grpc-go
<ul>
<li>protowrap</li>
</ul>
</li>
<li class=task-list-item><input type=checkbox disabled/> grpc-swift</li>
<li class=task-list-item><input type=checkbox disabled/> grpc-slate</li>
</ul>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># 假设 api 位于当前目录下的 apis</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">docker run --rm -it -v $PWD:/host --workdir /host wener/grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 创建目标目录</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 注意: 如果删除了 proto 文件, 目录下之前生成的的文件不会被删除, 此时建议删除目录从新生成</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 注意: 文件生成在了当前目录, 需要同步到项目中. 也可以直接生成到项目中</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">mkdir java javanano php go objc js ruby python csharp node slatedoc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 定义常用参数</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 注意: 如果文件列表发生了变化需要从新执行</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">COMMON_ARGS="$(echo -I . apis/**/*.proto)"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Java</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=$(which protoc-gen-grpc-java) --java_out=./java --grpc-java_out=./java</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Java Nano</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=$(which protoc-gen-grpc-java) --java_out=nano:./javanano --grpc-java_out=./javanano</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Go by protowrap</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># The last -I apis is required</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protowrap $COMMON_ARGS --go_out=plugins=grpc:$HOME/go/src -I apis/</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate slate document</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protowrap $COMMON_ARGS --slate_out=./slatedoc -I apis/</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Swift</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --swift_out=./swift --swiftgrpc_out=./swift</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate PHP</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_php_plugin) --php_out=./php --grpc_out=./php</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate CXX</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_cpp_plugin) --cpp_out=./cpp --grpc_out=./cpp</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate C#</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_csharp_plugin) --csharp_out=./csharp --grpc_out=./csharp</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate ObjC</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_objective_c_plugin) --objc_out=./objc --grpc_out=./objc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Ruby</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_ruby_plugin) --ruby_out=./ruby --grpc_out=./ruby</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Python</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_python_plugin) --python_out=./objc --grpc_out=./python</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Generate Node</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc $COMMON_ARGS --plugin=protoc-gen-grpc=$(which grpc_node_plugin) --js_out=import_style=commonjs,binary:./node --grpc_out=./node</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=安装>安装<a href=#安装 class=hash-link aria-label="Direct link to 安装" title="Direct link to 安装" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/grpc/grpc/blob/master/INSTALL.md target=_blank rel="noopener noreferrer">https://github.com/grpc/grpc/blob/master/INSTALL.md</a></li>
<li><a href=https://hub.docker.com/u/grpc/ target=_blank rel="noopener noreferrer">https://hub.docker.com/u/grpc/</a></li>
<li>生成主要依赖插件
<ul>
<li>protoc-gen-go</li>
<li>protoc-gen-grpc-gateway</li>
<li>protoc-gen-swagger</li>
<li>protoc-gen-grpc-java</li>
</ul>
</li>
<li><a href=https://github.com/Juniper/grpc-c target=_blank rel="noopener noreferrer">Juniper/grpc-c</a>
<ul>
<li>支持 C</li>
</ul>
</li>
<li><a href=https://github.com/grpc/grpc-java/tree/master/compiler target=_blank rel="noopener noreferrer">https://github.com/grpc/grpc-java/tree/master/compiler</a></li>
</ul>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_cli</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_cpp_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_csharp_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_node_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_objective_c_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_php_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_python_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># grpc_ruby_plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">brew install grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 不 link 则使用绝对路径</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">brew link grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 变量定义简化操作</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 安装 gRPC 后会包含很多插件</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># # 生成 cpp, node, php, c#, ruby, python, objc 的方式是一样的</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GRPC_BIN=$(brew --prefix grpc)/bin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 定义 pb 路径</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">PROTO_PATH=./apis/</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 对路径进行展开</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">PROTO_FILES=(apis/**/*.proto)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">PROTO_ARGS="-I $PROTO_PATH  ${PROTO_FILES[*]}"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 覆盖 protoc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">alias protoc="protoc $PROTO_ARGS"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># gRPC 生成</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># --js_out=./node 生成 protobuf</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># --grpc_out=./node 生成 grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># --plugin=protoc-gen-grpc=$GRPC_BIN/grpc_node_plugin 使用 grpc_node_plugin 来生成 node 的 grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># -I . 包从当前目录查找</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># apis/**/*.proto 生成所有 apis 下的 proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --js_out=./node --grpc_out=./node --plugin=protoc-gen-grpc=$GRPC_BIN/grpc_node_plugin -I . apis/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Golang</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 不支持一次性生成多个包</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># https://github.com/golang/protobuf/pull/40</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 可以使用 https://github.com/square/goprotowrap 规避</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/golang/protobuf/{proto,protoc-gen-go}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u google.golang.org/grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Golang 可直接生成 gRPC 和 Protobuf</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --go_out=plugins=grpc:$HOME/go/src -I . apis/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 使用 protowrap</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/square/goprotowrap/cmd/protowrap</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># -I apis/ 是必须的, 要有有一个前缀</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protowrap --go_out=plugins=grpc:$HOME/go/src -I . -I apis/ apis/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># https://github.com/gogo/protobuf</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># gogoprotobuf is a fork of golang/protobuf with extra code generation features.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 扩展 https://github.com/gogo/protobuf/blob/master/extensions.md</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">#</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># protoc-gen-gogofast (same as gofast, but imports gogoprotobuf)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># protoc-gen-gogofaster (same as gogofast, without XXX_unrecognized, less pointer fields)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># protoc-gen-gogoslick (same as gogofaster, but with generated string, gostring and equal methods)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/gogo/protobuf/protoc-gen-gofast</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protowrap --gofast_out=plugins=grpc:$HOME/go/src -I . -I apis/ apis/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Java</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Java 插件需要自己编译</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">git clone https://github.com/grpc/grpc-java</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">cd grpc-java/compiler</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">../gradlew java_pluginExecutable</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 插件完整路径</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">realpath build/exe/java_plugin/protoc-gen-grpc-java</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GEN_JAVA="$(realpath build/exe/java_plugin/protoc-gen-grpc-java)"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 gRPC</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --plugin=protoc-gen-grpc-java=$GEN_JAVA --grpc-java_out=$PWD/java -I . proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 protobuf</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc -I . --java_out=./java proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 nano 的 pb</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc -I . --javanano_out=./java proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 gRPC lite</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --plugin=protoc-gen-grpc-java=$GEN_JAVA --grpc-java_out=lite:$PWD/java -I . proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 gRPC nano</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --plugin=protoc-gen-grpc-java=$GEN_JAVA --grpc-java_out=nano:$PWD/java -I . proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Swift</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># https://github.com/grpc/grpc-swift</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">git clone https://github.com/grpc/grpc-swift</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">cd grpc-swift/Plugin</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">make</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GEN_SWIFT=$(realpath .)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 pb 和 grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --plugin=$GEN_SWIFT/protoc-gen-swift --swift_out=./swift -I . proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --plugin=$GEN_SWIFT/protoc-gen-swiftgrpc --swiftgrpc_out=./swift -I . proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Node</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --js_out=./node --grpc_out=./node --plugin=protoc-gen-grpc=$GRPC_BIN/grpc_node_plugin -I . proto/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 使用 grpc-tools 生成</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">yarn global add grpc-tools</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc -I=. ./protos/product.proto \</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --js_out=import_style=commonjs,binary:./server \</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --grpc_out=./server \</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --plugin=protoc-gen-grpc=$(which grpc_tools_node_protoc_plugin)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># ts-protoc-gen</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># https://github.com/improbable-eng/ts-protoc-gen</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 Typescript 定义 .d.ts</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Gateway</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># Web &lt;-> gRPC</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成网关代码和 Swagger 配置</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-grpc-gateway</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-swagger</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 stub</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --go_out=plugins=grpc:. -I proto/ proto/hello.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成反向代理</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --grpc-gateway_out=logtostderr=true:. -I proto/ proto/hello.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 swagger</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --swagger_out=logtostderr=true:. -I proto/ proto/hello.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># prototools</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成文档, json, dump</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># https://github.com/sourcegraph/prototools</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u sourcegraph.com/sourcegraph/prototools/cmd/protoc-gen-doc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 如果找不到文件可以考虑指定 filemap=./tmpl/filemap.xml</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protowrap --doc_out=./apidoc -I . -I apis/ apis/**/*.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># pseudomuto/protoc-gen-doc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># =========</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成文档, 支持生成 HTML, JSON, DocBook, Markdown</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 默认模板比 prototools 好看</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># https://github.com/pseudomuto/protoc-gen-doc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/pseudomuto/protoc-gen-doc/cmd/...</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=java>Java<a href=#java class=hash-link aria-label="Direct link to Java" title="Direct link to Java" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/grpc/grpc-java/issues/3458 target=_blank rel="noopener noreferrer">grpc/grpc-java#3458</a> - FR: Port sharing with traditional HTTP services
<ul>
<li><a href=https://github.com/netty/netty/issues/3667 target=_blank rel="noopener noreferrer">netty/netty#3667</a> - h2childchan: Model streams in HTTP/2 as child channels</li>
</ul>
</li>
</ul>
<div class="language-java codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-java codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Tests</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// TLS 服务端</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token annotation punctuation" style="color:rgb(199, 146, 234)">@Test</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token keyword" style=font-style:italic>public</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">testTLSSvr</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>throws</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">IOException</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">InterruptedException</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">java</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">security</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">Security</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">addProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">org</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">bouncycastle</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">jce</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">provider</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">BouncyCastleProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token keyword" style=font-style:italic>int</span><span class="token plain"> port </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8443</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">Server</span><span class="token plain"> server </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">NettyServerBuilder</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">forPort</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">sslContext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">GrpcSslContexts</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">forServer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">File</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"localhost.pem"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">File</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"localhost-key.pem"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">trustManager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">File</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"ca.pem"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 要求客户端认证</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">clientAuth</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">ClientAuth</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token constant" style="color:rgb(130, 170, 255)">REQUIRE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">addService</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyServiceImpl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"Server started, listening on "</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> port</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    server</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">awaitTermination</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// TLS 客户端</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token annotation punctuation" style="color:rgb(199, 146, 234)">@Test</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token keyword" style=font-style:italic>public</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>void</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">testTLSCli</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>throws</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">Exception</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">java</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">security</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">Security</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">addProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">org</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">bouncycastle</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">jce</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name namespace" style="color:rgb(178, 204, 214)">provider</span><span class="token class-name namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">BouncyCastleProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 使用 Netty 实现, 也可以使用 OkHttp 实现</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">ManagedChannel</span><span class="token plain"> channel </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">NettyChannelBuilder</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">forAddress</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"localhost"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">8443</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">sslContext</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">GrpcSslContexts</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">forClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">trustManager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">File</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"ca.pem"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 双向认证才需要</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">keyManager</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">File</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"cli.pem"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">File</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">"cli-key.pem"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 创建阻塞客户端</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyServiceGrpcBlockingStub</span><span class="token plain"> stub </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyServiceGrpc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">newBlockingStub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">channel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">GetInfoResponse</span><span class="token plain"> info </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> stub</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">getInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token class-name" style="color:rgb(255, 203, 107)">GetInfoRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">newBuilder</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">build</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token class-name" style="color:rgb(255, 203, 107)">System</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">println</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">info</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token function" style="color:rgb(130, 170, 255)">getName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=php>PHP<a href=#php class=hash-link aria-label="Direct link to PHP" title="Direct link to PHP" translate=no>​</a></h2>
<div class="language-php codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-php codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token delimiter important">&lt;?php</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>require</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">__DIR__</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">'/vendor/autoload.php'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$creds</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 无 TLS</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token class-name class-name-fully-qualified static-context" style="color:rgb(255, 203, 107)">Grpc</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:rgb(255, 203, 107)">ChannelCredentials</span><span class="token operator" style="color:rgb(137, 221, 255)">::</span><span class="token function" style="color:rgb(130, 170, 255)">createInsecure</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 只配置 CA 如果服务端不要求客户端认证</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// \Grpc\ChannelCredentials::createSsl(file_get_contents("ca.pem"))</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 双向认证, 服务端要求客户端认证</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// \Grpc\ChannelCredentials::createSsl(file_get_contents("ca.pem"),file_get_contents("cli-key.pem"),file_get_contents("cli.pem"))</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token variable" style="color:rgb(191, 199, 213)">$client</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">Wener</span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">Service</span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">V1</span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">InfoServiceClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string double-quoted-string" style="color:rgb(195, 232, 141)">"localhost:5002"</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    </span><span class="token string single-quoted-string" style="color:rgb(195, 232, 141)">'credentials'</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=></span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$creds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">/**</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @var \Wener\Service\V1\GetInfoResponse $reply</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> * @var \Wener\Api\GrpcStatus $status Customized type for ide to hint type</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"> */</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$reply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$client</span><span class="token operator" style="color:rgb(137, 221, 255)">-></span><span class="token function" style="color:rgb(130, 170, 255)">GetInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">Wener</span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">Service</span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">V1</span><span class="token class-name class-name-fully-qualified punctuation" style="color:rgb(199, 146, 234)">\</span><span class="token class-name class-name-fully-qualified" style="color:rgb(255, 203, 107)">GetInfoRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">-></span><span class="token function" style="color:rgb(130, 170, 255)">wait</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>echo</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$status</span><span class="token operator" style="color:rgb(137, 221, 255)">-></span><span class="token property">code</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">PHP_EOL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>echo</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$reply</span><span class="token operator" style="color:rgb(137, 221, 255)">-></span><span class="token function" style="color:rgb(130, 170, 255)">getName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">PHP_EOL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// All Status</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">print_r</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// JSON</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 再次解码编码是为了方便调试</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>echo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">json_encode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token function" style="color:rgb(130, 170, 255)">json_decode</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token variable" style="color:rgb(191, 199, 213)">$reply</span><span class="token operator" style="color:rgb(137, 221, 255)">-></span><span class="token function" style="color:rgb(130, 170, 255)">serializeToJsonString</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">JSON_PRETTY_PRINT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">JSON_UNESCAPED_UNICODE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">.</span><span class="token plain"> </span><span class="token constant" style="color:rgb(130, 170, 255)">PHP_EOL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=node>Node<a href=#node class=hash-link aria-label="Direct link to Node" title="Direct link to Node" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/grpc/grpc/issues/8233 target=_blank rel="noopener noreferrer">#8233 Typescript typings for node package</a></li>
</ul>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># 最基本的只需要这两个依赖</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">yarn add google-protobuf</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">yarn add grpc</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 调试相关的环境变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GRPC_TRACE=all</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GRPC_VERBOSITY=DEBUG</span><br/></span></code></pre></div></div>
<div class="language-js codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-js codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token keyword" style=font-style:italic>const</span><span class="token plain"> grpc </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'grpc'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>const</span><span class="token plain"> fs </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'fs'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 生成的 pb 对象</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>const</span><span class="token plain"> messages </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'./service_pb'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 生成 grpc 客户端和服务端</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>const</span><span class="token plain"> services </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">require</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'./service_grpc_pb'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>let</span><span class="token plain"> client </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">services</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">ServiceClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token string" style="color:rgb(195, 232, 141)">'service.wener.me:443'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 无 TLS</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// grpc.credentials.createInsecure(),</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 使用 self-signed 证书</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  grpc</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token property-access">credentials</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">createSsl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">fs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">readFileSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'ca.pem'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">readFileSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'cli-key.pem'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> fs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">readFileSync</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'cli.pem'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// 发起请求</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token keyword" style=font-style:italic>let</span><span class="token plain"> request </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token keyword" style=font-style:italic>new</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">messages</span><span class="token class-name punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token class-name" style="color:rgb(255, 203, 107)">GetInfoRequest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">client</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getInfo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">request</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token parameter">err</span><span class="token parameter punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token parameter"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(137, 221, 255)">=></span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  </span><span class="token console class-name" style="color:rgb(255, 203, 107)">console</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">'Service name'</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token method function property-access" style="color:rgb(130, 170, 255)">getName</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=golang>Golang<a href=#golang class=hash-link aria-label="Direct link to Golang" title="Direct link to Golang" translate=no>​</a></h2>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># http2 相关的环境变量</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GODEBUG=http2client=0 # disable HTTP/2 client support</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GODEBUG=http2server=0 # disable HTTP/2 server support</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GODEBUG=http2debug=1  # enable verbose HTTP/2 debug logs</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">GODEBUG=http2debug=2  # ... even more verbose, with frame dumps</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=client>Client<a href=#client class=hash-link aria-label="Direct link to Client" title="Direct link to Client" translate=no>​</a></h3>
<div class="language-golang codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-golang codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">package main</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">func main(){</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=server>Server<a href=#server class=hash-link aria-label="Direct link to Server" title="Direct link to Server" translate=no>​</a></h3>
<div class="language-golang codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-golang codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">package main</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">var (</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	ServerCert string</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	ServerKey  string</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	RootCA     string</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	Addr       string</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">func main() {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	flag.StringVar(&ServerCert, "cert", "", "")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	flag.StringVar(&ServerKey, "key", "", "")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	flag.StringVar(&RootCA, "ca", "", "")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	flag.StringVar(&Addr, "addr", "", "")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	flag.Parse()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	var srv *grpc.Server</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	lis, err := net.Listen("tcp", Addr)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	if err != nil {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		panic(fmt.Errorf("could not list on %s: %s", Addr, err))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	if ServerCert == "" {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		srv = grpc.NewServer()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	} else {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		logrus.WithField("cert", ServerCert).Info("With TLS")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		// 读取证书信息</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		certificate, err := tls.LoadX509KeyPair(ServerCert, ServerKey)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		if err != nil {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">			panic(fmt.Errorf("could not load client key pair: %s", err))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		// Create a certificate pool from the certificate authority</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		certPool := x509.NewCertPool()</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		ca, err := ioutil.ReadFile(RootCA)</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		if err != nil {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">			panic(fmt.Errorf("could not read ca certificate: %s", err))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		// Append the certificates from the CA</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		if ok := certPool.AppendCertsFromPEM(ca); !ok {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">			panic(errors.New("failed to append ca certs"))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		creds := credentials.NewTLS(&tls.Config{</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      // 如何对客户端进行认证, 可进行双向认证</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">			ClientAuth:   tls.VerifyClientCertIfGiven,</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">			Certificates: []tls.Certificate{certificate},</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">			ClientCAs:    certPool,</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		srv = grpc.NewServer(grpc.Creds(creds))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	// Create the gRPC server with the credentials</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	service.RegisterInfoServiceServer(srv, &DemoStatus{})</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	logrus.WithField("addr", Addr).Info("Serving")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	// Serve and Listen</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	if err := srv.Serve(lis); err != nil {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">		panic(fmt.Errorf("grpc serve error: %s", err))</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">type DemoStatus struct {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	service.InfoServiceServer</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">func (DemoStatus) GetInfo(context.Context, *service.GetInfoRequest) (*service.GetInfoResponse, error) {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	logrus.Info("Handle request")</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">	return &service.GetInfoResponse{Name: "Demo Service"}, nil</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=web>Web<a href=#web class=hash-link aria-label="Direct link to Web" title="Direct link to Web" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/grpc/grpc/blob/master/doc/PROTOCOL-WEB.md target=_blank rel="noopener noreferrer">gRPC Web</a></li>
<li><a href=https://github.com/dcodeIO/ProtoBuf.js/ target=_blank rel="noopener noreferrer">https://github.com/dcodeIO/ProtoBuf.js/</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=typescript>Typescript<a href=#typescript class=hash-link aria-label="Direct link to Typescript" title="Direct link to Typescript" translate=no>​</a></h2>
<p><a href=https://www.npmjs.com/package/ts-protoc-gen target=_blank rel="noopener noreferrer">https://www.npmjs.com/package/ts-protoc-gen</a></p>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=grpc-gateway>grpc-gateway<a href=#grpc-gateway class=hash-link aria-label="Direct link to grpc-gateway" title="Direct link to grpc-gateway" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/grpc-ecosystem/grpc-gateway target=_blank rel="noopener noreferrer">grpc-gateway</a>
<ul>
<li>gRPC to JSON proxy generator</li>
</ul>
</li>
<li>支持 googleapis 中的 http 定义</li>
<li>Features
<ul>
<li>Generating JSON API handlers</li>
<li>Method parameters in request body</li>
<li>Method parameters in request path</li>
<li>Method parameters in query string</li>
<li>Enum fields in path parameter (including repeated enum fields).</li>
<li>Mapping streaming APIs to newline-delimited JSON streams</li>
<li>Mapping HTTP headers with Grpc-Metadata- prefix to gRPC metadata (prefixed with grpcgateway-)</li>
<li>Optionally emitting API definition for Swagger.</li>
<li>Setting gRPC timeouts through inbound HTTP Grpc-Timeout header.</li>
</ul>
</li>
<li>可以只拷贝需要的导入文件
<ul>
<li><code>google/api/annotations.proto</code></li>
<li><code>google/api/http.proto</code></li>
</ul>
</li>
<li>然后在 rpc 中添加 http 定义即可</li>
</ul>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">rpc SayHello (HelloRequest) returns (HelloReply) {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  option (google.api.http) = {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      post:"/v1/greeter/hello"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">      body:"*"</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  };</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># 安装</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-grpc-gateway</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/grpc-ecosystem/grpc-gateway/protoc-gen-swagger</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get -u github.com/golang/protobuf/protoc-gen-go</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 stub</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --go_out=plugins=grpc:. -I proto/ proto/hello.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成反向代理</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --grpc-gateway_out=logtostderr=true:. -I proto/ proto/hello.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 生成 swagger</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">protoc --swagger_out=logtostderr=true:. -I proto/ proto/hello.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 拉取相关依赖</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">go get .</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 添加 main, 启动时调用注册</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=auth>Auth<a href=#auth class=hash-link aria-label="Direct link to Auth" title="Direct link to Auth" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/grpc/grpc-java/blob/master/SECURITY.md target=_blank rel="noopener noreferrer">grpc/grpc-java/SECURITY.md</a></li>
<li>guides/<a href=https://grpc.io/docs/guides/auth.html target=_blank rel="noopener noreferrer">auth</a>
<ul>
<li>SSL/TLS 双向认证</li>
<li>基于 Token</li>
</ul>
</li>
<li>授权分为整个通道和单次请求</li>
<li>gRPC 可以自带元数据头, 因此也可以自定义授权</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=案例>案例<a href=#案例 class=hash-link aria-label="Direct link to 案例" title="Direct link to 案例" translate=no>​</a></h2>
<ul>
<li><a href=https://github.com/cockroachdb/cockroach/tree/master/pkg/roachpb target=_blank rel="noopener noreferrer">cockroachdb/cockroach</a></li>
<li><a href=https://github.com/docker/swarmkit/tree/master/api target=_blank rel="noopener noreferrer">docker/swarmkit</a></li>
<li><a href=https://github.com/gogo/protobuf#users target=_blank rel="noopener noreferrer">https://github.com/gogo/protobuf#users</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=gcp>GCP<a href=#gcp class=hash-link aria-label="Direct link to GCP" title="Direct link to GCP" translate=no>​</a></h3>
<ul>
<li>
<p><a href=https://github.com/googleapis/googleapis target=_blank rel="noopener noreferrer">googleapis/googleapis</a></p>
</li>
<li>
<p><a href=https://github.com/googleapis/toolkit target=_blank rel="noopener noreferrer">googleapis/toolkit</a></p>
</li>
<li>
<p><a href=https://github.com/googleapis/artman target=_blank rel="noopener noreferrer">googleapis/artman</a></p>
</li>
<li>
<p>GAPIC</p>
</li>
<li>
<p>selector</p>
<ul>
<li>逗号分隔</li>
<li>可以使用 <code>*</code> 做匹配, 但是只能放在最后
<ul>
<li>例如 <code>foo.*</code>, 但不能写 <code>foo.*b</code>, <code>foo.*.abc</code></li>
<li>可以使用 <code>*</code> 匹配所有</li>
</ul>
</li>
</ul>
</li>
<li>
<p>服务结构</p>
<ul>
<li>api
<ul>
<li>接口相关的定义</li>
<li>backend.proto
<ul>
<li>定义服务的后端</li>
</ul>
</li>
<li>service.proto
<ul>
<li>对服务的定义</li>
</ul>
</li>
<li>servicecontrol
<ul>
<li>服务控制</li>
<li>对服务的检查报告</li>
</ul>
</li>
<li>servicemanagement
<ul>
<li>服务管理</li>
<li>对服务的 CRUD, 启用停用</li>
</ul>
</li>
</ul>
</li>
<li>appengine</li>
</ul>
</li>
</ul>
<div class="language-bash codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-bash codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain"># artman</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># 包含了 grpc 生成个个语言的环境</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">docker pull googleapis/artman</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">docker run -it --rm -v $PWD/googleapis:/googleapis -v $PWD/artman:/artman -w /googleapis googleapis/artman</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain"># artman --api pubsub --language python</span><br/></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_EG6R" id=service-control>Service Control<a href=#service-control class=hash-link aria-label="Direct link to Service Control" title="Direct link to Service Control" translate=no>​</a></h4>
<ul>
<li><a href=https://cloud.google.com/service-control/overview target=_blank rel="noopener noreferrer">Google Service Control</a></li>
<li>How to control access to your service.</li>
<li>How to validate API keys.</li>
<li>How to send logging and monitoring data to both consumers and producers.</li>
<li>How to create and manage dashboards to visualize such data.</li>
<li>How to scale the control plane components with your service.</li>
</ul>
<p><img decoding=async loading=lazy src=https://cloud.google.com/service-control/images/arch.svg alt=Architecture class=img_IxRA /></p>
<ul>
<li>Managed services
<ul>
<li>Google Service Management 管理每个服务和其配置, 用于定制化 Google Service Control 的行为. 服务配置也被用于 Google Cloud Platform Console 显示其配置, 启用/禁用 等.</li>
<li>For example:
<ul>
<li>Google Cloud Pub/Sub (pubsub.googleapis.com)</li>
<li>Google Cloud Vision (vision.googleapis.com)</li>
<li>Google Cloud Bigtable (bigtable.googleapis.com)</li>
<li>Google Cloud Datastore (datastore.googleapis.com)</li>
</ul>
</li>
</ul>
</li>
<li>Operations
<ul>
<li>表示被管理服务的活动, 例如接口调用或资源使用</li>
<li>每个操作都关联一个被管理的服务,和调用者, 也包含调用的相关信息, 例如调用方法, 资源使用量等</li>
</ul>
</li>
<li>Check
<ul>
<li>Check if the consumer is still active.</li>
<li>Check if the consumer has enabled the service.</li>
<li>Check if the API key is still valid.</li>
<li>对接口进行检测以保证更好的性能, 更高的可用性</li>
</ul>
</li>
<li>Report</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_EG6R" id=service-management>Service Management<a href=#service-management class=hash-link aria-label="Direct link to Service Management" title="Direct link to Service Management" translate=no>​</a></h4>
<ul>
<li>Google <a href=https://cloud.google.com/service-management/overview target=_blank rel="noopener noreferrer">Service Management</a></li>
<li>Service producer
<ul>
<li>由谷歌开发者负责发布维护被管理的服务. 每个被管理的服务都由一个服务生产者所有</li>
</ul>
</li>
<li>Service consumers
<ul>
<li>启用了接口调用的管理服务, 一个被管理的服务可以有很多服务消费者</li>
</ul>
</li>
<li>Service configurations
<ul>
<li>每个被管理的服务都有自己的配置描述, 包括名字, 标题, RPC 接口定义, REST 接口定义, 文档, 授权等</li>
</ul>
</li>
<li>Service rollouts
<ul>
<li>流量控制</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=源码和使用分析>源码和使用分析<a href=#源码和使用分析 class=hash-link aria-label="Direct link to 源码和使用分析" title="Direct link to 源码和使用分析" translate=no>​</a></h2>
<ul>
<li>PB 附带了所有解析后的消息格式定义</li>
<li>PB 3 增加了 java-util, 可以进行 JSON 序列化
<ul>
<li><code>JsonFormat</code> 打印时需要使用 <code>com.google.protobuf.util.JsonFormat.TypeRegistry</code> 来反查具体类</li>
</ul>
</li>
<li>优化模式
<ul>
<li>SPEED
<ul>
<li>Generate complete code for parsing, serialization, etc.</li>
</ul>
</li>
<li>CODE_SIZE
<ul>
<li>Use ReflectionOps to implement these methods.</li>
</ul>
</li>
<li>LITE_RUNTIME
<ul>
<li>Generate code using MessageLite and the lite runtime.</li>
</ul>
</li>
</ul>
</li>
<li>命名空间
<ul>
<li>与 Java 命名空间的概念相似</li>
<li>生成的类的包名可以不同于 proto 的包</li>
<li>所有定义的消息都有自己的类型和命名空间</li>
<li>因此 Any 消息才能根据一个 url 和数据来还原消息</li>
<li>类型的引用也是基于该命名空间</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=java-1>Java<a href=#java-1 class=hash-link aria-label="Direct link to Java" title="Direct link to Java" translate=no>​</a></h3>
<ul>
<li>服务端支持 Netty</li>
<li>客户端支持 OkHttp 和 Netty</li>
<li>传输层解析出请求的方法
<ul>
<li>方法名实际包含了请求类 <code>foo.bar.Greeter/SayHello</code></li>
</ul>
</li>
<li>实际方法触发位置为 <code>io.grpc.ServerCall.Listener</code> 的不同实现</li>
<li><code>ServerServiceDefinition</code>
<ul>
<li>服务定义</li>
</ul>
</li>
<li><code>ServiceDescriptor</code>
<ul>
<li>服务描述</li>
</ul>
</li>
<li><code>MethodDescriptor</code>
<ul>
<li>方法描述</li>
<li>类型
<ul>
<li>UNARY - 请求 -> 响应</li>
<li>CLIENT_STREAMING - 流请求 -> 响应</li>
<li>SERVER_STREAMING - 请求 -> 流响应</li>
<li>BIDI_STREAMING - 流请求 -> 流响应</li>
</ul>
</li>
</ul>
</li>
<li><code>HandlerRegistry</code>
<ul>
<li>服务注册中心</li>
</ul>
</li>
<li><code>ServerInterceptor</code>
<ul>
<li>服务端拦截器</li>
<li>常见用例
<ul>
<li>授权认证</li>
<li>日志监控</li>
<li>代理</li>
</ul>
</li>
</ul>
</li>
<li><code>ServerCallHandler</code>
<ul>
<li>实际请求处理的方法</li>
</ul>
</li>
<li><code>Stream</code>
<ul>
<li>客户端和服务端的通讯流</li>
</ul>
</li>
<li><code>io.grpc.Context</code>
<ul>
<li>跨线程的处理上下文</li>
</ul>
</li>
<li>速度优化
<ul>
<li>会生成 <code>MethodHandlers</code></li>
<li>统一方法调用</li>
<li>实现所有类型的方法调用接口
<ul>
<li><code>io.grpc.stub.ServerCalls.UnaryMethod</code></li>
<li><code>io.grpc.stub.ServerCalls.ServerStreamingMethod</code></li>
<li><code>io.grpc.stub.ServerCalls.ClientStreamingMethod</code></li>
<li><code>io.grpc.stub.ServerCalls.BidiStreamingMethod</code></li>
</ul>
</li>
<li>实际调用时使用 <code>switch</code> 和事先给定的方法 id 进行请求, 避免使用反射</li>
</ul>
</li>
<li><code>io.grpc.Server</code>
<ul>
<li>服务端</li>
<li><code>InternalServer</code>
<ul>
<li>用于不同链接层实现的接口</li>
<li>建立新的链接时回调 <code>ServerListener#transportCreated</code></li>
</ul>
</li>
</ul>
</li>
<li><code>io.grpc.Status</code>
<ul>
<li>表达异常和状态</li>
</ul>
</li>
<li>基础
<ul>
<li><code>Stream</code></li>
<li><code>StreamListener</code></li>
<li>基本流程
<ul>
<li>方法 -> Call -> Stream</li>
<li>生成 Call 时会创建对应的 Feature</li>
<li>同步请求是循环等待 Feature 完成</li>
</ul>
</li>
<li>完整方法名的命名规则为
<ul>
<li><code>完整的服务名/方法名</code></li>
<li><code>wener.scel.v1.Scel/Search</code></li>
</ul>
</li>
</ul>
</li>
<li>客户端
<ul>
<li><code>ClientCall</code>
<ul>
<li><code>ClientCall.Listener</code>
<ul>
<li><code>onHeaders(Metadata)</code></li>
<li><code>onMessage(RespT)</code></li>
<li><code>onClose(Status,Metadata)</code></li>
</ul>
</li>
<li>处理流程</li>
<li>职责</li>
</ul>
</li>
<li><code>ManagedChannelBuilder</code></li>
<li><code>ClientTransport</code>
<ul>
<li><code>ManagedClientTransport</code>
<ul>
<li>有生命周期管理</li>
<li><code>ConnectionClientTransport</code>
<ul>
<li>基于链接</li>
<li>有属性</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><code>ClientStream</code></li>
<li><code>ClientStreamListener</code></li>
<li>生成的客户端分为三种类型
<ul>
<li>Stub
<ul>
<li>有所有的方法</li>
<li>响应均为 <code>io.grpc.stub.StreamObserver</code></li>
</ul>
</li>
<li>BlockingStub
<ul>
<li>阻塞接口</li>
<li>响应为直接的对象</li>
<li>流响应为 Iterator</li>
<li>不生成流请求</li>
</ul>
</li>
<li>FeatureStub
<ul>
<li>以 Feature 作为返回状态</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>服务端
<ul>
<li><code>ServerCall</code>
<ul>
<li>处理流程
<ul>
<li><code>ServerStream</code> -> <code>ServerStreamListener</code></li>
<li><code>ServerStreamListener#messageRead</code>
<ul>
<li>会对请求对象进行解析</li>
</ul>
</li>
<li><code>ServerCall.Listener#onMessage</code>
<ul>
<li>拦截处理在这一层发生</li>
<li><code>ServerCallHandler</code> 负责从 <code>ServerCall</code> 创建 <code>ServerCall.Listener</code></li>
<li>即实际的方法处理发生在这里</li>
</ul>
</li>
</ul>
</li>
<li><code>ServerCalls</code>
<ul>
<li>提供 <code>ServerCall</code> 到 <code>ServerCallHandler</code> 的适配</li>
<li>主要用于简化实现</li>
<li><code>ServerCall</code> -> <code>ServerCall.Listener</code></li>
<li>一个方法 <code>MethodDescriptor</code> 对应一个 <code>ServerCallHandler</code></li>
</ul>
</li>
<li>职责
<ul>
<li><code>ServerCall.Listener</code> 用于接收消息</li>
<li><code>ServerCall</code> 用于发送和向客户端请求消息</li>
<li><code>ServerCallHandler</code> 方法处理</li>
</ul>
</li>
</ul>
</li>
<li><code>ServerBuilder</code></li>
<li><code>ServerTransport</code></li>
<li><code>ServerStream</code></li>
<li><code>ServerStreamListener</code></li>
</ul>
</li>
<li>Netty
<ul>
<li><code>NettyServerProvider</code></li>
<li><code>NettyChannelProvider</code></li>
<li><code>NettyServer</code></li>
<li><code>NettyServerHandler</code>
<ul>
<li>服务端 GRPC 处理</li>
<li>执行上下文</li>
</ul>
</li>
<li>服务端
<ul>
<li><code>NettyServerTransport</code></li>
<li><code>NettyServerStream</code></li>
</ul>
</li>
<li>客户端
<ul>
<li><code>NettyClientTransport</code></li>
<li><code>NettyClientStream</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>protoc --help</strong></p>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">$ protoc --help</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Usage: protoc [OPTION] PROTO_FILES</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">Parse PROTO_FILES and generate output based on the options given:</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  -IPATH, --proto_path=PATH   Specify the directory in which to search for</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              imports.  May be specified multiple times;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              directories will be searched in order.  If not</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              given, the current working directory is used.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --version                   Show version info and exit.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  -h, --help                  Show this text and exit.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --encode=MESSAGE_TYPE       Read a text-format message of the given type</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              from standard input and write it in binary</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              to standard output.  The message type must</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              be defined in PROTO_FILES or their imports.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --decode=MESSAGE_TYPE       Read a binary message of the given type from</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              standard input and write it in text format</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              to standard output.  The message type must</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              be defined in PROTO_FILES or their imports.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --decode_raw                Read an arbitrary protocol message from</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              standard input and write the raw tag/value</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              pairs in text format to standard output.  No</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              PROTO_FILES should be given when using this</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              flag.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  -oFILE,                     Writes a FileDescriptorSet (a protocol buffer,</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    --descriptor_set_out=FILE defined in descriptor.proto) containing all of</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              the input files to FILE.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --include_imports           When using --descriptor_set_out, also include</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              all dependencies of the input files in the</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              set, so that the set is self-contained.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --include_source_info       When using --descriptor_set_out, do not strip</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              SourceCodeInfo from the FileDescriptorProto.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              This results in vastly larger descriptors that</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              include information about the original</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              location of each decl in the source file as</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              well as surrounding comments.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --dependency_out=FILE       Write a dependency output file in the format</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              expected by make. This writes the transitive</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              set of input file paths to FILE</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --error_format=FORMAT       Set the format in which to print errors.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              FORMAT may be 'gcc' (the default) or 'msvs'</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              (Microsoft Visual Studio format).</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --print_free_field_numbers  Print the free field numbers of the messages</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              defined in the given proto files. Groups share</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              the same field number space with the parent</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              message. Extension ranges are counted as</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              occupied fields numbers.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --plugin=EXECUTABLE         Specifies a plugin executable to use.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              Normally, protoc searches the PATH for</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              plugins, but you may specify additional</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              executables not in the path using this flag.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              Additionally, EXECUTABLE may be of the form</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              NAME=PATH, in which case the given plugin name</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              is mapped to the given executable even if</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">                              the executable's own name differs.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --cpp_out=OUT_DIR           Generate C++ header and source.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --csharp_out=OUT_DIR        Generate C# source file.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --java_out=OUT_DIR          Generate Java source file.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --javanano_out=OUT_DIR      Generate Java Nano source file.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --js_out=OUT_DIR            Generate JavaScript source.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --objc_out=OUT_DIR          Generate Objective C header and source.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --php_out=OUT_DIR           Generate PHP source file.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --python_out=OUT_DIR        Generate Python source file.</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  --ruby_out=OUT_DIR          Generate Ruby source file.</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=聊天>聊天<a href=#聊天 class=hash-link aria-label="Direct link to 聊天" title="Direct link to 聊天" translate=no>​</a></h3>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">syntax = "proto3";</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">// https://github.com/yafithekid/grpc-chat/blob/master/src/main/proto/rpcchat.proto</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">option java_package = "com.if4031.proto";</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">option objc_class_prefix = "HLW";</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">service ChatService {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc join (JoinRequest) returns (Response);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc leave (LeaveRequest) returns (Response);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc send (SendRequest) returns (Response);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc sendAll (SendAllRequest) returns (Response);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc recvAll (RecvAllRequest) returns (ChatResponse);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message Message {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string nickname = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string channel = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string content = 3;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    int64 timestamp = 4;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message Response {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string status = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string message = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message ChatResponse {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string status = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string message = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    repeated Message chats = 3;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message JoinRequest {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string nickname = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string channel = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message LeaveRequest {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string nickname = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string channel = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message SendRequest {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string nickname = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string channel = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string message = 3;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message SendAllRequest {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string nickname = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string message = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message RecvAllRequest {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string nickname = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">syntax = "proto3";</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">service Chat {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  rpc Authorize(RequestAuthorize) returns (ResponseAuthorize);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  rpc Connect(RequestConnect) returns (stream Event);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  rpc Say(CommandSay) returns (None);</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message None {}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message RequestAuthorize {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  string name = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message ResponseAuthorize {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  bytes session_id = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message RequestConnect {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  bytes session_id = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message CommandSay {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  bytes session_id = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  string message = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message Event {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  oneof event {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    EventNone none = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    EventJoin join = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    EventLeave leave = 3;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    EventLog log = 4;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  }</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message EventNone {}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message EventJoin {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  string name = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message EventLeave {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  string name = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message EventLog {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  string name = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">  string message = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<div class="language-text codeBlockContainer_ljD1 theme-code-block" style=--prism-color:#bfc7d5;--prism-background-color:#292d3e><div class=codeBlockContent_rhaG><pre tabindex=0 class="prism-code language-text codeBlock_mx9Q thin-scrollbar" style=color:#bfc7d5;background-color:#292d3e><code class=codeBlockLines_NG8l><span class=token-line style=color:#bfc7d5><span class="token plain">syntax = "proto3";</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">option java_package = "com.chat";</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">package Chat;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">service MyChat{</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc login (Username) returns (LoginSuccess){}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc join (ChannelName) returns (IsSuccess){}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc leave (ChannelName) returns (IsSuccess){}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc sendMessage (Message) returns (IsSuccess) {}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc broadcastMessage (BroadcastMsg) returns (IsSuccess) {}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    rpc getMessages (Username) returns (Messages) {}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message Username {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string username = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message LoginSuccess{</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    bool success = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string username = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message ChannelName {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string username = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string channel = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message IsSuccess {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    bool success = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message Message {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string username = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string channel = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string msg = 3;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message Messages {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    bool success = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    repeated string messages = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">message BroadcastMsg {</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string username = 1;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">    string msg = 2;</span><br/></span><span class=token-line style=color:#bfc7d5><span class="token plain">}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_EG6R" id=faq>FAQ<a href=#faq class=hash-link aria-label="Direct link to FAQ" title="Direct link to FAQ" translate=no>​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_EG6R" id=all-subconns-are-in-transientfailure>all SubConns are in TransientFailure<a href=#all-subconns-are-in-transientfailure class=hash-link aria-label="Direct link to all SubConns are in TransientFailure" title="Direct link to all SubConns are in TransientFailure" translate=no>​</a></h3>
<ul>
<li><a href=https://groups.google.com/forum/#!topic/grpc-io/yCUwuHycNWk target=_blank rel="noopener noreferrer">https://groups.google.com/forum/#!topic/grpc-io/yCUwuHycNWk</a></li>
<li>超时后会恢复</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/wenerme/wener/edit/master/notes/../notes/service/api/grpc/README.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_A7Jz aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_Hg3U"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2023-02-24T07:04:38.000Z itemprop=dateModified>Feb 24, 2023</time></b> by <b>wener</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/notes/service/api/graphql/urql><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>URQL</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/notes/service/api/grpc/connect><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Connect</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_wpyd thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#note class="table-of-contents__link toc-highlight">Note</a><li><a href=#docker class="table-of-contents__link toc-highlight">Docker</a><li><a href=#安装 class="table-of-contents__link toc-highlight">安装</a><li><a href=#java class="table-of-contents__link toc-highlight">Java</a><li><a href=#php class="table-of-contents__link toc-highlight">PHP</a><li><a href=#node class="table-of-contents__link toc-highlight">Node</a><li><a href=#golang class="table-of-contents__link toc-highlight">Golang</a><ul><li><a href=#client class="table-of-contents__link toc-highlight">Client</a><li><a href=#server class="table-of-contents__link toc-highlight">Server</a></ul><li><a href=#web class="table-of-contents__link toc-highlight">Web</a><li><a href=#typescript class="table-of-contents__link toc-highlight">Typescript</a><li><a href=#grpc-gateway class="table-of-contents__link toc-highlight">grpc-gateway</a><li><a href=#auth class="table-of-contents__link toc-highlight">Auth</a><li><a href=#案例 class="table-of-contents__link toc-highlight">案例</a><ul><li><a href=#gcp class="table-of-contents__link toc-highlight">GCP</a></ul><li><a href=#源码和使用分析 class="table-of-contents__link toc-highlight">源码和使用分析</a><ul><li><a href=#java-1 class="table-of-contents__link toc-highlight">Java</a><li><a href=#聊天 class="table-of-contents__link toc-highlight">聊天</a></ul><li><a href=#faq class="table-of-contents__link toc-highlight">FAQ</a><ul><li><a href=#all-subconns-are-in-transientfailure class="table-of-contents__link toc-highlight">all SubConns are in TransientFailure</a></ul></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title>笔记</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/notes/java>Java</a><li class=footer__item><a class=footer__link-item href=/notes/os/alpine>AlpineLinux</a><li class=footer__item><a class=footer__link-item href=/notes/devops/kubernetes>Kubernates</a><li class=footer__item><a class=footer__link-item href=/notes/voip>VoIP</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Projects</div><ul class="footer__items clean-list"><li class=footer__item>
              <div>
              <a class=footer__link-item href=https://github.com/wenerme/wener>Wener</a>
              -
              <a class=footer__link-item href=https://github.com/wenerme/wener/actions title="wenerme/wener - ci">
              <img style="vertical-align: middle;opacity: .4;" src=https://github.com/wenerme/wener/workflows/Build/badge.svg />
              </a>
              </div>
              <li class=footer__item><a href=https://apis.wener.me target=_blank rel="noopener noreferrer" class=footer__link-item>Wener's Apis<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_kUGX><use href=#theme-svg-external-link /></svg></a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Social</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/story>Blog</a><li class=footer__item><a href=https://github.com/wenerme target=_blank rel="noopener noreferrer" class=footer__link-item>GitHub</a><li class=footer__item><a href=https://twitter.com/wenerme target=_blank rel="noopener noreferrer" class=footer__link-item>Twitter</a></ul></div></div><div class="footer__bottom text--center"><div class=margin-bottom--sm><img src=/img/wener-logo.svg alt="Wener Site" class="footer__logo themedComponent_j2y5 themedComponent--light_v877"/><img src=/img/wener-logo.svg alt="Wener Site" class="footer__logo themedComponent_j2y5 themedComponent--dark_PUQY"/></div><div class=footer__copyright>Copyright © 1992-2025 Wener - <img alt=cc-by-sa-4.0 src=https://mirrors.creativecommons.org/presskit/buttons/80x15/svg/by-sa.svg /> - Build @2025-10-09 13:46</div></div></div></footer></div></body>